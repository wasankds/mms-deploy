function showToast(e,t="blue",n=3e3,i="{{sep}}"){document.querySelectorAll(".toast").forEach(c=>c.style.opacity=.5);const o=document.createElement("DIV");o.style.zIndex="99",o.style.position="fixed",o.style.left="0",o.style.bottom="90px",o.style.width="100%",o.style.minWidth="250px",o.style.textAlign="center",o.style.padding="10px 5px",o.style.animation="none",o.style.animation=null,o.classList.add("toast",t),e.split(i).forEach(c=>{const a=document.createElement("P");a.style.lineHeight="1.75rem";const d=document.createElement("span");d.appendChild(document.createTextNode(c)),a.appendChild(d),o.appendChild(a)}),o.style.visibility="visible",o.style.animation=`fadeToastIn 0.5s, fadeToastOut 0.5s ${Number(n/1e3)}s`,document.body.appendChild(o),setTimeout(()=>o.remove(),n)}function showToastStill(e,t="blue",n="{{sep}}"){document.querySelectorAll(".toast").forEach(l=>l.remove());const s=document.createElement("DIV");s.style.zIndex="99",s.style.position="fixed",s.style.left="0",s.style.bottom="30px",s.style.width="100%",s.style.minWidth="250px",s.style.textAlign="center",s.style.padding="16px 5px",s.style.animation="none",s.style.animation=null,s.classList.add("toast",t),e.split(n).forEach(l=>{const c=document.createElement("P"),a=document.createElement("span");a.appendChild(document.createTextNode(l)),c.appendChild(a),s.appendChild(c)}),s.style.visibility="visible",s.style.animation="fadeToastIn 0.5s",document.body.appendChild(s)}var btnCounter,btnFace="";function menuAction(e=null,t=null,n=[]){const i=["_id","_pagePre","_pageNxt"];n.length>0&&n.forEach(c=>i.push(c));const o=document.querySelectorAll("input, select, button, a");var l=1;t=="disabled"?(btnFace==""&&(btnFace=e.value),btnCounter=setInterval(()=>e.value=(l++/10).toFixed(1),100),o.forEach(c=>{i.includes(c.id)||(c.disabled=!0)})):t=="active"&&(o.forEach(c=>{i.includes(c.id)||(c.disabled=!1)}),clearTimeout(btnCounter),e&&(e.value=btnFace,btnFace=""))}function onBtnClicked(e,t,n=!0){var i=e.parentNode;const s=i.querySelector(".btn-show"),o=i.querySelector(".btn-confirm"),l=i.querySelector(".btn-cancel");t=="ON"?(s.style.display="none",l.style.display="inline-block",o.style.display="inline-block",n&&(s.disabled=!1,l.disabled=!1,o.disabled=!1),o.style.gridColumn="1/3",l.style.gridColumn="3/5"):t=="CANCEL"||t=="SUBMITTED"?(s.style.display="inline-block",l.style.display="none",o.style.display="none",n&&(s.disabled=!1,l.disabled=!1,o.disabled=!1)):t=="CONFIRM"&&(s.style.display="none",l.style.display="none",o.style.display="inline-block",o.style.gridColumn="1/5",n&&(s.disabled=!0,l.disabled=!0,o.disabled=!0))}function clearBtnGroupAll(e=!0){document.querySelectorAll(".btn-show").forEach(n=>{e?onBtnClicked(n,"CANCEL"):onBtnClicked(n,"CANCEL",!1)}),clearToast()}function clearToast(){document.querySelectorAll(".toast").forEach(t=>t.remove())}function createSpinner(){const e=document.createElement("div");e.id="custom-spinner-container",e.classList.add("custom-spinner-container"),e.style.cssText=`
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.75); // Semi-transparent backdrop
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000; `;const t=document.createElement("div");t.id="custom-spinner",t.style.cssText=`
    border: 8px solid #f3f3f3; /* Light grey */
    border-top: 8px solid #3498db; /* Blue */
    border-radius: 50%;
    width: 60px;
    height: 60px;
    animation: spin 2s linear infinite;

    position: absolute;    
    top: 50%; 
    left: 50%;
    transform: translate(-50%, -50%); 
  `;const n=document.createElement("style");n.innerHTML=`
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),e.appendChild(t),document.body.appendChild(e)}function removeSpinner(){const e=document.getElementById("custom-spinner-container");e&&e.remove(),document.querySelectorAll("custom-spinner-container").forEach(t=>{t.remove()})}const sendHttpRequest=async(e,t,n)=>{const i=await fetch(t,{method:e,body:JSON.stringify(n),headers:n?{"Content-Type":"application/json"}:{}});return i.status>=400?i.json().then(s=>{const o=new Error("Somthing went wrong !");throw o.data=s,o}):await i.json()};function createThaiDatePicker(e,t="bottom",n=null){const i=["\u0E21\u0E01\u0E23\u0E32\u0E04\u0E21","\u0E01\u0E38\u0E21\u0E20\u0E32\u0E1E\u0E31\u0E19\u0E18\u0E4C","\u0E21\u0E35\u0E19\u0E32\u0E04\u0E21","\u0E40\u0E21\u0E29\u0E32\u0E22\u0E19","\u0E1E\u0E24\u0E29\u0E20\u0E32\u0E04\u0E21","\u0E21\u0E34\u0E16\u0E38\u0E19\u0E32\u0E22\u0E19","\u0E01\u0E23\u0E01\u0E0E\u0E32\u0E04\u0E21","\u0E2A\u0E34\u0E07\u0E2B\u0E32\u0E04\u0E21","\u0E01\u0E31\u0E19\u0E22\u0E32\u0E22\u0E19","\u0E15\u0E38\u0E25\u0E32\u0E04\u0E21","\u0E1E\u0E24\u0E28\u0E08\u0E34\u0E01\u0E32\u0E22\u0E19","\u0E18\u0E31\u0E19\u0E27\u0E32\u0E04\u0E21"],s=flatpickr(e,{dateFormat:"Y-m-d",defaultDate:n,allowInput:!1,clickOpens:!0,static:!1,appendTo:document.body,parseDate:function(o,l){if(console.log(`Parsing date: ${o}`),i.some(c=>o.includes(c))){const a=document.querySelector(e).getAttribute("data-iso-date");return a?new Date(a):new Date}else console.warn(`Invalid date format: ${o}`);return new Date(o)},onOpen:function(o,l,c){setTimeout(()=>{const a=c.calendarContainer,u=c.input.getBoundingClientRect();if(t=="top-right"){const p=u.right-a.offsetWidth,f=u.top-a.offsetHeight;a.style.left=`${p}px`,a.style.top=`${f}px`}else{const p=u.right-a.offsetWidth,f=u.bottom+window.scrollY;a.style.left=`${p}px`,a.style.top=`${f}px`}},0)},onChange:function(o,l,c){if(o[0]&&o.length){const a=o[0],d=a.getDate(),u=a.getMonth(),p=a.getFullYear()+543,f=`${d} ${i[u]} ${p}`,m=newDate_ISO(a),r=document.querySelector(e);if(!r){console.error(`Element with selector "${e}" not found`);return}r.value=f,r.setAttribute("data-iso-date",m),r.setAttribute("data-thai-date",f)}},onClose:function(o,l,c){const a=c.input.getAttribute("data-thai-date");a&&c.input.value!==a&&(c.input.value=a)}});return n&&setTimeout(()=>{const o=document.querySelector(e);if(!o){console.error(`Element with selector "${e}" not found`);return}const l=n.getDate(),c=n.getMonth(),a=n.getFullYear()+543,d=`${l} ${i[c]} ${a}`,u=newDate_ISO(n);o.value=d,o.setAttribute("data-iso-date",u),o.setAttribute("data-thai-date",d)},10),s}function clear_FlatpickrElm(e,t=!1){const n=document.getElementById(e);n.value="",delete n.dataset.thaiDate,delete n.dataset.isoDate,t?n.disabled=!0:n.disabled=!1}function newDate_ISO(e=new Date){const t=e.getDate()<10?"0"+e.getDate():e.getDate(),n=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1;return`${e.getFullYear().toString()}-${n}-${t}`}function newDateTime_ISO(e=new Date){const t=e.getDate()<10?"0"+e.getDate():e.getDate(),n=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,i=e.getFullYear().toString(),s=e.getHours()<10?"0"+e.getHours():e.getHours(),o=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes();return`${i}-${n}-${t} ${s}:${o}`}function now(){const e=new Date,t=e.getDate()<10?"0"+e.getDate():e.getDate(),n=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,i=e.getFullYear().toString(),s=e.getHours()<10?"0"+e.getHours():e.getHours(),o=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),l=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();return`${i}-${n}-${t} ${s}:${o}:${l}`}function format_StringDate_Thai_to_ISO(e){const t=["\u0E21\u0E01\u0E23\u0E32\u0E04\u0E21","\u0E01\u0E38\u0E21\u0E20\u0E32\u0E1E\u0E31\u0E19\u0E18\u0E4C","\u0E21\u0E35\u0E19\u0E32\u0E04\u0E21","\u0E40\u0E21\u0E29\u0E32\u0E22\u0E19","\u0E1E\u0E24\u0E29\u0E20\u0E32\u0E04\u0E21","\u0E21\u0E34\u0E16\u0E38\u0E19\u0E32\u0E22\u0E19","\u0E01\u0E23\u0E01\u0E0E\u0E32\u0E04\u0E21","\u0E2A\u0E34\u0E07\u0E2B\u0E32\u0E04\u0E21","\u0E01\u0E31\u0E19\u0E22\u0E32\u0E22\u0E19","\u0E15\u0E38\u0E25\u0E32\u0E04\u0E21","\u0E1E\u0E24\u0E28\u0E08\u0E34\u0E01\u0E32\u0E22\u0E19","\u0E18\u0E31\u0E19\u0E27\u0E32\u0E04\u0E21"],[n,i,s]=e.split(" "),o=t.indexOf(i)+1;return`${s-543}-${String(o).padStart(2,"0")}-${String(n).padStart(2,"0")}`}function format_StringDate_ISO_to_Thai(e){const t=["\u0E21\u0E01\u0E23\u0E32\u0E04\u0E21","\u0E01\u0E38\u0E21\u0E20\u0E32\u0E1E\u0E31\u0E19\u0E18\u0E4C","\u0E21\u0E35\u0E19\u0E32\u0E04\u0E21","\u0E40\u0E21\u0E29\u0E32\u0E22\u0E19","\u0E1E\u0E24\u0E29\u0E20\u0E32\u0E04\u0E21","\u0E21\u0E34\u0E16\u0E38\u0E19\u0E32\u0E22\u0E19","\u0E01\u0E23\u0E01\u0E0E\u0E32\u0E04\u0E21","\u0E2A\u0E34\u0E07\u0E2B\u0E32\u0E04\u0E21","\u0E01\u0E31\u0E19\u0E22\u0E32\u0E22\u0E19","\u0E15\u0E38\u0E25\u0E32\u0E04\u0E21","\u0E1E\u0E24\u0E28\u0E08\u0E34\u0E01\u0E32\u0E22\u0E19","\u0E18\u0E31\u0E19\u0E27\u0E32\u0E04\u0E21"],n=e.getDate(),i=e.getMonth(),s=e.getFullYear()+543;return`${n} ${t[i]} ${s}`}function format_StringMonth_Thai_to_ISO(e){const t=["\u0E21\u0E01\u0E23\u0E32\u0E04\u0E21","\u0E01\u0E38\u0E21\u0E20\u0E32\u0E1E\u0E31\u0E19\u0E18\u0E4C","\u0E21\u0E35\u0E19\u0E32\u0E04\u0E21","\u0E40\u0E21\u0E29\u0E32\u0E22\u0E19","\u0E1E\u0E24\u0E29\u0E20\u0E32\u0E04\u0E21","\u0E21\u0E34\u0E16\u0E38\u0E19\u0E32\u0E22\u0E19","\u0E01\u0E23\u0E01\u0E0E\u0E32\u0E04\u0E21","\u0E2A\u0E34\u0E07\u0E2B\u0E32\u0E04\u0E21","\u0E01\u0E31\u0E19\u0E22\u0E32\u0E22\u0E19","\u0E15\u0E38\u0E25\u0E32\u0E04\u0E21","\u0E1E\u0E24\u0E28\u0E08\u0E34\u0E01\u0E32\u0E22\u0E19","\u0E18\u0E31\u0E19\u0E27\u0E32\u0E04\u0E21"],[n,i]=e.split(" "),s=t.indexOf(n)+1;return`${i-543}-${String(s).padStart(2,"0")}`}function format_StringMonth_ISO_to_Thai(e){const t=["\u0E21\u0E01\u0E23\u0E32\u0E04\u0E21","\u0E01\u0E38\u0E21\u0E20\u0E32\u0E1E\u0E31\u0E19\u0E18\u0E4C","\u0E21\u0E35\u0E19\u0E32\u0E04\u0E21","\u0E40\u0E21\u0E29\u0E32\u0E22\u0E19","\u0E1E\u0E24\u0E29\u0E20\u0E32\u0E04\u0E21","\u0E21\u0E34\u0E16\u0E38\u0E19\u0E32\u0E22\u0E19","\u0E01\u0E23\u0E01\u0E0E\u0E32\u0E04\u0E21","\u0E2A\u0E34\u0E07\u0E2B\u0E32\u0E04\u0E21","\u0E01\u0E31\u0E19\u0E22\u0E32\u0E22\u0E19","\u0E15\u0E38\u0E25\u0E32\u0E04\u0E21","\u0E1E\u0E24\u0E28\u0E08\u0E34\u0E01\u0E32\u0E22\u0E19","\u0E18\u0E31\u0E19\u0E27\u0E32\u0E04\u0E21"],[n,i]=e.split("-");return`${t[Number(i)-1]} ${Number(n)+543}`}function calc_DiffDateTime(e,t){const n=new Date(e),i=new Date(t),s=864e5,o=36e5,l=i-n,c=Math.floor(l/s),a=Math.floor(l%s/o),d=Math.round(l%s%o/6e4),u=Math.round(l%s%o%6e4/1e3);if(l>0&&c>0)return{diffMs:l,diffDhm:`${c} \u0E27\u0E31\u0E19 ${a} \u0E0A\u0E31\u0E48\u0E27\u0E42\u0E21\u0E07 ${d} \u0E19\u0E32\u0E17\u0E35`};if(l>0&&c==0&&a>0)return{diffMs:l,diffDhm:`${a} \u0E0A\u0E31\u0E48\u0E27\u0E42\u0E21\u0E07 ${d} \u0E19\u0E32\u0E17\u0E35`};if(l>0&&c==0&&a==0&&d>0)return{diffMs:l,diffDhm:`${d} \u0E19\u0E32\u0E17\u0E35`};if(l>0&&c==0&&a==0&&d==0&&u>0)return{diffMs:l,diffDhm:`${u} \u0E27\u0E34\u0E19\u0E32\u0E17\u0E35`};if(l<=0)return{diffMs:l,diffDhm:"-"}}document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".nav-ctn nav"),t=e.querySelector("#navDropdownBtn"),n=e.querySelector("#navDropdownMenu");t.addEventListener("click",function(s){s.stopPropagation(),n.style.display=n.style.display==="block"?"none":"block"}),document.addEventListener("click",function(){n.style.display="none"});const i=e.querySelector("#nav_reportType");i&&i.addEventListener("change",function(){i.value&&(window.location.href=i.value)})});const notifyElm=document.querySelector(".page-notify");document.addEventListener("DOMContentLoaded",()=>{notifyElm&&setTimeout(()=>{notifyElm.remove()},3e3)});let audioContext=null,isAudioEnabled=!1;document.addEventListener("DOMContentLoaded",function(){enableAudioOnFirstInteraction(),setTimeout(()=>{isAudioEnabled||createAudioEnableButton()},2e3)});function enableAudioOnFirstInteraction(){const e=()=>{isAudioEnabled||(audioContext=new(window.AudioContext||window.webkitAudioContext),audioContext.resume().then(()=>{isAudioEnabled=!0}),document.removeEventListener("click",e),document.removeEventListener("keydown",e),document.removeEventListener("touchstart",e))};document.addEventListener("click",e),document.addEventListener("keydown",e),document.addEventListener("touchstart",e)}function createAudioEnableButton(){if(document.getElementById("enableAudioBtn"))return;const e=document.createElement("button");e.id="enableAudioBtn",e.innerHTML="\u{1F514} \u0E40\u0E1B\u0E34\u0E14\u0E43\u0E0A\u0E49\u0E40\u0E2A\u0E35\u0E22\u0E07\u0E41\u0E08\u0E49\u0E07\u0E40\u0E15\u0E37\u0E2D\u0E19",e.style.cssText=`
    position: fixed;
    top: 80px;
    right: 20px;
    background: linear-gradient(45deg, #ff6b6b, #ee5a24);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    box-shadow: 0 4px 12px rgba(238, 90, 36, 0.3);
    z-index: 10000;
    font-size: 14px;
    animation: pulse 2s infinite;
  `;const t=document.createElement("style");t.textContent=`
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
  `,document.head.appendChild(t),e.onclick=()=>{audioContext=new(window.AudioContext||window.webkitAudioContext),audioContext.resume().then(()=>{isAudioEnabled=!0,e.remove();const n=new Audio("/sounds/TINBELL.WAV");n.volume=1,n.play().catch(i=>{console.log("\u0E44\u0E21\u0E48\u0E2A\u0E32\u0E21\u0E32\u0E23\u0E16\u0E40\u0E25\u0E48\u0E19\u0E40\u0E2A\u0E35\u0E22\u0E07\u0E17\u0E14\u0E2A\u0E2D\u0E1A\u0E44\u0E14\u0E49:",i.message)})}).catch(n=>{console.log("\u0E44\u0E21\u0E48\u0E2A\u0E32\u0E21\u0E32\u0E23\u0E16\u0E40\u0E1B\u0E34\u0E14\u0E43\u0E0A\u0E49\u0E40\u0E2A\u0E35\u0E22\u0E07\u0E44\u0E14\u0E49:",n.message),showToast("\u0E44\u0E21\u0E48\u0E2A\u0E32\u0E21\u0E32\u0E23\u0E16\u0E40\u0E1B\u0E34\u0E14\u0E43\u0E0A\u0E49\u0E40\u0E2A\u0E35\u0E22\u0E07\u0E44\u0E14\u0E49","red",3e3)})},document.body.appendChild(e)}function playAlertSound(){if(!isAudioEnabled){console.log("\u0E40\u0E2A\u0E35\u0E22\u0E07\u0E22\u0E31\u0E07\u0E44\u0E21\u0E48\u0E44\u0E14\u0E49\u0E40\u0E1B\u0E34\u0E14\u0E43\u0E0A\u0E49\u0E07\u0E32\u0E19 - \u0E41\u0E2A\u0E14\u0E07 visual indicator \u0E41\u0E17\u0E19");return}try{const e=new Audio("/sounds/boing_from_mouth_harp.mp3");e.volume=.7,e.play().catch(t=>{console.log("\u0E44\u0E21\u0E48\u0E2A\u0E32\u0E21\u0E32\u0E23\u0E16\u0E40\u0E25\u0E48\u0E19\u0E40\u0E2A\u0E35\u0E22\u0E07\u0E44\u0E14\u0E49:",t.message)})}catch(e){console.log("Error creating audio:",e.message)}}socket.on("alert",function(e){if(typeof DEVICE>"u"||e.deviceId!==DEVICE.deviceId)return;const t=document.getElementById("alertCount");if(t){let n=parseInt(t.textContent)||0;n++,t.textContent=n}playAlertSound(),showToast("\u{1F514} \u0E21\u0E35\u0E01\u0E32\u0E23\u0E41\u0E08\u0E49\u0E07\u0E40\u0E15\u0E37\u0E2D\u0E19\u0E43\u0E2B\u0E21\u0E48!","red",3e3)});const alertBellEl=document.getElementById("alertBell");alertBellEl&&alertBellEl.addEventListener("click",function(){const e={};typeof DEVICE<"u"&&(e.deviceId=DEVICE.deviceId),sendHttpRequest("post",PATH_GET_ALERTS,e).then(t=>{if(!t.isGet){showToast(t.msg,"red");return}const n=t.dataAlerts;if(n.length>0){showAlertsModal(n);const i=document.getElementById("alertCount");i&&(i.textContent="")}else showToast("\u0E44\u0E21\u0E48\u0E21\u0E35\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E01\u0E32\u0E23\u0E41\u0E08\u0E49\u0E07\u0E40\u0E15\u0E37\u0E2D\u0E19\u0E43\u0E2B\u0E21\u0E48","blue",2e3)}).catch(t=>{console.log(t),showToast(t.message,"red")}).finally(()=>{})});function showAlertsModal(e){const t=document.createElement("div");t.classList.add("alert-modal-overlay");const n=document.createElement("div");n.classList.add("alert-modal");const i=document.createElement("div");i.classList.add("alert-modal-header"),i.innerHTML=`
    <span>\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E01\u0E32\u0E23\u0E41\u0E08\u0E49\u0E07\u0E40\u0E15\u0E37\u0E2D\u0E19 (${e.length} \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23)</span>
    <button type="button" class="alert-modal-close">&times;</button>
  `;const s=document.createElement("div");s.classList.add("alert-modal-body");const o=document.createElement("table");o.classList.add("modal-alerts-table");const l=document.createElement("thead");l.innerHTML=`<tr>
      <th class="al-c"><i class="fas fa-clock"></i></th>
      <th class="al-c"><i class="fas fa-microchip"></i></th>
      <th class="al-c"><i class="fas fa-tags"></th>
      <th class="al-c"><i class="fas fa-sort"></th>
      <th class="al-c"><i class="fas fa-exclamation-triangle"></i></th>
      <th class="al-c"><i class="fas fa-bell"></i></th>
      <th class="al-c"><i class="fas fa-exchange-alt"></i></th>
    </tr>`,o.appendChild(l);const c=document.createElement("tbody");e.forEach(r=>{const h=document.createElement("tr"),y=r.triggerType=="min"?"fc-dkorange":"fc-red",g=r.triggerType=="min"?"\u0E15\u0E48\u0E33":"\u0E2A\u0E39\u0E07",{diffDhm:v}=calc_DiffDateTime(r.timestamp,now()),E=r.deviceName.length>10?r.deviceName.substring(0,10)+"..":r.deviceName,b=r.value-r.triggerValue;h.innerHTML=`
        <td class="${y}" title="${r.timestamp}">${v}\u0E01\u0E48\u0E2D\u0E19</td>
        <td class="${y}">${E} [${r.deviceId}]</td>
        <td class="${y}">${r.keyName} [${r.key}]</td>
        <td class="al-c ${y}">${g}</td>
        <td class="al-r ${y}">${r.triggerValue} ${r.keyUnit}</td>
        <td class="al-r ${y}">${r.value} ${r.keyUnit}</td>
        <td class="al-r ${y}">${b}</td>
      `,c.appendChild(h)}),o.appendChild(c),s.appendChild(o),n.appendChild(i),n.appendChild(s),t.appendChild(n),document.body.appendChild(t);const a=alertBellEl.getBoundingClientRect(),d=Math.min(600,window.innerWidth-10);let u=a.right-d,p=a.bottom+5;u<10&&(u=10),p+400>window.innerHeight&&(p=a.top-400,p<10&&(p=10)),n.style.left=u+"px",n.style.top=p+"px",n.style.width=d+"px",setTimeout(()=>{t.classList.add("show")},10);const f=()=>{t.classList.remove("show"),setTimeout(()=>{document.body.removeChild(t)},200)};i.querySelector(".alert-modal-close").addEventListener("click",f),t.addEventListener("click",r=>{r.target===t&&f()});const m=r=>{r.key==="Escape"&&(f(),document.removeEventListener("keydown",m))};document.addEventListener("keydown",m)}const IS_MOVE_CARD=0;var MSNRY;document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector(".card-container");if(Masonry){const t=window.innerWidth;let n="10px";t<768?n="3px":t<1e3&&(n="5px"),e.style.paddingTop=n,MSNRY=new Masonry(e,{itemSelector:".card",percentPosition:!0,gutter:3,originTop:!0,transitionDuration:"0.2s"})}}),deviceIds.forEach(e=>{socket.on(e,function(t){const n=document.querySelector(`.${e}-card`);if(!n)return;const i=n.querySelector(`.${t.id}-${t.key}-timestamp`),s=t.timestamp?t.timestamp.split(" ")[1]:"";i&&(i.textContent=s);const o=n.querySelector(`.${t.id}-${t.key}-lastValue`);if(o){o.textContent=t.lastValue!==void 0?Number(t.lastValue).toFixed(2):"";const m=o.closest("div");m&&m.removeAttribute("style")}const l=n.querySelector(`.${t.id}-${t.key}-timeInterval`);l&&(l.textContent=t.timeInterval?t.timeInterval:"");const c=n.querySelector(`.${t.id}-${t.key}-min`);c&&(c.textContent=t.min!==void 0?Number(t.min).toFixed(2):"");const a=n.querySelector(`.${t.id}-${t.key}-max`);a&&(a.textContent=t.max!==void 0?Number(t.max).toFixed(2):"");const d=n.querySelector(`.${t.id}-${t.key}-avg`);d&&(d.textContent=t.avg!==void 0?Number(t.avg).toFixed(2):"");const u=n.querySelector(`.${t.id}-${t.key}-count`);u&&(u.textContent=t.count!==void 0?t.count:"");const p=dataDevices.find(m=>m.deviceId===t.id);if(p){const m=p.triggerRows.find(r=>r.triggerKey===t.key);if(!m||m.triggerStatus!="active")return;if(m.triggerMin&&t.lastValue<m.triggerMin)var f="yellow";else if(m.triggerMax&&t.lastValue>m.triggerMax)var f="red";else var f="";if(f){const r=n.querySelector(`.${t.id}-${t.key}-lastValue`);if(r){const h=r.closest("div");h&&(h.style.backgroundColor=f)}IS_MOVE_CARD&&(n.parentNode.prepend(n),n.classList.add("move-up"),MSNRY.reloadItems(),MSNRY.layout(),setTimeout(()=>{n.classList.remove("move-up")},1e3))}}})});
