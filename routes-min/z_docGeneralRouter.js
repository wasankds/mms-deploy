const _0x48eaf5=_0x38c1;(function(_0x2f4a56,_0x3602f6){const _0x41f757=_0x38c1,_0x585b89=_0x2f4a56();while(!![]){try{const _0x1f5d2a=-parseInt(_0x41f757(0x182))/0x1+-parseInt(_0x41f757(0x240))/0x2*(parseInt(_0x41f757(0x1f0))/0x3)+-parseInt(_0x41f757(0x23e))/0x4*(parseInt(_0x41f757(0x19c))/0x5)+-parseInt(_0x41f757(0x223))/0x6+parseInt(_0x41f757(0x27a))/0x7+parseInt(_0x41f757(0x1c4))/0x8+-parseInt(_0x41f757(0x246))/0x9*(-parseInt(_0x41f757(0x1bb))/0xa);if(_0x1f5d2a===_0x3602f6)break;else _0x585b89['push'](_0x585b89['shift']());}catch(_0x275c44){_0x585b89['push'](_0x585b89['shift']());}}}(_0x34f9,0xeff02));const _0xcec276=(function(){const _0x2849d7=_0x38c1,_0x2f257c={'jrlNA':function(_0x5d16fa,_0xfe13fd){return _0x5d16fa(_0xfe13fd);},'BhUXi':'red','pKdpn':function(_0xfa2361,_0x594713){return _0xfa2361===_0x594713;},'ubkpm':_0x2849d7(0x174),'MOzWj':function(_0x5cca53,_0xaafd21){return _0x5cca53!==_0xaafd21;},'nFpoU':'kBCOV','nkWwb':function(_0x395e34,_0x590761){return _0x395e34===_0x590761;},'TPcTl':'ZaNap','qdEHi':_0x2849d7(0x245)};let _0x2544b7=!![];return function(_0x5c27ae,_0x5140ed){const _0xac0efa=_0x2849d7,_0x1b0e71={'TuutI':_0x2f257c[_0xac0efa(0x292)],'RzYnl':function(_0x315e6b,_0x3989f2){const _0x14fa5f=_0xac0efa;return _0x2f257c[_0x14fa5f(0x15a)](_0x315e6b,_0x3989f2);},'ttTuO':_0x2f257c['ubkpm'],'RvBAq':function(_0x5e5060,_0x193101){return _0x2f257c['MOzWj'](_0x5e5060,_0x193101);},'QPjeb':_0x2f257c['nFpoU']};if(_0x2f257c['nkWwb'](_0x2f257c[_0xac0efa(0x290)],_0x2f257c[_0xac0efa(0x1ca)]))_0x2f257c[_0xac0efa(0x280)](_0x4fc90a,'0');else{const _0x151e86=_0x2544b7?function(){const _0x9d5eb1=_0xac0efa,_0x276133={'YWend':_0x1b0e71[_0x9d5eb1(0x2a2)]};if(_0x1b0e71[_0x9d5eb1(0x2a4)](_0x1b0e71[_0x9d5eb1(0x1c1)],_0x1b0e71['ttTuO'])){if(_0x5140ed){if(_0x1b0e71[_0x9d5eb1(0x1fc)](_0x1b0e71['QPjeb'],_0x1b0e71[_0x9d5eb1(0x1f4)])){const _0x83ad3c=_0x2d29c2?function(){const _0xc668ba=_0x9d5eb1;if(_0x3e2462){const _0xff5e6b=_0x5aa2f0[_0xc668ba(0x288)](_0x2c87a0,arguments);return _0x296e11=null,_0xff5e6b;}}:function(){};return _0x1e3550=![],_0x83ad3c;}else{const _0x1fcfa1=_0x5140ed[_0x9d5eb1(0x288)](_0x5c27ae,arguments);return _0x5140ed=null,_0x1fcfa1;}}}else return _0x5b6109['log'](_0x448112),_0x1691f4[_0x9d5eb1(0x1d3)](_0xc5f3ff['stringify']({'isFetch':!0x1,'class':_0x276133[_0x9d5eb1(0x186)],'msg':_0x346583[_0x9d5eb1(0x270)]}));}:function(){};return _0x2544b7=![],_0x151e86;}};}());(function(){const _0x1209d6=_0x38c1,_0x254d04={'FepFJ':_0x1209d6(0x1cb),'ncsGQ':_0x1209d6(0x205),'yeuOF':function(_0x312db7,_0x508f4d){return _0x312db7!==_0x508f4d;},'jMWIY':_0x1209d6(0x1ea),'wUUpl':_0x1209d6(0x230),'hNCic':'function\x20*\x5c(\x20*\x5c)','oyFGo':_0x1209d6(0x209),'fJVCn':function(_0x4c9876,_0x125cc3){return _0x4c9876(_0x125cc3);},'rIDPA':'init','SRffY':function(_0xee61e4,_0xc7a6a9){return _0xee61e4+_0xc7a6a9;},'fMFZl':_0x1209d6(0x1aa),'oSkFI':_0x1209d6(0x177),'FRlOo':function(_0x34f7c9,_0x16b51b){return _0x34f7c9===_0x16b51b;},'exikM':_0x1209d6(0x19a),'OqOna':function(_0x1fd55a,_0x2ecf5a){return _0x1fd55a(_0x2ecf5a);},'mFKSO':_0x1209d6(0x1fa),'TePFm':function(_0x31f2fc){return _0x31f2fc();},'YJsgM':function(_0x4a4df0,_0x1a79e4,_0x496685){return _0x4a4df0(_0x1a79e4,_0x496685);}};_0x254d04[_0x1209d6(0x18b)](_0xcec276,this,function(){const _0x5b675b=_0x1209d6,_0x42322f={'AfqVq':_0x254d04[_0x5b675b(0x192)],'AxSeS':_0x254d04[_0x5b675b(0x26f)]};if(_0x254d04[_0x5b675b(0x184)](_0x254d04[_0x5b675b(0x1a9)],_0x254d04[_0x5b675b(0x2a1)])){const _0x4817cd=new RegExp(_0x254d04[_0x5b675b(0x28a)]),_0xfc8d77=new RegExp(_0x254d04['oyFGo'],'i'),_0x4534d4=_0x254d04[_0x5b675b(0x1c0)](_0x12becd,_0x254d04[_0x5b675b(0x293)]);if(!_0x4817cd[_0x5b675b(0x170)](_0x254d04[_0x5b675b(0x1c5)](_0x4534d4,_0x254d04['fMFZl']))||!_0xfc8d77[_0x5b675b(0x170)](_0x254d04[_0x5b675b(0x1c5)](_0x4534d4,_0x254d04[_0x5b675b(0x155)]))){if(_0x254d04[_0x5b675b(0x193)](_0x254d04['exikM'],_0x254d04[_0x5b675b(0x1fe)]))_0x254d04[_0x5b675b(0x289)](_0x4534d4,'0');else return![];}else _0x254d04[_0x5b675b(0x184)](_0x254d04[_0x5b675b(0x1bc)],_0x254d04[_0x5b675b(0x1bc)])?_0xc0b025['close']():_0x254d04[_0x5b675b(0x16a)](_0x12becd);}else _0x1d0a47[_0x5b675b(0x2a0)](_0x42322f[_0x5b675b(0x22e)],_0x51a568),_0x8bdd3c['send'](_0x23e608[_0x5b675b(0x236)]({'isPrint':!0x1,'class':_0x42322f[_0x5b675b(0x18a)],'msg':_0x3c44ef[_0x5b675b(0x270)]}));})();}());const _0x45c5fd=(function(){const _0x228ff0=_0x38c1,_0x4d7280={'vwNVv':function(_0x42515b,_0x493cdc){return _0x42515b===_0x493cdc;},'iYNRv':_0x228ff0(0x297),'uHRCr':_0x228ff0(0x1f5),'rrvhS':_0x228ff0(0x205),'JgjqE':function(_0x52ec3f,_0x208e56){return _0x52ec3f!==_0x208e56;},'VlDjq':_0x228ff0(0x1be),'GBXGz':_0x228ff0(0x22f)};let _0x4f806f=!![];return function(_0x3ce011,_0x13057e){const _0xa076f7=_0x228ff0,_0x570c86={'YbSOY':_0x4d7280[_0xa076f7(0x2b8)]};if(_0x4d7280[_0xa076f7(0x2a9)](_0x4d7280['VlDjq'],_0x4d7280['GBXGz'])){const _0x9f1839=_0x4f806f?function(){const _0x1165a7=_0xa076f7;if(_0x4d7280[_0x1165a7(0x2a3)](_0x4d7280[_0x1165a7(0x217)],_0x4d7280[_0x1165a7(0x217)])){if(_0x13057e){if(_0x4d7280[_0x1165a7(0x2a3)](_0x4d7280[_0x1165a7(0x2ab)],_0x4d7280[_0x1165a7(0x2ab)])){const _0x59b4b2=_0x13057e[_0x1165a7(0x288)](_0x3ce011,arguments);return _0x13057e=null,_0x59b4b2;}else return _0x6861c8[_0x1165a7(0x2a0)](_0xc277fb),_0x2b3fec[_0x1165a7(0x1d3)](_0x493294[_0x1165a7(0x236)]({'isSearch':!0x1,'class':_0x570c86[_0x1165a7(0x284)],'msg':_0x4b108f[_0x1165a7(0x270)]}));}}else return!![];}:function(){};return _0x4f806f=![],_0x9f1839;}else{const _0x22d07c=_0x3285f9['apply'](_0x274eb9,arguments);return _0x5e1015=null,_0x22d07c;}};}()),_0x5861f3=_0x45c5fd(this,function(){const _0x2551a0=_0x38c1,_0x19ab72={'UKKjw':'red','HaIvf':_0x2551a0(0x15d),'UMskL':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','gZSFT':function(_0x72f832,_0x20e6b7){return _0x72f832(_0x20e6b7);},'sMJNp':_0x2551a0(0x16d),'OskcL':function(_0x269db4,_0x325725){return _0x269db4+_0x325725;},'OgYVX':_0x2551a0(0x1aa),'MgYnc':'input','pPmlU':function(_0x759697){return _0x759697();},'AFYkx':function(_0x469816,_0x46a270,_0x48b14d){return _0x469816(_0x46a270,_0x48b14d);},'YIFBE':function(_0x14d88a,_0x186280){return _0x14d88a===_0x186280;},'njlvF':_0x2551a0(0x27e),'WKoij':function(_0x33db5e,_0x2b5a58){return _0x33db5e!==_0x2b5a58;},'mupDZ':_0x2551a0(0x25a),'mFtqI':function(_0x2fc1b7,_0x26390a){return _0x2fc1b7+_0x26390a;},'rKjbN':_0x2551a0(0x251),'kyEuh':_0x2551a0(0x20e),'xBvyo':'RyNVV','DljNg':_0x2551a0(0x234),'RzMRf':function(_0xddf8b5){return _0xddf8b5();},'OfVWs':_0x2551a0(0x2a0),'kZHgN':_0x2551a0(0x2a7),'DlENV':_0x2551a0(0x25f),'OBORO':'error','HBqIE':_0x2551a0(0x283),'lWYLm':'table','emCJA':'trace','PMUzE':function(_0x4e3241,_0x3748d3){return _0x4e3241<_0x3748d3;},'oBVhE':_0x2551a0(0x23f)},_0xb894f2=function(){const _0x5bf1ef=_0x2551a0;if(_0x19ab72[_0x5bf1ef(0x255)](_0x19ab72[_0x5bf1ef(0x250)],_0x19ab72[_0x5bf1ef(0x250)])){let _0x3f1ffd;try{_0x19ab72[_0x5bf1ef(0x1c2)](_0x19ab72[_0x5bf1ef(0x282)],_0x19ab72[_0x5bf1ef(0x282)])?(_0x5f2e0b[_0x5bf1ef(0x2a0)](_0xad0769),_0x29e97b[_0x5bf1ef(0x1d3)](_0x3b1f46[_0x5bf1ef(0x236)]({'isStatus':!0x1,'class':_0x19ab72[_0x5bf1ef(0x1f9)],'msg':_0x470251[_0x5bf1ef(0x270)]}))):_0x3f1ffd=_0x19ab72[_0x5bf1ef(0x26b)](Function,_0x19ab72['OskcL'](_0x19ab72[_0x5bf1ef(0x1ab)](_0x19ab72[_0x5bf1ef(0x203)],_0x19ab72['kyEuh']),');'))();}catch(_0x5d3623){if(_0x19ab72['YIFBE'](_0x19ab72[_0x5bf1ef(0x25b)],_0x19ab72[_0x5bf1ef(0x29a)])){const _0x3f4b16={'aAGxz':_0x19ab72['HaIvf'],'zEFNL':_0x19ab72['UMskL'],'daVvJ':function(_0x52d602,_0x2ea95a){const _0x4b3d60=_0x5bf1ef;return _0x19ab72[_0x4b3d60(0x26b)](_0x52d602,_0x2ea95a);},'UdQDn':_0x19ab72[_0x5bf1ef(0x162)],'qsGoG':function(_0x150bd2,_0x36a690){const _0x212d74=_0x5bf1ef;return _0x19ab72[_0x212d74(0x1b5)](_0x150bd2,_0x36a690);},'uSIiX':_0x19ab72['OgYVX'],'zrOLW':function(_0x37fd15,_0x2cf9a7){const _0x2e4f35=_0x5bf1ef;return _0x19ab72[_0x2e4f35(0x1b5)](_0x37fd15,_0x2cf9a7);},'CEChd':_0x19ab72[_0x5bf1ef(0x1ac)],'hHlzD':function(_0x5d5225,_0x5a85d7){return _0x19ab72['gZSFT'](_0x5d5225,_0x5a85d7);},'smHaA':function(_0x34f7c4){const _0x246910=_0x5bf1ef;return _0x19ab72[_0x246910(0x27c)](_0x34f7c4);}};_0x19ab72['AFYkx'](_0x5e1f7f,this,function(){const _0x3669c2=_0x5bf1ef,_0x1c6ca4=new _0x55c17d(_0x3f4b16['aAGxz']),_0x1beaa7=new _0x297e3e(_0x3f4b16['zEFNL'],'i'),_0x34f225=_0x3f4b16[_0x3669c2(0x156)](_0x302c84,_0x3f4b16[_0x3669c2(0x1d9)]);!_0x1c6ca4[_0x3669c2(0x170)](_0x3f4b16[_0x3669c2(0x29c)](_0x34f225,_0x3f4b16['uSIiX']))||!_0x1beaa7[_0x3669c2(0x170)](_0x3f4b16['zrOLW'](_0x34f225,_0x3f4b16[_0x3669c2(0x22d)]))?_0x3f4b16[_0x3669c2(0x2c2)](_0x34f225,'0'):_0x3f4b16[_0x3669c2(0x1a1)](_0x1db486);})();}else _0x3f1ffd=window;}return _0x3f1ffd;}else _0x246014=_0x1f1301;},_0x504e89=_0x19ab72[_0x2551a0(0x24f)](_0xb894f2),_0x19a1d5=_0x504e89[_0x2551a0(0x21a)]=_0x504e89['console']||{},_0x45f748=[_0x19ab72[_0x2551a0(0x1b3)],_0x19ab72[_0x2551a0(0x1c7)],_0x19ab72[_0x2551a0(0x2bb)],_0x19ab72[_0x2551a0(0x254)],_0x19ab72['HBqIE'],_0x19ab72[_0x2551a0(0x152)],_0x19ab72['emCJA']];for(let _0x4308b9=0x0;_0x19ab72[_0x2551a0(0x1d4)](_0x4308b9,_0x45f748[_0x2551a0(0x1a4)]);_0x4308b9++){if(_0x19ab72[_0x2551a0(0x255)](_0x19ab72[_0x2551a0(0x21d)],_0x19ab72[_0x2551a0(0x21d)])){const _0x3c24ab=_0x45c5fd[_0x2551a0(0x298)]['prototype'][_0x2551a0(0x20a)](_0x45c5fd),_0x52bdec=_0x45f748[_0x4308b9],_0x29df64=_0x19a1d5[_0x52bdec]||_0x3c24ab;_0x3c24ab[_0x2551a0(0x17e)]=_0x45c5fd[_0x2551a0(0x20a)](_0x45c5fd),_0x3c24ab['toString']=_0x29df64[_0x2551a0(0x1b8)]['bind'](_0x29df64),_0x19a1d5[_0x52bdec]=_0x3c24ab;}else{const _0x1c6658=_0x7e7d0d['apply'](_0x477e5c,arguments);return _0x38d7ac=null,_0x1c6658;}}});_0x5861f3();import _0xd29416 from'express';const b=_0xd29416[_0x48eaf5(0x1e4)]();import _0x383b20 from'path';import{MongoClient as _0xdb116}from'mongodb';import _0x45c881 from'../middleware/mainAuth.js';import*as _0x1ad5a7 from'../mymodule/myUsers.js';import*as _0x33a6d9 from'../mymodule/myDateTime.js';import*as _0x41c318 from'../mymodule/myModule.js';import*as _0x4de8c1 from'../mymodule/myDocMain.js';import*as _0x49ba9b from'../mymodule/myData.js';function _0x38c1(_0x51da4d,_0x191817){const _0x3d0272=_0x34f9();return _0x38c1=function(_0x5861f3,_0x45c5fd){_0x5861f3=_0x5861f3-0x151;let _0x39d7c2=_0x3d0272[_0x5861f3];return _0x39d7c2;},_0x38c1(_0x51da4d,_0x191817);}function _0x34f9(){const _0x3b15bc=['fOuaH','uHRCr','mSHPl','setContent','debu','gnWBi','ottCn','spaBC','rfZXF','/changes','action','PATH_WAREHOUSE_OUT','mPVSJ','ไม่พบเอกสารล่าสุด','rrvhS','matchedCount','canEdit','DlENV','doc_changes.ejs','string','sddlK','afOsx','modifiedCount','ZNuQJ','hHlzD','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','lWYLm','ykCwm','wRaFl','oSkFI','daVvJ','KlOLe','active','NjGfS','pKdpn','lUHFT','odyvp','function\x20*\x5c(\x20*\x5c)','YWafz','SqZln','svRuL','sdQVG','sMJNp','KcIZd','MfJdw','fggLZ','HJyAr','green','/print','nBZyC','TePFm','/search','QFDrl','init','naYVu','includes','test','updateOne','offsetHeight','setViewport','IKtxD','uuWYo','clientHeight','input','oLEYF','close','evaluate','jyYZp','PATH_WAREHOUSE_IN','XezXn','__proto__','akzxI','dNoRA','rPXCD','1193605FkLiDY','isAuth','yeuOF','cNoGF','YWend','ItNDu','sales','tFMWa','AxSeS','YJsgM','พบ\x20\x22','tLRZj','OFFiG','APUeB','YuXHN','getSettings','FepFJ','FRlOo','userId','sBPhJ','/load-last','nBdQU','check_DocDateTime_CanEdit','.jpeg','OLEvF','baSNF','485zGiOXD','docStatusNumber','\x20ไม่เปลี่ยนแปลง\x22','DOC_TYPE','renderView','smHaA','image','iySEA','length','bfMLn','XTPnk','qRZQP','VlUfv','jMWIY','chain','mFtqI','MgYnc','ไม่พบเอกสาร\x20\x22','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','ubTHh','/status','{{sep}}หรือไม่มีสิทธิ์','dbUrl','OfVWs','canCancel','OskcL','zuvmg','PciYE','toString','UqlNh','MeCVl','20fnJNPm','mFKSO','setZone','MfhRE','fWUXw','fJVCn','ttTuO','WKoij','rFbIA','9983408oAzGUY','SRffY','sfKrY','kZHgN','originalUrl','JDhfJ','qdEHi','error\x20===>\x20','stateObject','UMvTM','ukVRP','pgbgN','bBCkz','getUserData','dateTimeCanEdit','send','PMUzE','check_DocDateTime_CanCancel','toFormat','IaGyJ','get_StatusName_byStatusNumber','UdQDn','getItems_for_Modal','replace','IkbDO','เอกสาร\x20\x22','finish','INKHW','QtoBH','XnGUy','PqlKt','branchName','Router','tvylg','gger','JqLys','DnXcb','call','qVDyv','dbName','PQoSC','kLrwL','CAiRt','fKWVZ','1498452uSBqoJ','puppeteer','image/jpeg','attachment;\x20filename=','QPjeb','FOUoe','EPwVi','rphXU','ไม่พบประวัติการเปลี่ยนแปลง','UKKjw','jqBTB','dYCeu','RvBAq','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','exikM','yyyy-MM-dd\x20HH:mm','LiLyk','CbJKe','LffkG','rKjbN','CUQwS','red','JdCXe','MpmEb','gqHdG','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','bind','docTitle','stock','getUserBranchesById','{}.constructor(\x22return\x20this\x22)(\x20)','getChangeHistory','vYXCx','getDate','HUMAe','USiVs','post','HbLHw','zaLUj','iYNRv','IIOgv','vWLUa','console','WqIhp','jpeg','oBVhE','networkidle0','get_Info_ByUrl','BCOVP','qPTEH','vFMQN','10048542cLXvGG','auDSO','DMmay','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','BVfmz','nxfwp','nfWOU','IGbny','dateTimeCanCancel','rtXLz','CEChd','AfqVq','FVmqz','MlaUj','iYZRL','prototype','findOne','DEAPt','ไม่พบเอกสารเลขที่\x20\x22','stringify','docId','print','BDuDi','/load','toArray','nLSgF','TWJAn','37108WfMEQw','iMIuJ','2mCrJKt','load','RjCcE','YVYpn','warehouseOut','wkmor','14690826VTIEom','XWVOI','RBHDh','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','gfgYM','getMainDocPathObj','ucRYF','connect','yellow','RzMRf','njlvF','return\x20(function()\x20','igbVt','FFdBI','OBORO','YIFBE','hjwib','qwQtF','userAuthority','YrSiB','cBAXZ','xBvyo','max','rJcUF','dateTimeEditRemain','info','load-last','WTOxk','qldEE','HnsdH','kZgHI','vvkmR','BqDIO','โหลดเอกสารเลขที่\x20\x22','JNyIl','now','aaeUm','gZSFT','scrollHeight','TByUV','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','ncsGQ','message','warehouseIn','DUiCx','convert_DocPrint','XyrLL','/fetch/modal','tmLEd','xShcT','userFullname','\x22\x20{{sep}}เรียบร้อยแล้ว','5165629ZCcank','bkmOF','pPmlU','VVaCQ','lCRFx','rxCxZ','jrlNA','dateTimeCancelRemain','mupDZ','exception','YbSOY','{{sep}}[บันทึกการแก้ไข]','uKxhK','eRSsv','apply','OqOna','hNCic','floor','zVQbc','wnGaO','wfmcH','DyGck','TPcTl','enDiw','BhUXi','rIDPA','lEsMy','kHWfd','body','pWkbM','constructor','DAnGg','DljNg','while\x20(true)\x20{}','qsGoG','XGzop','rCpTo','join','log','wUUpl','TuutI','vwNVv','RzYnl','lFMMV','newPage','warn','collection','JgjqE'];_0x34f9=function(){return _0x3b15bc;};return _0x34f9();}import{DateTime as _0x2efc7b}from'luxon';const w=global[_0x48eaf5(0x17c)],S=global[_0x48eaf5(0x2b5)],p=global['PATH_SALES'],k=[w+_0x48eaf5(0x2b3),S+_0x48eaf5(0x2b3),p+_0x48eaf5(0x2b3)],v=[w+_0x48eaf5(0x168),S+_0x48eaf5(0x168),p+_0x48eaf5(0x168)],B=[w+_0x48eaf5(0x1b0),S+'/status',p+'/status'],x=[w+_0x48eaf5(0x16b),S+_0x48eaf5(0x16b),p+_0x48eaf5(0x16b)],L=[w+_0x48eaf5(0x23a),S+'/load',p+_0x48eaf5(0x23a),w+'/load-last',S+_0x48eaf5(0x196),p+_0x48eaf5(0x196)],W=[w+_0x48eaf5(0x275),S+_0x48eaf5(0x275),p+'/fetch/modal'];b['get'](W,_0x45c881['isAuth'],async(_0x34b56c,_0x402a82)=>{const _0x5dcc51=_0x48eaf5,_0x5b5b68={'baSNF':function(_0x17fbbf,_0xaf75aa){return _0x17fbbf!==_0xaf75aa;},'hjwib':_0x5dcc51(0x276),'VlUfv':function(_0x6d2d85,_0x21909a){return _0x6d2d85==_0x21909a;},'JDhfJ':_0x5dcc51(0x271),'zuvmg':_0x5dcc51(0x20c),'mYXcf':_0x5dcc51(0x244),'KcIZd':function(_0x39df91,_0x19aa1e){return _0x39df91==_0x19aa1e;},'eRSsv':_0x5dcc51(0x188),'kKozr':_0x5dcc51(0x158),'ItNDu':'green','OFFiG':_0x5dcc51(0x26e),'qwQtF':'NrcgU','WTOxk':'QCQgF','XnGUy':'red'},_0x27825d=await _0x1ad5a7[_0x5dcc51(0x1d1)](_0x34b56c),_0xa3c193=await _0x4de8c1[_0x5dcc51(0x24b)](_0x34b56c,_0x402a82,_0x27825d[_0x5dcc51(0x258)]);try{if(_0x5b5b68['baSNF'](_0x5b5b68[_0x5dcc51(0x256)],_0x5b5b68[_0x5dcc51(0x256)])){const _0x4049b4=_0x464f1a[_0x5dcc51(0x298)][_0x5dcc51(0x232)][_0x5dcc51(0x20a)](_0x355425),_0x4e214d=_0x176715[_0x2ad3df],_0x44e4b4=_0x1c653c[_0x4e214d]||_0x4049b4;_0x4049b4[_0x5dcc51(0x17e)]=_0x91e621[_0x5dcc51(0x20a)](_0x5c8f7f),_0x4049b4[_0x5dcc51(0x1b8)]=_0x44e4b4['toString']['bind'](_0x44e4b4),_0x2c6bf0[_0x4e214d]=_0x4049b4;}else{if(_0x5b5b68[_0x5dcc51(0x1a8)](_0xa3c193[_0x5dcc51(0x19f)],_0x5b5b68[_0x5dcc51(0x1c9)]))var _0x57be3a=await _0x49ba9b[_0x5dcc51(0x1da)](_0x5b5b68[_0x5dcc51(0x1b6)]);else{if(_0x5b5b68['VlUfv'](_0xa3c193['DOC_TYPE'],_0x5b5b68['mYXcf']))var _0x57be3a=await _0x49ba9b['getItems_for_Modal'](_0x5b5b68[_0x5dcc51(0x1b6)]);else{if(_0x5b5b68[_0x5dcc51(0x163)](_0xa3c193[_0x5dcc51(0x19f)],_0x5b5b68[_0x5dcc51(0x287)]))var _0x57be3a=await _0x49ba9b[_0x5dcc51(0x1da)](_0x5b5b68['kKozr']);}}const _0x19bb26=await _0x49ba9b['getItemsCategory']();return _0x402a82[_0x5dcc51(0x1d3)](JSON[_0x5dcc51(0x236)]({'DATA_ITEMS':_0x57be3a,'DATA_CATEGORY':_0x19bb26,'isFetch':!0x0,'class':_0x5b5b68[_0x5dcc51(0x187)],'msg':_0x5b5b68[_0x5dcc51(0x18e)]}));}}catch(_0x565024){if(_0x5b5b68[_0x5dcc51(0x19b)](_0x5b5b68[_0x5dcc51(0x257)],_0x5b5b68[_0x5dcc51(0x261)]))return console[_0x5dcc51(0x2a0)](_0x565024),_0x402a82[_0x5dcc51(0x1d3)](JSON[_0x5dcc51(0x236)]({'isFetch':!0x1,'class':_0x5b5b68[_0x5dcc51(0x1e1)],'msg':_0x565024['message']}));else _0x57657c[_0x5dcc51(0x179)]();}}),b[_0x48eaf5(0x214)](x,_0x45c881[_0x48eaf5(0x183)],async(_0x285073,_0xce1548)=>{const _0x353254=_0x48eaf5,_0x27ff40={'fKWVZ':'error\x20===>\x20','qRZQP':_0x353254(0x205),'XTPnk':function(_0x32baea,_0x32543c){return _0x32baea<_0x32543c;},'nLSgF':'yellow','kHWfd':'กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','vWLUa':function(_0x2e53ba,_0x131e64){return _0x2e53ba===_0x131e64;},'UFNWg':_0x353254(0x175),'JdCXe':_0x353254(0x1af),'RBHDh':_0x353254(0x151),'PciYE':function(_0x5c8758,_0x17dc3a){return _0x5c8758+_0x17dc3a;},'bfMLn':_0x353254(0x167),'sIwdt':function(_0x473dd9,_0x8546b5){return _0x473dd9!==_0x8546b5;},'DUiCx':_0x353254(0x252),'RjCcE':function(_0x23c1a4,_0x477bef){return _0x23c1a4!==_0x477bef;},'LffkG':'UpDSh'};let {sip:_0x34db09}=_0x285073['body'];if(!_0x34db09&&_0x27ff40[_0x353254(0x1a6)](_0x34db09['length'],0x2))return _0xce1548['send'](JSON[_0x353254(0x236)]({'isSearch':!0x1,'class':_0x27ff40[_0x353254(0x23c)],'msg':_0x27ff40[_0x353254(0x295)]}));_0x34db09=_0x34db09[_0x353254(0x1db)](/[!@#$%^&*<>]/g,'')??null;const _0x4fe08c=await _0x1ad5a7[_0x353254(0x1d1)](_0x285073);await _0x4de8c1[_0x353254(0x24b)](_0x285073,_0xce1548,_0x4fe08c[_0x353254(0x258)]);const {collectionName:_0x16eea3}=_0x49ba9b[_0x353254(0x21f)](_0x285073[_0x353254(0x1c8)]),_0x39b387=new _0xdb116(global[_0x353254(0x1b2)]);try{if(_0x27ff40[_0x353254(0x219)](_0x27ff40['UFNWg'],_0x27ff40[_0x353254(0x206)]))_0x42800a['log'](_0x27ff40[_0x353254(0x1ef)],_0x47947f),_0x76f270[_0x353254(0x1d3)](_0x3e3fec['stringify']({'isPrint':!0x1,'class':_0x27ff40['qRZQP'],'msg':_0xabbb98[_0x353254(0x270)]}));else{await _0x39b387[_0x353254(0x24d)]();const _0x26b7e3=_0x39b387['db'](global[_0x353254(0x1eb)])['collection'](_0x16eea3),_0x20b2d1=[{'$or':[{'docId':{'$regex':_0x34db09,'$options':'i'}},{'docDateTime':{'$regex':_0x34db09,'$options':'i'}}]}];let _0x1a30e4='';['O','S'][_0x353254(0x16f)](_0x4fe08c[_0x353254(0x258)])||(_0x1a30e4+=_0x27ff40[_0x353254(0x248)],_0x20b2d1['push']({'userId':_0x4fe08c[_0x353254(0x194)]}));const _0x3782dc=await _0x26b7e3['aggregate']([{'$match':{'$and':_0x20b2d1}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDateTime':0x1,'userId':0x1}}])[_0x353254(0x23b)]();return _0x1a30e4=_0x27ff40[_0x353254(0x1b7)](_0x353254(0x18c)+_0x3782dc[_0x353254(0x1a4)]+'\x22\x20เอกสาร',_0x1a30e4),_0xce1548[_0x353254(0x1d3)](JSON[_0x353254(0x236)]({'searchFound':_0x3782dc,'msg':_0x1a30e4,'isSearch':!0x0,'class':_0x27ff40[_0x353254(0x1a5)]}));}}catch(_0x299a87){if(_0x27ff40['sIwdt'](_0x27ff40[_0x353254(0x272)],_0x27ff40['DUiCx'])){if(_0x570ce0){const _0x490cef=_0x1cb0fa[_0x353254(0x288)](_0x26d040,arguments);return _0x5db2f4=null,_0x490cef;}}else return console[_0x353254(0x2a0)](_0x299a87),_0xce1548[_0x353254(0x1d3)](JSON['stringify']({'isSearch':!0x1,'class':_0x27ff40[_0x353254(0x1a7)],'msg':_0x299a87[_0x353254(0x270)]}));}finally{if(_0x27ff40[_0x353254(0x242)](_0x27ff40[_0x353254(0x202)],_0x27ff40['LffkG'])){const _0x22eb8e=_0x516ca3?function(){const _0x5322ea=_0x353254;if(_0x298598){const _0x422e37=_0x65409b[_0x5322ea(0x288)](_0x55c8e5,arguments);return _0x57c10b=null,_0x422e37;}}:function(){};return _0x4c3e37=![],_0x22eb8e;}else _0x39b387[_0x353254(0x179)]();}}),b[_0x48eaf5(0x214)](L,_0x45c881['isAuth'],async(_0x2ef4cb,_0x481b67)=>{const _0xcefe70=_0x48eaf5,_0x1b158d={'XezXn':function(_0x21a150,_0x51c10b){return _0x21a150+_0x51c10b;},'gnWBi':_0xcefe70(0x2ae),'rFbIA':_0xcefe70(0x1e6),'mSHPl':'action','DnXcb':function(_0x493abf,_0x34ed6a){return _0x493abf+_0x34ed6a;},'fOuaH':_0xcefe70(0x1cc),'APUeB':function(_0x1feb60){return _0x1feb60();},'DyGck':function(_0x4d18ef,_0x5c8a65){return _0x4d18ef(_0x5c8a65);},'fWUXw':_0xcefe70(0x251),'gfgYM':_0xcefe70(0x20e),'nBdQU':function(_0x1085b7,_0x3c94fa){return _0x1085b7(_0x3c94fa);},'PeGGV':function(_0xefa81,_0x183d9b){return _0xefa81!==_0x183d9b;},'IIOgv':_0xcefe70(0x227),'YrSiB':'pYdsS','CAiRt':function(_0xdcd0b9,_0x5c1ce6){return _0xdcd0b9===_0x5c1ce6;},'sddlK':_0xcefe70(0x241),'svRuL':function(_0x4baa00,_0xfe418e){return _0x4baa00!==_0xfe418e;},'HJyAr':'pQsJf','aaeUm':_0xcefe70(0x178),'SqZln':_0xcefe70(0x260),'MeCVl':_0xcefe70(0x2b7),'YVYpn':'red','nBZyC':function(_0x552df9,_0x4953b4){return _0x552df9==_0x4953b4;},'CUQwS':function(_0x1d1ed2,_0x5e47bc){return _0x1d1ed2===_0x5e47bc;},'vfVqv':_0xcefe70(0x23d),'EPwVi':function(_0x66421f,_0x5a37e5){return _0x66421f==_0x5a37e5;},'sJuke':_0xcefe70(0x249),'IaGyJ':_0xcefe70(0x216),'HUquW':_0xcefe70(0x1ed),'PpFTo':function(_0x1a0e29,_0x12ccf9){return _0x1a0e29==_0x12ccf9;},'Eaohz':'{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','ucRYF':_0xcefe70(0x167),'EqILN':'WvlyA','qPTEH':_0xcefe70(0x268)};let {docId:_0x2bc43a,action:_0x89aa68}=_0x2ef4cb[_0xcefe70(0x296)];const _0x42f45e=await _0x1ad5a7[_0xcefe70(0x1d1)](_0x2ef4cb);await _0x4de8c1[_0xcefe70(0x24b)](_0x2ef4cb,_0x481b67,_0x42f45e[_0xcefe70(0x258)]);const {collectionName:_0xe43d38}=_0x49ba9b['get_Info_ByUrl'](_0x2ef4cb['originalUrl']),_0x2efe74=new _0xdb116(global[_0xcefe70(0x1b2)]);try{if(_0x1b158d['PeGGV'](_0x1b158d[_0xcefe70(0x218)],_0x1b158d[_0xcefe70(0x259)])){await _0x2efe74['connect']();const _0x16adb5=_0x2efe74['db'](global['dbName'])['collection'](_0xe43d38);if(_0x1b158d[_0xcefe70(0x1ee)](_0x89aa68,_0x1b158d[_0xcefe70(0x2be)])){if(_0x1b158d[_0xcefe70(0x160)](_0x1b158d[_0xcefe70(0x166)],_0x1b158d[_0xcefe70(0x26a)])){const _0x241206=['O','S'][_0xcefe70(0x16f)](_0x42f45e[_0xcefe70(0x258)])?{'docId':_0x2bc43a}:{'docId':_0x2bc43a,'userId':_0x42f45e[_0xcefe70(0x194)]};var _0x1c9d25=await _0x16adb5[_0xcefe70(0x233)](_0x241206,{'projection':{'_id':0x0,'changesHistory':0x0}});}else(function(){return!![];}[_0xcefe70(0x298)](MMYfkj[_0xcefe70(0x17d)](MMYfkj[_0xcefe70(0x2af)],MMYfkj[_0xcefe70(0x1c3)]))[_0xcefe70(0x1e9)](MMYfkj[_0xcefe70(0x2ac)]));}else{if(_0x1b158d[_0xcefe70(0x1ee)](_0x89aa68,_0x1b158d[_0xcefe70(0x15f)]))var _0x1c9d25=await _0x16adb5['findOne']({'userId':_0x42f45e[_0xcefe70(0x194)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x1e4ad5=_0x1c9d25?'':_0x1b158d['CAiRt'](_0x89aa68,_0x1b158d[_0xcefe70(0x2be)])?_0xcefe70(0x235)+_0x2bc43a+'\x22':_0x1b158d[_0xcefe70(0x1ba)];if(!_0x1c9d25)return _0x481b67[_0xcefe70(0x1d3)](JSON[_0xcefe70(0x236)]({'isLoad':!0x1,'class':_0x1b158d[_0xcefe70(0x243)],'msg':_0x1e4ad5}));let _0x3507bb=_0xcefe70(0x267)+_0x1c9d25[_0xcefe70(0x237)]+_0xcefe70(0x279);if(_0x1b158d[_0xcefe70(0x169)](_0x1c9d25[_0xcefe70(0x19d)],0x1)&&_0x1c9d25[_0xcefe70(0x1d2)]){if(_0x1b158d[_0xcefe70(0x204)](_0x1b158d['vfVqv'],_0x1b158d['vfVqv'])){let _0x4940a2=await _0x49ba9b[_0xcefe70(0x198)](_0x1c9d25,_0xe43d38,_0x42f45e[_0xcefe70(0x194)]);_0x1c9d25[_0xcefe70(0x25e)]=_0x4940a2[_0xcefe70(0x25e)],_0x1b158d['EPwVi'](_0x4940a2[_0xcefe70(0x2ba)],!0x1)&&(_0x1c9d25[_0xcefe70(0x19d)]=_0x4940a2[_0xcefe70(0x19d)],_0x3507bb+=_0x1b158d['sJuke']);}else(function(){return![];}[_0xcefe70(0x298)](MMYfkj['DnXcb'](MMYfkj[_0xcefe70(0x2af)],MMYfkj[_0xcefe70(0x1c3)]))['apply'](MMYfkj[_0xcefe70(0x2aa)]));}else _0x1c9d25[_0xcefe70(0x25e)]='-';if((_0x1b158d[_0xcefe70(0x1f6)](_0x1c9d25['docStatusNumber'],0x1)||_0x1b158d[_0xcefe70(0x169)](_0x1c9d25[_0xcefe70(0x19d)],0x2))&&_0x1c9d25[_0xcefe70(0x22b)]){if(_0x1b158d[_0xcefe70(0x160)](_0x1b158d[_0xcefe70(0x1d7)],_0x1b158d['HUquW'])){const _0x48081b=await _0x49ba9b[_0xcefe70(0x1d5)](_0x1c9d25,_0xe43d38,_0x42f45e[_0xcefe70(0x194)]);_0x1c9d25[_0xcefe70(0x281)]=_0x48081b[_0xcefe70(0x281)],_0x1b158d['PpFTo'](_0x48081b[_0xcefe70(0x1b4)],!0x1)&&(_0x3507bb+=_0x1b158d['Eaohz']);}else MMYfkj[_0xcefe70(0x18f)](_0x2d3fc9);}else _0x1c9d25['dateTimeCancelRemain']='-';const {branchName:_0x57be4a}=await _0x49ba9b[_0xcefe70(0x20d)](_0x1c9d25['branchId']);return _0x1c9d25[_0xcefe70(0x1e3)]=_0x57be4a,_0x481b67['send'](JSON['stringify']({'doc':_0x1c9d25,'isLoad':!0x0,'class':_0x1b158d[_0xcefe70(0x24c)],'msg':_0x3507bb,'userId':_0x42f45e[_0xcefe70(0x194)],'userAuthority':_0x42f45e[_0xcefe70(0x258)]}));}else _0x12b14e=MMYfkj[_0xcefe70(0x28f)](_0x5eab9d,MMYfkj[_0xcefe70(0x1e8)](MMYfkj[_0xcefe70(0x1e8)](MMYfkj[_0xcefe70(0x1bf)],MMYfkj[_0xcefe70(0x24a)]),');'))();}catch(_0x2a185a){if(_0x1b158d[_0xcefe70(0x1ee)](_0x1b158d['EqILN'],_0x1b158d['EqILN']))return console[_0xcefe70(0x2a0)](_0x2a185a),_0x481b67[_0xcefe70(0x1d3)](JSON[_0xcefe70(0x236)]({'isLoad':!0x1,'class':_0x1b158d[_0xcefe70(0x243)],'msg':_0x2a185a[_0xcefe70(0x270)]}));else _0x2b124f[_0xcefe70(0x179)]();}finally{if(_0x1b158d[_0xcefe70(0x160)](_0x1b158d[_0xcefe70(0x221)],_0x1b158d[_0xcefe70(0x221)])){if(_0x3b1ec2)return _0x1b6b06;else MMYfkj[_0xcefe70(0x197)](_0xebf49,0x0);}else _0x2efe74[_0xcefe70(0x179)]();}}),b[_0x48eaf5(0x214)](k,_0x45c881[_0x48eaf5(0x183)],async(_0x2f7a93,_0xb78fb9)=>{const _0x1649ea=_0x48eaf5,_0x3eaedf={'sfKrY':_0x1649ea(0x29b),'pgbgN':'counter','TByUV':function(_0x697fc9,_0x368680){return _0x697fc9!==_0x368680;},'odyvp':'MLIge','ykCwm':_0x1649ea(0x205),'bBCkz':function(_0x4389f6,_0x4f5909){return _0x4389f6<_0x4f5909;},'YuXHN':'yellow','dYCeu':_0x1649ea(0x1f8),'zVQbc':_0x1649ea(0x2bc),'KAFLA':'Asia/Bangkok','ottCn':_0x1649ea(0x1ff),'wtyTP':_0x1649ea(0x167),'rtXLz':function(_0x12c1a0,_0x12d90d){return _0x12c1a0===_0x12d90d;},'lFMMV':'OnVRt','ZNuQJ':'error\x20===>\x20','iYZRL':function(_0x41a806,_0x32fbbf){return _0x41a806!==_0x32fbbf;},'WqIhp':_0x1649ea(0x165)},{docId:_0x4bef49}=_0x2f7a93['body'],_0x318a36=await _0x1ad5a7['getUserData'](_0x2f7a93);await _0x4de8c1[_0x1649ea(0x24b)](_0x2f7a93,_0xb78fb9,_0x318a36[_0x1649ea(0x258)]);const {collectionName:_0x533092}=_0x49ba9b[_0x1649ea(0x21f)](_0x2f7a93[_0x1649ea(0x1c8)]),_0x11130e=new _0xdb116(global['dbUrl']);try{if(_0x3eaedf[_0x1649ea(0x26d)](_0x3eaedf[_0x1649ea(0x15c)],_0x3eaedf[_0x1649ea(0x15c)])){if(_0x4ff241){const _0x4a8ab7=_0x3405b5[_0x1649ea(0x288)](_0x1f9bc0,arguments);return _0x3b6340=null,_0x4a8ab7;}}else{await _0x11130e[_0x1649ea(0x24d)]();var _0x3e6690=await _0x11130e['db'](global[_0x1649ea(0x1eb)])['collection'](_0x533092)[_0x1649ea(0x233)]({'docId':_0x4bef49});if(!_0x3e6690)return _0xb78fb9[_0x1649ea(0x1d3)](JSON[_0x1649ea(0x236)]({'isPrint':!0x1,'class':_0x3eaedf[_0x1649ea(0x153)],'msg':_0x1649ea(0x235)+_0x4bef49+'\x22'}));const _0x3ca7e=_0x3e6690['changesHistory']||[];if(_0x3eaedf[_0x1649ea(0x1d0)](_0x3ca7e[_0x1649ea(0x1a4)],0x1))return _0xb78fb9[_0x1649ea(0x1d3)](JSON[_0x1649ea(0x236)]({'isPrint':!0x1,'class':_0x3eaedf[_0x1649ea(0x190)],'msg':_0x3eaedf[_0x1649ea(0x1fb)]}));const _0x4b6ead=_0x383b20[_0x1649ea(0x29f)](folderForms,_0x3eaedf[_0x1649ea(0x28c)]),_0x836453=await _0x41c318[_0x1649ea(0x1a0)](_0x4b6ead,_0xb78fb9,{'title':_0x3e6690[_0x1649ea(0x237)],'time':_0x2efc7b[_0x1649ea(0x269)]()[_0x1649ea(0x1bd)](_0x3eaedf['KAFLA'])[_0x1649ea(0x1d6)](_0x3eaedf[_0x1649ea(0x2b0)]),'changesHistory':_0x3ca7e});_0xb78fb9[_0x1649ea(0x1d3)](JSON[_0x1649ea(0x236)]({'isPrint':!0x0,'class':_0x3eaedf['wtyTP'],'htmlPage':_0x836453}));}}catch(_0x34308e){_0x3eaedf[_0x1649ea(0x22c)](_0x3eaedf['lFMMV'],_0x3eaedf[_0x1649ea(0x2a5)])?(console['log'](_0x3eaedf[_0x1649ea(0x2c1)],_0x34308e),_0xb78fb9[_0x1649ea(0x1d3)](JSON[_0x1649ea(0x236)]({'isPrint':!0x1,'class':_0x3eaedf[_0x1649ea(0x153)],'msg':_0x34308e[_0x1649ea(0x270)]}))):_0x422724[_0x1649ea(0x179)]();}finally{if(_0x3eaedf[_0x1649ea(0x231)](_0x3eaedf[_0x1649ea(0x21b)],_0x3eaedf[_0x1649ea(0x21b)]))return function(_0x169d0a){}[_0x1649ea(0x298)](udIhfR[_0x1649ea(0x1c6)])[_0x1649ea(0x288)](udIhfR[_0x1649ea(0x1cf)]);else _0x11130e[_0x1649ea(0x179)]();}}),b[_0x48eaf5(0x214)](v,_0x45c881[_0x48eaf5(0x183)],async(_0x1f2f84,_0x18339e)=>{const _0x5d42ff=_0x48eaf5,_0x2dd22d={'HbLHw':_0x5d42ff(0x205),'gqHdG':function(_0x5f07f2,_0x2b80e7){return _0x5f07f2===_0x2b80e7;},'USwzl':_0x5d42ff(0x263),'VVaCQ':_0x5d42ff(0x16c),'KArIa':'function\x20*\x5c(\x20*\x5c)','sBPhJ':_0x5d42ff(0x209),'rJcUF':function(_0x5a1497,_0x42fda2){return _0x5a1497(_0x42fda2);},'lUHFT':'init','MpmEb':function(_0x391f1,_0x338b5b){return _0x391f1+_0x338b5b;},'cNoGF':_0x5d42ff(0x1aa),'DAnGg':function(_0x124701,_0x169bcc){return _0x124701+_0x169bcc;},'XSjWe':_0x5d42ff(0x177),'qtZar':function(_0x53f011,_0x2f8239){return _0x53f011(_0x2f8239);},'HUMAe':function(_0x887f33){return _0x887f33();},'mPVSJ':function(_0x1b00f0,_0x3551de){return _0x1b00f0!==_0x3551de;},'XyrLL':_0x5d42ff(0x1e5),'NjGfS':'doc_print.ejs','rswfW':function(_0x3e5a34,_0x463463){return _0x3e5a34==_0x463463;},'QtoBH':_0x5d42ff(0x238),'lZvtf':_0x5d42ff(0x167),'dNoRA':function(_0x26ea39,_0x17aff4){return _0x26ea39==_0x17aff4;},'IsIku':_0x5d42ff(0x1a2),'xShcT':_0x5d42ff(0x222),'iySEA':_0x5d42ff(0x1f1),'naYVu':_0x5d42ff(0x21e),'jyYZp':function(_0x5e544f,_0x3a4ec2){return _0x5e544f*_0x3a4ec2;},'tFMWa':function(_0x3b5bc0,_0x1cce51){return _0x3b5bc0/_0x1cce51;},'vvkmR':_0x5d42ff(0x21c),'qjvOP':_0x5d42ff(0x1f2),'kZgHI':_0x5d42ff(0x228),'enDiw':'error\x20===>\x20','sdQVG':function(_0x25501b,_0x4286c1){return _0x25501b!==_0x4286c1;},'wnGaO':'ISzhz'},{docId:_0x381611,action:_0x13e9d3}=_0x1f2f84[_0x5d42ff(0x296)],_0x38cb5d=await _0x1ad5a7[_0x5d42ff(0x1d1)](_0x1f2f84);await _0x4de8c1[_0x5d42ff(0x24b)](_0x1f2f84,_0x18339e,_0x38cb5d[_0x5d42ff(0x258)]);const {collectionName:_0x34bb83,docTitle:_0x5191b6}=_0x49ba9b[_0x5d42ff(0x21f)](_0x1f2f84[_0x5d42ff(0x1c8)]),_0x4c51c7=new _0xdb116(global[_0x5d42ff(0x1b2)]);try{if(_0x2dd22d[_0x5d42ff(0x2b6)](_0x2dd22d[_0x5d42ff(0x274)],_0x2dd22d['XyrLL'])){const _0xb48d00=_0x2a1359[_0x5d42ff(0x296)],_0x2e087e=_0x5932bb['documentElement'];return _0x301409[_0x5d42ff(0x25c)](_0xb48d00[_0x5d42ff(0x26c)],_0xb48d00[_0x5d42ff(0x172)],_0x2e087e[_0x5d42ff(0x176)],_0x2e087e['scrollHeight'],_0x2e087e[_0x5d42ff(0x172)]);}else{await _0x4c51c7['connect']();var _0x59e7f9=await _0x4c51c7['db'](global[_0x5d42ff(0x1eb)])[_0x5d42ff(0x2a8)](_0x34bb83)['findOne']({'docId':_0x381611});if(!_0x59e7f9)return _0x18339e[_0x5d42ff(0x1d3)](JSON[_0x5d42ff(0x236)]({'isLoad':!0x1,'class':_0x2dd22d[_0x5d42ff(0x215)],'msg':_0x5d42ff(0x235)+_0x381611+'\x22'}));_0x59e7f9[_0x5d42ff(0x20b)]=_0x5191b6,_0x59e7f9['statusName']=_0x49ba9b[_0x5d42ff(0x1d8)](_0x59e7f9['docStatusNumber']);const _0x1ae097=_0x49ba9b[_0x5d42ff(0x273)](_0x59e7f9),_0x41f8fb=_0x383b20[_0x5d42ff(0x29f)](folderForms,_0x2dd22d[_0x5d42ff(0x159)]),_0x4d019e=await _0x41c318['renderView'](_0x41f8fb,_0x18339e,{'title':_0x381611,'time':_0x33a6d9[_0x5d42ff(0x211)](0x0),'action':_0x13e9d3,'doc':_0x1ae097,...await _0x41c318[_0x5d42ff(0x191)]()});if(_0x2dd22d['rswfW'](_0x13e9d3,_0x2dd22d[_0x5d42ff(0x1e0)]))_0x18339e[_0x5d42ff(0x1d3)](JSON['stringify']({'isPrint':!0x0,'class':_0x2dd22d['lZvtf'],'htmlPage':_0x4d019e}));else{if(_0x2dd22d[_0x5d42ff(0x180)](_0x13e9d3,_0x2dd22d['IsIku'])){if(_0x2dd22d[_0x5d42ff(0x208)](_0x2dd22d[_0x5d42ff(0x277)],_0x2dd22d['xShcT'])){const _0x3d88cf=await(await import(_0x2dd22d[_0x5d42ff(0x1a3)]))['launch'](),_0x299bb8=await _0x3d88cf[_0x5d42ff(0x2a6)]();await _0x299bb8[_0x5d42ff(0x2ad)](_0x4d019e,{'waitUntil':_0x2dd22d[_0x5d42ff(0x16e)],'timeout':0x2710}),await new Promise(_0x1067af=>setTimeout(_0x1067af,0x3e8));const _0x46307b=Math[_0x5d42ff(0x28b)](_0x2dd22d[_0x5d42ff(0x17b)](_0x2dd22d[_0x5d42ff(0x189)](0x50,25.4),0x60));await _0x299bb8[_0x5d42ff(0x173)]({'width':_0x46307b,'height':0x258,'deviceScaleFactor':0x1});const _0x3386e6=await _0x299bb8[_0x5d42ff(0x17a)](()=>{const _0x291a75=_0x5d42ff,_0x5b7bcf={'rPXCD':_0x2dd22d['HbLHw']};if(_0x2dd22d['gqHdG'](_0x2dd22d['USwzl'],_0x2dd22d[_0x291a75(0x27d)]))return _0x387a94[_0x291a75(0x2a0)](_0x557af7),_0x171412[_0x291a75(0x1d3)](_0x1e5799['stringify']({'isLoad':!0x1,'class':_0x5b7bcf[_0x291a75(0x181)],'msg':_0x49ac8a[_0x291a75(0x270)]}));else{const _0x5a10cd=document['body'],_0x2f77f8=document['documentElement'];return Math[_0x291a75(0x25c)](_0x5a10cd[_0x291a75(0x26c)],_0x5a10cd[_0x291a75(0x172)],_0x2f77f8['clientHeight'],_0x2f77f8[_0x291a75(0x26c)],_0x2f77f8['offsetHeight']);}}),_0x2ef8a3=await _0x299bb8['screenshot']({'type':_0x2dd22d[_0x5d42ff(0x265)],'clip':{'x':0x0,'y':0x0,'width':_0x46307b,'height':_0x3386e6},'omitBackground':!0x1});await _0x3d88cf[_0x5d42ff(0x179)]();const _0x2e273f=_0x59e7f9[_0x5d42ff(0x237)][_0x5d42ff(0x1db)](/\//g,'');_0x18339e['writeHead'](0xc8,{'Content-Type':_0x2dd22d['qjvOP'],'Content-Disposition':_0x5d42ff(0x1f3)+_0x2e273f+_0x5d42ff(0x199),'Content-Length':_0x2ef8a3[_0x5d42ff(0x1a4)]}),_0x18339e['end'](_0x2ef8a3);}else return _0x46700e;}}}}catch(_0x3d7f79){_0x2dd22d[_0x5d42ff(0x208)](_0x2dd22d['kZgHI'],_0x2dd22d[_0x5d42ff(0x264)])?(console[_0x5d42ff(0x2a0)](_0x2dd22d[_0x5d42ff(0x291)],_0x3d7f79),_0x18339e[_0x5d42ff(0x1d3)](JSON['stringify']({'isPrint':!0x1,'class':_0x2dd22d[_0x5d42ff(0x215)],'msg':_0x3d7f79[_0x5d42ff(0x270)]}))):_0x3e5484['close']();}finally{if(_0x2dd22d[_0x5d42ff(0x161)](_0x2dd22d['wnGaO'],_0x2dd22d[_0x5d42ff(0x28d)])){const _0x197ed4=new _0x5bc389(hnSodU['KArIa']),_0x9b0078=new _0x4b4a70(hnSodU[_0x5d42ff(0x195)],'i'),_0x3eb608=hnSodU[_0x5d42ff(0x25d)](_0x548633,hnSodU[_0x5d42ff(0x15b)]);!_0x197ed4[_0x5d42ff(0x170)](hnSodU[_0x5d42ff(0x207)](_0x3eb608,hnSodU[_0x5d42ff(0x185)]))||!_0x9b0078[_0x5d42ff(0x170)](hnSodU[_0x5d42ff(0x299)](_0x3eb608,hnSodU['XSjWe']))?hnSodU['qtZar'](_0x3eb608,'0'):hnSodU[_0x5d42ff(0x212)](_0x35d787);}else _0x4c51c7[_0x5d42ff(0x179)]();}}),b[_0x48eaf5(0x214)](B,_0x45c881[_0x48eaf5(0x183)],async(_0x598522,_0x23c0ed)=>{const _0x57b700=_0x48eaf5,_0x101ef1={'afOsx':function(_0x47d4fd,_0x27f543){return _0x47d4fd(_0x27f543);},'XWVOI':function(_0x236ca6,_0xfc6427){return _0x236ca6(_0xfc6427);},'wRaFl':function(_0x5db50c,_0x547411){return _0x5db50c+_0x547411;},'rxCxZ':function(_0x3902a0,_0x17f1e5){return _0x3902a0+_0x17f1e5;},'ANhzA':_0x57b700(0x251),'exogg':_0x57b700(0x20e),'KlOLe':function(_0x3ac8b9,_0x111d79){return _0x3ac8b9==_0x111d79;},'USiVs':'cancel','UqlNh':'ยกเลิก','nBCWp':function(_0x193eb7,_0x487c1c){return _0x193eb7==_0x487c1c;},'bkmOF':_0x57b700(0x1de),'MfJdw':_0x57b700(0x205),'MDILt':_0x57b700(0x1fd),'rfZXF':function(_0x3e478f,_0x4f8df1){return _0x3e478f===_0x4f8df1;},'BCOVP':function(_0x17aa23,_0x4d348a){return _0x17aa23==_0x4d348a;},'LiLyk':function(_0x5acc26,_0x31abe4){return _0x5acc26==_0x31abe4;},'CbJKe':_0x57b700(0x226),'VHANJ':'ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','BqDIO':function(_0x12da2c,_0x5225d7){return _0x12da2c==_0x5225d7;},'rphXU':function(_0x11a1aa,_0x4a7696){return _0x11a1aa!==_0x4a7696;},'YWafz':'ofhuy','DMmay':_0x57b700(0x1e2),'PQoSC':function(_0x3daa1c,_0x126f43){return _0x3daa1c==_0x126f43;},'YkBWH':function(_0x4b70b8,_0x5812ef){return _0x4b70b8==_0x5812ef;},'vYXCx':function(_0x384f07,_0x2c097f){return _0x384f07==_0x2c097f;},'rCpTo':function(_0x70eacd,_0x275dee){return _0x70eacd>_0x275dee;},'FFdBI':function(_0x403846,_0x1d1ae2){return _0x403846>_0x1d1ae2;},'ZleYx':function(_0x280073,_0x11e4f5){return _0x280073===_0x11e4f5;},'JqLys':'wiRzq','IkbDO':_0x57b700(0x28e),'IGbny':'Asia/Bangkok','ukVRP':_0x57b700(0x1ff),'PazWY':_0x57b700(0x285),'spaBC':_0x57b700(0x167),'FYGtV':function(_0x153aca,_0xe807b7){return _0x153aca<_0xe807b7;},'XGzop':_0x57b700(0x24e)},_0x3ffd2=new _0xdb116(global[_0x57b700(0x1b2)]);try{const _0x2db9f6=await _0x1ad5a7[_0x57b700(0x1d1)](_0x598522);await _0x4de8c1['getMainDocPathObj'](_0x598522,_0x23c0ed,_0x2db9f6[_0x57b700(0x258)]);const {collectionName:_0x131fe1}=_0x49ba9b[_0x57b700(0x21f)](_0x598522[_0x57b700(0x1c8)]),{docId:_0xa790e,action:_0x4ee50a}=_0x598522[_0x57b700(0x296)],_0x530b6d=_0x101ef1[_0x57b700(0x157)](_0x4ee50a,_0x101ef1[_0x57b700(0x213)])?_0x101ef1[_0x57b700(0x1b9)]:_0x101ef1['nBCWp'](_0x4ee50a,_0x101ef1[_0x57b700(0x27b)])?'จบ':'';if(!_0xa790e||![_0x101ef1[_0x57b700(0x27b)],_0x101ef1[_0x57b700(0x213)]][_0x57b700(0x16f)](_0x4ee50a))return _0x23c0ed[_0x57b700(0x1d3)](JSON['stringify']({'isStatus':!0x1,'class':_0x101ef1[_0x57b700(0x164)],'msg':_0x101ef1['MDILt']}));const _0x3760d2={'docId':_0xa790e,'userId':_0x2db9f6[_0x57b700(0x194)]},_0x195bb8=_0x3ffd2['db'](global[_0x57b700(0x1eb)])[_0x57b700(0x2a8)](_0x131fe1),_0x4a9b6d=await _0x195bb8['findOne'](_0x3760d2);if(!_0x4a9b6d)return _0x23c0ed['send'](JSON[_0x57b700(0x236)]({'isStatus':!0x1,'class':_0x101ef1[_0x57b700(0x164)],'msg':_0x57b700(0x1ad)+_0xa790e+_0x57b700(0x1b1)+_0x530b6d+'เอกสารที่ตันเองไม่ได้สร้าง'}));const _0x4c2fd2=_0x4a9b6d[_0x57b700(0x19d)];if(_0x101ef1['rfZXF'](_0x4ee50a,_0x101ef1['USiVs'])&&!(_0x101ef1[_0x57b700(0x220)](_0x4c2fd2,0x1)||_0x101ef1[_0x57b700(0x200)](_0x4c2fd2,0x2)))return _0x23c0ed[_0x57b700(0x1d3)](JSON[_0x57b700(0x236)]({'isStatus':!0x1,'class':_0x101ef1['MfJdw'],'msg':_0x101ef1[_0x57b700(0x201)]}));if(_0x101ef1[_0x57b700(0x2b2)](_0x4ee50a,_0x101ef1['bkmOF'])&&_0x101ef1[_0x57b700(0x220)](!_0x4c2fd2,0x1))return _0x23c0ed[_0x57b700(0x1d3)](JSON[_0x57b700(0x236)]({'isStatus':!0x1,'class':_0x101ef1[_0x57b700(0x164)],'msg':_0x101ef1['VHANJ']}));if(_0x101ef1[_0x57b700(0x266)](_0x4ee50a,_0x101ef1[_0x57b700(0x213)])){if(_0x101ef1[_0x57b700(0x1f7)](_0x101ef1[_0x57b700(0x15e)],_0x101ef1[_0x57b700(0x225)])){if(_0x101ef1[_0x57b700(0x1ec)](_0x4a9b6d[_0x57b700(0x1b4)],!0x1))return _0x23c0ed['send'](JSON[_0x57b700(0x236)]({'isStatus':!0x1,'class':_0x101ef1['MfJdw'],'msg':'เอกสาร\x20\x22'+_0xa790e+_0x57b700(0x1ae)}));if(_0x101ef1['YkBWH']((await _0x49ba9b[_0x57b700(0x1d5)](_0x4a9b6d,_0x131fe1,_0x2db9f6[_0x57b700(0x194)]))['canCancel'],!0x1))return _0x23c0ed[_0x57b700(0x1d3)](JSON[_0x57b700(0x236)]({'isStatus':!0x1,'class':_0x101ef1['MfJdw'],'msg':_0x57b700(0x1dd)+_0xa790e+_0x57b700(0x1ae)}));}else dnDKwN[_0x57b700(0x2bf)](_0x53c36b,0x0);}if(_0x101ef1[_0x57b700(0x210)](_0x4ee50a,_0x101ef1[_0x57b700(0x213)]))var _0x44af32=0xa;else{if(_0x101ef1[_0x57b700(0x1ec)](_0x4ee50a,_0x101ef1['bkmOF']))var _0x44af32=0x2;}const _0x36f0a7=await _0x195bb8[_0x57b700(0x171)](_0x3760d2,{'$set':{'docStatusNumber':_0x44af32}});var _0x2d8c51=_0x530b6d+'\x20\x22'+_0xa790e+'\x22\x20เรียบร้อยแล้ว';if(_0x36f0a7[_0x57b700(0x2b9)]||_0x101ef1[_0x57b700(0x29e)](_0x36f0a7[_0x57b700(0x2c0)],0x0)){const _0x7b8a4a=_0x49ba9b[_0x57b700(0x20f)]({'docStatusNumber':_0x4c2fd2},{'docStatusNumber':_0x44af32});if(_0x101ef1[_0x57b700(0x253)](_0x7b8a4a['length'],0x0)){if(_0x101ef1['ZleYx'](_0x101ef1[_0x57b700(0x1e7)],_0x101ef1[_0x57b700(0x1dc)])){let _0x92a6b1;try{_0x92a6b1=dnDKwN[_0x57b700(0x247)](_0x5b1405,dnDKwN[_0x57b700(0x154)](dnDKwN[_0x57b700(0x27f)](dnDKwN['ANhzA'],dnDKwN['exogg']),');'))();}catch(_0x4e18fe){_0x92a6b1=_0x1e19c6;}return _0x92a6b1;}else{const _0x355cf5={'dateTime':_0x2efc7b[_0x57b700(0x269)]()[_0x57b700(0x1bd)](_0x101ef1[_0x57b700(0x22a)])[_0x57b700(0x1d6)](_0x101ef1[_0x57b700(0x1ce)]),'userId':_0x2db9f6['userId'],'userFullname':_0x2db9f6[_0x57b700(0x278)],'changes':_0x7b8a4a};await _0x195bb8[_0x57b700(0x171)]({'docId':_0xa790e},{'$push':{'changesHistory':{'$each':[_0x355cf5],'$position':0x0}}}),_0x2d8c51+=_0x101ef1['PazWY'];}}return _0x23c0ed['send'](JSON[_0x57b700(0x236)]({'isStatus':!0x0,'docId':_0xa790e,'docStatusNumber':_0x44af32,'class':_0x101ef1[_0x57b700(0x2b1)],'msg':_0x2d8c51}));}else{if(_0x36f0a7[_0x57b700(0x2b9)]&&_0x101ef1['FYGtV'](_0x36f0a7[_0x57b700(0x2c0)],0x1))return _0x23c0ed[_0x57b700(0x1d3)](JSON[_0x57b700(0x236)]({'isStatus':!0x1,'docId':_0xa790e,'docStatusNumber':_0x4c2fd2,'class':_0x101ef1[_0x57b700(0x29d)],'msg':'\x22'+_0xa790e+_0x57b700(0x19e)}));}}catch(_0x2c3417){console[_0x57b700(0x2a0)](_0x2c3417),_0x23c0ed[_0x57b700(0x1d3)](JSON['stringify']({'isStatus':!0x1,'class':_0x101ef1[_0x57b700(0x164)],'msg':_0x2c3417[_0x57b700(0x270)]}));}finally{_0x3ffd2[_0x57b700(0x179)]();}});export default b;function _0x12becd(_0x68a6f5){const _0x2a13b7=_0x48eaf5,_0x3b393a={'INKHW':function(_0x5cefea,_0x356570){return _0x5cefea===_0x356570;},'VZfUV':_0x2a13b7(0x2bd),'UMvTM':_0x2a13b7(0x29b),'tLRZj':'counter','PDvSe':function(_0x388408,_0x3c51da){return _0x388408!==_0x3c51da;},'auDSO':function(_0x1fcce2,_0x1f0151){return _0x1fcce2+_0x1f0151;},'ZxnuO':function(_0x420c15,_0x529c6a){return _0x420c15/_0x529c6a;},'FDmjn':_0x2a13b7(0x1a4),'BDuDi':function(_0x52dc0d,_0x420253){return _0x52dc0d%_0x420253;},'lEsMy':function(_0x457f5e,_0x559e5a){return _0x457f5e+_0x559e5a;},'akzxI':_0x2a13b7(0x2ae),'qldEE':_0x2a13b7(0x1e6),'nfWOU':_0x2a13b7(0x2b4),'uKxhK':_0x2a13b7(0x1cc),'nuIdp':function(_0x3e666f,_0x27b482){return _0x3e666f(_0x27b482);},'okvgV':function(_0x2eb5bc,_0x4fd12e){return _0x2eb5bc(_0x4fd12e);}};function _0x40032d(_0x3c828b){const _0x9f0597=_0x2a13b7;if(_0x3b393a[_0x9f0597(0x1df)](typeof _0x3c828b,_0x3b393a['VZfUV']))return function(_0x415ceb){}['constructor'](_0x3b393a[_0x9f0597(0x1cd)])['apply'](_0x3b393a[_0x9f0597(0x18d)]);else _0x3b393a['PDvSe'](_0x3b393a[_0x9f0597(0x224)]('',_0x3b393a['ZxnuO'](_0x3c828b,_0x3c828b))[_0x3b393a['FDmjn']],0x1)||_0x3b393a[_0x9f0597(0x1df)](_0x3b393a[_0x9f0597(0x239)](_0x3c828b,0x14),0x0)?function(){return!![];}[_0x9f0597(0x298)](_0x3b393a['lEsMy'](_0x3b393a[_0x9f0597(0x17f)],_0x3b393a[_0x9f0597(0x262)]))[_0x9f0597(0x1e9)](_0x3b393a[_0x9f0597(0x229)]):function(){return![];}['constructor'](_0x3b393a[_0x9f0597(0x294)](_0x3b393a[_0x9f0597(0x17f)],_0x3b393a[_0x9f0597(0x262)]))[_0x9f0597(0x288)](_0x3b393a[_0x9f0597(0x286)]);_0x3b393a['nuIdp'](_0x40032d,++_0x3c828b);}try{if(_0x68a6f5)return _0x40032d;else _0x3b393a['okvgV'](_0x40032d,0x0);}catch(_0x7e3fec){}}