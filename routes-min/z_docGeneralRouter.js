const _0x13835b=_0x445e;(function(_0x31e55,_0x3062aa){const _0x15ec3e=_0x445e,_0x3c34c0=_0x31e55();while(!![]){try{const _0xa36e40=-parseInt(_0x15ec3e(0x2ff))/0x1+-parseInt(_0x15ec3e(0x252))/0x2+parseInt(_0x15ec3e(0x2e6))/0x3*(parseInt(_0x15ec3e(0x2d5))/0x4)+parseInt(_0x15ec3e(0x210))/0x5*(-parseInt(_0x15ec3e(0x2f5))/0x6)+-parseInt(_0x15ec3e(0x2a5))/0x7*(-parseInt(_0x15ec3e(0x2ed))/0x8)+-parseInt(_0x15ec3e(0x26b))/0x9*(-parseInt(_0x15ec3e(0x21a))/0xa)+parseInt(_0x15ec3e(0x2d2))/0xb;if(_0xa36e40===_0x3062aa)break;else _0x3c34c0['push'](_0x3c34c0['shift']());}catch(_0x350890){_0x3c34c0['push'](_0x3c34c0['shift']());}}}(_0x3263,0x6d21f));const _0x3ac650=(function(){const _0x5b96ef=_0x445e,_0x25e271={'FUVtm':function(_0x29e3e5){return _0x29e3e5();},'hIJPz':_0x5b96ef(0x1be),'eyvAu':function(_0x5de3e6,_0x1ad0b5){return _0x5de3e6!==_0x1ad0b5;},'iIxgr':_0x5b96ef(0x1db),'yuUNf':_0x5b96ef(0x305),'pNWUw':function(_0x514538,_0x3ba391){return _0x514538===_0x3ba391;},'mvlDr':_0x5b96ef(0x2d0),'xxyWE':_0x5b96ef(0x2d3)};let _0xef1c14=!![];return function(_0x97243e,_0x347902){const _0x32c601=_0x5b96ef;if(_0x25e271['pNWUw'](_0x25e271['xxyWE'],_0x25e271[_0x32c601(0x21c)])){const _0x5ec56a=_0xef1c14?function(){const _0x180804=_0x32c601,_0x55d311={'kaplH':function(_0x3b000c){const _0x5aca53=_0x445e;return _0x25e271[_0x5aca53(0x275)](_0x3b000c);},'drgHa':_0x25e271['hIJPz']};if(_0x25e271[_0x180804(0x1d9)](_0x25e271['iIxgr'],_0x25e271[_0x180804(0x2c5)])){if(_0x347902){if(_0x25e271[_0x180804(0x323)](_0x25e271[_0x180804(0x27e)],_0x25e271[_0x180804(0x27e)])){const _0x554ec8=_0x347902[_0x180804(0x209)](_0x97243e,arguments);return _0x347902=null,_0x554ec8;}else _0x55d311[_0x180804(0x1d7)](_0x51df15);}}else return _0x3562b5[_0x180804(0x1e9)](_0xcc7060),_0xf64b02[_0x180804(0x29e)](_0x52793b['stringify']({'isLoad':!0x1,'class':_0x55d311[_0x180804(0x307)],'msg':_0x4f295d[_0x180804(0x222)]}));}:function(){};return _0xef1c14=![],_0x5ec56a;}else{const _0x4f6625=_0x198320[_0x32c601(0x232)],_0x35e9e6=_0x253522[_0x32c601(0x25b)];return _0x38dc67[_0x32c601(0x2df)](_0x4f6625['scrollHeight'],_0x4f6625[_0x32c601(0x2a4)],_0x35e9e6[_0x32c601(0x1c9)],_0x35e9e6['scrollHeight'],_0x35e9e6['offsetHeight']);}};}());(function(){const _0x274b46=_0x445e,_0x3377c8={'Otuvv':function(_0x1f2409,_0x167238){return _0x1f2409(_0x167238);},'dbYHL':function(_0x43b909,_0x40aace){return _0x43b909===_0x40aace;},'McOqX':_0x274b46(0x2a6),'aLDfb':'EdLsv','HIGkK':'function\x20*\x5c(\x20*\x5c)','vfSMW':_0x274b46(0x2ce),'deafD':function(_0x8dbbc6,_0x25ac38){return _0x8dbbc6(_0x25ac38);},'mYrYZ':_0x274b46(0x2dc),'CzeDR':function(_0x20a826,_0x4de023){return _0x20a826+_0x4de023;},'HanJb':'chain','qjBvN':function(_0x446fb7,_0x314793){return _0x446fb7+_0x314793;},'hWRIS':_0x274b46(0x281),'LInGn':function(_0xb4e689,_0x5e3678){return _0xb4e689!==_0x5e3678;},'DMnXV':'mFhlM','CGRcz':_0x274b46(0x313),'rtCHC':function(_0x4794ae,_0x29c4c4){return _0x4794ae(_0x29c4c4);},'YhFPa':_0x274b46(0x27b),'BMXzL':function(_0x427cc8){return _0x427cc8();},'rkGUT':function(_0x268011,_0x535a1b,_0x1f217a){return _0x268011(_0x535a1b,_0x1f217a);}};_0x3377c8['rkGUT'](_0x3ac650,this,function(){const _0x35f140=_0x274b46,_0x3a4e57={'YrULl':function(_0xd22c89,_0x1746f9){const _0x475b57=_0x445e;return _0x3377c8[_0x475b57(0x1e5)](_0xd22c89,_0x1746f9);}};if(_0x3377c8[_0x35f140(0x2e7)](_0x3377c8['McOqX'],_0x3377c8[_0x35f140(0x25f)])){const _0x45b2ec=_0x102cad['apply'](_0x459da8,arguments);return _0x5c3dee=null,_0x45b2ec;}else{const _0x5c898f=new RegExp(_0x3377c8[_0x35f140(0x310)]),_0x3b16e1=new RegExp(_0x3377c8['vfSMW'],'i'),_0x21808b=_0x3377c8[_0x35f140(0x1e4)](_0x19fd92,_0x3377c8[_0x35f140(0x326)]);if(!_0x5c898f['test'](_0x3377c8['CzeDR'](_0x21808b,_0x3377c8[_0x35f140(0x20a)]))||!_0x3b16e1[_0x35f140(0x2b2)](_0x3377c8[_0x35f140(0x20d)](_0x21808b,_0x3377c8[_0x35f140(0x261)]))){if(_0x3377c8['LInGn'](_0x3377c8[_0x35f140(0x2d4)],_0x3377c8['CGRcz']))_0x3377c8[_0x35f140(0x296)](_0x21808b,'0');else return _0x2a9cde;}else{if(_0x3377c8[_0x35f140(0x2e7)](_0x3377c8[_0x35f140(0x248)],_0x3377c8[_0x35f140(0x248)]))_0x3377c8['BMXzL'](_0x19fd92);else{if(_0x3ac1b5)return _0x590351;else _0x3a4e57['YrULl'](_0x1831e0,0x0);}}}})();}());const _0x41baae=(function(){const _0x53e3fc=_0x445e,_0x3f13ff={'CCnGs':function(_0x2ab1a5,_0x49ec5d){return _0x2ab1a5!==_0x49ec5d;},'dmrcc':'sbyxP','kPEUE':_0x53e3fc(0x1d0),'jvtnR':function(_0x10aeea,_0x3c1a24){return _0x10aeea===_0x3c1a24;},'MydQk':'KjtvL','mzryQ':_0x53e3fc(0x272),'rPqms':_0x53e3fc(0x282),'ouDiV':_0x53e3fc(0x238),'dOzjx':'red','Tvgbd':function(_0x3a02d0,_0x3ff431){return _0x3a02d0!==_0x3ff431;},'tIODw':_0x53e3fc(0x235)};let _0x47f155=!![];return function(_0x4c470b,_0x5bf0e0){const _0x5deea8=_0x53e3fc,_0x4f546d={'GGqqU':_0x3f13ff[_0x5deea8(0x2b7)],'zsMWP':_0x3f13ff[_0x5deea8(0x24c)],'QttUv':_0x3f13ff[_0x5deea8(0x2a9)]};if(_0x3f13ff[_0x5deea8(0x308)](_0x3f13ff[_0x5deea8(0x22d)],_0x3f13ff['tIODw']))return function(_0x11fb8f){}[_0x5deea8(0x1fe)](_0x4f546d['GGqqU'])[_0x5deea8(0x209)](_0x4f546d[_0x5deea8(0x1f7)]);else{const _0x4d919a=_0x47f155?function(){const _0x5d66ad=_0x5deea8;if(_0x3f13ff[_0x5d66ad(0x312)](_0x3f13ff['dmrcc'],_0x3f13ff[_0x5d66ad(0x283)])){if(_0x5bf0e0){if(_0x3f13ff['jvtnR'](_0x3f13ff[_0x5d66ad(0x255)],_0x3f13ff[_0x5d66ad(0x1d8)]))_0x5caf14[_0x5d66ad(0x228)]();else{const _0x27732d=_0x5bf0e0[_0x5d66ad(0x209)](_0x4c470b,arguments);return _0x5bf0e0=null,_0x27732d;}}}else return _0xf71e47[_0x5d66ad(0x1e9)](_0x3464c4),_0x3d114b[_0x5d66ad(0x29e)](_0xe90ada[_0x5d66ad(0x1dd)]({'isSearch':!0x1,'class':_0x4f546d[_0x5d66ad(0x2de)],'msg':_0x56b7af[_0x5d66ad(0x222)]}));}:function(){};return _0x47f155=![],_0x4d919a;}};}()),_0x2b9d24=_0x41baae(this,function(){const _0x5318ea=_0x445e,_0x53d072={'Qpwvp':_0x5318ea(0x1be),'yETPJ':_0x5318ea(0x1bf),'vlXgH':_0x5318ea(0x2ce),'FQCTg':function(_0x20c2ea,_0x1580fa){return _0x20c2ea(_0x1580fa);},'GWmlH':_0x5318ea(0x2dc),'JzzsS':function(_0xdc11b4,_0x108cff){return _0xdc11b4+_0x108cff;},'ZDsYj':_0x5318ea(0x30f),'UeHcL':_0x5318ea(0x281),'WHYnF':function(_0x538516,_0x62eed7){return _0x538516(_0x62eed7);},'GyHdj':function(_0x444812){return _0x444812();},'QPEPE':function(_0x4115fd,_0x25cba4){return _0x4115fd===_0x25cba4;},'GsJcq':_0x5318ea(0x317),'iWDGi':function(_0x5a97fb,_0x3c0f95){return _0x5a97fb===_0x3c0f95;},'OziJj':_0x5318ea(0x2ae),'XQiGS':function(_0x2b27f1,_0x2d72ef){return _0x2b27f1(_0x2d72ef);},'iPJcI':function(_0x3324f2,_0x5a83a1){return _0x3324f2+_0x5a83a1;},'ylSXT':function(_0xf30a41,_0x26605a){return _0xf30a41+_0x26605a;},'yGiJg':_0x5318ea(0x2b8),'xizAM':_0x5318ea(0x29d),'LYnpO':_0x5318ea(0x2fe),'OwhCo':'lerJu','cwbYR':_0x5318ea(0x2db),'zmJmf':_0x5318ea(0x2f3),'qiRYo':'action','ORMLb':_0x5318ea(0x1e9),'SaVEL':_0x5318ea(0x225),'osKCu':_0x5318ea(0x200),'lDaiN':_0x5318ea(0x30b),'JOmIG':'exception','fjzwl':_0x5318ea(0x23d),'xVBwi':'trace','udrdQ':function(_0x2cdcf5,_0x9f2d4d){return _0x2cdcf5<_0x9f2d4d;},'GNJpp':function(_0x531079,_0x497166){return _0x531079!==_0x497166;},'TvRhl':'FJnld'},_0x143b41=function(){const _0x3afb7a=_0x5318ea;if(_0x53d072[_0x3afb7a(0x31b)](_0x53d072[_0x3afb7a(0x2c3)],_0x53d072[_0x3afb7a(0x2c3)])){let _0x59e89b;try{_0x53d072[_0x3afb7a(0x2e9)](_0x53d072[_0x3afb7a(0x2bd)],_0x53d072[_0x3afb7a(0x2bd)])?_0x59e89b=_0x53d072[_0x3afb7a(0x216)](Function,_0x53d072[_0x3afb7a(0x1e6)](_0x53d072['ylSXT'](_0x53d072['yGiJg'],_0x53d072[_0x3afb7a(0x1ef)]),');'))():(_0x45fb0a[_0x3afb7a(0x1e9)](_0x3505e9),_0x3ba293[_0x3afb7a(0x29e)](_0x47e219[_0x3afb7a(0x1dd)]({'isStatus':!0x1,'class':_0x53d072[_0x3afb7a(0x2e8)],'msg':_0x8e9d93['message']})));}catch(_0x2d4334){_0x53d072[_0x3afb7a(0x31b)](_0x53d072['LYnpO'],_0x53d072['OwhCo'])?_0x2d6be3=_0x22b2db:_0x59e89b=window;}return _0x59e89b;}else{const _0x42ab6b=new _0x6cf9c4(_0x53d072[_0x3afb7a(0x2eb)]),_0x52a791=new _0x52c38d(_0x53d072[_0x3afb7a(0x21d)],'i'),_0x592902=_0x53d072[_0x3afb7a(0x1cc)](_0x571ab2,_0x53d072[_0x3afb7a(0x31e)]);!_0x42ab6b['test'](_0x53d072[_0x3afb7a(0x328)](_0x592902,_0x53d072[_0x3afb7a(0x1c2)]))||!_0x52a791[_0x3afb7a(0x2b2)](_0x53d072['JzzsS'](_0x592902,_0x53d072[_0x3afb7a(0x1cb)]))?_0x53d072[_0x3afb7a(0x2ad)](_0x592902,'0'):_0x53d072[_0x3afb7a(0x1c5)](_0x463baf);}},_0x43157a=_0x53d072['GyHdj'](_0x143b41),_0x193e18=_0x43157a['console']=_0x43157a[_0x5318ea(0x279)]||{},_0x597d84=[_0x53d072[_0x5318ea(0x31c)],_0x53d072['SaVEL'],_0x53d072[_0x5318ea(0x26f)],_0x53d072[_0x5318ea(0x1f0)],_0x53d072[_0x5318ea(0x223)],_0x53d072[_0x5318ea(0x1d2)],_0x53d072[_0x5318ea(0x294)]];for(let _0x1d3603=0x0;_0x53d072[_0x5318ea(0x2ee)](_0x1d3603,_0x597d84[_0x5318ea(0x256)]);_0x1d3603++){if(_0x53d072[_0x5318ea(0x206)](_0x53d072[_0x5318ea(0x21f)],_0x53d072[_0x5318ea(0x21f)]))(function(){return!![];}['constructor'](_0x53d072[_0x5318ea(0x328)](_0x53d072[_0x5318ea(0x2a3)],_0x53d072[_0x5318ea(0x2af)]))[_0x5318ea(0x2aa)](_0x53d072[_0x5318ea(0x2d1)]));else{const _0x38fbe9=_0x41baae[_0x5318ea(0x1fe)][_0x5318ea(0x2da)]['bind'](_0x41baae),_0x3e3185=_0x597d84[_0x1d3603],_0xf5c361=_0x193e18[_0x3e3185]||_0x38fbe9;_0x38fbe9['__proto__']=_0x41baae['bind'](_0x41baae),_0x38fbe9[_0x5318ea(0x218)]=_0xf5c361[_0x5318ea(0x218)]['bind'](_0xf5c361),_0x193e18[_0x3e3185]=_0x38fbe9;}}});_0x2b9d24();import _0x4669e7 from'express';const b=_0x4669e7[_0x13835b(0x1ca)]();import _0x3cc47f from'path';import{MongoClient as _0x1b6a0a}from'mongodb';import _0x1668b2 from'../middleware/mainAuth.js';import*as _0x29c329 from'../mymodule/myUsers.js';import*as _0x4498fd from'../mymodule/myDateTime.js';import*as _0x15876a from'../mymodule/myModule.js';function _0x445e(_0xe4d57f,_0x1bf791){const _0x912000=_0x3263();return _0x445e=function(_0x2b9d24,_0x41baae){_0x2b9d24=_0x2b9d24-0x1bc;let _0x4d34f9=_0x912000[_0x2b9d24];return _0x4d34f9;},_0x445e(_0xe4d57f,_0x1bf791);}import*as _0x25d051 from'../mymodule/myDocMain.js';import*as _0xc8c22c from'../mymodule/myData.js';import{DateTime as _0x3ab192}from'luxon';const w=global[_0x13835b(0x2ec)],S=global['PATH_WAREHOUSE_OUT'],p=global[_0x13835b(0x213)],k=[w+_0x13835b(0x262),S+'/changes',p+'/changes'],v=[w+_0x13835b(0x226),S+'/print',p+_0x13835b(0x226)],B=[w+_0x13835b(0x325),S+_0x13835b(0x325),p+_0x13835b(0x325)],x=[w+_0x13835b(0x2be),S+_0x13835b(0x2be),p+_0x13835b(0x2be)],L=[w+_0x13835b(0x2a2),S+_0x13835b(0x2a2),p+'/load',w+_0x13835b(0x30c),S+_0x13835b(0x30c),p+'/load-last'],W=[w+'/fetch/modal',S+'/fetch/modal',p+_0x13835b(0x287)];b[_0x13835b(0x298)](W,_0x1668b2[_0x13835b(0x239)],async(_0x5e7bea,_0x14c02f)=>{const _0x125afe=_0x13835b,_0x5eb172={'DMgeS':function(_0x52bd85,_0x18451c){return _0x52bd85!==_0x18451c;},'UuTKz':_0x125afe(0x215),'opHeQ':function(_0x3d17f8,_0xe9fe22){return _0x3d17f8==_0xe9fe22;},'TRXDY':_0x125afe(0x2f0),'jVvry':_0x125afe(0x2d7),'NayoD':function(_0x39a26d,_0x7dde2){return _0x39a26d==_0x7dde2;},'tlLse':_0x125afe(0x1e1),'Dyuph':function(_0x4bbd6a,_0x404209){return _0x4bbd6a==_0x404209;},'GMZYr':_0x125afe(0x277),'EwTlr':_0x125afe(0x1bd),'IvGwz':_0x125afe(0x27c),'zrHie':_0x125afe(0x2a0),'CsupZ':function(_0x8157d8,_0x3f99fd){return _0x8157d8!==_0x3f99fd;},'rCSTA':'GZCJJ','KkIzI':'red'},_0x2fe8e4=await _0x29c329['getUserData'](_0x5e7bea),_0x1ccc0a=await _0x25d051[_0x125afe(0x21b)](_0x5e7bea,_0x14c02f,_0x2fe8e4[_0x125afe(0x2b6)]);try{if(_0x5eb172[_0x125afe(0x269)](_0x5eb172['UuTKz'],_0x5eb172[_0x125afe(0x1f1)]))_0x175374[_0x125afe(0x228)]();else{if(_0x5eb172['opHeQ'](_0x1ccc0a[_0x125afe(0x2a8)],_0x5eb172[_0x125afe(0x26c)]))var _0x49e8f6=await _0xc8c22c[_0x125afe(0x286)](_0x5eb172[_0x125afe(0x2cf)]);else{if(_0x5eb172[_0x125afe(0x2b9)](_0x1ccc0a[_0x125afe(0x2a8)],_0x5eb172[_0x125afe(0x1c6)]))var _0x49e8f6=await _0xc8c22c['getItems_for_Modal'](_0x5eb172[_0x125afe(0x2cf)]);else{if(_0x5eb172[_0x125afe(0x1c3)](_0x1ccc0a[_0x125afe(0x2a8)],_0x5eb172['GMZYr']))var _0x49e8f6=await _0xc8c22c['getItems_for_Modal'](_0x5eb172[_0x125afe(0x27f)]);}}const _0x2783f2=await _0xc8c22c[_0x125afe(0x258)]();return _0x14c02f[_0x125afe(0x29e)](JSON[_0x125afe(0x1dd)]({'DATA_ITEMS':_0x49e8f6,'DATA_CATEGORY':_0x2783f2,'isFetch':!0x0,'class':_0x5eb172['IvGwz'],'msg':_0x5eb172[_0x125afe(0x245)]}));}}catch(_0x11b191){if(_0x5eb172[_0x125afe(0x23b)](_0x5eb172[_0x125afe(0x295)],_0x5eb172[_0x125afe(0x295)])){const _0xbb8f87=_0x3c0d10?function(){const _0x9b9db=_0x125afe;if(_0x39b8c4){const _0x494b7a=_0x4b9d02[_0x9b9db(0x209)](_0x4a73f8,arguments);return _0x2121b8=null,_0x494b7a;}}:function(){};return _0x3b2bde=![],_0xbb8f87;}else return console[_0x125afe(0x1e9)](_0x11b191),_0x14c02f[_0x125afe(0x29e)](JSON[_0x125afe(0x1dd)]({'isFetch':!0x1,'class':_0x5eb172[_0x125afe(0x1f8)],'msg':_0x11b191[_0x125afe(0x222)]}));}}),b['post'](x,_0x1668b2['isAuth'],async(_0x4952d4,_0xd2c718)=>{const _0x1849ec=_0x13835b,_0x5b6e69={'PuJRc':function(_0x25b847,_0x3a5861){return _0x25b847(_0x3a5861);},'NXRsK':function(_0x477023,_0x5e0d35){return _0x477023<_0x5e0d35;},'eBxAq':_0x1849ec(0x207),'xoZoy':'กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','tBcyg':function(_0x4d0cd1,_0x5953dc){return _0x4d0cd1===_0x5953dc;},'SLipS':_0x1849ec(0x251),'GdVzd':'{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','JSZhl':function(_0xbddb17,_0x18940e){return _0xbddb17+_0x18940e;},'eWlIL':'green','OLXRC':_0x1849ec(0x320),'clPCA':_0x1849ec(0x291),'aJpzv':'red','rPGug':_0x1849ec(0x233)};let {sip:_0x1a3d2f}=_0x4952d4[_0x1849ec(0x232)];if(!_0x1a3d2f&&_0x5b6e69['NXRsK'](_0x1a3d2f[_0x1849ec(0x256)],0x2))return _0xd2c718[_0x1849ec(0x29e)](JSON['stringify']({'isSearch':!0x1,'class':_0x5b6e69[_0x1849ec(0x1fc)],'msg':_0x5b6e69['xoZoy']}));_0x1a3d2f=_0x1a3d2f['replace'](/[!@#$%^&*<>]/g,'')??null;const _0x192e9a=await _0x29c329[_0x1849ec(0x1c0)](_0x4952d4);await _0x25d051[_0x1849ec(0x21b)](_0x4952d4,_0xd2c718,_0x192e9a[_0x1849ec(0x2b6)]);const {collectionName:_0x3ff4b5}=_0xc8c22c['get_Info_ByUrl'](_0x4952d4[_0x1849ec(0x1d3)]),_0x5b05f3=new _0x1b6a0a(global[_0x1849ec(0x28e)]);try{if(_0x5b6e69[_0x1849ec(0x302)](_0x5b6e69[_0x1849ec(0x2ef)],_0x5b6e69[_0x1849ec(0x2ef)])){await _0x5b05f3[_0x1849ec(0x28c)]();const _0x8db41=_0x5b05f3['db'](global[_0x1849ec(0x1d1)])[_0x1849ec(0x289)](_0x3ff4b5),_0xed8535=[{'$or':[{'docId':{'$regex':_0x1a3d2f,'$options':'i'}},{'docDateTime':{'$regex':_0x1a3d2f,'$options':'i'}}]}];let _0x284e76='';['O','S']['includes'](_0x192e9a[_0x1849ec(0x2b6)])||(_0x284e76+=_0x5b6e69['GdVzd'],_0xed8535[_0x1849ec(0x264)]({'userId':_0x192e9a[_0x1849ec(0x29a)]}));const _0x1e55f8=await _0x8db41[_0x1849ec(0x268)]([{'$match':{'$and':_0xed8535}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDateTime':0x1,'userId':0x1}}])[_0x1849ec(0x22b)]();return _0x284e76=_0x5b6e69[_0x1849ec(0x20b)]('พบ\x20\x22'+_0x1e55f8[_0x1849ec(0x256)]+_0x1849ec(0x2dd),_0x284e76),_0xd2c718[_0x1849ec(0x29e)](JSON['stringify']({'searchFound':_0x1e55f8,'msg':_0x284e76,'isSearch':!0x0,'class':_0x5b6e69[_0x1849ec(0x299)]}));}else{if(_0x2939ca){const _0x30623c=_0x21b375[_0x1849ec(0x209)](_0x10fe6e,arguments);return _0x3c0c95=null,_0x30623c;}}}catch(_0x30be9e){return _0x5b6e69[_0x1849ec(0x302)](_0x5b6e69[_0x1849ec(0x2e0)],_0x5b6e69[_0x1849ec(0x201)])?!![]:(console[_0x1849ec(0x1e9)](_0x30be9e),_0xd2c718[_0x1849ec(0x29e)](JSON['stringify']({'isSearch':!0x1,'class':_0x5b6e69['aJpzv'],'msg':_0x30be9e[_0x1849ec(0x222)]})));}finally{_0x5b6e69[_0x1849ec(0x302)](_0x5b6e69[_0x1849ec(0x31a)],_0x5b6e69[_0x1849ec(0x31a)])?_0x5b05f3['close']():KzCJvY['PuJRc'](_0x5a492f,0x0);}}),b[_0x13835b(0x2cc)](L,_0x1668b2[_0x13835b(0x239)],async(_0x594f76,_0x20c97b)=>{const _0xb239f4=_0x13835b,_0xcf8545={'XBJLc':function(_0x1eeace,_0x1072a5){return _0x1eeace(_0x1072a5);},'tZCXQ':_0xb239f4(0x1be),'bwQKl':_0xb239f4(0x29b),'FhfvH':function(_0x833882,_0x3febae){return _0x833882===_0x3febae;},'DcYBo':'tTPjC','iEoaI':_0xb239f4(0x2c8),'UmUmP':_0xb239f4(0x2ab),'EFqvY':function(_0x4150ff,_0x4bb0d6){return _0x4150ff!==_0x4bb0d6;},'AAtaL':_0xb239f4(0x1ed),'WQmjG':'jOaeT','szAnB':function(_0x20f795,_0x5bf5a3){return _0x20f795===_0x5bf5a3;},'MYvxX':'load-last','rEuYM':_0xb239f4(0x2f6),'tCGeG':function(_0x2e505f,_0x379f8f){return _0x2e505f==_0x379f8f;},'guCsh':_0xb239f4(0x1d6),'sKqcm':_0xb239f4(0x1ec),'ATwMY':function(_0x784320,_0xa5e3d8){return _0x784320==_0xa5e3d8;},'LIngO':_0xb239f4(0x2c7),'FGVzO':function(_0x2c2528,_0x3dee34){return _0x2c2528===_0x3dee34;},'ZrqEF':_0xb239f4(0x23a),'YBdAh':'IWWuh','IEiTQ':_0xb239f4(0x297),'oWmkj':_0xb239f4(0x27c),'BlkeQ':function(_0x4b4cda,_0x265ecb){return _0x4b4cda!==_0x265ecb;},'Gfjby':_0xb239f4(0x2ea),'MQMnq':_0xb239f4(0x25a)};let {docId:_0x5dd8d3,action:_0x3511e3}=_0x594f76[_0xb239f4(0x232)];const _0x43e9d8=await _0x29c329[_0xb239f4(0x1c0)](_0x594f76);await _0x25d051['getMainDocPathObj'](_0x594f76,_0x20c97b,_0x43e9d8[_0xb239f4(0x2b6)]);const {collectionName:_0x228fcf}=_0xc8c22c[_0xb239f4(0x2b5)](_0x594f76[_0xb239f4(0x1d3)]),_0x5a71cc=new _0x1b6a0a(global['dbUrl']);try{if(_0xcf8545[_0xb239f4(0x267)](_0xcf8545['DcYBo'],_0xcf8545[_0xb239f4(0x2fb)]))_0xa724cb['close']();else{await _0x5a71cc[_0xb239f4(0x28c)]();const _0x477d55=_0x5a71cc['db'](global[_0xb239f4(0x1d1)])[_0xb239f4(0x289)](_0x228fcf);if(_0xcf8545[_0xb239f4(0x267)](_0x3511e3,_0xcf8545[_0xb239f4(0x2b0)])){if(_0xcf8545[_0xb239f4(0x278)](_0xcf8545[_0xb239f4(0x293)],_0xcf8545[_0xb239f4(0x24f)])){const _0x18134=['O','S'][_0xb239f4(0x214)](_0x43e9d8['userAuthority'])?{'docId':_0x5dd8d3}:{'docId':_0x5dd8d3,'userId':_0x43e9d8[_0xb239f4(0x29a)]};var _0x3454e8=await _0x477d55[_0xb239f4(0x1f4)](_0x18134,{'projection':{'_id':0x0,'changesHistory':0x0}});}else odecUP[_0xb239f4(0x2f9)](_0x51dae0,'0');}else{if(_0xcf8545['szAnB'](_0x3511e3,_0xcf8545[_0xb239f4(0x260)]))var _0x3454e8=await _0x477d55['findOne']({'userId':_0x43e9d8['userId']},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x2d6aad=_0x3454e8?'':_0xcf8545[_0xb239f4(0x2c9)](_0x3511e3,_0xcf8545[_0xb239f4(0x2b0)])?_0xb239f4(0x2c6)+_0x5dd8d3+'\x22':_0xcf8545[_0xb239f4(0x241)];if(!_0x3454e8)return _0x20c97b[_0xb239f4(0x29e)](JSON[_0xb239f4(0x1dd)]({'isLoad':!0x1,'class':_0xcf8545[_0xb239f4(0x25d)],'msg':_0x2d6aad}));let _0x5a4b82='โหลดเอกสารเลขที่\x20\x22'+_0x3454e8[_0xb239f4(0x2ca)]+'\x22\x20{{sep}}เรียบร้อยแล้ว';if(_0xcf8545['tCGeG'](_0x3454e8['docStatusNumber'],0x1)&&_0x3454e8[_0xb239f4(0x2f1)]){if(_0xcf8545[_0xb239f4(0x267)](_0xcf8545[_0xb239f4(0x2b4)],_0xcf8545[_0xb239f4(0x1f5)]))return _0x586fca[_0xb239f4(0x1e9)](_0x69f501),_0x223a3f[_0xb239f4(0x29e)](_0x36806d[_0xb239f4(0x1dd)]({'isFetch':!0x1,'class':_0xcf8545['tZCXQ'],'msg':_0x5ed653[_0xb239f4(0x222)]}));else{let _0x3bb265=await _0xc8c22c[_0xb239f4(0x303)](_0x3454e8,_0x228fcf,_0x43e9d8['userId']);_0x3454e8[_0xb239f4(0x243)]=_0x3bb265[_0xb239f4(0x243)],_0xcf8545['ATwMY'](_0x3bb265[_0xb239f4(0x31d)],!0x1)&&(_0x3454e8[_0xb239f4(0x23e)]=_0x3bb265[_0xb239f4(0x23e)],_0x5a4b82+=_0xcf8545[_0xb239f4(0x1f2)]);}}else _0x3454e8[_0xb239f4(0x243)]='-';if((_0xcf8545[_0xb239f4(0x254)](_0x3454e8[_0xb239f4(0x23e)],0x1)||_0xcf8545[_0xb239f4(0x31f)](_0x3454e8[_0xb239f4(0x23e)],0x2))&&_0x3454e8[_0xb239f4(0x2a1)]){if(_0xcf8545[_0xb239f4(0x21e)](_0xcf8545[_0xb239f4(0x1f9)],_0xcf8545[_0xb239f4(0x288)])){const _0x22ec65=_0x48c1c8?function(){const _0x45f78f=_0xb239f4;if(_0x386400){const _0xfdd55c=_0x5ec2d1[_0x45f78f(0x209)](_0x2d7462,arguments);return _0x3b6a83=null,_0xfdd55c;}}:function(){};return _0x58db56=![],_0x22ec65;}else{const _0x21935d=await _0xc8c22c[_0xb239f4(0x322)](_0x3454e8,_0x228fcf,_0x43e9d8['userId']);_0x3454e8[_0xb239f4(0x309)]=_0x21935d[_0xb239f4(0x309)],_0xcf8545[_0xb239f4(0x31f)](_0x21935d['canCancel'],!0x1)&&(_0x5a4b82+=_0xcf8545[_0xb239f4(0x28f)]);}}else _0x3454e8[_0xb239f4(0x309)]='-';const {branchName:_0x3c23fe}=await _0xc8c22c[_0xb239f4(0x1ea)](_0x3454e8['branchId']);return _0x3454e8[_0xb239f4(0x250)]=_0x3c23fe,_0x20c97b[_0xb239f4(0x29e)](JSON[_0xb239f4(0x1dd)]({'doc':_0x3454e8,'isLoad':!0x0,'class':_0xcf8545[_0xb239f4(0x2fd)],'msg':_0x5a4b82,'userId':_0x43e9d8[_0xb239f4(0x29a)],'userAuthority':_0x43e9d8[_0xb239f4(0x2b6)]}));}}catch(_0x40400f){if(_0xcf8545[_0xb239f4(0x2cd)](_0xcf8545[_0xb239f4(0x1cf)],_0xcf8545[_0xb239f4(0x1cf)]))_0x3619de['log'](_0xcf8545[_0xb239f4(0x1e2)],_0x4ebe30),_0x188fc2[_0xb239f4(0x29e)](_0x4ab865[_0xb239f4(0x1dd)]({'isPrint':!0x1,'class':_0xcf8545[_0xb239f4(0x25d)],'msg':_0x5d6b16[_0xb239f4(0x222)]}));else return console[_0xb239f4(0x1e9)](_0x40400f),_0x20c97b[_0xb239f4(0x29e)](JSON[_0xb239f4(0x1dd)]({'isLoad':!0x1,'class':_0xcf8545['tZCXQ'],'msg':_0x40400f[_0xb239f4(0x222)]}));}finally{if(_0xcf8545[_0xb239f4(0x2cd)](_0xcf8545['MQMnq'],_0xcf8545[_0xb239f4(0x230)])){const _0x4aaebd=_0x5e1296[_0xb239f4(0x1fe)][_0xb239f4(0x2da)][_0xb239f4(0x1bc)](_0x23528c),_0x56dd4c=_0x3c7460[_0x551245],_0xe5a2ce=_0xcd5c16[_0x56dd4c]||_0x4aaebd;_0x4aaebd['__proto__']=_0xac47c7['bind'](_0x35997f),_0x4aaebd['toString']=_0xe5a2ce[_0xb239f4(0x218)]['bind'](_0xe5a2ce),_0x49b1e3[_0x56dd4c]=_0x4aaebd;}else _0x5a71cc['close']();}}),b[_0x13835b(0x2cc)](k,_0x1668b2['isAuth'],async(_0x537003,_0x10e883)=>{const _0xd0a62a=_0x13835b,_0x2717d0={'SdIwc':function(_0x166c5b,_0x3b3bd7){return _0x166c5b(_0x3b3bd7);},'FSaTm':function(_0x1bd055,_0x4ff327){return _0x1bd055+_0x4ff327;},'dPAsv':'return\x20(function()\x20','UovCi':_0xd0a62a(0x29d),'BgvWD':function(_0x1b8994,_0x535999){return _0x1b8994===_0x535999;},'JkyRu':_0xd0a62a(0x273),'ZPFMp':_0xd0a62a(0x1be),'majXV':function(_0x391342,_0x3ca279){return _0x391342<_0x3ca279;},'ELTvV':_0xd0a62a(0x207),'ZZRhZ':'ไม่พบประวัติการเปลี่ยนแปลง','phKlY':_0xd0a62a(0x1da),'nIOfT':_0xd0a62a(0x2bb),'PHPdN':_0xd0a62a(0x24d),'AtvyV':_0xd0a62a(0x27c),'FcxOt':function(_0x14e510,_0x46364b){return _0x14e510!==_0x46364b;},'ZlFhC':'mgbhI','ZdEeH':_0xd0a62a(0x29b),'gFbvZ':'FEvDU'},{docId:_0x1ac093}=_0x537003[_0xd0a62a(0x232)],_0x2fbd0f=await _0x29c329[_0xd0a62a(0x1c0)](_0x537003);await _0x25d051['getMainDocPathObj'](_0x537003,_0x10e883,_0x2fbd0f[_0xd0a62a(0x2b6)]);const {collectionName:_0x1895bc}=_0xc8c22c['get_Info_ByUrl'](_0x537003[_0xd0a62a(0x1d3)]),_0x157168=new _0x1b6a0a(global[_0xd0a62a(0x28e)]);try{if(_0x2717d0[_0xd0a62a(0x327)](_0x2717d0[_0xd0a62a(0x1e3)],_0x2717d0[_0xd0a62a(0x1e3)])){await _0x157168[_0xd0a62a(0x28c)]();var _0x5707db=await _0x157168['db'](global['dbName'])[_0xd0a62a(0x289)](_0x1895bc)['findOne']({'docId':_0x1ac093});if(!_0x5707db)return _0x10e883[_0xd0a62a(0x29e)](JSON[_0xd0a62a(0x1dd)]({'isPrint':!0x1,'class':_0x2717d0[_0xd0a62a(0x2f7)],'msg':_0xd0a62a(0x2c6)+_0x1ac093+'\x22'}));const _0x30a0ac=_0x5707db[_0xd0a62a(0x280)]||[];if(_0x2717d0[_0xd0a62a(0x246)](_0x30a0ac[_0xd0a62a(0x256)],0x1))return _0x10e883[_0xd0a62a(0x29e)](JSON[_0xd0a62a(0x1dd)]({'isPrint':!0x1,'class':_0x2717d0[_0xd0a62a(0x20c)],'msg':_0x2717d0['ZZRhZ']}));const _0xce2753=_0x3cc47f[_0xd0a62a(0x27d)](folderForms,_0x2717d0[_0xd0a62a(0x211)]),_0x3eab6c=await _0x15876a[_0xd0a62a(0x2fc)](_0xce2753,_0x10e883,{'title':_0x5707db[_0xd0a62a(0x2ca)],'time':_0x3ab192[_0xd0a62a(0x26a)]()[_0xd0a62a(0x28d)](_0x2717d0[_0xd0a62a(0x311)])[_0xd0a62a(0x25e)](_0x2717d0[_0xd0a62a(0x202)]),'changesHistory':_0x30a0ac});_0x10e883[_0xd0a62a(0x29e)](JSON[_0xd0a62a(0x1dd)]({'isPrint':!0x0,'class':_0x2717d0[_0xd0a62a(0x204)],'htmlPage':_0x3eab6c}));}else _0x35157a[_0xd0a62a(0x228)]();}catch(_0x37a4a9){_0x2717d0[_0xd0a62a(0x1c1)](_0x2717d0[_0xd0a62a(0x29f)],_0x2717d0[_0xd0a62a(0x29f)])?_0x18b3a3=FyynDY['SdIwc'](_0x368fe5,FyynDY[_0xd0a62a(0x220)](FyynDY[_0xd0a62a(0x220)](FyynDY['dPAsv'],FyynDY[_0xd0a62a(0x2ac)]),');'))():(console[_0xd0a62a(0x1e9)](_0x2717d0[_0xd0a62a(0x208)],_0x37a4a9),_0x10e883[_0xd0a62a(0x29e)](JSON[_0xd0a62a(0x1dd)]({'isPrint':!0x1,'class':_0x2717d0[_0xd0a62a(0x2f7)],'msg':_0x37a4a9['message']})));}finally{if(_0x2717d0[_0xd0a62a(0x327)](_0x2717d0[_0xd0a62a(0x1ce)],_0x2717d0[_0xd0a62a(0x1ce)]))_0x157168[_0xd0a62a(0x228)]();else{const _0x5cf6a6=_0x3bc8bb[_0xd0a62a(0x209)](_0x3e1fc8,arguments);return _0x4f3be6=null,_0x5cf6a6;}}}),b[_0x13835b(0x2cc)](v,_0x1668b2[_0x13835b(0x239)],async(_0xfbd59d,_0x52f8d8)=>{const _0x397c9e=_0x13835b,_0x4ac7bf={'zBQAy':_0x397c9e(0x29b),'AvCgp':_0x397c9e(0x1be),'lomoD':function(_0x4ef570,_0x568eee){return _0x4ef570!==_0x568eee;},'mURWi':'ehEvW','jKpwK':_0x397c9e(0x1bf),'uvFaf':_0x397c9e(0x2ce),'FCZEP':function(_0x2f3698,_0x14c4db){return _0x2f3698(_0x14c4db);},'Ftopi':'init','clhie':function(_0x9179ac,_0x3c51ce){return _0x9179ac+_0x3c51ce;},'tODhI':'chain','HRhBg':_0x397c9e(0x281),'KnjvR':function(_0x413e6f){return _0x413e6f();},'iMXpN':function(_0x312880,_0x5b737d,_0x3c51b6){return _0x312880(_0x5b737d,_0x3c51b6);},'woPJh':_0x397c9e(0x2db),'VhvCk':_0x397c9e(0x2f3),'HsuDp':_0x397c9e(0x234),'bLquv':_0x397c9e(0x266),'qCeWx':'xyXwm','rstlY':_0x397c9e(0x1fb),'bfsXD':function(_0x24e562,_0x154567){return _0x24e562==_0x154567;},'FZHzu':_0x397c9e(0x24a),'LoJrB':'green','eBXUx':_0x397c9e(0x2ba),'bCqWm':'CnRMI','kFcwc':_0x397c9e(0x292),'oaWKv':'networkidle0','Rwpvy':function(_0x123d8a,_0x149ea2){return _0x123d8a*_0x149ea2;},'hYmaa':function(_0x123059,_0x23715d){return _0x123059/_0x23715d;},'GgacT':_0x397c9e(0x1df),'EHdVd':_0x397c9e(0x30d),'LXnHj':_0x397c9e(0x2d6),'kvVkl':function(_0x1c127e,_0xff67a){return _0x1c127e!==_0xff67a;},'ezBIu':_0x397c9e(0x2e5)},{docId:_0x29634b,action:_0x3191e5}=_0xfbd59d[_0x397c9e(0x232)],_0x26fff7=await _0x29c329[_0x397c9e(0x1c0)](_0xfbd59d);await _0x25d051[_0x397c9e(0x21b)](_0xfbd59d,_0x52f8d8,_0x26fff7['userAuthority']);const {collectionName:_0x2cd583,docTitle:_0x27f092}=_0xc8c22c[_0x397c9e(0x2b5)](_0xfbd59d[_0x397c9e(0x1d3)]),_0x1491cf=new _0x1b6a0a(global[_0x397c9e(0x28e)]);try{if(_0x4ac7bf['lomoD'](_0x4ac7bf['bLquv'],_0x4ac7bf[_0x397c9e(0x2e1)])){await _0x1491cf['connect']();var _0x3b0422=await _0x1491cf['db'](global[_0x397c9e(0x1d1)])[_0x397c9e(0x289)](_0x2cd583)[_0x397c9e(0x1f4)]({'docId':_0x29634b});if(!_0x3b0422)return _0x52f8d8[_0x397c9e(0x29e)](JSON['stringify']({'isLoad':!0x1,'class':_0x4ac7bf[_0x397c9e(0x26d)],'msg':_0x397c9e(0x2c6)+_0x29634b+'\x22'}));_0x3b0422[_0x397c9e(0x290)]=_0x27f092,_0x3b0422[_0x397c9e(0x27a)]=_0xc8c22c['get_StatusName_byStatusNumber'](_0x3b0422[_0x397c9e(0x23e)]);const _0x5493e5=_0xc8c22c['convert_DocPrint'](_0x3b0422),_0x3644e0=_0x3cc47f[_0x397c9e(0x27d)](folderForms,_0x4ac7bf['rstlY']),_0x4a6745=await _0x15876a['renderView'](_0x3644e0,_0x52f8d8,{'title':_0x29634b,'time':_0x4498fd[_0x397c9e(0x253)](0x0),'action':_0x3191e5,'doc':_0x5493e5,...await _0x15876a[_0x397c9e(0x2bc)]()});if(_0x4ac7bf[_0x397c9e(0x30e)](_0x3191e5,_0x4ac7bf[_0x397c9e(0x2d8)]))_0x52f8d8[_0x397c9e(0x29e)](JSON[_0x397c9e(0x1dd)]({'isPrint':!0x0,'class':_0x4ac7bf[_0x397c9e(0x1e0)],'htmlPage':_0x4a6745}));else{if(_0x4ac7bf['bfsXD'](_0x3191e5,_0x4ac7bf[_0x397c9e(0x26e)])){if(_0x4ac7bf['lomoD'](_0x4ac7bf['bCqWm'],_0x4ac7bf[_0x397c9e(0x2a7)]))_0x5f408f[_0x397c9e(0x1e9)](_0x4ac7bf['zBQAy'],_0x5c3031),_0x4cb07a['send'](_0x3716c6[_0x397c9e(0x1dd)]({'isPrint':!0x1,'class':_0x4ac7bf[_0x397c9e(0x26d)],'msg':_0x13426d[_0x397c9e(0x222)]}));else{const _0x1884bd=await(await import(_0x4ac7bf[_0x397c9e(0x2b3)]))['launch'](),_0x17aef0=await _0x1884bd[_0x397c9e(0x2bf)]();await _0x17aef0[_0x397c9e(0x2f2)](_0x4a6745,{'waitUntil':_0x4ac7bf[_0x397c9e(0x25c)],'timeout':0x2710}),await new Promise(_0xf4e288=>setTimeout(_0xf4e288,0x3e8));const _0x1272bb=Math[_0x397c9e(0x2b1)](_0x4ac7bf[_0x397c9e(0x1e7)](_0x4ac7bf[_0x397c9e(0x257)](0x50,25.4),0x60));await _0x17aef0[_0x397c9e(0x2cb)]({'width':_0x1272bb,'height':0x258,'deviceScaleFactor':0x1});const _0x206904=await _0x17aef0['evaluate'](()=>{const _0x85385=_0x397c9e;if(_0x4ac7bf['lomoD'](_0x4ac7bf[_0x85385(0x319)],_0x4ac7bf[_0x85385(0x319)]))_0x1c4838[_0x85385(0x228)]();else{const _0x2ed0a0=document[_0x85385(0x232)],_0x35674f=document['documentElement'];return Math[_0x85385(0x2df)](_0x2ed0a0['scrollHeight'],_0x2ed0a0[_0x85385(0x2a4)],_0x35674f[_0x85385(0x1c9)],_0x35674f[_0x85385(0x2c4)],_0x35674f['offsetHeight']);}}),_0x36650b=await _0x17aef0[_0x397c9e(0x285)]({'type':_0x4ac7bf['GgacT'],'clip':{'x':0x0,'y':0x0,'width':_0x1272bb,'height':_0x206904},'omitBackground':!0x1});await _0x1884bd[_0x397c9e(0x228)]();const _0x432fb6=_0x3b0422[_0x397c9e(0x2ca)]['replace'](/\//g,'');_0x52f8d8[_0x397c9e(0x1ff)](0xc8,{'Content-Type':_0x4ac7bf['EHdVd'],'Content-Disposition':_0x397c9e(0x1c7)+_0x432fb6+_0x397c9e(0x321),'Content-Length':_0x36650b[_0x397c9e(0x256)]}),_0x52f8d8[_0x397c9e(0x1eb)](_0x36650b);}}}}else return![];}catch(_0x4af744){_0x4ac7bf['lomoD'](_0x4ac7bf['LXnHj'],_0x4ac7bf[_0x397c9e(0x23c)])?GSzrLL['iMXpN'](_0x37681d,this,function(){const _0x340c77=_0x397c9e,_0x57768f=new _0x564c5d(GSzrLL[_0x340c77(0x2f8)]),_0x3a4946=new _0x901945(GSzrLL[_0x340c77(0x1ee)],'i'),_0x57de44=GSzrLL[_0x340c77(0x301)](_0x2f4809,GSzrLL['Ftopi']);!_0x57768f[_0x340c77(0x2b2)](GSzrLL[_0x340c77(0x1e8)](_0x57de44,GSzrLL[_0x340c77(0x304)]))||!_0x3a4946['test'](GSzrLL[_0x340c77(0x1e8)](_0x57de44,GSzrLL[_0x340c77(0x316)]))?GSzrLL['FCZEP'](_0x57de44,'0'):GSzrLL['KnjvR'](_0x9b00b8);})():(console[_0x397c9e(0x1e9)](_0x4ac7bf['zBQAy'],_0x4af744),_0x52f8d8[_0x397c9e(0x29e)](JSON[_0x397c9e(0x1dd)]({'isPrint':!0x1,'class':_0x4ac7bf[_0x397c9e(0x26d)],'msg':_0x4af744['message']})));}finally{_0x4ac7bf[_0x397c9e(0x1c8)](_0x4ac7bf[_0x397c9e(0x315)],_0x4ac7bf[_0x397c9e(0x315)])?function(){return![];}['constructor'](GSzrLL['clhie'](GSzrLL[_0x397c9e(0x2e3)],GSzrLL[_0x397c9e(0x20e)]))[_0x397c9e(0x209)](GSzrLL['HsuDp']):_0x1491cf['close']();}}),b[_0x13835b(0x2cc)](B,_0x1668b2[_0x13835b(0x239)],async(_0x4a294a,_0x2a30b3)=>{const _0x65f4fb=_0x13835b,_0x4027b4={'kzQjs':function(_0x1b88f8,_0xe6b815){return _0x1b88f8(_0xe6b815);},'rJPcl':function(_0x4f222b,_0x50ab86){return _0x4f222b+_0x50ab86;},'KiOSo':function(_0x3538ed,_0x5f4be2){return _0x3538ed+_0x5f4be2;},'ydUDz':_0x65f4fb(0x2b8),'YGfCe':'{}.constructor(\x22return\x20this\x22)(\x20)','DXFCl':function(_0xef4c3e,_0x21c1c7){return _0xef4c3e==_0x21c1c7;},'LHqCn':_0x65f4fb(0x1de),'gEfaW':_0x65f4fb(0x2c0),'arIGG':_0x65f4fb(0x276),'wxUEY':_0x65f4fb(0x1be),'OVLcf':_0x65f4fb(0x249),'JQRni':function(_0x4baccf,_0x1c421d){return _0x4baccf===_0x1c421d;},'JiRsI':function(_0x2d29a4,_0x201e31){return _0x2d29a4==_0x201e31;},'VAGmD':'ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','iRHsV':function(_0xe1269,_0x3d3127){return _0xe1269===_0x3d3127;},'maBYN':function(_0x10dbdf,_0x176e6b){return _0x10dbdf==_0x176e6b;},'Yyuau':_0x65f4fb(0x2d9),'BJzSC':_0x65f4fb(0x23f),'QuVVZ':_0x65f4fb(0x22e),'klWiR':function(_0x4cfe5a,_0x368c85){return _0x4cfe5a==_0x368c85;},'kiOlO':function(_0x39744c,_0x42e31f){return _0x39744c==_0x42e31f;},'hZdRs':function(_0x21a747,_0x22f61b){return _0x21a747==_0x22f61b;},'Qiltu':function(_0x5271dd,_0x22590d){return _0x5271dd>_0x22590d;},'GntYK':function(_0x126a17,_0x397846){return _0x126a17!==_0x397846;},'dKgnA':_0x65f4fb(0x318),'GwMVW':_0x65f4fb(0x2bb),'pBHJY':_0x65f4fb(0x24d),'zRJjS':_0x65f4fb(0x231),'qBpJT':'green','IsvzD':function(_0x205b83,_0x1ac1c8){return _0x205b83<_0x1ac1c8;},'wkQdG':'yellow'},_0x23c025=new _0x1b6a0a(global[_0x65f4fb(0x28e)]);try{const _0x5aecea=await _0x29c329['getUserData'](_0x4a294a);await _0x25d051[_0x65f4fb(0x21b)](_0x4a294a,_0x2a30b3,_0x5aecea[_0x65f4fb(0x2b6)]);const {collectionName:_0x2bc0d9}=_0xc8c22c['get_Info_ByUrl'](_0x4a294a[_0x65f4fb(0x1d3)]),{docId:_0x9fac88,action:_0x1c82fb}=_0x4a294a['body'],_0x5073e6=_0x4027b4[_0x65f4fb(0x247)](_0x1c82fb,_0x4027b4[_0x65f4fb(0x22a)])?_0x4027b4[_0x65f4fb(0x212)]:_0x4027b4['DXFCl'](_0x1c82fb,_0x4027b4[_0x65f4fb(0x244)])?'จบ':'';if(!_0x9fac88||![_0x4027b4[_0x65f4fb(0x244)],_0x4027b4[_0x65f4fb(0x22a)]][_0x65f4fb(0x214)](_0x1c82fb))return _0x2a30b3[_0x65f4fb(0x29e)](JSON[_0x65f4fb(0x1dd)]({'isStatus':!0x1,'class':_0x4027b4[_0x65f4fb(0x263)],'msg':_0x4027b4[_0x65f4fb(0x221)]}));const _0x2544b7={'docId':_0x9fac88,'userId':_0x5aecea[_0x65f4fb(0x29a)]},_0x2d106a=_0x23c025['db'](global[_0x65f4fb(0x1d1)])[_0x65f4fb(0x289)](_0x2bc0d9),_0x16e059=await _0x2d106a['findOne'](_0x2544b7);if(!_0x16e059)return _0x2a30b3[_0x65f4fb(0x29e)](JSON[_0x65f4fb(0x1dd)]({'isStatus':!0x1,'class':_0x4027b4[_0x65f4fb(0x263)],'msg':_0x65f4fb(0x314)+_0x9fac88+_0x65f4fb(0x2e2)+_0x5073e6+'เอกสารที่ตันเองไม่ได้สร้าง'}));const _0x22e79c=_0x16e059[_0x65f4fb(0x23e)];if(_0x4027b4[_0x65f4fb(0x22c)](_0x1c82fb,_0x4027b4['LHqCn'])&&!(_0x4027b4[_0x65f4fb(0x2c1)](_0x22e79c,0x1)||_0x4027b4['DXFCl'](_0x22e79c,0x2)))return _0x2a30b3[_0x65f4fb(0x29e)](JSON[_0x65f4fb(0x1dd)]({'isStatus':!0x1,'class':_0x4027b4[_0x65f4fb(0x263)],'msg':_0x4027b4[_0x65f4fb(0x28a)]}));if(_0x4027b4[_0x65f4fb(0x2e4)](_0x1c82fb,_0x4027b4[_0x65f4fb(0x244)])&&_0x4027b4[_0x65f4fb(0x217)](!_0x22e79c,0x1))return _0x2a30b3[_0x65f4fb(0x29e)](JSON['stringify']({'isStatus':!0x1,'class':_0x4027b4[_0x65f4fb(0x263)],'msg':_0x4027b4[_0x65f4fb(0x24e)]}));if(_0x4027b4[_0x65f4fb(0x247)](_0x1c82fb,_0x4027b4[_0x65f4fb(0x22a)])){if(_0x4027b4[_0x65f4fb(0x22c)](_0x4027b4['BJzSC'],_0x4027b4[_0x65f4fb(0x1fa)])){let _0x1af7f7;try{_0x1af7f7=RIPGFy[_0x65f4fb(0x237)](_0x219841,RIPGFy['rJPcl'](RIPGFy[_0x65f4fb(0x240)](RIPGFy[_0x65f4fb(0x270)],RIPGFy['YGfCe']),');'))();}catch(_0x5167d6){_0x1af7f7=_0xa2dd8f;}return _0x1af7f7;}else{if(_0x4027b4[_0x65f4fb(0x247)](_0x16e059[_0x65f4fb(0x1d5)],!0x1))return _0x2a30b3[_0x65f4fb(0x29e)](JSON[_0x65f4fb(0x1dd)]({'isStatus':!0x1,'class':_0x4027b4[_0x65f4fb(0x263)],'msg':_0x65f4fb(0x219)+_0x9fac88+_0x65f4fb(0x1d4)}));if(_0x4027b4[_0x65f4fb(0x22f)]((await _0xc8c22c[_0x65f4fb(0x322)](_0x16e059,_0x2bc0d9,_0x5aecea[_0x65f4fb(0x29a)]))[_0x65f4fb(0x1d5)],!0x1))return _0x2a30b3[_0x65f4fb(0x29e)](JSON['stringify']({'isStatus':!0x1,'class':_0x4027b4[_0x65f4fb(0x263)],'msg':'เอกสาร\x20\x22'+_0x9fac88+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));}}if(_0x4027b4['kiOlO'](_0x1c82fb,_0x4027b4[_0x65f4fb(0x22a)]))var _0x27f2e0=0xa;else{if(_0x4027b4['hZdRs'](_0x1c82fb,_0x4027b4[_0x65f4fb(0x244)]))var _0x27f2e0=0x2;}const _0x478957=await _0x2d106a[_0x65f4fb(0x242)](_0x2544b7,{'$set':{'docStatusNumber':_0x27f2e0}});var _0x4333b8=_0x5073e6+'\x20\x22'+_0x9fac88+'\x22\x20เรียบร้อยแล้ว';if(_0x478957[_0x65f4fb(0x259)]||_0x4027b4[_0x65f4fb(0x236)](_0x478957[_0x65f4fb(0x271)],0x0)){const _0x3db64f=_0xc8c22c['getChangeHistory']({'docStatusNumber':_0x22e79c},{'docStatusNumber':_0x27f2e0});if(_0x4027b4[_0x65f4fb(0x236)](_0x3db64f[_0x65f4fb(0x256)],0x0)){if(_0x4027b4[_0x65f4fb(0x227)](_0x4027b4[_0x65f4fb(0x30a)],_0x4027b4[_0x65f4fb(0x30a)])){if(_0x8bda80){const _0x1e92e3=_0x5bacab[_0x65f4fb(0x209)](_0x266c65,arguments);return _0x4aa64d=null,_0x1e92e3;}}else{const _0x2e9198={'dateTime':_0x3ab192[_0x65f4fb(0x26a)]()[_0x65f4fb(0x28d)](_0x4027b4[_0x65f4fb(0x265)])[_0x65f4fb(0x25e)](_0x4027b4[_0x65f4fb(0x284)]),'userId':_0x5aecea[_0x65f4fb(0x29a)],'userFullname':_0x5aecea[_0x65f4fb(0x1f6)],'changes':_0x3db64f};await _0x2d106a[_0x65f4fb(0x242)]({'docId':_0x9fac88},{'$push':{'changesHistory':{'$each':[_0x2e9198],'$position':0x0}}}),_0x4333b8+=_0x4027b4[_0x65f4fb(0x203)];}}return _0x2a30b3[_0x65f4fb(0x29e)](JSON[_0x65f4fb(0x1dd)]({'isStatus':!0x0,'docId':_0x9fac88,'docStatusNumber':_0x27f2e0,'class':_0x4027b4[_0x65f4fb(0x229)],'msg':_0x4333b8}));}else{if(_0x478957[_0x65f4fb(0x259)]&&_0x4027b4['IsvzD'](_0x478957[_0x65f4fb(0x271)],0x1))return _0x2a30b3[_0x65f4fb(0x29e)](JSON['stringify']({'isStatus':!0x1,'docId':_0x9fac88,'docStatusNumber':_0x22e79c,'class':_0x4027b4[_0x65f4fb(0x224)],'msg':'\x22'+_0x9fac88+_0x65f4fb(0x24b)}));}}catch(_0x2c4167){console[_0x65f4fb(0x1e9)](_0x2c4167),_0x2a30b3[_0x65f4fb(0x29e)](JSON[_0x65f4fb(0x1dd)]({'isStatus':!0x1,'class':_0x4027b4[_0x65f4fb(0x263)],'msg':_0x2c4167[_0x65f4fb(0x222)]}));}finally{_0x23c025[_0x65f4fb(0x228)]();}});export default b;function _0x19fd92(_0x23a276){const _0x5bf413=_0x13835b,_0x245728={'LeegC':function(_0x483197,_0x3b3427){return _0x483197===_0x3b3427;},'isenD':_0x5bf413(0x1fd),'VrrqU':_0x5bf413(0x282),'wLFXi':'counter','bnyTC':function(_0x3c66b5,_0x3d6127){return _0x3c66b5!==_0x3d6127;},'FkLJs':function(_0x117b35,_0x4b9694){return _0x117b35+_0x4b9694;},'BtRue':function(_0x5aca10,_0x557a1e){return _0x5aca10/_0x557a1e;},'BHKNt':_0x5bf413(0x256),'WEzea':function(_0x219596,_0x1e380e){return _0x219596%_0x1e380e;},'LKrMN':function(_0x43f6ce,_0x58e712){return _0x43f6ce+_0x58e712;},'kZJxV':_0x5bf413(0x2db),'WkrWJ':_0x5bf413(0x2f3),'OcMPa':_0x5bf413(0x205),'JvxDC':function(_0xd7f634,_0xf6986c){return _0xd7f634+_0xf6986c;},'KvhUd':_0x5bf413(0x234),'fWHTa':function(_0x81c7c5,_0x3b4347){return _0x81c7c5(_0x3b4347);}};function _0xa7feed(_0x3e7340){const _0x57f749=_0x5bf413;if(_0x245728[_0x57f749(0x306)](typeof _0x3e7340,_0x245728[_0x57f749(0x20f)]))return function(_0x19e1f1){}[_0x57f749(0x1fe)](_0x245728['VrrqU'])[_0x57f749(0x209)](_0x245728[_0x57f749(0x1dc)]);else _0x245728[_0x57f749(0x2fa)](_0x245728[_0x57f749(0x2f4)]('',_0x245728[_0x57f749(0x2c2)](_0x3e7340,_0x3e7340))[_0x245728[_0x57f749(0x300)]],0x1)||_0x245728[_0x57f749(0x306)](_0x245728[_0x57f749(0x28b)](_0x3e7340,0x14),0x0)?function(){return!![];}['constructor'](_0x245728[_0x57f749(0x274)](_0x245728[_0x57f749(0x29c)],_0x245728[_0x57f749(0x1cd)]))[_0x57f749(0x2aa)](_0x245728[_0x57f749(0x324)]):function(){return![];}[_0x57f749(0x1fe)](_0x245728['JvxDC'](_0x245728[_0x57f749(0x29c)],_0x245728[_0x57f749(0x1cd)]))[_0x57f749(0x209)](_0x245728[_0x57f749(0x1f3)]);_0x245728[_0x57f749(0x1c4)](_0xa7feed,++_0x3e7340);}try{if(_0x23a276)return _0xa7feed;else _0x245728[_0x5bf413(0x1c4)](_0xa7feed,0x0);}catch(_0x24efde){}}function _0x3263(){const _0x5a2679=['eBXUx','osKCu','ydUDz','modifiedCount','RYjij','pBlPX','LKrMN','FUVtm','finish','sales','EFqvY','console','statusName','Qyyoa','green','join','mvlDr','EwTlr','changesHistory','input','while\x20(true)\x20{}','kPEUE','pBHJY','screenshot','getItems_for_Modal','/fetch/modal','YBdAh','collection','VAGmD','WEzea','connect','setZone','dbUrl','IEiTQ','docTitle','PROLV','puppeteer','AAtaL','xVBwi','rCSTA','rtCHC','{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','get','eWlIL','userId','error\x20===>\x20','kZJxV','{}.constructor(\x22return\x20this\x22)(\x20)','send','ZlFhC','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','dateTimeCanCancel','/load','cwbYR','offsetHeight','266nuBuJi','aIMkr','bCqWm','DOC_TYPE','dOzjx','call','load','UovCi','WHYnF','CxGfi','zmJmf','UmUmP','floor','test','kFcwc','guCsh','get_Info_ByUrl','userAuthority','rPqms','return\x20(function()\x20','NayoD','image','Asia/Bangkok','getSettings','OziJj','/search','newPage','ยกเลิก','JiRsI','BtRue','GsJcq','scrollHeight','yuUNf','ไม่พบเอกสารเลขที่\x20\x22','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','EATFi','szAnB','docId','setViewport','post','BlkeQ','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','jVvry','vhtAE','qiRYo','557480aQTWGh','WHchb','DMnXV','2898604PZEOvX','yjdNq','stock','FZHzu','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','prototype','debu','init','\x22\x20เอกสาร','QttUv','max','OLXRC','qCeWx','{{sep}}หรือไม่มีสิทธิ์','woPJh','iRHsV','egeSE','3liidHh','dbYHL','Qpwvp','iWDGi','uYitW','yETPJ','PATH_WAREHOUSE_IN','83704cMnVEV','udrdQ','SLipS','warehouseIn','dateTimeCanEdit','setContent','gger','FkLJs','54EfoxVY','ไม่พบเอกสารล่าสุด','ZPFMp','jKpwK','XBJLc','bnyTC','iEoaI','renderView','oWmkj','EUSWP','641500ghBhUY','BHKNt','FCZEP','tBcyg','check_DocDateTime_CanEdit','tODhI','JQWxK','LeegC','drgHa','Tvgbd','dateTimeCancelRemain','dKgnA','error','/load-last','image/jpeg','bfsXD','chain','HIGkK','nIOfT','CCnGs','NkZpK','ไม่พบเอกสาร\x20\x22','ezBIu','HRhBg','DdbtH','xLoAV','mURWi','rPGug','QPEPE','ORMLb','canEdit','GWmlH','ATwMY','yPHON','.jpeg','check_DocDateTime_CanCancel','pNWUw','OcMPa','/status','mYrYZ','BgvWD','JzzsS','bind','active','red','function\x20*\x5c(\x20*\x5c)','getUserData','FcxOt','ZDsYj','Dyuph','fWHTa','GyHdj','tlLse','attachment;\x20filename=','kvVkl','clientHeight','Router','UeHcL','FQCTg','WkrWJ','gFbvZ','Gfjby','KfUQS','dbName','fjzwl','originalUrl','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','canCancel','sfhtF','kaplH','mzryQ','eyvAu','doc_changes.ejs','qcBVA','wLFXi','stringify','cancel','jpeg','LoJrB','warehouseOut','bwQKl','JkyRu','deafD','Otuvv','iPJcI','Rwpvy','clhie','log','getUserBranchesById','end','NEbXX','FCAPG','uvFaf','xizAM','lDaiN','UuTKz','LIngO','KvhUd','findOne','sKqcm','userFullname','zsMWP','KkIzI','ZrqEF','QuVVZ','doc_print.ejs','eBxAq','string','constructor','writeHead','info','clPCA','PHPdN','zRJjS','AtvyV','action','GNJpp','yellow','ZdEeH','apply','HanJb','JSZhl','ELTvV','qjBvN','VhvCk','isenD','74345raVBis','phKlY','gEfaW','PATH_SALES','includes','ZcgdT','XQiGS','maBYN','toString','เอกสาร\x20\x22','1610GKXwqD','getMainDocPathObj','xxyWE','vlXgH','FGVzO','TvRhl','FSaTm','OVLcf','message','JOmIG','wkQdG','warn','/print','GntYK','close','qBpJT','LHqCn','toArray','JQRni','tIODw','sAqNr','klWiR','MQMnq','{{sep}}[บันทึกการแก้ไข]','body','dfdts','stateObject','feIfl','Qiltu','kzQjs','counter','isAuth','GDuWd','CsupZ','LXnHj','table','docStatusNumber','ewcot','KiOSo','rEuYM','updateOne','dateTimeEditRemain','arIGG','zrHie','majXV','DXFCl','YhFPa','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','print','\x20ไม่เปลี่ยนแปลง\x22','ouDiV','yyyy-MM-dd\x20HH:mm','Yyuau','WQmjG','branchName','IFFVm','1091628tWYipK','getDate','tCGeG','MydQk','length','hYmaa','getItemsCategory','matchedCount','SRpgs','documentElement','oaWKv','tZCXQ','toFormat','aLDfb','MYvxX','hWRIS','/changes','wxUEY','push','GwMVW','BqoIQ','FhfvH','aggregate','DMgeS','now','33273wWUCzq','TRXDY','AvCgp'];_0x3263=function(){return _0x5a2679;};return _0x3263();}