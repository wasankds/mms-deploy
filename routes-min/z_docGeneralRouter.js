const _0x2b69ca=_0x24a4;(function(_0x43ef3f,_0x3a8642){const _0x123794=_0x24a4,_0x35c598=_0x43ef3f();while(!![]){try{const _0xd9aa97=-parseInt(_0x123794(0x192))/0x1+parseInt(_0x123794(0x139))/0x2+-parseInt(_0x123794(0x15d))/0x3+parseInt(_0x123794(0x114))/0x4+parseInt(_0x123794(0x146))/0x5*(parseInt(_0x123794(0x14b))/0x6)+-parseInt(_0x123794(0x1c5))/0x7+parseInt(_0x123794(0x184))/0x8*(parseInt(_0x123794(0x1df))/0x9);if(_0xd9aa97===_0x3a8642)break;else _0x35c598['push'](_0x35c598['shift']());}catch(_0x320494){_0x35c598['push'](_0x35c598['shift']());}}}(_0x7434,0xd4e75));function _0x7434(){const _0x1b4d5a=['RXyja','WNrJE','getUserData','FkWqq','AihhW','UugPO','ujUxG','FTgSf','thgRF','iLMKe','getChangeHistory','userId','DKbVk','emXDs','viJhP','LJcPA','Router','bVOJW','fhSZw','zPJei','QXZcg','ipcbD','userFullname','ytvQt','/print','isAuth','send','ixmni','dUzKq','oCtqF','warn','stateObject','nRbZY','Cojul','SLJlh','cFrge','nWnKb','end','gdqtt','canEdit','toArray','canCancel','iIdfS','ไม่พบเอกสารเลขที่\x20\x22','Bannd','okGYn','OVIyS','chain','IJxRp','crBbm','getMainDocPathObj','sSQPx','CIePX','AfvaN','huYju','fvHXh','IiFCX','Jaxzo','VdeHn','YRwcu','error','โหลดเอกสารเลขที่\x20\x22','BpXZI','getItemsCategory','includes','zMhoP','ARWww','jQOGR','zDvWF','HyWEv','call','gger','counter','uNsDU','HzZoZ','{{sep}}[บันทึกการแก้ไข]','DnPOo','jDYbC','ไม่พบเอกสารล่าสุด','nCbmq','prototype','check_DocDateTime_CanCancel','IZlRx','replace','max','log','vrvZJ','viaHi','bJEod','oPxXy','attachment;\x20filename=','getUserBranchesById','eTRlD','constructor','dnVHm','oRevu','VggSC','cXjDR','esGRM','EMJuB','llDoI','LnKlr','return\x20(function()\x20','Yfcfk','/search','doc_changes.ejs','/load','dyYJr','sHBZa','JASLo','EpYnu','HpZAW','BrOno','VBPtj','error\x20===>\x20','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','NwTZE','QybCG','image','iYUGo','qiCMs','info','qCnRM','changesHistory','6952456NBbSTn','vPnSm','lZBZx','NCznb','YYZwY','lfHTs','table','CtlhL','input','kVakb','uyNQn','findOne','wPWCj','stock','{{sep}}หรือไม่มีสิทธิ์','/changes','Nuniz','zUOGV','jHWlk','vzQDM','/fetch/modal','fwjcj','docStatusNumber','Mbtku','NaqRu','pAIqh','cExfi','matchedCount','Dbfdb','AbQts','toString','PYWne','DOC_TYPE','VYZri','ROGvb','VxZMx','poCoP','8190CKFKkx','wQMpv','uKClN','LTkam','docId','originalUrl','bind','floor','FlENm','load-last','kuadv','userAuthority','fYmON','234655aDshrk','SLLkM','BjlyQ','OqKuK','eQTCJ','18HQgSHu','YWNmU','Axeep','console','tHAvk','networkidle0','ZCrIY','xxQBh','dateTimeCanEdit','init','aGggj','modifiedCount','yyyy-MM-dd\x20HH:mm','dzuvJ','\x22\x20เอกสาร','dcfrO','QiuRX','rdWJK','5157159AhOoeC','OtiSr','ybFDF','nqoxS','eGNax','HUVWP','{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','RUhDQ','DNdck','hcSzp','HSZED','IRsdd','PIhve','ZOkdO','EQYqe','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','xRUGG','dateTimeEditRemain','nPntQ','Asia/Bangkok','RgerI','TtiuG','lZDhq','TQjWQ','setZone','TUCOw','OpkgB','eNdhm','tIxFk','xbkQN','body','load','fCSWo','renderView','sPHHV','action','warehouseIn','wRTvo','YYEsW','2310376EGjfYg','FPGnE','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','branchName','get_Info_ByUrl','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','DRnlo','aggregate','scrollHeight','red','EhZNW','isAjC','MCZza','tkEcN','448720kzskun','owjgC','UZhZv','LCGaV','setContent','RVszs','BTema','sales','YTVoE','CqXwH','พบ\x20\x22','ZjAxq','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','{}.constructor(\x22return\x20this\x22)(\x20)','PqyHY','nZlWS','JyBrq','connect','stringify','rIHsv','cxeeo','เอกสาร\x20\x22','HvCSc','launch','VqqWX','\x20ไม่เปลี่ยนแปลง\x22','now','__proto__','LOVLk','NyITF','getItems_for_Modal','cancel','CeWaV','rIUgX','EedYC','function\x20*\x5c(\x20*\x5c)','MvtyL','dateTimeCanCancel','CNSpI','PATH_SALES','/load-last','exception','CjaeK','HlDgT','mosWp','YJzKm','LQsPJ','offsetHeight','fBJzF','\x22\x20{{sep}}เรียบร้อยแล้ว','SGZLV','10096443gSxtbp','.jpeg','trace','SNRxW','qhjQj','test','/status','maJxT','PuRcp','PuRnF','XRNgi','aOZqB','weHUT','active','clientHeight','writeHead','apply','dbUrl','jFdrj','yellow','nQTfp','cfXBh','while\x20(true)\x20{}','XiZqI','kDlhg','YjTUM','81fnCoBW','DTNAf','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','ยกเลิก','VysuO','qBsae','rOyaV','nBkcc','stRdM','collection','join','QUbSW','ZnmpK','JQSFh','jwgLj','ztFQs','documentElement','YjzDg','green','toFormat','yktbq','xqlKH','cFpiM','aobpc','nbgJA','wZLMt','TDQzk','evaluate','dbName','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','lyBHp','message','MinUs','close','otIEh','post','kDNPT','ZjbGJ','gMCWR','get','CptcS','get_StatusName_byStatusNumber','kfgom','ไม่พบประวัติการเปลี่ยนแปลง','LdDUb','Vmgyd','debu','wPdmB','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','rhYWh','dbhyg','length','wTffo','updateOne','vruzj','WmMrL','xrZkt','rKYaC','ไม่พบเอกสาร\x20\x22'];_0x7434=function(){return _0x1b4d5a;};return _0x7434();}const _0x540660=(function(){const _0x4179b9=_0x24a4,_0xe071d3={'Nuniz':_0x4179b9(0x18d),'LnKlr':function(_0x32779e,_0x157dd0){return _0x32779e===_0x157dd0;},'BrOno':_0x4179b9(0x1f0),'UugPO':_0x4179b9(0x173),'LJcPA':function(_0x988e0f,_0x506719){return _0x988e0f!==_0x506719;},'wPdmB':_0x4179b9(0x112),'LOVLk':_0x4179b9(0x1c0),'snxTB':function(_0x46c82b,_0x1b0a50){return _0x46c82b===_0x1b0a50;},'IRsdd':'zTIAR','jQOGR':_0x4179b9(0x1f7)};let _0x18464f=!![];return function(_0x32d575,_0x32cc36){const _0x479b18=_0x4179b9;if(_0xe071d3['snxTB'](_0xe071d3[_0x479b18(0x168)],_0xe071d3[_0x479b18(0xdb)])){const _0x3fb19d=_0x37b5ac?function(){if(_0xebefb0){const _0x5ccaa9=_0x20b2dd['apply'](_0x114818,arguments);return _0x197738=null,_0x5ccaa9;}}:function(){};return _0xaf12fb=![],_0x3fb19d;}else{const _0x3aab5c=_0x18464f?function(){const _0x2fde6b=_0x479b18,_0x3127f0={'NwTZE':_0xe071d3[_0x2fde6b(0x124)]};if(_0xe071d3[_0x2fde6b(0xfd)](_0xe071d3[_0x2fde6b(0x108)],_0xe071d3[_0x2fde6b(0x21f)]))_0x47a6c2[_0x2fde6b(0xed)](_0x4fd0b1),_0x5aa920[_0x2fde6b(0x234)](_0x4a14eb[_0x2fde6b(0x1a4)]({'isStatus':!0x1,'class':_0x3127f0[_0x2fde6b(0x10c)],'msg':_0xc4a337[_0x2fde6b(0x1fe)]}));else{if(_0x32cc36){if(_0xe071d3[_0x2fde6b(0x229)](_0xe071d3[_0x2fde6b(0x20e)],_0xe071d3[_0x2fde6b(0x1ae)])){const _0x1c01ee=_0x32cc36['apply'](_0x32d575,arguments);return _0x32cc36=null,_0x1c01ee;}else _0x3b1c6a[_0x2fde6b(0x200)]();}}}:function(){};return _0x18464f=![],_0x3aab5c;}};}());(function(){const _0x5a5bcf=_0x24a4,_0xc09d67={'FKrqv':_0x5a5bcf(0x18d),'EQYqe':function(_0x50db83,_0x4e8bcd){return _0x50db83!==_0x4e8bcd;},'pAIqh':_0x5a5bcf(0xbe),'ORGxY':_0x5a5bcf(0x1e3),'vLfbk':_0x5a5bcf(0x1b5),'wTffo':_0x5a5bcf(0x189),'lfHTs':function(_0x40653f,_0x30400a){return _0x40653f(_0x30400a);},'DKbVk':_0x5a5bcf(0x154),'FKRBA':function(_0x2e0461,_0x447313){return _0x2e0461+_0x447313;},'PuRnF':_0x5a5bcf(0xc7),'SLJlh':function(_0xa5fe89,_0x2fdf7e){return _0xa5fe89+_0x2fdf7e;},'oPxXy':_0x5a5bcf(0x11c),'kVakb':function(_0x344362,_0x70965a){return _0x344362===_0x70965a;},'CtlhL':'gqoyG','HlDgT':'uxjEl','zUOGV':function(_0x367599,_0x27c8c4){return _0x367599!==_0x27c8c4;},'Yfcfk':_0x5a5bcf(0x129),'BVhoG':function(_0xc48995){return _0xc48995();},'xxQBh':function(_0x20863e,_0x4f44c2,_0x7558d1){return _0x20863e(_0x4f44c2,_0x7558d1);}};_0xc09d67[_0x5a5bcf(0x152)](_0x540660,this,function(){const _0xd6c877=_0x5a5bcf;if(_0xc09d67[_0xd6c877(0x16b)](_0xc09d67[_0xd6c877(0x12d)],_0xc09d67['ORGxY'])){const _0x259f5f=new RegExp(_0xc09d67['vLfbk']),_0x4f1246=new RegExp(_0xc09d67[_0xd6c877(0x213)],'i'),_0x38f327=_0xc09d67[_0xd6c877(0x119)](_0x4774de,_0xc09d67[_0xd6c877(0x226)]);if(!_0x259f5f[_0xd6c877(0x1ca)](_0xc09d67['FKRBA'](_0x38f327,_0xc09d67[_0xd6c877(0x1ce)]))||!_0x4f1246[_0xd6c877(0x1ca)](_0xc09d67[_0xd6c877(0x23c)](_0x38f327,_0xc09d67[_0xd6c877(0xf1)]))){if(_0xc09d67[_0xd6c877(0x11d)](_0xc09d67[_0xd6c877(0x11b)],_0xc09d67[_0xd6c877(0x1bd)]))return _0x5ec085[_0xd6c877(0xed)](_0x5917dd),_0x2bd529[_0xd6c877(0x234)](_0xf098fb[_0xd6c877(0x1a4)]({'isLoad':!0x1,'class':_0xc09d67['FKrqv'],'msg':_0x45fc80['message']}));else _0xc09d67[_0xd6c877(0x119)](_0x38f327,'0');}else{if(_0xc09d67[_0xd6c877(0x125)](_0xc09d67[_0xd6c877(0xff)],_0xc09d67[_0xd6c877(0xff)]))return _0x80c111[_0xd6c877(0xed)](_0x1277a0),_0x150a95[_0xd6c877(0x234)](_0xe3f968['stringify']({'isFetch':!0x1,'class':_0xc09d67['FKrqv'],'msg':_0x2905c4['message']}));else _0xc09d67['BVhoG'](_0x4774de);}}else{const _0x2acbaf=_0x5b653c[_0xd6c877(0x1d5)](_0x491c02,arguments);return _0x4000ba=null,_0x2acbaf;}})();}());function _0x24a4(_0x597888,_0x538ecb){const _0x4e66e4=_0x7434();return _0x24a4=function(_0x2c7387,_0x449973){_0x2c7387=_0x2c7387-0xbd;let _0x349994=_0x4e66e4[_0x2c7387];return _0x349994;},_0x24a4(_0x597888,_0x538ecb);}const _0x449973=(function(){const _0x4932d1=_0x24a4,_0x5d54ee={'bwoWq':_0x4932d1(0x10a),'dUzKq':_0x4932d1(0x18d),'SLLkM':function(_0x51e96e,_0x37815a){return _0x51e96e(_0x37815a);},'vPnSm':function(_0x696086,_0x32c6b0){return _0x696086+_0x32c6b0;},'ipcbD':_0x4932d1(0xfe),'QXZcg':_0x4932d1(0x19f),'llDoI':function(_0x31ec23,_0x348b77){return _0x31ec23===_0x348b77;},'DNdck':'OXSxY','zMhoP':_0x4932d1(0xcc),'TQjWQ':function(_0x31e047,_0x286337){return _0x31e047!==_0x286337;},'ytvQt':_0x4932d1(0x14f),'MCZza':'omORi'};let _0x1efc8a=!![];return function(_0x3e8a0a,_0xfeb7e4){const _0x30088a=_0x4932d1,_0x1ec6d9={'vzQDM':function(_0x21323c,_0x236cfb){const _0x361a3d=_0x24a4;return _0x5d54ee[_0x361a3d(0x147)](_0x21323c,_0x236cfb);},'wZLMt':function(_0x1d84df,_0x37cbb9){const _0x57d2ec=_0x24a4;return _0x5d54ee[_0x57d2ec(0x115)](_0x1d84df,_0x37cbb9);},'fYmON':_0x5d54ee[_0x30088a(0x22f)],'nQTfp':_0x5d54ee[_0x30088a(0x22e)],'ZnmpK':function(_0x4ac86f,_0x265139){const _0x5cd346=_0x30088a;return _0x5d54ee[_0x5cd346(0xfc)](_0x4ac86f,_0x265139);},'VxZMx':_0x5d54ee[_0x30088a(0x165)],'qBsae':_0x5d54ee[_0x30088a(0xd9)]};if(_0x5d54ee[_0x30088a(0x174)](_0x5d54ee[_0x30088a(0x231)],_0x5d54ee[_0x30088a(0x190)])){const _0x235c4b=_0x1efc8a?function(){const _0x2bc0a1=_0x30088a,_0x38170b={'Cojul':function(_0x2347e6,_0x50ee90){const _0x5887f1=_0x24a4;return _0x1ec6d9[_0x5887f1(0x127)](_0x2347e6,_0x50ee90);},'rBset':function(_0x58c22f,_0xe64f59){const _0x5bf8e5=_0x24a4;return _0x1ec6d9[_0x5bf8e5(0x1f8)](_0x58c22f,_0xe64f59);},'uiAoS':function(_0x1fabb5,_0x473923){const _0x1e8bcb=_0x24a4;return _0x1ec6d9[_0x1e8bcb(0x1f8)](_0x1fabb5,_0x473923);},'huYju':_0x1ec6d9[_0x2bc0a1(0x145)],'FNYsE':_0x1ec6d9[_0x2bc0a1(0x1d9)]};if(_0x1ec6d9[_0x2bc0a1(0x1eb)](_0x1ec6d9['VxZMx'],_0x1ec6d9[_0x2bc0a1(0x137)])){if(_0xfeb7e4){if(_0x1ec6d9[_0x2bc0a1(0x1eb)](_0x1ec6d9[_0x2bc0a1(0x1e4)],_0x1ec6d9[_0x2bc0a1(0x1e4)])){const _0x1bb7d7=_0xfeb7e4[_0x2bc0a1(0x1d5)](_0x3e8a0a,arguments);return _0xfeb7e4=null,_0x1bb7d7;}else{let _0x419b34;try{_0x419b34=_0x38170b['Cojul'](_0x38df0c,_0x38170b['rBset'](_0x38170b['uiAoS'](_0x38170b[_0x2bc0a1(0xce)],_0x38170b['FNYsE']),');'))();}catch(_0x15dc99){_0x419b34=_0x1b8bab;}return _0x419b34;}}}else _0x38170b[_0x2bc0a1(0x23b)](_0x23c484,'0');}:function(){};return _0x1efc8a=![],_0x235c4b;}else _0x5d90aa[_0x30088a(0xed)](_0x5d54ee['bwoWq'],_0xb2806),_0x32c2aa[_0x30088a(0x234)](_0x1b0ceb['stringify']({'isPrint':!0x1,'class':_0x5d54ee[_0x30088a(0x236)],'msg':_0x5a8456[_0x30088a(0x1fe)]}));};}()),_0x2c7387=_0x449973(this,function(){const _0x4106fc=_0x24a4,_0x548158={'UZhZv':function(_0x140cd7,_0xf263c2){return _0x140cd7!==_0xf263c2;},'iYUGo':_0x4106fc(0xf7),'weHUT':function(_0x4a0bf6,_0x42afb8){return _0x4a0bf6===_0x42afb8;},'YYEsW':_0x4106fc(0x16a),'dupDy':'XrjzO','yktbq':function(_0x1883f9,_0x3e6d3b){return _0x1883f9(_0x3e6d3b);},'bHbAW':function(_0x1b61e2,_0x168f82){return _0x1b61e2+_0x168f82;},'xRUGG':function(_0x165613,_0x4df87e){return _0x165613+_0x4df87e;},'ixmni':_0x4106fc(0xfe),'sHBZa':_0x4106fc(0x19f),'sSQPx':function(_0x55e71f,_0x2dd792){return _0x55e71f===_0x2dd792;},'JASLo':_0x4106fc(0xe1),'gMCWR':_0x4106fc(0xdc),'ybFDF':_0x4106fc(0x1db),'uolfI':_0x4106fc(0xe0),'xbkQN':function(_0x5919d8){return _0x5919d8();},'VqqWX':_0x4106fc(0xed),'PYWne':_0x4106fc(0x238),'hcSzp':_0x4106fc(0x111),'otIEh':_0x4106fc(0xd4),'rKYaC':_0x4106fc(0x1bb),'CjaeK':_0x4106fc(0x11a),'JQSFh':_0x4106fc(0x1c7),'CeWaV':function(_0x5800a1,_0x1f3de8){return _0x5800a1<_0x1f3de8;},'AbQts':_0x4106fc(0x167),'PuRcp':_0x4106fc(0x221)},_0x1b17d9=function(){const _0xadc757=_0x4106fc;if(_0x548158[_0xadc757(0x194)](_0x548158[_0xadc757(0x10f)],_0x548158[_0xadc757(0x10f)])){const _0x3af657=_0xd3a81[_0xadc757(0x1d5)](_0x3011a6,arguments);return _0x4a3782=null,_0x3af657;}else{let _0x4ea4b6;try{if(_0x548158[_0xadc757(0x1d1)](_0x548158[_0xadc757(0x183)],_0x548158['dupDy'])){const _0x4ea271=_0x626196[_0xadc757(0x17b)],_0x25805f=_0x26bba4[_0xadc757(0x1ef)];return _0x120f85[_0xadc757(0xec)](_0x4ea271[_0xadc757(0x18c)],_0x4ea271['offsetHeight'],_0x25805f['clientHeight'],_0x25805f[_0xadc757(0x18c)],_0x25805f[_0xadc757(0x1c1)]);}else _0x4ea4b6=_0x548158[_0xadc757(0x1f3)](Function,_0x548158['bHbAW'](_0x548158[_0xadc757(0x16d)](_0x548158[_0xadc757(0x235)],_0x548158[_0xadc757(0x104)]),');'))();}catch(_0xc38f63){if(_0x548158[_0xadc757(0xcb)](_0x548158[_0xadc757(0x105)],_0x548158[_0xadc757(0x205)]))return _0x29720b;else _0x4ea4b6=window;}return _0x4ea4b6;}},_0x286cbf=_0x548158[_0x4106fc(0x17a)](_0x1b17d9),_0x2d4c89=_0x286cbf[_0x4106fc(0x14e)]=_0x286cbf[_0x4106fc(0x14e)]||{},_0xd34b2d=[_0x548158[_0x4106fc(0x1aa)],_0x548158[_0x4106fc(0x133)],_0x548158[_0x4106fc(0x166)],_0x548158[_0x4106fc(0x201)],_0x548158[_0x4106fc(0x218)],_0x548158[_0x4106fc(0x1bc)],_0x548158[_0x4106fc(0x1ec)]];for(let _0xfb4f99=0x0;_0x548158[_0x4106fc(0x1b2)](_0xfb4f99,_0xd34b2d[_0x4106fc(0x212)]);_0xfb4f99++){if(_0x548158[_0x4106fc(0xcb)](_0x548158[_0x4106fc(0x131)],_0x548158[_0x4106fc(0x1cd)]))return function(_0x5c62b4){}[_0x4106fc(0xf5)](_0x548158[_0x4106fc(0x15f)])[_0x4106fc(0x1d5)](_0x548158['uolfI']);else{const _0x1940e8=_0x449973[_0x4106fc(0xf5)]['prototype'][_0x4106fc(0x13f)](_0x449973),_0x2ec7e7=_0xd34b2d[_0xfb4f99],_0x5077c3=_0x2d4c89[_0x2ec7e7]||_0x1940e8;_0x1940e8[_0x4106fc(0x1ad)]=_0x449973[_0x4106fc(0x13f)](_0x449973),_0x1940e8[_0x4106fc(0x132)]=_0x5077c3[_0x4106fc(0x132)][_0x4106fc(0x13f)](_0x5077c3),_0x2d4c89[_0x2ec7e7]=_0x1940e8;}}});_0x2c7387();import _0x14b0f7 from'express';const b=_0x14b0f7[_0x2b69ca(0x22a)]();import _0x2cfa95 from'path';import{MongoClient as _0x194070}from'mongodb';import _0x960fe0 from'../middleware/mainAuth.js';import*as _0x569a59 from'../mymodule/myUsers.js';import*as _0x55e8a9 from'../mymodule/myDateTime.js';import*as _0x46b10f from'../mymodule/myModule.js';import*as _0xadf518 from'../mymodule/myDocMain.js';import*as _0x54dd74 from'../mymodule/myData.js';import{DateTime as _0x1a7aad}from'luxon';const w=global['PATH_WAREHOUSE_IN'],S=global['PATH_WAREHOUSE_OUT'],p=global[_0x2b69ca(0x1b9)],k=[w+_0x2b69ca(0x123),S+_0x2b69ca(0x123),p+_0x2b69ca(0x123)],v=[w+_0x2b69ca(0x232),S+_0x2b69ca(0x232),p+_0x2b69ca(0x232)],B=[w+_0x2b69ca(0x1cb),S+'/status',p+_0x2b69ca(0x1cb)],x=[w+'/search',S+_0x2b69ca(0x100),p+_0x2b69ca(0x100)],L=[w+'/load',S+_0x2b69ca(0x102),p+_0x2b69ca(0x102),w+_0x2b69ca(0x1ba),S+_0x2b69ca(0x1ba),p+'/load-last'],W=[w+_0x2b69ca(0x128),S+'/fetch/modal',p+_0x2b69ca(0x128)];b[_0x2b69ca(0x206)](W,_0x960fe0['isAuth'],async(_0x4dbae4,_0x55d64a)=>{const _0x4b5f8f=_0x2b69ca,_0x561045={'GtZJu':_0x4b5f8f(0x1b5),'nWnKb':_0x4b5f8f(0x189),'AihhW':function(_0x3f6fd5,_0x338bcd){return _0x3f6fd5(_0x338bcd);},'PIhve':_0x4b5f8f(0x154),'JoBpy':function(_0x5852d,_0x372d52){return _0x5852d+_0x372d52;},'crBbm':_0x4b5f8f(0xc7),'HzZoZ':function(_0x20b162,_0x31ab22){return _0x20b162+_0x31ab22;},'czFLd':_0x4b5f8f(0x11c),'fhSZw':function(_0x11ff4a){return _0x11ff4a();},'FkWqq':function(_0x563c75,_0x21dbd8,_0x1964c5){return _0x563c75(_0x21dbd8,_0x1964c5);},'eTRlD':function(_0x2f87a7,_0x43d0a8){return _0x2f87a7===_0x43d0a8;},'okGYn':'wQrfG','ZjbGJ':function(_0x3873dc,_0x2387d2){return _0x3873dc==_0x2387d2;},'Vmgyd':_0x4b5f8f(0x181),'stRdM':_0x4b5f8f(0x121),'dyYJr':function(_0x11c6d0,_0x455ac5){return _0x11c6d0==_0x455ac5;},'YRwcu':'warehouseOut','eQTCJ':_0x4b5f8f(0x199),'kuadv':_0x4b5f8f(0x1d2),'VggSC':_0x4b5f8f(0x1f1),'SUmPe':_0x4b5f8f(0x10b),'SPDIF':_0x4b5f8f(0x1e5),'maJxT':_0x4b5f8f(0x136),'xqlKH':_0x4b5f8f(0x18d)},_0x1e830=await _0x569a59[_0x4b5f8f(0x21c)](_0x4dbae4),_0x4ed331=await _0xadf518[_0x4b5f8f(0xca)](_0x4dbae4,_0x55d64a,_0x1e830[_0x4b5f8f(0x144)]);try{if(_0x561045[_0x4b5f8f(0xf4)](_0x561045[_0x4b5f8f(0xc5)],_0x561045[_0x4b5f8f(0xc5)])){if(_0x561045[_0x4b5f8f(0x204)](_0x4ed331[_0x4b5f8f(0x134)],_0x561045[_0x4b5f8f(0x20c)]))var _0xb69642=await _0x54dd74['getItems_for_Modal'](_0x561045[_0x4b5f8f(0x1e7)]);else{if(_0x561045[_0x4b5f8f(0x103)](_0x4ed331[_0x4b5f8f(0x134)],_0x561045[_0x4b5f8f(0xd3)]))var _0xb69642=await _0x54dd74[_0x4b5f8f(0x1b0)](_0x561045[_0x4b5f8f(0x1e7)]);else{if(_0x561045['dyYJr'](_0x4ed331[_0x4b5f8f(0x134)],_0x561045[_0x4b5f8f(0x14a)]))var _0xb69642=await _0x54dd74[_0x4b5f8f(0x1b0)](_0x561045[_0x4b5f8f(0x143)]);}}const _0x252ddb=await _0x54dd74[_0x4b5f8f(0xd7)]();return _0x55d64a[_0x4b5f8f(0x234)](JSON[_0x4b5f8f(0x1a4)]({'DATA_ITEMS':_0xb69642,'DATA_CATEGORY':_0x252ddb,'isFetch':!0x0,'class':_0x561045[_0x4b5f8f(0xf8)],'msg':_0x561045['SUmPe']}));}else HalCeJ[_0x4b5f8f(0x21d)](_0x21891b,this,function(){const _0x55f0ec=_0x4b5f8f,_0x1fa927=new _0x40b9b5(HalCeJ['GtZJu']),_0x3ea712=new _0x58372a(HalCeJ[_0x55f0ec(0x23e)],'i'),_0x211f18=HalCeJ[_0x55f0ec(0x21e)](_0x56504b,HalCeJ[_0x55f0ec(0x169)]);!_0x1fa927[_0x55f0ec(0x1ca)](HalCeJ['JoBpy'](_0x211f18,HalCeJ[_0x55f0ec(0xc9)]))||!_0x3ea712[_0x55f0ec(0x1ca)](HalCeJ[_0x55f0ec(0xe2)](_0x211f18,HalCeJ['czFLd']))?HalCeJ[_0x55f0ec(0x21e)](_0x211f18,'0'):HalCeJ[_0x55f0ec(0x22c)](_0x3a8908);})();}catch(_0x137e79){if(_0x561045[_0x4b5f8f(0xf4)](_0x561045['SPDIF'],_0x561045[_0x4b5f8f(0x1cc)])){if(_0x10b23a){const _0x751385=_0x837085[_0x4b5f8f(0x1d5)](_0x5697bf,arguments);return _0x2767c0=null,_0x751385;}}else return console['log'](_0x137e79),_0x55d64a[_0x4b5f8f(0x234)](JSON[_0x4b5f8f(0x1a4)]({'isFetch':!0x1,'class':_0x561045[_0x4b5f8f(0x1f4)],'msg':_0x137e79['message']}));}}),b[_0x2b69ca(0x202)](x,_0x960fe0[_0x2b69ca(0x233)],async(_0x12c72a,_0x160d9b)=>{const _0x47f9dd=_0x2b69ca,_0x219b09={'tMVNn':function(_0xab4d6c,_0x3ececa){return _0xab4d6c(_0x3ececa);},'nCbmq':function(_0x167927,_0x290f06){return _0x167927+_0x290f06;},'WmMrL':function(_0x751ebb,_0x37e6f2){return _0x751ebb+_0x37e6f2;},'NaqRu':_0x47f9dd(0xfe),'fvHXh':_0x47f9dd(0x19f),'EowTm':function(_0x112e30,_0x942513){return _0x112e30<_0x942513;},'fnJEF':'yellow','LCGaV':_0x47f9dd(0x19e),'YWNmU':function(_0x318d06,_0x48f222){return _0x318d06===_0x48f222;},'nPntQ':_0x47f9dd(0x1dc),'cScIp':_0x47f9dd(0x1fc),'MvtyL':function(_0x5a312c,_0x4a75a9){return _0x5a312c+_0x4a75a9;},'CqXwH':_0x47f9dd(0x1f1),'tIxFk':function(_0x36427f,_0x33ea35){return _0x36427f!==_0x33ea35;},'jDYbC':_0x47f9dd(0x15b),'TDQzk':_0x47f9dd(0x18d),'CNSpI':_0x47f9dd(0x109),'RgerI':_0x47f9dd(0x223)};let {sip:_0x2c33d9}=_0x12c72a['body'];if(!_0x2c33d9&&_0x219b09['EowTm'](_0x2c33d9['length'],0x2))return _0x160d9b['send'](JSON['stringify']({'isSearch':!0x1,'class':_0x219b09['fnJEF'],'msg':_0x219b09[_0x47f9dd(0x195)]}));_0x2c33d9=_0x2c33d9[_0x47f9dd(0xeb)](/[!@#$%^&*<>]/g,'')??null;const _0x568eb8=await _0x569a59[_0x47f9dd(0x21c)](_0x12c72a);await _0xadf518[_0x47f9dd(0xca)](_0x12c72a,_0x160d9b,_0x568eb8[_0x47f9dd(0x144)]);const {collectionName:_0x446763}=_0x54dd74[_0x47f9dd(0x188)](_0x12c72a[_0x47f9dd(0x13e)]),_0x33c5cf=new _0x194070(global[_0x47f9dd(0x1d6)]);try{if(_0x219b09[_0x47f9dd(0x14c)](_0x219b09[_0x47f9dd(0x16f)],_0x219b09[_0x47f9dd(0x16f)])){await _0x33c5cf[_0x47f9dd(0x1a3)]();const _0x15c815=_0x33c5cf['db'](global['dbName'])[_0x47f9dd(0x1e8)](_0x446763),_0x24d3e7=[{'$or':[{'docId':{'$regex':_0x2c33d9,'$options':'i'}},{'docDateTime':{'$regex':_0x2c33d9,'$options':'i'}}]}];let _0x221966='';['O','S']['includes'](_0x568eb8[_0x47f9dd(0x144)])||(_0x221966+=_0x219b09['cScIp'],_0x24d3e7['push']({'userId':_0x568eb8[_0x47f9dd(0x225)]}));const _0x4b3da0=await _0x15c815[_0x47f9dd(0x18b)]([{'$match':{'$and':_0x24d3e7}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDateTime':0x1,'userId':0x1}}])[_0x47f9dd(0xc0)]();return _0x221966=_0x219b09[_0x47f9dd(0x1b6)](_0x47f9dd(0x19c)+_0x4b3da0[_0x47f9dd(0x212)]+_0x47f9dd(0x159),_0x221966),_0x160d9b['send'](JSON['stringify']({'searchFound':_0x4b3da0,'msg':_0x221966,'isSearch':!0x0,'class':_0x219b09[_0x47f9dd(0x19b)]}));}else{if(_0x1924c8){const _0x1a706a=_0x5b7353[_0x47f9dd(0x1d5)](_0x522694,arguments);return _0x54ac49=null,_0x1a706a;}}}catch(_0x51c738){if(_0x219b09[_0x47f9dd(0x179)](_0x219b09[_0x47f9dd(0xe5)],_0x219b09[_0x47f9dd(0xe5)]))_0x29ff69=naPnzS['tMVNn'](_0x137603,naPnzS[_0x47f9dd(0xe7)](naPnzS[_0x47f9dd(0x216)](naPnzS[_0x47f9dd(0x12c)],naPnzS[_0x47f9dd(0xcf)]),');'))();else return console[_0x47f9dd(0xed)](_0x51c738),_0x160d9b[_0x47f9dd(0x234)](JSON[_0x47f9dd(0x1a4)]({'isSearch':!0x1,'class':_0x219b09[_0x47f9dd(0x1f9)],'msg':_0x51c738['message']}));}finally{if(_0x219b09[_0x47f9dd(0x179)](_0x219b09[_0x47f9dd(0x1b8)],_0x219b09[_0x47f9dd(0x171)]))_0x33c5cf[_0x47f9dd(0x200)]();else return!![];}}),b[_0x2b69ca(0x202)](L,_0x960fe0['isAuth'],async(_0x132a4e,_0x5aec15)=>{const _0x273e90=_0x2b69ca,_0x4ccaf0={'ETvij':'function\x20*\x5c(\x20*\x5c)','sFHZs':_0x273e90(0x189),'ZCrIY':function(_0x21f1bd,_0x5e1248){return _0x21f1bd(_0x5e1248);},'PqyHY':_0x273e90(0x154),'Jaxzo':function(_0x4cda16,_0x49ea4d){return _0x4cda16+_0x49ea4d;},'Dbfdb':_0x273e90(0xc7),'IJxRp':_0x273e90(0x11c),'EedYC':function(_0xabb39d){return _0xabb39d();},'fCSWo':'red','zPJei':function(_0x4e84ee,_0x2e9d67){return _0x4e84ee+_0x2e9d67;},'OVIyS':_0x273e90(0x20d),'hfpkj':_0x273e90(0xdf),'wRTvo':_0x273e90(0x239),'RUhDQ':function(_0x30a93e,_0xa9c687){return _0x30a93e===_0xa9c687;},'nqoxS':'IREkR','qiCMs':_0x273e90(0x203),'FlENm':_0x273e90(0x17c),'cExfi':function(_0x57bca3,_0x4d7fe0){return _0x57bca3!==_0x4d7fe0;},'xPBXo':_0x273e90(0x1a8),'cfXBh':'YRyCH','owjgC':_0x273e90(0x142),'azgEX':_0x273e90(0xe6),'QUbSW':function(_0x33869e,_0x426a4f){return _0x33869e==_0x426a4f;},'YYZwY':function(_0x382b42,_0x5351d7){return _0x382b42===_0x5351d7;},'TbEUe':_0x273e90(0x148),'isAjC':_0x273e90(0x16c),'WNrJE':_0x273e90(0xda),'RXyja':function(_0x573829,_0x2ce5a2){return _0x573829==_0x2ce5a2;},'QybCG':_0x273e90(0x163),'mmYmy':_0x273e90(0x1f1),'EhZNW':_0x273e90(0x17f),'nZlWS':_0x273e90(0x1ff)};let {docId:_0x25448a,action:_0x14befb}=_0x132a4e[_0x273e90(0x17b)];const _0x1b895f=await _0x569a59['getUserData'](_0x132a4e);await _0xadf518[_0x273e90(0xca)](_0x132a4e,_0x5aec15,_0x1b895f[_0x273e90(0x144)]);const {collectionName:_0x4325d0}=_0x54dd74[_0x273e90(0x188)](_0x132a4e[_0x273e90(0x13e)]),_0x4b94f0=new _0x194070(global[_0x273e90(0x1d6)]);try{if(_0x4ccaf0['RUhDQ'](_0x4ccaf0[_0x273e90(0x160)],_0x4ccaf0[_0x273e90(0x110)]))_0x13838e=_0x5667e8;else{await _0x4b94f0[_0x273e90(0x1a3)]();const _0x3379aa=_0x4b94f0['db'](global[_0x273e90(0x1fb)])[_0x273e90(0x1e8)](_0x4325d0);if(_0x4ccaf0[_0x273e90(0x164)](_0x14befb,_0x4ccaf0[_0x273e90(0x141)])){if(_0x4ccaf0[_0x273e90(0x12e)](_0x4ccaf0['xPBXo'],_0x4ccaf0[_0x273e90(0x1da)])){const _0x1ca644=['O','S'][_0x273e90(0xd8)](_0x1b895f[_0x273e90(0x144)])?{'docId':_0x25448a}:{'docId':_0x25448a,'userId':_0x1b895f[_0x273e90(0x225)]};var _0x512700=await _0x3379aa[_0x273e90(0x11f)](_0x1ca644,{'projection':{'_id':0x0,'changesHistory':0x0}});}else{const _0x30e6dc=new _0xddd863(xxwXVl['ETvij']),_0x36c4c9=new _0x28a34d(xxwXVl['sFHZs'],'i'),_0x1563aa=xxwXVl[_0x273e90(0x151)](_0x4ee276,xxwXVl[_0x273e90(0x1a0)]);!_0x30e6dc[_0x273e90(0x1ca)](xxwXVl[_0x273e90(0xd1)](_0x1563aa,xxwXVl[_0x273e90(0x130)]))||!_0x36c4c9[_0x273e90(0x1ca)](xxwXVl[_0x273e90(0xd1)](_0x1563aa,xxwXVl[_0x273e90(0xc8)]))?xxwXVl[_0x273e90(0x151)](_0x1563aa,'0'):xxwXVl[_0x273e90(0x1b4)](_0xd0fe7b);}}else{if(_0x4ccaf0[_0x273e90(0x164)](_0x14befb,_0x4ccaf0[_0x273e90(0x193)]))var _0x512700=await _0x3379aa['findOne']({'userId':_0x1b895f['userId']},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x1850a2=_0x512700?'':_0x4ccaf0[_0x273e90(0x164)](_0x14befb,_0x4ccaf0[_0x273e90(0x141)])?_0x273e90(0xc3)+_0x25448a+'\x22':_0x4ccaf0['azgEX'];if(!_0x512700)return _0x5aec15[_0x273e90(0x234)](JSON[_0x273e90(0x1a4)]({'isLoad':!0x1,'class':_0x4ccaf0[_0x273e90(0x17d)],'msg':_0x1850a2}));let _0x144c94=_0x273e90(0xd5)+_0x512700[_0x273e90(0x13d)]+_0x273e90(0x1c3);if(_0x4ccaf0[_0x273e90(0x1ea)](_0x512700[_0x273e90(0x12a)],0x1)&&_0x512700[_0x273e90(0x153)]){if(_0x4ccaf0[_0x273e90(0x118)](_0x4ccaf0['TbEUe'],_0x4ccaf0['TbEUe'])){let _0x249237=await _0x54dd74['check_DocDateTime_CanEdit'](_0x512700,_0x4325d0,_0x1b895f[_0x273e90(0x225)]);_0x512700['dateTimeEditRemain']=_0x249237[_0x273e90(0x16e)],_0x4ccaf0[_0x273e90(0x1ea)](_0x249237[_0x273e90(0xbf)],!0x1)&&(_0x512700[_0x273e90(0x12a)]=_0x249237[_0x273e90(0x12a)],_0x144c94+=_0x4ccaf0[_0x273e90(0x18f)]);}else return _0x2df1bf[_0x273e90(0xed)](_0xba21e7),_0x338129['send'](_0x3e96b9[_0x273e90(0x1a4)]({'isSearch':!0x1,'class':_0x4ccaf0[_0x273e90(0x17d)],'msg':_0x1338a6[_0x273e90(0x1fe)]}));}else _0x512700[_0x273e90(0x16e)]='-';if((_0x4ccaf0['QUbSW'](_0x512700[_0x273e90(0x12a)],0x1)||_0x4ccaf0[_0x273e90(0x1ea)](_0x512700[_0x273e90(0x12a)],0x2))&&_0x512700[_0x273e90(0x1b7)]){if(_0x4ccaf0[_0x273e90(0x118)](_0x4ccaf0['WNrJE'],_0x4ccaf0[_0x273e90(0x21b)])){const _0x4ed986=await _0x54dd74[_0x273e90(0xe9)](_0x512700,_0x4325d0,_0x1b895f[_0x273e90(0x225)]);_0x512700['dateTimeCancelRemain']=_0x4ed986['dateTimeCancelRemain'],_0x4ccaf0[_0x273e90(0x21a)](_0x4ed986[_0x273e90(0xc1)],!0x1)&&(_0x144c94+=_0x4ccaf0[_0x273e90(0x10d)]);}else _0x39adfb['close']();}else _0x512700['dateTimeCancelRemain']='-';const {branchName:_0x344d17}=await _0x54dd74[_0x273e90(0xf3)](_0x512700['branchId']);return _0x512700[_0x273e90(0x187)]=_0x344d17,_0x5aec15[_0x273e90(0x234)](JSON[_0x273e90(0x1a4)]({'doc':_0x512700,'isLoad':!0x0,'class':_0x4ccaf0['mmYmy'],'msg':_0x144c94,'userId':_0x1b895f['userId'],'userAuthority':_0x1b895f[_0x273e90(0x144)]}));}}catch(_0x20a83a){if(_0x4ccaf0[_0x273e90(0x12e)](_0x4ccaf0['EhZNW'],_0x4ccaf0[_0x273e90(0x18e)]))(function(){return![];}['constructor'](xxwXVl[_0x273e90(0x22d)](xxwXVl[_0x273e90(0xc6)],xxwXVl['hfpkj']))[_0x273e90(0x1d5)](xxwXVl[_0x273e90(0x182)]));else return console[_0x273e90(0xed)](_0x20a83a),_0x5aec15[_0x273e90(0x234)](JSON['stringify']({'isLoad':!0x1,'class':_0x4ccaf0['fCSWo'],'msg':_0x20a83a['message']}));}finally{_0x4ccaf0[_0x273e90(0x118)](_0x4ccaf0[_0x273e90(0x1a1)],_0x4ccaf0['nZlWS'])?_0x4b94f0['close']():_0x4c37f5[_0x273e90(0x200)]();}}),b[_0x2b69ca(0x202)](k,_0x960fe0[_0x2b69ca(0x233)],async(_0x8c0746,_0x88515c)=>{const _0x22a0fb=_0x2b69ca,_0x406ac7={'AfvaN':_0x22a0fb(0x10a),'BpXZI':'red','EpYnu':function(_0x53b7c2,_0x1d8dc1){return _0x53b7c2!==_0x1d8dc1;},'eGNax':_0x22a0fb(0x155),'YTVoE':function(_0x3c19b4,_0x4c46c1){return _0x3c19b4<_0x4c46c1;},'nwPFM':_0x22a0fb(0x1d8),'FPGnE':_0x22a0fb(0x20a),'Mbtku':_0x22a0fb(0x101),'jFdrj':_0x22a0fb(0x170),'sJXua':'yyyy-MM-dd\x20HH:mm','HyWEv':_0x22a0fb(0x1f1),'llJYM':function(_0x5c86c3,_0x48a052){return _0x5c86c3===_0x48a052;},'XRNgi':'mslUT','YJzKm':_0x22a0fb(0x1a5)},{docId:_0x502187}=_0x8c0746[_0x22a0fb(0x17b)],_0x2040b8=await _0x569a59['getUserData'](_0x8c0746);await _0xadf518['getMainDocPathObj'](_0x8c0746,_0x88515c,_0x2040b8[_0x22a0fb(0x144)]);const {collectionName:_0x56e97e}=_0x54dd74['get_Info_ByUrl'](_0x8c0746[_0x22a0fb(0x13e)]),_0x1b9d89=new _0x194070(global[_0x22a0fb(0x1d6)]);try{if(_0x406ac7[_0x22a0fb(0x106)](_0x406ac7[_0x22a0fb(0x161)],_0x406ac7['eGNax']))_0x5d0740[_0x22a0fb(0x200)]();else{await _0x1b9d89[_0x22a0fb(0x1a3)]();var _0x5cdab3=await _0x1b9d89['db'](global[_0x22a0fb(0x1fb)])[_0x22a0fb(0x1e8)](_0x56e97e)[_0x22a0fb(0x11f)]({'docId':_0x502187});if(!_0x5cdab3)return _0x88515c['send'](JSON[_0x22a0fb(0x1a4)]({'isPrint':!0x1,'class':_0x406ac7[_0x22a0fb(0xd6)],'msg':_0x22a0fb(0xc3)+_0x502187+'\x22'}));const _0x1bcfe9=_0x5cdab3[_0x22a0fb(0x113)]||[];if(_0x406ac7[_0x22a0fb(0x19a)](_0x1bcfe9['length'],0x1))return _0x88515c['send'](JSON[_0x22a0fb(0x1a4)]({'isPrint':!0x1,'class':_0x406ac7['nwPFM'],'msg':_0x406ac7[_0x22a0fb(0x185)]}));const _0x1198bc=_0x2cfa95['join'](folderForms,_0x406ac7[_0x22a0fb(0x12b)]),_0x10df17=await _0x46b10f[_0x22a0fb(0x17e)](_0x1198bc,_0x88515c,{'title':_0x5cdab3[_0x22a0fb(0x13d)],'time':_0x1a7aad[_0x22a0fb(0x1ac)]()['setZone'](_0x406ac7[_0x22a0fb(0x1d7)])['toFormat'](_0x406ac7['sJXua']),'changesHistory':_0x1bcfe9});_0x88515c[_0x22a0fb(0x234)](JSON[_0x22a0fb(0x1a4)]({'isPrint':!0x0,'class':_0x406ac7[_0x22a0fb(0xdd)],'htmlPage':_0x10df17}));}}catch(_0x49f9f6){_0x406ac7['llJYM'](_0x406ac7[_0x22a0fb(0x1cf)],_0x406ac7['XRNgi'])?(console[_0x22a0fb(0xed)](_0x406ac7[_0x22a0fb(0xcd)],_0x49f9f6),_0x88515c[_0x22a0fb(0x234)](JSON[_0x22a0fb(0x1a4)]({'isPrint':!0x1,'class':_0x406ac7[_0x22a0fb(0xd6)],'msg':_0x49f9f6[_0x22a0fb(0x1fe)]}))):(_0x4892ea[_0x22a0fb(0xed)](_0x406ac7['AfvaN'],_0x47ef5c),_0x4d88eb[_0x22a0fb(0x234)](_0x50dc02['stringify']({'isPrint':!0x1,'class':_0x406ac7[_0x22a0fb(0xd6)],'msg':_0x159a93['message']})));}finally{_0x406ac7[_0x22a0fb(0x106)](_0x406ac7['YJzKm'],_0x406ac7[_0x22a0fb(0x1bf)])?_0x11897a[_0x22a0fb(0x200)]():_0x1b9d89['close']();}}),b[_0x2b69ca(0x202)](v,_0x960fe0[_0x2b69ca(0x233)],async(_0x142b79,_0x7bb37)=>{const _0x5ddb4a=_0x2b69ca,_0x215299={'thgRF':function(_0x503e29,_0x2dbbcf){return _0x503e29+_0x2dbbcf;},'HEoSQ':_0x5ddb4a(0x20d),'VYZri':'gger','HUVWP':_0x5ddb4a(0x180),'hOVkV':function(_0x25e7a5,_0x134f7f){return _0x25e7a5(_0x134f7f);},'lZBZx':function(_0x17644c,_0x5744b8){return _0x17644c===_0x5744b8;},'RVszs':_0x5ddb4a(0x1a2),'jHWlk':_0x5ddb4a(0xe4),'OtiSr':_0x5ddb4a(0x18d),'dcfrO':'doc_print.ejs','uKClN':function(_0xfdb9a6,_0x44b6ad){return _0xfdb9a6==_0x44b6ad;},'dzuvJ':'print','YjTUM':_0x5ddb4a(0x1f1),'oCtqF':_0x5ddb4a(0x10e),'SNRxW':function(_0x387ab4,_0x59c717){return _0x387ab4===_0x59c717;},'kDlhg':'QwasW','DTNAf':_0x5ddb4a(0x22b),'SGZLV':'puppeteer','dnVHm':_0x5ddb4a(0x150),'EMJuB':function(_0x31d63f,_0x529546){return _0x31d63f*_0x529546;},'EGWQy':function(_0x104ee8,_0x586e7e){return _0x104ee8/_0x586e7e;},'poCoP':'jpeg','emXDs':'image/jpeg','OqKuK':_0x5ddb4a(0x18a),'HpZAW':_0x5ddb4a(0x14d),'nBkcc':_0x5ddb4a(0x10a),'nRbZY':_0x5ddb4a(0x198)},{docId:_0x2763c0,action:_0x5e2ed7}=_0x142b79['body'],_0x64e9fe=await _0x569a59[_0x5ddb4a(0x21c)](_0x142b79);await _0xadf518['getMainDocPathObj'](_0x142b79,_0x7bb37,_0x64e9fe[_0x5ddb4a(0x144)]);const {collectionName:_0x13c03c,docTitle:_0x227b61}=_0x54dd74[_0x5ddb4a(0x188)](_0x142b79[_0x5ddb4a(0x13e)]),_0x412e9a=new _0x194070(global['dbUrl']);try{if(_0x215299[_0x5ddb4a(0x116)](_0x215299[_0x5ddb4a(0x126)],_0x215299['jHWlk'])){await _0x412e9a[_0x5ddb4a(0x1a3)]();var _0x1ec96e=await _0x412e9a['db'](global[_0x5ddb4a(0x1fb)])[_0x5ddb4a(0x1e8)](_0x13c03c)[_0x5ddb4a(0x11f)]({'docId':_0x2763c0});if(!_0x1ec96e)return _0x7bb37[_0x5ddb4a(0x234)](JSON[_0x5ddb4a(0x1a4)]({'isLoad':!0x1,'class':_0x215299[_0x5ddb4a(0x15e)],'msg':_0x5ddb4a(0xc3)+_0x2763c0+'\x22'}));_0x1ec96e['docTitle']=_0x227b61,_0x1ec96e['statusName']=_0x54dd74[_0x5ddb4a(0x208)](_0x1ec96e[_0x5ddb4a(0x12a)]);const _0x3a9abc=_0x54dd74['convert_DocPrint'](_0x1ec96e),_0x1a9f4d=_0x2cfa95[_0x5ddb4a(0x1e9)](folderForms,_0x215299[_0x5ddb4a(0x15a)]),_0x39951a=await _0x46b10f[_0x5ddb4a(0x17e)](_0x1a9f4d,_0x7bb37,{'title':_0x2763c0,'time':_0x55e8a9['getDate'](0x0),'action':_0x5e2ed7,'doc':_0x3a9abc,...await _0x46b10f['getSettings']()});if(_0x215299['uKClN'](_0x5e2ed7,_0x215299[_0x5ddb4a(0x158)]))_0x7bb37[_0x5ddb4a(0x234)](JSON[_0x5ddb4a(0x1a4)]({'isPrint':!0x0,'class':_0x215299[_0x5ddb4a(0x1de)],'htmlPage':_0x39951a}));else{if(_0x215299[_0x5ddb4a(0x13b)](_0x5e2ed7,_0x215299[_0x5ddb4a(0x237)])){if(_0x215299[_0x5ddb4a(0x1c8)](_0x215299[_0x5ddb4a(0x1dd)],_0x215299[_0x5ddb4a(0x1e0)]))(function(){return!![];}[_0x5ddb4a(0xf5)](JBLKvm[_0x5ddb4a(0x222)](JBLKvm['HEoSQ'],JBLKvm[_0x5ddb4a(0x135)]))[_0x5ddb4a(0xde)](JBLKvm[_0x5ddb4a(0x162)]));else{const _0x13d1f0=await(await import(_0x215299[_0x5ddb4a(0x1c4)]))[_0x5ddb4a(0x1a9)](),_0x12bac2=await _0x13d1f0['newPage']();await _0x12bac2[_0x5ddb4a(0x196)](_0x39951a,{'waitUntil':_0x215299[_0x5ddb4a(0xf6)],'timeout':0x2710}),await new Promise(_0x386f2f=>setTimeout(_0x386f2f,0x3e8));const _0x3e2d39=Math[_0x5ddb4a(0x140)](_0x215299[_0x5ddb4a(0xfb)](_0x215299['EGWQy'](0x50,25.4),0x60));await _0x12bac2['setViewport']({'width':_0x3e2d39,'height':0x258,'deviceScaleFactor':0x1});const _0x2554fc=await _0x12bac2[_0x5ddb4a(0x1fa)](()=>{const _0xa5fb2c=_0x5ddb4a;if(_0x215299['lZBZx'](_0x215299[_0xa5fb2c(0x197)],_0x215299[_0xa5fb2c(0x197)])){const _0x18e89e=document[_0xa5fb2c(0x17b)],_0x15c1b7=document['documentElement'];return Math[_0xa5fb2c(0xec)](_0x18e89e[_0xa5fb2c(0x18c)],_0x18e89e[_0xa5fb2c(0x1c1)],_0x15c1b7[_0xa5fb2c(0x1d3)],_0x15c1b7['scrollHeight'],_0x15c1b7[_0xa5fb2c(0x1c1)]);}else JBLKvm['hOVkV'](_0x1afcb2,0x0);}),_0xb68921=await _0x12bac2['screenshot']({'type':_0x215299[_0x5ddb4a(0x138)],'clip':{'x':0x0,'y':0x0,'width':_0x3e2d39,'height':_0x2554fc},'omitBackground':!0x1});await _0x13d1f0[_0x5ddb4a(0x200)]();const _0x594e6a=_0x1ec96e[_0x5ddb4a(0x13d)]['replace'](/\//g,'');_0x7bb37[_0x5ddb4a(0x1d4)](0xc8,{'Content-Type':_0x215299[_0x5ddb4a(0x227)],'Content-Disposition':_0x5ddb4a(0xf2)+_0x594e6a+_0x5ddb4a(0x1c6),'Content-Length':_0xb68921[_0x5ddb4a(0x212)]}),_0x7bb37[_0x5ddb4a(0xbd)](_0xb68921);}}}}else{const _0x31d4a4=_0x25e9eb?function(){const _0x55a136=_0x5ddb4a;if(_0x37245c){const _0x4afdb7=_0x3bff73[_0x55a136(0x1d5)](_0x2dc4ed,arguments);return _0x1473ed=null,_0x4afdb7;}}:function(){};return _0x181589=![],_0x31d4a4;}}catch(_0x190783){if(_0x215299[_0x5ddb4a(0x116)](_0x215299[_0x5ddb4a(0x149)],_0x215299[_0x5ddb4a(0x107)])){const _0x1061b6=_0x388a53[_0x5ddb4a(0xf5)][_0x5ddb4a(0xe8)][_0x5ddb4a(0x13f)](_0x1ccb5e),_0x483df8=_0x485bf8[_0x3b7739],_0xe8f8ad=_0x31157c[_0x483df8]||_0x1061b6;_0x1061b6[_0x5ddb4a(0x1ad)]=_0x2d97a0[_0x5ddb4a(0x13f)](_0x57fce8),_0x1061b6[_0x5ddb4a(0x132)]=_0xe8f8ad[_0x5ddb4a(0x132)][_0x5ddb4a(0x13f)](_0xe8f8ad),_0x3e6f60[_0x483df8]=_0x1061b6;}else console[_0x5ddb4a(0xed)](_0x215299[_0x5ddb4a(0x1e6)],_0x190783),_0x7bb37[_0x5ddb4a(0x234)](JSON[_0x5ddb4a(0x1a4)]({'isPrint':!0x1,'class':_0x215299[_0x5ddb4a(0x15e)],'msg':_0x190783[_0x5ddb4a(0x1fe)]}));}finally{if(_0x215299[_0x5ddb4a(0x1c8)](_0x215299[_0x5ddb4a(0x23a)],_0x215299[_0x5ddb4a(0x23a)]))_0x412e9a[_0x5ddb4a(0x200)]();else return![];}}),b['post'](B,_0x960fe0['isAuth'],async(_0x1f4736,_0x54f82b)=>{const _0x3633e8=_0x2b69ca,_0x5dbeab={'fBJzF':function(_0x418694){return _0x418694();},'rdWJK':function(_0x17c585,_0x193731){return _0x17c585(_0x193731);},'kfgom':function(_0x2df255,_0x59baa5){return _0x2df255==_0x59baa5;},'mosWp':_0x3633e8(0x1b1),'eNdhm':_0x3633e8(0x1e2),'IiFCX':'finish','ZjAxq':'red','CptcS':_0x3633e8(0x20f),'iIdfS':function(_0x5a881a,_0x28cec6){return _0x5a881a===_0x28cec6;},'Bannd':function(_0x31aef5,_0x561026){return _0x31aef5==_0x561026;},'aobpc':function(_0x560b87,_0x164be9){return _0x560b87==_0x164be9;},'ujUxG':'ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','VdeHn':function(_0x4e3262,_0x3974d7){return _0x4e3262===_0x3974d7;},'NyITF':function(_0x1d5645,_0x38e13b){return _0x1d5645==_0x38e13b;},'qhjQj':_0x3633e8(0x1e1),'FqaDu':function(_0x26d062,_0x5b2977){return _0x26d062!==_0x5b2977;},'vruzj':_0x3633e8(0xf0),'viJhP':_0x3633e8(0x1f5),'OpkgB':function(_0x3e396e,_0x2f7eea){return _0x3e396e==_0x2f7eea;},'lyBHp':function(_0x1059d5,_0x39862c){return _0x1059d5==_0x39862c;},'LTkam':function(_0x791950,_0x312a56){return _0x791950>_0x312a56;},'ztFQs':function(_0xef2b8a,_0x500962){return _0xef2b8a>_0x500962;},'aOZqB':_0x3633e8(0x210),'tkEcN':_0x3633e8(0x1a6),'TUCOw':_0x3633e8(0x170),'NCznb':_0x3633e8(0x157),'wPWCj':_0x3633e8(0xe3),'Tyoyf':_0x3633e8(0x1f1),'rIUgX':function(_0x22e343,_0x196997){return _0x22e343<_0x196997;},'uotkc':_0x3633e8(0x1d8)},_0x5de637=new _0x194070(global[_0x3633e8(0x1d6)]);try{const _0x3d00b9=await _0x569a59[_0x3633e8(0x21c)](_0x1f4736);await _0xadf518[_0x3633e8(0xca)](_0x1f4736,_0x54f82b,_0x3d00b9[_0x3633e8(0x144)]);const {collectionName:_0x387747}=_0x54dd74[_0x3633e8(0x188)](_0x1f4736[_0x3633e8(0x13e)]),{docId:_0x3f7ad6,action:_0x171434}=_0x1f4736['body'],_0x50ce2a=_0x5dbeab[_0x3633e8(0x209)](_0x171434,_0x5dbeab[_0x3633e8(0x1be)])?_0x5dbeab[_0x3633e8(0x178)]:_0x5dbeab['kfgom'](_0x171434,_0x5dbeab[_0x3633e8(0xd0)])?'จบ':'';if(!_0x3f7ad6||![_0x5dbeab[_0x3633e8(0xd0)],_0x5dbeab[_0x3633e8(0x1be)]]['includes'](_0x171434))return _0x54f82b['send'](JSON[_0x3633e8(0x1a4)]({'isStatus':!0x1,'class':_0x5dbeab[_0x3633e8(0x19d)],'msg':_0x5dbeab[_0x3633e8(0x207)]}));const _0x267847={'docId':_0x3f7ad6,'userId':_0x3d00b9[_0x3633e8(0x225)]},_0x5a9c2f=_0x5de637['db'](global[_0x3633e8(0x1fb)])['collection'](_0x387747),_0x20f4b8=await _0x5a9c2f[_0x3633e8(0x11f)](_0x267847);if(!_0x20f4b8)return _0x54f82b['send'](JSON[_0x3633e8(0x1a4)]({'isStatus':!0x1,'class':_0x5dbeab[_0x3633e8(0x19d)],'msg':_0x3633e8(0x219)+_0x3f7ad6+_0x3633e8(0x122)+_0x50ce2a+'เอกสารที่ตันเองไม่ได้สร้าง'}));const _0x1f5a17=_0x20f4b8[_0x3633e8(0x12a)];if(_0x5dbeab[_0x3633e8(0xc2)](_0x171434,_0x5dbeab[_0x3633e8(0x1be)])&&!(_0x5dbeab[_0x3633e8(0xc4)](_0x1f5a17,0x1)||_0x5dbeab[_0x3633e8(0x1f6)](_0x1f5a17,0x2)))return _0x54f82b[_0x3633e8(0x234)](JSON[_0x3633e8(0x1a4)]({'isStatus':!0x1,'class':_0x5dbeab[_0x3633e8(0x19d)],'msg':_0x5dbeab[_0x3633e8(0x220)]}));if(_0x5dbeab[_0x3633e8(0xd2)](_0x171434,_0x5dbeab[_0x3633e8(0xd0)])&&_0x5dbeab[_0x3633e8(0x1af)](!_0x1f5a17,0x1))return _0x54f82b[_0x3633e8(0x234)](JSON['stringify']({'isStatus':!0x1,'class':_0x5dbeab[_0x3633e8(0x19d)],'msg':_0x5dbeab[_0x3633e8(0x1c9)]}));if(_0x5dbeab[_0x3633e8(0xc4)](_0x171434,_0x5dbeab[_0x3633e8(0x1be)])){if(_0x5dbeab['FqaDu'](_0x5dbeab[_0x3633e8(0x215)],_0x5dbeab[_0x3633e8(0x228)])){if(_0x5dbeab['aobpc'](_0x20f4b8['canCancel'],!0x1))return _0x54f82b[_0x3633e8(0x234)](JSON[_0x3633e8(0x1a4)]({'isStatus':!0x1,'class':_0x5dbeab['ZjAxq'],'msg':_0x3633e8(0x1a7)+_0x3f7ad6+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));if(_0x5dbeab[_0x3633e8(0x177)]((await _0x54dd74[_0x3633e8(0xe9)](_0x20f4b8,_0x387747,_0x3d00b9[_0x3633e8(0x225)]))[_0x3633e8(0xc1)],!0x1))return _0x54f82b[_0x3633e8(0x234)](JSON[_0x3633e8(0x1a4)]({'isStatus':!0x1,'class':_0x5dbeab['ZjAxq'],'msg':_0x3633e8(0x1a7)+_0x3f7ad6+_0x3633e8(0x186)}));}else AIIRSu[_0x3633e8(0x1c2)](_0x32094e);}if(_0x5dbeab[_0x3633e8(0x1fd)](_0x171434,_0x5dbeab[_0x3633e8(0x1be)]))var _0x1ce1ef=0xa;else{if(_0x5dbeab[_0x3633e8(0x1af)](_0x171434,_0x5dbeab['IiFCX']))var _0x1ce1ef=0x2;}const _0x222d0c=await _0x5a9c2f[_0x3633e8(0x214)](_0x267847,{'$set':{'docStatusNumber':_0x1ce1ef}});var _0x2444e4=_0x50ce2a+'\x20\x22'+_0x3f7ad6+'\x22\x20เรียบร้อยแล้ว';if(_0x222d0c[_0x3633e8(0x12f)]||_0x5dbeab[_0x3633e8(0x13c)](_0x222d0c[_0x3633e8(0x156)],0x0)){const _0x4311f5=_0x54dd74[_0x3633e8(0x224)]({'docStatusNumber':_0x1f5a17},{'docStatusNumber':_0x1ce1ef});if(_0x5dbeab[_0x3633e8(0x1ee)](_0x4311f5['length'],0x0)){if(_0x5dbeab[_0x3633e8(0xc2)](_0x5dbeab[_0x3633e8(0x1d0)],_0x5dbeab[_0x3633e8(0x191)])){if(_0x51f460)return _0x176bb9;else AIIRSu[_0x3633e8(0x15c)](_0x469ab2,0x0);}else{const _0xdaef76={'dateTime':_0x1a7aad[_0x3633e8(0x1ac)]()[_0x3633e8(0x175)](_0x5dbeab[_0x3633e8(0x176)])[_0x3633e8(0x1f2)](_0x5dbeab[_0x3633e8(0x117)]),'userId':_0x3d00b9[_0x3633e8(0x225)],'userFullname':_0x3d00b9[_0x3633e8(0x230)],'changes':_0x4311f5};await _0x5a9c2f[_0x3633e8(0x214)]({'docId':_0x3f7ad6},{'$push':{'changesHistory':{'$each':[_0xdaef76],'$position':0x0}}}),_0x2444e4+=_0x5dbeab[_0x3633e8(0x120)];}}return _0x54f82b['send'](JSON[_0x3633e8(0x1a4)]({'isStatus':!0x0,'docId':_0x3f7ad6,'docStatusNumber':_0x1ce1ef,'class':_0x5dbeab['Tyoyf'],'msg':_0x2444e4}));}else{if(_0x222d0c[_0x3633e8(0x12f)]&&_0x5dbeab[_0x3633e8(0x1b3)](_0x222d0c[_0x3633e8(0x156)],0x1))return _0x54f82b['send'](JSON['stringify']({'isStatus':!0x1,'docId':_0x3f7ad6,'docStatusNumber':_0x1f5a17,'class':_0x5dbeab['uotkc'],'msg':'\x22'+_0x3f7ad6+_0x3633e8(0x1ab)}));}}catch(_0x2ae9de){console['log'](_0x2ae9de),_0x54f82b['send'](JSON[_0x3633e8(0x1a4)]({'isStatus':!0x1,'class':_0x5dbeab[_0x3633e8(0x19d)],'msg':_0x2ae9de[_0x3633e8(0x1fe)]}));}finally{_0x5de637['close']();}});export default b;function _0x4774de(_0x2145ed){const _0x3701b8=_0x2b69ca,_0x49a233={'cFrge':function(_0x59853f,_0x56fda0){return _0x59853f===_0x56fda0;},'Hbknb':'string','wQMpv':_0x3701b8(0x1db),'esGRM':'counter','cXjDR':function(_0x50abe1,_0x526f4b){return _0x50abe1!==_0x526f4b;},'jwgLj':function(_0x275602,_0xd57a83){return _0x275602+_0xd57a83;},'viaHi':function(_0x521ff4,_0x5a06ee){return _0x521ff4/_0x5a06ee;},'wmjXt':'length','IZlRx':function(_0x5412be,_0x110f71){return _0x5412be===_0x110f71;},'dbhyg':function(_0x18d382,_0x24bd27){return _0x18d382%_0x24bd27;},'LdDUb':_0x3701b8(0x20d),'xrZkt':'gger','vrvZJ':_0x3701b8(0x180),'uyNQn':'stateObject','TtiuG':function(_0x42d573,_0x5483e6){return _0x42d573(_0x5483e6);}};function _0x2f0227(_0x568038){const _0x52b8dd=_0x3701b8;if(_0x49a233[_0x52b8dd(0x23d)](typeof _0x568038,_0x49a233['Hbknb']))return function(_0x1cb545){}[_0x52b8dd(0xf5)](_0x49a233[_0x52b8dd(0x13a)])['apply'](_0x49a233[_0x52b8dd(0xfa)]);else _0x49a233[_0x52b8dd(0xf9)](_0x49a233['jwgLj']('',_0x49a233[_0x52b8dd(0xef)](_0x568038,_0x568038))[_0x49a233['wmjXt']],0x1)||_0x49a233[_0x52b8dd(0xea)](_0x49a233[_0x52b8dd(0x211)](_0x568038,0x14),0x0)?function(){return!![];}[_0x52b8dd(0xf5)](_0x49a233[_0x52b8dd(0x1ed)](_0x49a233[_0x52b8dd(0x20b)],_0x49a233['xrZkt']))['call'](_0x49a233[_0x52b8dd(0xee)]):function(){return![];}[_0x52b8dd(0xf5)](_0x49a233['jwgLj'](_0x49a233[_0x52b8dd(0x20b)],_0x49a233[_0x52b8dd(0x217)]))['apply'](_0x49a233[_0x52b8dd(0x11e)]);_0x49a233[_0x52b8dd(0x172)](_0x2f0227,++_0x568038);}try{if(_0x2145ed)return _0x2f0227;else _0x49a233[_0x3701b8(0x172)](_0x2f0227,0x0);}catch(_0x132acc){}}