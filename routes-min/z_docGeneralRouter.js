const _0x3635e2=_0x2706;(function(_0x41fb19,_0x2d99dd){const _0x56e63c=_0x2706,_0x3ce2ab=_0x41fb19();while(!![]){try{const _0x4f808e=parseInt(_0x56e63c(0x215))/0x1+-parseInt(_0x56e63c(0x1ef))/0x2*(-parseInt(_0x56e63c(0x34c))/0x3)+-parseInt(_0x56e63c(0x2c4))/0x4*(parseInt(_0x56e63c(0x201))/0x5)+-parseInt(_0x56e63c(0x206))/0x6+-parseInt(_0x56e63c(0x2c2))/0x7*(-parseInt(_0x56e63c(0x22a))/0x8)+parseInt(_0x56e63c(0x2da))/0x9*(parseInt(_0x56e63c(0x2d6))/0xa)+-parseInt(_0x56e63c(0x307))/0xb*(parseInt(_0x56e63c(0x34b))/0xc);if(_0x4f808e===_0x2d99dd)break;else _0x3ce2ab['push'](_0x3ce2ab['shift']());}catch(_0x37cdf9){_0x3ce2ab['push'](_0x3ce2ab['shift']());}}}(_0xc435,0x1a84a));const _0x5e895c=(function(){const _0x5442ab=_0x2706,_0x1ef815={'KsiXc':function(_0x41e01d,_0xf3d553){return _0x41e01d===_0xf3d553;},'YLDaY':_0x5442ab(0x20f),'VnDDb':_0x5442ab(0x241),'YtVhD':function(_0x1c0b3e,_0x5cd76e){return _0x1c0b3e!==_0x5cd76e;},'IFQdk':_0x5442ab(0x317),'NzDuq':_0x5442ab(0x2f7),'uLVrW':_0x5442ab(0x229),'DyOPF':_0x5442ab(0x2d8),'OTxWH':_0x5442ab(0x2be),'IRdpa':_0x5442ab(0x300)};let _0x55883e=!![];return function(_0x50bad9,_0x2b2e4d){const _0x5cb438=_0x5442ab,_0x13d281={'HRIPI':_0x1ef815[_0x5cb438(0x2b2)],'jXCGv':_0x1ef815['DyOPF']};if(_0x1ef815[_0x5cb438(0x2f6)](_0x1ef815['OTxWH'],_0x1ef815[_0x5cb438(0x35d)]))_0x28293c['close']();else{const _0x3b2e37=_0x55883e?function(){const _0x556bfb=_0x5cb438;if(_0x1ef815[_0x556bfb(0x2f6)](_0x1ef815['YLDaY'],_0x1ef815['VnDDb']))return![];else{if(_0x2b2e4d){if(_0x1ef815[_0x556bfb(0x222)](_0x1ef815[_0x556bfb(0x333)],_0x1ef815[_0x556bfb(0x235)])){const _0xf7f5a9=_0x2b2e4d[_0x556bfb(0x321)](_0x50bad9,arguments);return _0x2b2e4d=null,_0xf7f5a9;}else _0x205555[_0x556bfb(0x2e7)](_0x13d281[_0x556bfb(0x1eb)],_0x214e3e),_0x546416[_0x556bfb(0x245)](_0x4195fb[_0x556bfb(0x28a)]({'isPrint':!0x1,'class':_0x13d281[_0x556bfb(0x21a)],'msg':_0x349b48[_0x556bfb(0x232)]}));}}}:function(){};return _0x55883e=![],_0x3b2e37;}};}());(function(){const _0x401144=_0x2706,_0x50d101={'xzayf':function(_0xe574a4,_0x43f146){return _0xe574a4(_0x43f146);},'CJEBW':function(_0x107b2c,_0x42edc0){return _0x107b2c+_0x42edc0;},'ldfTL':function(_0x44a5c3,_0x2965d2){return _0x44a5c3+_0x2965d2;},'zVEQf':_0x401144(0x327),'ttEgv':_0x401144(0x2b9),'Bavdb':function(_0x5c0424){return _0x5c0424();},'guYcL':function(_0x2433ed,_0x397263){return _0x2433ed===_0x397263;},'zqhlv':_0x401144(0x334),'lxhHY':_0x401144(0x348),'gfEZP':_0x401144(0x2fc),'jKqZu':function(_0x234af1,_0x55ff01){return _0x234af1(_0x55ff01);},'JWxDO':'init','lcnsH':_0x401144(0x2bc),'sQGKe':_0x401144(0x33b),'NusEp':function(_0x30428c,_0x285ab0){return _0x30428c===_0x285ab0;},'koBXk':_0x401144(0x209),'GTnWA':_0x401144(0x283),'pgilT':function(_0x2becea,_0x5f5866){return _0x2becea(_0x5f5866);},'XmbpO':function(_0x4ef8dc,_0x24c4d2){return _0x4ef8dc===_0x24c4d2;},'RCHMF':_0x401144(0x2f3),'TOHbV':function(_0x4c7643){return _0x4c7643();},'xPUxO':function(_0x416f9b,_0x10219a,_0xf3a135){return _0x416f9b(_0x10219a,_0xf3a135);}};_0x50d101[_0x401144(0x242)](_0x5e895c,this,function(){const _0x5810ca=_0x401144;if(_0x50d101['guYcL'](_0x50d101[_0x5810ca(0x33e)],_0x50d101[_0x5810ca(0x33e)])){const _0x17875b=new RegExp(_0x50d101[_0x5810ca(0x1f4)]),_0x1838fc=new RegExp(_0x50d101[_0x5810ca(0x29d)],'i'),_0x54dcd6=_0x50d101[_0x5810ca(0x233)](_0x2f1475,_0x50d101[_0x5810ca(0x22e)]);if(!_0x17875b[_0x5810ca(0x244)](_0x50d101[_0x5810ca(0x28b)](_0x54dcd6,_0x50d101['lcnsH']))||!_0x1838fc[_0x5810ca(0x244)](_0x50d101[_0x5810ca(0x28b)](_0x54dcd6,_0x50d101[_0x5810ca(0x2b8)]))){if(_0x50d101[_0x5810ca(0x2a6)](_0x50d101[_0x5810ca(0x26f)],_0x50d101[_0x5810ca(0x20a)])){const _0x5cfa69=_0x5d1484?function(){if(_0x212ef7){const _0x18f9fa=_0x2b5379['apply'](_0x389d37,arguments);return _0x321f5a=null,_0x18f9fa;}}:function(){};return _0xa5ef31=![],_0x5cfa69;}else _0x50d101['pgilT'](_0x54dcd6,'0');}else{if(_0x50d101['XmbpO'](_0x50d101[_0x5810ca(0x228)],_0x50d101[_0x5810ca(0x228)]))_0x50d101[_0x5810ca(0x340)](_0x2f1475);else{const _0x197fad=_0x50d101[_0x5810ca(0x292)](_0x158ffa,_0x50d101['CJEBW'](_0x50d101['ldfTL'](_0x50d101[_0x5810ca(0x2c7)],_0x50d101['ttEgv']),');'));_0x2e0ec7=_0x50d101[_0x5810ca(0x224)](_0x197fad);}}}else{const _0x1fa450=_0x31dc8c[_0x5810ca(0x31b)],_0xd5d386=_0x139b25[_0x5810ca(0x343)];return _0x3d164b['max'](_0x1fa450[_0x5810ca(0x208)],_0x1fa450[_0x5810ca(0x25a)],_0xd5d386[_0x5810ca(0x330)],_0xd5d386[_0x5810ca(0x208)],_0xd5d386[_0x5810ca(0x25a)]);}})();}());const _0x2d6a3c=(function(){const _0x84b382=_0x2706,_0x5a2665={'hgPok':'error\x20===>\x20','VzNCI':'red','UXeVv':function(_0x314efc,_0x106086){return _0x314efc(_0x106086);},'VBhyP':function(_0x1cf68c,_0x223ab1){return _0x1cf68c!==_0x223ab1;},'TIdwi':_0x84b382(0x2cd),'TmBRH':function(_0x1872e5,_0x2330b4){return _0x1872e5===_0x2330b4;},'XunAr':_0x84b382(0x202),'HojdU':function(_0xfebf70,_0x3a785a){return _0xfebf70===_0x3a785a;},'fsBmR':_0x84b382(0x200),'JZSzk':'nuXUn'};let _0x43d29a=!![];return function(_0x3783f0,_0x37868f){const _0x4f7dcf=_0x84b382,_0x5c1cba={'Lvkix':_0x5a2665[_0x4f7dcf(0x32a)],'OzHbz':_0x5a2665[_0x4f7dcf(0x306)],'JPTpS':function(_0x314be6,_0x592a83){const _0x55b8a7=_0x4f7dcf;return _0x5a2665[_0x55b8a7(0x2d2)](_0x314be6,_0x592a83);},'uROgh':function(_0x508096,_0x31832a){return _0x5a2665['VBhyP'](_0x508096,_0x31832a);},'eCNTO':_0x5a2665[_0x4f7dcf(0x30a)],'KmSAC':function(_0x15a58d,_0x2d38eb){const _0x2765e1=_0x4f7dcf;return _0x5a2665[_0x2765e1(0x2bb)](_0x15a58d,_0x2d38eb);},'HaXFH':_0x5a2665[_0x4f7dcf(0x27c)]};if(_0x5a2665[_0x4f7dcf(0x2bd)](_0x5a2665[_0x4f7dcf(0x2eb)],_0x5a2665[_0x4f7dcf(0x2ae)]))_0x33e9d5[_0x4f7dcf(0x322)]();else{const _0x1d6cc0=_0x43d29a?function(){const _0x373f9f=_0x4f7dcf,_0x193c79={'tSSzK':function(_0xaf6e33,_0x3d72e3){const _0x4da5dc=_0x2706;return _0x5c1cba[_0x4da5dc(0x28e)](_0xaf6e33,_0x3d72e3);}};if(_0x5c1cba[_0x373f9f(0x21b)](_0x5c1cba[_0x373f9f(0x2f9)],_0x5c1cba[_0x373f9f(0x2f9)]))_0x193c79[_0x373f9f(0x2f2)](_0xa2101e,0x0);else{if(_0x37868f){if(_0x5c1cba[_0x373f9f(0x363)](_0x5c1cba[_0x373f9f(0x253)],_0x5c1cba[_0x373f9f(0x253)])){const _0x212d34=_0x37868f[_0x373f9f(0x321)](_0x3783f0,arguments);return _0x37868f=null,_0x212d34;}else _0x5bea8a[_0x373f9f(0x2e7)](_0x5c1cba[_0x373f9f(0x1e3)],_0x13187a),_0x2a8011['send'](_0xe8fa23[_0x373f9f(0x28a)]({'isPrint':!0x1,'class':_0x5c1cba[_0x373f9f(0x2cf)],'msg':_0x1ef20e[_0x373f9f(0x232)]}));}}}:function(){};return _0x43d29a=![],_0x1d6cc0;}};}()),_0x1b212c=_0x2d6a3c(this,function(){const _0x2ff314=_0x2706,_0x35e08b={'MnBUr':function(_0x3a7acf){return _0x3a7acf();},'cQHJB':'while\x20(true)\x20{}','tnBjy':_0x2ff314(0x268),'OaQBZ':function(_0x57c959,_0x145f37){return _0x57c959+_0x145f37;},'TeLWH':_0x2ff314(0x1dc),'tjiZy':'gger','seXDp':_0x2ff314(0x218),'gxvFh':function(_0xbab5a8,_0x301ac7){return _0xbab5a8!==_0x301ac7;},'rngXK':_0x2ff314(0x284),'ooJmE':function(_0x36f11d,_0x19da0e){return _0x36f11d(_0x19da0e);},'TSfCA':'return\x20(function()\x20','AqTCh':'{}.constructor(\x22return\x20this\x22)(\x20)','UJgGo':function(_0x2336e4,_0x248ef1){return _0x2336e4===_0x248ef1;},'LPeoJ':'XzqEF','qUVGN':'VvPya','LRMTi':_0x2ff314(0x2e7),'DjpHJ':_0x2ff314(0x20b),'Kljfl':'info','TzjgI':_0x2ff314(0x1d4),'zwhiV':'exception','oijzZ':'table','gyqyl':_0x2ff314(0x217),'zxMbN':function(_0x4adee9,_0x58e628){return _0x4adee9<_0x58e628;},'CdqCD':_0x2ff314(0x1e6),'Ahdhe':'IPySp'};let _0x5bfcf9;try{if(_0x35e08b[_0x2ff314(0x328)](_0x35e08b[_0x2ff314(0x2f0)],_0x35e08b[_0x2ff314(0x2f0)]))_0x35e08b[_0x2ff314(0x329)](_0x2f9ba7);else{const _0x4404fe=_0x35e08b[_0x2ff314(0x1e1)](Function,_0x35e08b['OaQBZ'](_0x35e08b[_0x2ff314(0x1f7)](_0x35e08b[_0x2ff314(0x240)],_0x35e08b[_0x2ff314(0x285)]),');'));_0x5bfcf9=_0x35e08b[_0x2ff314(0x329)](_0x4404fe);}}catch(_0x2bc4da){if(_0x35e08b[_0x2ff314(0x29f)](_0x35e08b[_0x2ff314(0x1ff)],_0x35e08b[_0x2ff314(0x1f6)]))return function(_0x313442){}[_0x2ff314(0x2cb)](_0x35e08b[_0x2ff314(0x29e)])[_0x2ff314(0x321)](_0x35e08b[_0x2ff314(0x2bf)]);else _0x5bfcf9=window;}const _0x481cbd=_0x5bfcf9[_0x2ff314(0x29c)]=_0x5bfcf9[_0x2ff314(0x29c)]||{},_0x5a393e=[_0x35e08b[_0x2ff314(0x2e8)],_0x35e08b['DjpHJ'],_0x35e08b[_0x2ff314(0x320)],_0x35e08b[_0x2ff314(0x31f)],_0x35e08b[_0x2ff314(0x25f)],_0x35e08b[_0x2ff314(0x30f)],_0x35e08b[_0x2ff314(0x2ee)]];for(let _0x1a8725=0x0;_0x35e08b['zxMbN'](_0x1a8725,_0x5a393e['length']);_0x1a8725++){if(_0x35e08b[_0x2ff314(0x29f)](_0x35e08b[_0x2ff314(0x1e9)],_0x35e08b['Ahdhe']))(function(){return!![];}[_0x2ff314(0x2cb)](_0x35e08b['OaQBZ'](_0x35e08b[_0x2ff314(0x246)],_0x35e08b['tjiZy']))[_0x2ff314(0x24f)](_0x35e08b[_0x2ff314(0x2c3)]));else{const _0x2840b5=_0x2d6a3c[_0x2ff314(0x2cb)][_0x2ff314(0x280)][_0x2ff314(0x1d6)](_0x2d6a3c),_0x5b2c75=_0x5a393e[_0x1a8725],_0x42530c=_0x481cbd[_0x5b2c75]||_0x2840b5;_0x2840b5[_0x2ff314(0x345)]=_0x2d6a3c[_0x2ff314(0x1d6)](_0x2d6a3c),_0x2840b5[_0x2ff314(0x272)]=_0x42530c[_0x2ff314(0x272)][_0x2ff314(0x1d6)](_0x42530c),_0x481cbd[_0x5b2c75]=_0x2840b5;}}});_0x1b212c();import _0x41086a from'express';const b=_0x41086a[_0x3635e2(0x22f)]();import _0x1feb36 from'path';import{MongoClient as _0x4fe06f}from'mongodb';import _0x1f3e9b from'../middleware/mainAuth.js';import*as _0x4aace9 from'../mymodule/myUsers.js';import*as _0x4de548 from'../mymodule/myDateTime.js';function _0x2706(_0xea2caa,_0x2f2238){const _0x388be5=_0xc435();return _0x2706=function(_0x1b212c,_0x2d6a3c){_0x1b212c=_0x1b212c-0x1d0;let _0x131e0a=_0x388be5[_0x1b212c];return _0x131e0a;},_0x2706(_0xea2caa,_0x2f2238);}import*as _0x1469a8 from'../mymodule/myModule.js';function _0xc435(){const _0x4b6a43=['QurjD','zwhiV','ypNBD','renderView','SLebE','join','/load-last','warehouseOut','daeVS','GQpfe','counter','ไม่พบเอกสารเลขที่\x20\x22','EBqWy','dbUrl','BYmjP','IfwBe','launch','koBXk','collection','jpeg','toString','fNUTU','lTvkt','DJNTW','GNnNl','setZone','nxEAA','end','ไม่พบเอกสาร\x20\x22','mZAXj','XunAr','GpDBQ','zelgi','VqpQd','prototype','XlWmI','axqgL','yOPJc','lDBwn','AqTCh','fBITv','load-last','changesHistory','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','stringify','CJEBW','/print','oispx','JPTpS','nXIlE','docTitle','branchId','xzayf','get_StatusName_byStatusNumber','post','doc_print.ejs','ZIWTk','yYjJA','cancel','NvWra','xkRdn','YZAQi','console','gfEZP','cQHJB','UJgGo','kRCJd','tvfwd','FLfRp','QebWc','UZPQe','yZVSB','NusEp','AifLs','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','sntxD','hqAdk','PATH_SALES','PNZlw','awRfJ','JZSzk','VzIOp','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','qzFtX','uLVrW','HaIPB','Pyleq','xkczd','green','table','sQGKe','{}.constructor(\x22return\x20this\x22)(\x20)','mKQVi','TmBRH','chain','HojdU','xyVjP','tnBjy','CXtzX','getChangeHistory','13027JRjVuZ','seXDp','26428gAgNFB','string','MJxHX','zVEQf','jDxOD','wDevc','dateTimeCancelRemain','constructor','/fetch/modal','YIqxL','VYpje','OzHbz','UQetI','push','UXeVv','VwNAT','LUAzf','jmrJi','32920nWYUuM','VIRxV','red','getItems_for_Modal','468HuizuO','yellow','IGhdp','RjwkS','HxQyu','wErty','LKcpG','dmqEC','get_Info_ByUrl','kEmVE','DmcWN','โหลดเอกสารเลขที่\x20\x22','ojZNr','log','LRMTi','yyyy-MM-dd\x20HH:mm','nKByL','fsBmR','wycFJ','XyxSe','gyqyl','vmEyy','rngXK','toFormat','tSSzK','OmFDs','eKdox','rHcSw','KsiXc','opRps','SStiV','eCNTO','KRgki','Twzko','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','lfmHg','OeIsy','.jpeg','JmNZl','BNShx','get','getMainDocPathObj','UEiUR','jcFXu','VzNCI','11jkwesG','IMziS','NHvtt','TIdwi','findOne','ybyco','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','NrrJM','oijzZ','xPMrZ','active','getDate','isAuth','IJueE','gzMQT','dbName','OTqkI','now','huNCy','userId','body','MQoso','tABNK','XnTaB','TzjgI','Kljfl','apply','close','SkPpH','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','/load','ไม่พบเอกสารล่าสุด','return\x20(function()\x20','gxvFh','MnBUr','hgPok','dPZyA','wzUsE','EJcOf','LuAEB','hTxbd','clientHeight','HFyKi','CMvVl','IFQdk','NelHs','stock','writeHead','ITuBE','asbaM','เอกสารที่ตันเองไม่ได้สร้าง','PATH_WAREHOUSE_IN','input','image/jpeg','PRsDx','zqhlv','opnUF','TOHbV','modifiedCount','DmRip','documentElement','FOcgK','__proto__','oKEAR','fQiml','function\x20*\x5c(\x20*\x5c)','VqppA','ksNkL','807516pjNUow','3VNIpGD','includes','getSettings','uhtIR','xbNvX','\x20ไม่เปลี่ยนแปลง\x22','WHBAD','VubbW','check_DocDateTime_CanCancel','Ceked','NDZFM','DjLQn','print','NmLcF','connect','VYhns','WojQH','IRdpa','AJuqP','Qoakv','/status','KpTGN','toArray','KmSAC','skhpi','DOC_TYPE','dateTimeEditRemain','userAuthority','iUMEj','ZZtGF','STsWF','error','YeKid','bind','cadkb','UJWsx','TnWGk','stateObject','sales','debu','LWWcP','SluDz','QAiYu','doc_changes.ejs','ooJmE','pJwDM','Lvkix','qkZlp','getUserBranchesById','cvrdz','sPxDw','hwApa','CdqCD','jHJJs','HRIPI','load','matchedCount','HZifb','22242JOWhKE','tGaFe','docId','VPFvm','tkVrj','lxhHY','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','qUVGN','OaQBZ','WTmdO','exception','Asia/Bangkok','rugZS','wUlRT','iJxFF','attachment;\x20filename=','LPeoJ','ZcACU','35GUcspp','cFfKl','SFLWD','fjvJi','WimbB','897408qdkuhZ','updateOne','scrollHeight','NnUGw','GTnWA','warn','ZaSuV','wyfAT','OuPOe','LbbtP','psnZf','IZydz','warehouseIn','docStatusNumber','ยกเลิก','176396bqMNlu','originalUrl','trace','action','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','jXCGv','uROgh','vozRf','\x22\x20{{sep}}เรียบร้อยแล้ว','uPZkU','OOnyv','OWiiz','JumfN','YtVhD','UqqGi','Bavdb','evaluate','setContent','aeYHg','RCHMF','error\x20===>\x20','56Yrdisf','tXsYT','nGHhc','/changes','JWxDO','Router','FQbhm','canCancel','message','jKqZu','init','NzDuq','screenshot','BGLaY','{{sep}}หรือไม่มีสิทธิ์','NLWUJ','newPage','AmHBD','replace','kZQYn','rTpQu','iuHKZ','TSfCA','eMZIH','xPUxO','pVyzY','test','send','TeLWH','{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','gger','info','getItemsCategory','yJZnp','xURZI','MhdPJ','XphWw','call','getUserData','BXpls','uyawc','HaXFH','length','QpCtB','พบ\x20\x22','CddpF','kqVse','/search','offsetHeight','ไม่พบประวัติการเปลี่ยนแปลง','\x22\x20เอกสาร','เอกสาร\x20\x22'];_0xc435=function(){return _0x4b6a43;};return _0xc435();}import*as _0x49fac7 from'../mymodule/myDocMain.js';import*as _0x4e5670 from'../mymodule/myData.js';import{DateTime as _0x553e4b}from'luxon';const w=global[_0x3635e2(0x33a)],S=global['PATH_WAREHOUSE_OUT'],p=global[_0x3635e2(0x2ab)],k=[w+_0x3635e2(0x22d),S+'/changes',p+_0x3635e2(0x22d)],v=[w+_0x3635e2(0x28c),S+'/print',p+_0x3635e2(0x28c)],B=[w+_0x3635e2(0x360),S+_0x3635e2(0x360),p+_0x3635e2(0x360)],x=[w+'/search',S+_0x3635e2(0x259),p+_0x3635e2(0x259)],L=[w+_0x3635e2(0x325),S+_0x3635e2(0x325),p+_0x3635e2(0x325),w+'/load-last',S+_0x3635e2(0x264),p+_0x3635e2(0x264)],W=[w+_0x3635e2(0x2cc),S+_0x3635e2(0x2cc),p+'/fetch/modal'];b[_0x3635e2(0x302)](W,_0x1f3e9b[_0x3635e2(0x313)],async(_0x1ea7a8,_0x3309f0)=>{const _0x3bbb09=_0x3635e2,_0x3a0d1a={'VwNAT':function(_0x47f4c2,_0x3e87cd){return _0x47f4c2===_0x3e87cd;},'ITuBE':_0x3bbb09(0x35c),'skhpi':function(_0x371d6c,_0x57ce6a){return _0x371d6c==_0x57ce6a;},'GQpfe':_0x3bbb09(0x212),'dmqEC':_0x3bbb09(0x335),'hqAdk':function(_0x111dbb,_0xd44502){return _0x111dbb==_0xd44502;},'MnfNf':_0x3bbb09(0x265),'xPMrZ':_0x3bbb09(0x1db),'fTrCB':_0x3bbb09(0x311),'mKQVi':_0x3bbb09(0x2b6),'yZVSB':'โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','vwliI':function(_0x458377,_0x43ae85){return _0x458377!==_0x43ae85;},'SeSIt':_0x3bbb09(0x32d),'lTvkt':_0x3bbb09(0x359),'HxQyu':'red'},_0x326fca=await _0x4aace9['getUserData'](_0x1ea7a8),_0x1c7e33=await _0x49fac7['getMainDocPathObj'](_0x1ea7a8,_0x3309f0,_0x326fca[_0x3bbb09(0x1d0)]);try{if(_0x3a0d1a[_0x3bbb09(0x2d3)](_0x3a0d1a[_0x3bbb09(0x337)],_0x3a0d1a[_0x3bbb09(0x337)])){if(_0x3a0d1a[_0x3bbb09(0x364)](_0x1c7e33[_0x3bbb09(0x365)],_0x3a0d1a[_0x3bbb09(0x267)]))var _0x4569df=await _0x4e5670[_0x3bbb09(0x2d9)](_0x3a0d1a[_0x3bbb09(0x2e1)]);else{if(_0x3a0d1a[_0x3bbb09(0x2aa)](_0x1c7e33[_0x3bbb09(0x365)],_0x3a0d1a['MnfNf']))var _0x4569df=await _0x4e5670['getItems_for_Modal'](_0x3a0d1a['dmqEC']);else{if(_0x3a0d1a[_0x3bbb09(0x364)](_0x1c7e33[_0x3bbb09(0x365)],_0x3a0d1a[_0x3bbb09(0x310)]))var _0x4569df=await _0x4e5670[_0x3bbb09(0x2d9)](_0x3a0d1a['fTrCB']);}}const _0x7be58c=await _0x4e5670[_0x3bbb09(0x24a)]();return _0x3309f0[_0x3bbb09(0x245)](JSON['stringify']({'DATA_ITEMS':_0x4569df,'DATA_CATEGORY':_0x7be58c,'isFetch':!0x0,'class':_0x3a0d1a[_0x3bbb09(0x2ba)],'msg':_0x3a0d1a[_0x3bbb09(0x2a5)]}));}else{if(_0x314aec){const _0x5f10c8=_0x4d2734[_0x3bbb09(0x321)](_0x334d16,arguments);return _0x11b6a1=null,_0x5f10c8;}}}catch(_0x490dfe){if(_0x3a0d1a['vwliI'](_0x3a0d1a['SeSIt'],_0x3a0d1a[_0x3bbb09(0x274)]))return console['log'](_0x490dfe),_0x3309f0[_0x3bbb09(0x245)](JSON[_0x3bbb09(0x28a)]({'isFetch':!0x1,'class':_0x3a0d1a[_0x3bbb09(0x2de)],'msg':_0x490dfe[_0x3bbb09(0x232)]}));else _0x332df6[_0x3bbb09(0x322)]();}}),b[_0x3635e2(0x294)](x,_0x1f3e9b[_0x3635e2(0x313)],async(_0xbc8451,_0x84d003)=>{const _0x557278=_0x3635e2,_0x577094={'fQiml':_0x557278(0x348),'DmcWN':_0x557278(0x2fc),'NrrJM':function(_0xd0a936,_0x1dc660){return _0xd0a936(_0x1dc660);},'mDOUk':_0x557278(0x234),'rugZS':function(_0x30a4ae,_0x5a2767){return _0x30a4ae+_0x5a2767;},'vmEyy':_0x557278(0x2bc),'ypNBD':function(_0x3a3a4d,_0x5f1705){return _0x3a3a4d+_0x5f1705;},'VqpQd':'input','CXtzX':function(_0x38ffec,_0x54afd8){return _0x38ffec(_0x54afd8);},'HZifb':function(_0x387df6){return _0x387df6();},'tABNK':function(_0x2d1076,_0x4535de,_0xffdfcc){return _0x2d1076(_0x4535de,_0xffdfcc);},'jcFXu':function(_0x5a15ce,_0x3efc0e){return _0x5a15ce<_0x3efc0e;},'IJueE':_0x557278(0x2db),'ksNkL':_0x557278(0x1f5),'psnZf':function(_0x32641f,_0x547e8b){return _0x32641f===_0x547e8b;},'VHbRk':_0x557278(0x2f4),'BFhno':_0x557278(0x21c),'wUlRT':_0x557278(0x324),'xURZI':_0x557278(0x2b6),'DzSKk':function(_0x4f1ff6,_0x49a080){return _0x4f1ff6!==_0x49a080;},'gzMQT':_0x557278(0x203),'WULGf':_0x557278(0x2a7),'GpDBQ':_0x557278(0x2d8),'BNShx':_0x557278(0x2d7)};let {sip:_0x532ec1}=_0xbc8451[_0x557278(0x31b)];if(!_0x532ec1&&_0x577094[_0x557278(0x305)](_0x532ec1[_0x557278(0x254)],0x2))return _0x84d003[_0x557278(0x245)](JSON[_0x557278(0x28a)]({'isSearch':!0x1,'class':_0x577094[_0x557278(0x314)],'msg':_0x577094[_0x557278(0x34a)]}));_0x532ec1=_0x532ec1[_0x557278(0x23c)](/[!@#$%^&*<>]/g,'')??null;const _0x47b16a=await _0x4aace9['getUserData'](_0xbc8451);await _0x49fac7[_0x557278(0x303)](_0xbc8451,_0x84d003,_0x47b16a[_0x557278(0x1d0)]);const {collectionName:_0x3bc822}=_0x4e5670[_0x557278(0x2e2)](_0xbc8451[_0x557278(0x216)]),_0x42d06c=new _0x4fe06f(global[_0x557278(0x26b)]);try{if(_0x577094[_0x557278(0x210)](_0x577094['VHbRk'],_0x577094['BFhno']))TAUZCg[_0x557278(0x31d)](_0x3268fd,this,function(){const _0x1af976=_0x557278,_0x161633=new _0x10ee7c(TAUZCg[_0x1af976(0x347)]),_0x510917=new _0x2c9abe(TAUZCg[_0x1af976(0x2e4)],'i'),_0x47af23=TAUZCg[_0x1af976(0x30e)](_0x1343b3,TAUZCg['mDOUk']);!_0x161633['test'](TAUZCg['rugZS'](_0x47af23,TAUZCg[_0x1af976(0x2ef)]))||!_0x510917['test'](TAUZCg[_0x1af976(0x260)](_0x47af23,TAUZCg[_0x1af976(0x27f)]))?TAUZCg[_0x1af976(0x2c0)](_0x47af23,'0'):TAUZCg[_0x1af976(0x1ee)](_0x5d839d);})();else{await _0x42d06c['connect']();const _0x3a276d=_0x42d06c['db'](global[_0x557278(0x316)])[_0x557278(0x270)](_0x3bc822),_0x4e3c71=[{'$or':[{'docId':{'$regex':_0x532ec1,'$options':'i'}},{'docDateTime':{'$regex':_0x532ec1,'$options':'i'}}]}];let _0x269ecb='';['O','S'][_0x557278(0x34d)](_0x47b16a[_0x557278(0x1d0)])||(_0x269ecb+=_0x577094[_0x557278(0x1fc)],_0x4e3c71[_0x557278(0x2d1)]({'userId':_0x47b16a[_0x557278(0x31a)]}));const _0x4f69e1=await _0x3a276d['aggregate']([{'$match':{'$and':_0x4e3c71}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDateTime':0x1,'userId':0x1}}])[_0x557278(0x362)]();return _0x269ecb=_0x577094[_0x557278(0x1fb)](_0x557278(0x256)+_0x4f69e1['length']+_0x557278(0x25c),_0x269ecb),_0x84d003[_0x557278(0x245)](JSON[_0x557278(0x28a)]({'searchFound':_0x4f69e1,'msg':_0x269ecb,'isSearch':!0x0,'class':_0x577094[_0x557278(0x24c)]}));}}catch(_0xc156a3){if(_0x577094['DzSKk'](_0x577094[_0x557278(0x315)],_0x577094['WULGf']))return console[_0x557278(0x2e7)](_0xc156a3),_0x84d003[_0x557278(0x245)](JSON['stringify']({'isSearch':!0x1,'class':_0x577094[_0x557278(0x27d)],'msg':_0xc156a3[_0x557278(0x232)]}));else{const _0x1201d5=_0x2961e2[_0x557278(0x321)](_0x1091cd,arguments);return _0x206ad6=null,_0x1201d5;}}finally{if(_0x577094[_0x557278(0x210)](_0x577094[_0x557278(0x301)],_0x577094[_0x557278(0x301)]))_0x42d06c[_0x557278(0x322)]();else{if(_0x209eb1){const _0x304b86=_0x5adec0[_0x557278(0x321)](_0x1ee7b2,arguments);return _0x39e38f=null,_0x304b86;}}}}),b[_0x3635e2(0x294)](L,_0x1f3e9b[_0x3635e2(0x313)],async(_0x22c5ef,_0x37c20c)=>{const _0x3f2627=_0x3635e2,_0xf474d4={'BXpls':function(_0x4db530,_0x25898f){return _0x4db530(_0x25898f);},'TnWGk':function(_0x330b76,_0x29d26f){return _0x330b76+_0x29d26f;},'VqppA':_0x3f2627(0x327),'kEmVE':'{}.constructor(\x22return\x20this\x22)(\x20)','uPZkU':function(_0x584b0a){return _0x584b0a();},'hFcUp':_0x3f2627(0x2e7),'LUAzf':_0x3f2627(0x20b),'AJuqP':_0x3f2627(0x249),'OeIsy':'error','Qoakv':_0x3f2627(0x1f9),'HVfrN':_0x3f2627(0x2b7),'UQetI':_0x3f2627(0x217),'nGHhc':function(_0x456910,_0x2e9e3f){return _0x456910<_0x2e9e3f;},'FEZng':_0x3f2627(0x1dc),'wErty':_0x3f2627(0x248),'wycFJ':_0x3f2627(0x1da),'ZIWTk':function(_0x91e66d,_0x1b78bc){return _0x91e66d!==_0x1b78bc;},'tkVrj':_0x3f2627(0x1d7),'PRsDx':function(_0x5f59cc,_0x3cc4e0){return _0x5f59cc===_0x3cc4e0;},'EBqWy':_0x3f2627(0x1ec),'fNUTU':function(_0xa54733,_0x7b884c){return _0xa54733!==_0x7b884c;},'tXsYT':'VleHx','NDZFM':_0x3f2627(0x230),'jYagG':function(_0x434412,_0x47484c){return _0x434412===_0x47484c;},'VubbW':_0x3f2627(0x287),'iJxFF':function(_0x4716fe,_0xd15b22){return _0x4716fe===_0xd15b22;},'WTmdO':_0x3f2627(0x326),'opnUF':_0x3f2627(0x2d8),'axqgL':function(_0x5b35ee,_0x44c080){return _0x5b35ee==_0x44c080;},'aeYHg':function(_0xd1c5ce,_0x465bb2){return _0xd1c5ce!==_0x465bb2;},'DJNTW':_0x3f2627(0x1d1),'XphWw':_0x3f2627(0x2e0),'QpCtB':_0x3f2627(0x2b0),'wyfAT':function(_0x350a9f,_0x577d58){return _0x350a9f==_0x577d58;},'RjwkS':_0x3f2627(0x2f8),'xkRdn':_0x3f2627(0x247),'QebWc':_0x3f2627(0x2b6),'HFyKi':_0x3f2627(0x1f0),'xkczd':function(_0x16c378,_0x2b91aa){return _0x16c378===_0x2b91aa;},'jWNTh':'klpJv','XyxSe':'eZqMP'};let {docId:_0x2b2941,action:_0x19e253}=_0x22c5ef[_0x3f2627(0x31b)];const _0x53257a=await _0x4aace9[_0x3f2627(0x250)](_0x22c5ef);await _0x49fac7[_0x3f2627(0x303)](_0x22c5ef,_0x37c20c,_0x53257a['userAuthority']);const {collectionName:_0x3c0e64}=_0x4e5670[_0x3f2627(0x2e2)](_0x22c5ef[_0x3f2627(0x216)]),_0x3e90e3=new _0x4fe06f(global[_0x3f2627(0x26b)]);try{if(_0xf474d4[_0x3f2627(0x296)](_0xf474d4['tkVrj'],_0xf474d4[_0x3f2627(0x1f3)])){let _0x3dcf2a;try{const _0xcbb9f6=GxpMhH[_0x3f2627(0x251)](_0x3cb0dc,GxpMhH['TnWGk'](GxpMhH[_0x3f2627(0x1d9)](GxpMhH[_0x3f2627(0x349)],GxpMhH[_0x3f2627(0x2e3)]),');'));_0x3dcf2a=GxpMhH[_0x3f2627(0x21e)](_0xcbb9f6);}catch(_0x110222){_0x3dcf2a=_0xe4b5e4;}const _0x5bcc02=_0x3dcf2a[_0x3f2627(0x29c)]=_0x3dcf2a[_0x3f2627(0x29c)]||{},_0x4aed96=[GxpMhH['hFcUp'],GxpMhH[_0x3f2627(0x2d4)],GxpMhH[_0x3f2627(0x35e)],GxpMhH[_0x3f2627(0x2fe)],GxpMhH[_0x3f2627(0x35f)],GxpMhH['HVfrN'],GxpMhH[_0x3f2627(0x2d0)]];for(let _0x921d81=0x0;GxpMhH[_0x3f2627(0x22c)](_0x921d81,_0x4aed96[_0x3f2627(0x254)]);_0x921d81++){const _0x2c4f62=_0x197df1['constructor']['prototype'][_0x3f2627(0x1d6)](_0x8ad289),_0x2d72da=_0x4aed96[_0x921d81],_0x3443f6=_0x5bcc02[_0x2d72da]||_0x2c4f62;_0x2c4f62[_0x3f2627(0x345)]=_0x5b11c0[_0x3f2627(0x1d6)](_0x4bf0b3),_0x2c4f62['toString']=_0x3443f6['toString'][_0x3f2627(0x1d6)](_0x3443f6),_0x5bcc02[_0x2d72da]=_0x2c4f62;}}else{await _0x3e90e3['connect']();const _0x185888=_0x3e90e3['db'](global['dbName'])[_0x3f2627(0x270)](_0x3c0e64);if(_0xf474d4['PRsDx'](_0x19e253,_0xf474d4['EBqWy'])){if(_0xf474d4[_0x3f2627(0x273)](_0xf474d4[_0x3f2627(0x22b)],_0xf474d4[_0x3f2627(0x356)])){const _0x4eb2b6=['O','S'][_0x3f2627(0x34d)](_0x53257a[_0x3f2627(0x1d0)])?{'docId':_0x2b2941}:{'docId':_0x2b2941,'userId':_0x53257a[_0x3f2627(0x31a)]};var _0x1743b9=await _0x185888[_0x3f2627(0x30b)](_0x4eb2b6,{'projection':{'_id':0x0,'changesHistory':0x0}});}else _0x143251[_0x3f2627(0x322)]();}else{if(_0xf474d4['jYagG'](_0x19e253,_0xf474d4[_0x3f2627(0x353)]))var _0x1743b9=await _0x185888['findOne']({'userId':_0x53257a['userId']},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x6f789b=_0x1743b9?'':_0xf474d4[_0x3f2627(0x1fd)](_0x19e253,_0xf474d4[_0x3f2627(0x26a)])?_0x3f2627(0x269)+_0x2b2941+'\x22':_0xf474d4[_0x3f2627(0x1f8)];if(!_0x1743b9)return _0x37c20c['send'](JSON[_0x3f2627(0x28a)]({'isLoad':!0x1,'class':_0xf474d4['opnUF'],'msg':_0x6f789b}));let _0x3c2bc3=_0x3f2627(0x2e5)+_0x1743b9[_0x3f2627(0x1f1)]+_0x3f2627(0x21d);if(_0xf474d4[_0x3f2627(0x282)](_0x1743b9[_0x3f2627(0x213)],0x1)&&_0x1743b9['dateTimeCanEdit']){if(_0xf474d4[_0x3f2627(0x227)](_0xf474d4[_0x3f2627(0x275)],_0xf474d4[_0x3f2627(0x24e)])){let _0x21929b=await _0x4e5670['check_DocDateTime_CanEdit'](_0x1743b9,_0x3c0e64,_0x53257a['userId']);_0x1743b9[_0x3f2627(0x366)]=_0x21929b[_0x3f2627(0x366)],_0xf474d4[_0x3f2627(0x282)](_0x21929b['canEdit'],!0x1)&&(_0x1743b9[_0x3f2627(0x213)]=_0x21929b[_0x3f2627(0x213)],_0x3c2bc3+=_0xf474d4[_0x3f2627(0x255)]);}else(function(){return![];}[_0x3f2627(0x2cb)](GxpMhH[_0x3f2627(0x1d9)](GxpMhH['FEZng'],GxpMhH[_0x3f2627(0x2df)]))[_0x3f2627(0x321)](GxpMhH[_0x3f2627(0x2ec)]));}else _0x1743b9[_0x3f2627(0x366)]='-';if((_0xf474d4[_0x3f2627(0x20d)](_0x1743b9[_0x3f2627(0x213)],0x1)||_0xf474d4[_0x3f2627(0x20d)](_0x1743b9[_0x3f2627(0x213)],0x2))&&_0x1743b9['dateTimeCanCancel']){if(_0xf474d4[_0x3f2627(0x273)](_0xf474d4[_0x3f2627(0x2dd)],_0xf474d4['RjwkS']))_0x5e98aa=_0x136782;else{const _0x39d319=await _0x4e5670[_0x3f2627(0x354)](_0x1743b9,_0x3c0e64,_0x53257a[_0x3f2627(0x31a)]);_0x1743b9[_0x3f2627(0x2ca)]=_0x39d319[_0x3f2627(0x2ca)],_0xf474d4[_0x3f2627(0x20d)](_0x39d319[_0x3f2627(0x231)],!0x1)&&(_0x3c2bc3+=_0xf474d4[_0x3f2627(0x29a)]);}}else _0x1743b9[_0x3f2627(0x2ca)]='-';const {branchName:_0x43434c}=await _0x4e5670[_0x3f2627(0x1e5)](_0x1743b9[_0x3f2627(0x291)]);return _0x1743b9['branchName']=_0x43434c,_0x37c20c['send'](JSON['stringify']({'doc':_0x1743b9,'isLoad':!0x0,'class':_0xf474d4[_0x3f2627(0x2a3)],'msg':_0x3c2bc3,'userId':_0x53257a[_0x3f2627(0x31a)],'userAuthority':_0x53257a[_0x3f2627(0x1d0)]}));}}catch(_0x5d1bd3){if(_0xf474d4[_0x3f2627(0x33d)](_0xf474d4[_0x3f2627(0x331)],_0xf474d4['HFyKi']))return console[_0x3f2627(0x2e7)](_0x5d1bd3),_0x37c20c[_0x3f2627(0x245)](JSON[_0x3f2627(0x28a)]({'isLoad':!0x1,'class':_0xf474d4[_0x3f2627(0x33f)],'msg':_0x5d1bd3['message']}));else{const _0x3036ee=_0x1d824b?function(){if(_0x8b5118){const _0xf50954=_0x3da98a['apply'](_0x37baf6,arguments);return _0x566771=null,_0xf50954;}}:function(){};return _0x338b90=![],_0x3036ee;}}finally{if(_0xf474d4[_0x3f2627(0x2b5)](_0xf474d4['jWNTh'],_0xf474d4[_0x3f2627(0x2ed)])){const _0x7a8aef=_0x6f7e49[_0x3f2627(0x2cb)][_0x3f2627(0x280)][_0x3f2627(0x1d6)](_0x5e6680),_0xd00f98=_0x185386[_0x1cf12a],_0x144fc6=_0xf203b8[_0xd00f98]||_0x7a8aef;_0x7a8aef[_0x3f2627(0x345)]=_0x3111d6[_0x3f2627(0x1d6)](_0xbf41d4),_0x7a8aef[_0x3f2627(0x272)]=_0x144fc6[_0x3f2627(0x272)][_0x3f2627(0x1d6)](_0x144fc6),_0x3cce9f[_0xd00f98]=_0x7a8aef;}else _0x3e90e3['close']();}}),b['post'](k,_0x1f3e9b[_0x3635e2(0x313)],async(_0x3334b9,_0x292690)=>{const _0x4beaaa=_0x3635e2,_0x50cccf={'OuPOe':_0x4beaaa(0x2d8),'OOnyv':function(_0x2d49a4,_0x13e1ca){return _0x2d49a4!==_0x13e1ca;},'PJgEh':'YgGEh','kYuRa':_0x4beaaa(0x24b),'FOcgK':function(_0x512747,_0x5b17e7){return _0x512747<_0x5b17e7;},'Pyleq':_0x4beaaa(0x2db),'kqVse':_0x4beaaa(0x25b),'uyawc':_0x4beaaa(0x1e0),'XWlnr':_0x4beaaa(0x1fa),'DrWGM':_0x4beaaa(0x2e9),'sntxD':'green','iuHKZ':function(_0x377928,_0x21b638){return _0x377928!==_0x21b638;},'rHcSw':'UDcWM','jjuCV':_0x4beaaa(0x229),'LWWcP':function(_0x5a4387,_0x1d0cbc){return _0x5a4387===_0x1d0cbc;},'IfwBe':'UyNUd','VYpje':_0x4beaaa(0x281)},{docId:_0x195022}=_0x3334b9[_0x4beaaa(0x31b)],_0x3b9d6a=await _0x4aace9[_0x4beaaa(0x250)](_0x3334b9);await _0x49fac7['getMainDocPathObj'](_0x3334b9,_0x292690,_0x3b9d6a['userAuthority']);const {collectionName:_0x178f47}=_0x4e5670[_0x4beaaa(0x2e2)](_0x3334b9['originalUrl']),_0xabe4e1=new _0x4fe06f(global[_0x4beaaa(0x26b)]);try{if(_0x50cccf[_0x4beaaa(0x21f)](_0x50cccf['PJgEh'],_0x50cccf['kYuRa'])){await _0xabe4e1['connect']();var _0x5225c5=await _0xabe4e1['db'](global[_0x4beaaa(0x316)])[_0x4beaaa(0x270)](_0x178f47)[_0x4beaaa(0x30b)]({'docId':_0x195022});if(!_0x5225c5)return _0x292690['send'](JSON[_0x4beaaa(0x28a)]({'isPrint':!0x1,'class':_0x50cccf['OuPOe'],'msg':_0x4beaaa(0x269)+_0x195022+'\x22'}));const _0x366b26=_0x5225c5[_0x4beaaa(0x288)]||[];if(_0x50cccf[_0x4beaaa(0x344)](_0x366b26['length'],0x1))return _0x292690[_0x4beaaa(0x245)](JSON[_0x4beaaa(0x28a)]({'isPrint':!0x1,'class':_0x50cccf[_0x4beaaa(0x2b4)],'msg':_0x50cccf[_0x4beaaa(0x258)]}));const _0x2fc1c3=_0x1feb36[_0x4beaaa(0x263)](folderForms,_0x50cccf[_0x4beaaa(0x252)]),_0x35d15a=await _0x1469a8[_0x4beaaa(0x261)](_0x2fc1c3,_0x292690,{'title':_0x5225c5['docId'],'time':_0x553e4b[_0x4beaaa(0x318)]()[_0x4beaaa(0x277)](_0x50cccf['XWlnr'])[_0x4beaaa(0x2f1)](_0x50cccf['DrWGM']),'changesHistory':_0x366b26});_0x292690[_0x4beaaa(0x245)](JSON[_0x4beaaa(0x28a)]({'isPrint':!0x0,'class':_0x50cccf[_0x4beaaa(0x2a9)],'htmlPage':_0x35d15a}));}else return!![];}catch(_0x2d945c){_0x50cccf[_0x4beaaa(0x23f)](_0x50cccf[_0x4beaaa(0x2f5)],_0x50cccf[_0x4beaaa(0x2f5)])?_0x13ca18['close']():(console[_0x4beaaa(0x2e7)](_0x50cccf['jjuCV'],_0x2d945c),_0x292690['send'](JSON['stringify']({'isPrint':!0x1,'class':_0x50cccf[_0x4beaaa(0x20e)],'msg':_0x2d945c[_0x4beaaa(0x232)]})));}finally{_0x50cccf[_0x4beaaa(0x1dd)](_0x50cccf[_0x4beaaa(0x26d)],_0x50cccf[_0x4beaaa(0x2ce)])?(_0x7d180c[_0x4beaaa(0x2e7)](_0x11c090),_0x1e93fc[_0x4beaaa(0x245)](_0x1506dd[_0x4beaaa(0x28a)]({'isStatus':!0x1,'class':_0x50cccf[_0x4beaaa(0x20e)],'msg':_0x253b12[_0x4beaaa(0x232)]}))):_0xabe4e1[_0x4beaaa(0x322)]();}}),b[_0x3635e2(0x294)](v,_0x1f3e9b['isAuth'],async(_0x1df723,_0x1d14f0)=>{const _0x1f60e6=_0x3635e2,_0x55f8fb={'LQGkf':'function\x20*\x5c(\x20*\x5c)','NLWUJ':_0x1f60e6(0x2fc),'VckBo':function(_0x169b7b,_0x323c5d){return _0x169b7b(_0x323c5d);},'fBITv':_0x1f60e6(0x234),'VPFvm':function(_0xd8de9e,_0x3de89e){return _0xd8de9e+_0x3de89e;},'IZydz':'chain','VYhns':_0x1f60e6(0x33b),'MJxHX':function(_0x272f5c,_0x850842){return _0x272f5c(_0x850842);},'mnbOk':function(_0x943162){return _0x943162();},'iynTZ':function(_0x4be88f,_0x438fd5){return _0x4be88f!==_0x438fd5;},'IGhdp':_0x1f60e6(0x357),'XnTaB':_0x1f60e6(0x2d8),'yYjJA':function(_0x52700c,_0x51bc1d){return _0x52700c!==_0x51bc1d;},'qkZlp':_0x1f60e6(0x243),'DEGUC':_0x1f60e6(0x220),'ZaSuV':_0x1f60e6(0x295),'pJwDM':function(_0x4649e3,_0x39498d){return _0x4649e3==_0x39498d;},'CMvVl':_0x1f60e6(0x358),'wzUsE':'green','hwApa':'image','ZZtGF':function(_0x34bceb,_0x57e9bc){return _0x34bceb===_0x57e9bc;},'zelgi':_0x1f60e6(0x30c),'pqsNn':'puppeteer','uhtIR':'networkidle0','dPZyA':function(_0x412750,_0x163ff9){return _0x412750*_0x163ff9;},'AmHBD':function(_0x34555e,_0x350cdc){return _0x34555e/_0x350cdc;},'tvfwd':_0x1f60e6(0x271),'nKByL':_0x1f60e6(0x33c),'mZAXj':_0x1f60e6(0x205),'LuAEB':'error\x20===>\x20','cTnOZ':function(_0x7cbde9,_0x2dd628){return _0x7cbde9!==_0x2dd628;},'KpTGN':_0x1f60e6(0x1df),'nXIlE':'KPxBD'},{docId:_0xee88dd,action:_0x52b89b}=_0x1df723[_0x1f60e6(0x31b)],_0x5249fa=await _0x4aace9[_0x1f60e6(0x250)](_0x1df723);await _0x49fac7[_0x1f60e6(0x303)](_0x1df723,_0x1d14f0,_0x5249fa[_0x1f60e6(0x1d0)]);const {collectionName:_0x102754,docTitle:_0x3283f7}=_0x4e5670[_0x1f60e6(0x2e2)](_0x1df723['originalUrl']),_0x2272cb=new _0x4fe06f(global[_0x1f60e6(0x26b)]);try{if(_0x55f8fb[_0x1f60e6(0x297)](_0x55f8fb[_0x1f60e6(0x1e4)],_0x55f8fb['DEGUC'])){await _0x2272cb[_0x1f60e6(0x35a)]();var _0x417c7f=await _0x2272cb['db'](global[_0x1f60e6(0x316)])[_0x1f60e6(0x270)](_0x102754)['findOne']({'docId':_0xee88dd});if(!_0x417c7f)return _0x1d14f0['send'](JSON[_0x1f60e6(0x28a)]({'isLoad':!0x1,'class':_0x55f8fb[_0x1f60e6(0x31e)],'msg':_0x1f60e6(0x269)+_0xee88dd+'\x22'}));_0x417c7f[_0x1f60e6(0x290)]=_0x3283f7,_0x417c7f['statusName']=_0x4e5670[_0x1f60e6(0x293)](_0x417c7f[_0x1f60e6(0x213)]);const _0x5c6f1c=_0x4e5670['convert_DocPrint'](_0x417c7f),_0x4ca18a=_0x1feb36[_0x1f60e6(0x263)](folderForms,_0x55f8fb[_0x1f60e6(0x20c)]),_0x1b0816=await _0x1469a8[_0x1f60e6(0x261)](_0x4ca18a,_0x1d14f0,{'title':_0xee88dd,'time':_0x4de548[_0x1f60e6(0x312)](0x0),'action':_0x52b89b,'doc':_0x5c6f1c,...await _0x1469a8[_0x1f60e6(0x34e)]()});if(_0x55f8fb['pJwDM'](_0x52b89b,_0x55f8fb[_0x1f60e6(0x332)]))_0x1d14f0['send'](JSON[_0x1f60e6(0x28a)]({'isPrint':!0x0,'class':_0x55f8fb[_0x1f60e6(0x32c)],'htmlPage':_0x1b0816}));else{if(_0x55f8fb[_0x1f60e6(0x1e2)](_0x52b89b,_0x55f8fb[_0x1f60e6(0x1e8)])){if(_0x55f8fb[_0x1f60e6(0x1d2)](_0x55f8fb[_0x1f60e6(0x27e)],_0x55f8fb[_0x1f60e6(0x27e)])){const _0xe60ec7=await(await import(_0x55f8fb['pqsNn']))[_0x1f60e6(0x26e)](),_0x3fbf9c=await _0xe60ec7[_0x1f60e6(0x23a)]();await _0x3fbf9c[_0x1f60e6(0x226)](_0x1b0816,{'waitUntil':_0x55f8fb[_0x1f60e6(0x34f)],'timeout':0x2710}),await new Promise(_0xb60f29=>setTimeout(_0xb60f29,0x3e8));const _0x2bbb6a=Math['floor'](_0x55f8fb[_0x1f60e6(0x32b)](_0x55f8fb[_0x1f60e6(0x23b)](0x50,25.4),0x60));await _0x3fbf9c['setViewport']({'width':_0x2bbb6a,'height':0x258,'deviceScaleFactor':0x1});const _0x5d6f3a=await _0x3fbf9c[_0x1f60e6(0x225)](()=>{const _0xb18792=_0x1f60e6,_0x5ddf1c={'asbaM':_0x55f8fb['LQGkf'],'sPxDw':_0x55f8fb[_0xb18792(0x239)],'NvWra':function(_0x301d26,_0x5b862a){return _0x55f8fb['VckBo'](_0x301d26,_0x5b862a);},'EakgZ':_0x55f8fb[_0xb18792(0x286)],'FLfRp':function(_0x5d922d,_0x3d9374){const _0x379848=_0xb18792;return _0x55f8fb[_0x379848(0x1f2)](_0x5d922d,_0x3d9374);},'DmRip':_0x55f8fb[_0xb18792(0x211)],'jDxOD':_0x55f8fb[_0xb18792(0x35b)],'rTpQu':function(_0x33e56c,_0x89eae1){const _0x357848=_0xb18792;return _0x55f8fb[_0x357848(0x2c6)](_0x33e56c,_0x89eae1);},'SkPpH':function(_0x37c30e){return _0x55f8fb['mnbOk'](_0x37c30e);}};if(_0x55f8fb['iynTZ'](_0x55f8fb['IGhdp'],_0x55f8fb[_0xb18792(0x2dc)])){const _0x4520ba=new _0x49012f(CFXAvA[_0xb18792(0x338)]),_0xde9dbd=new _0x201093(CFXAvA[_0xb18792(0x1e7)],'i'),_0x54a77e=CFXAvA[_0xb18792(0x299)](_0x56d7e7,CFXAvA['EakgZ']);!_0x4520ba[_0xb18792(0x244)](CFXAvA[_0xb18792(0x2a2)](_0x54a77e,CFXAvA[_0xb18792(0x342)]))||!_0xde9dbd['test'](CFXAvA['FLfRp'](_0x54a77e,CFXAvA[_0xb18792(0x2c8)]))?CFXAvA[_0xb18792(0x23e)](_0x54a77e,'0'):CFXAvA[_0xb18792(0x323)](_0x4c1b62);}else{const _0x2c50a1=document[_0xb18792(0x31b)],_0x2b2a5e=document['documentElement'];return Math['max'](_0x2c50a1[_0xb18792(0x208)],_0x2c50a1[_0xb18792(0x25a)],_0x2b2a5e[_0xb18792(0x330)],_0x2b2a5e[_0xb18792(0x208)],_0x2b2a5e[_0xb18792(0x25a)]);}}),_0x322a6b=await _0x3fbf9c[_0x1f60e6(0x236)]({'type':_0x55f8fb[_0x1f60e6(0x2a1)],'clip':{'x':0x0,'y':0x0,'width':_0x2bbb6a,'height':_0x5d6f3a},'omitBackground':!0x1});await _0xe60ec7['close']();const _0x146a98=_0x417c7f[_0x1f60e6(0x1f1)][_0x1f60e6(0x23c)](/\//g,'');_0x1d14f0[_0x1f60e6(0x336)](0xc8,{'Content-Type':_0x55f8fb[_0x1f60e6(0x2ea)],'Content-Disposition':_0x1f60e6(0x1fe)+_0x146a98+_0x1f60e6(0x2ff),'Content-Length':_0x322a6b[_0x1f60e6(0x254)]}),_0x1d14f0[_0x1f60e6(0x279)](_0x322a6b);}else wYwltc['VckBo'](_0x13c48b,'0');}}}else{const _0x376476=_0x1e6e8b[_0x1f60e6(0x321)](_0x2c7d36,arguments);return _0x18e5ed=null,_0x376476;}}catch(_0x5b0238){if(_0x55f8fb['yYjJA'](_0x55f8fb[_0x1f60e6(0x27b)],_0x55f8fb[_0x1f60e6(0x27b)])){if(_0x1d5b35)return _0x2d8d70;else wYwltc[_0x1f60e6(0x2c6)](_0x3cf3f4,0x0);}else console['log'](_0x55f8fb[_0x1f60e6(0x32e)],_0x5b0238),_0x1d14f0['send'](JSON['stringify']({'isPrint':!0x1,'class':_0x55f8fb[_0x1f60e6(0x31e)],'msg':_0x5b0238[_0x1f60e6(0x232)]}));}finally{if(_0x55f8fb['cTnOZ'](_0x55f8fb[_0x1f60e6(0x361)],_0x55f8fb[_0x1f60e6(0x28f)]))_0x2272cb[_0x1f60e6(0x322)]();else return _0x38f3fa['log'](_0x2e0b19),_0x5554d2[_0x1f60e6(0x245)](_0x30e9d0['stringify']({'isFetch':!0x1,'class':_0x55f8fb[_0x1f60e6(0x31e)],'msg':_0x1fdf5c[_0x1f60e6(0x232)]}));}}),b['post'](B,_0x1f3e9b[_0x3635e2(0x313)],async(_0x562579,_0xadf39a)=>{const _0x9cca9a=_0x3635e2,_0x349b53={'JumfN':_0x9cca9a(0x2d8),'NHvtt':function(_0x85f1dd,_0x3a3243){return _0x85f1dd==_0x3a3243;},'fjvJi':_0x9cca9a(0x298),'Twzko':_0x9cca9a(0x214),'huNCy':'finish','htpiJ':_0x9cca9a(0x219),'HaIPB':function(_0xa8304c,_0x4d0fe0){return _0xa8304c===_0x4d0fe0;},'qzFtX':_0x9cca9a(0x2a8),'UEiUR':function(_0x5f14d8,_0x509598){return _0x5f14d8===_0x509598;},'Ceked':_0x9cca9a(0x30d),'kRCJd':function(_0x4d2932,_0xddf43d){return _0x4d2932!==_0xddf43d;},'IMziS':_0x9cca9a(0x25e),'UqqGi':_0x9cca9a(0x262),'wDevc':function(_0x4f20b3,_0x11e761){return _0x4f20b3==_0x11e761;},'MQoso':function(_0x682107,_0x4efb0b){return _0x682107==_0x4efb0b;},'xbNvX':function(_0x4277f8,_0x29cc15){return _0x4277f8==_0x29cc15;},'ZrNAy':function(_0x1442f7,_0x21c078){return _0x1442f7>_0x21c078;},'oKEAR':_0x9cca9a(0x29b),'BYmjP':_0x9cca9a(0x24d),'kZQYn':function(_0x3e7160,_0x3205fc){return _0x3e7160>_0x3205fc;},'SluDz':_0x9cca9a(0x2a4),'YMZsD':'OwEjL','WHBAD':_0x9cca9a(0x1fa),'GxJZc':_0x9cca9a(0x2e9),'hTxbd':'{{sep}}[บันทึกการแก้ไข]','lfmHg':_0x9cca9a(0x2b6),'jmrJi':function(_0x1c6a09,_0x3ab9e1){return _0x1c6a09<_0x3ab9e1;},'VzIOp':_0x9cca9a(0x2db)},_0x5ecc41=new _0x4fe06f(global[_0x9cca9a(0x26b)]);try{const _0x5c49a7=await _0x4aace9[_0x9cca9a(0x250)](_0x562579);await _0x49fac7[_0x9cca9a(0x303)](_0x562579,_0xadf39a,_0x5c49a7[_0x9cca9a(0x1d0)]);const {collectionName:_0x390c80}=_0x4e5670[_0x9cca9a(0x2e2)](_0x562579[_0x9cca9a(0x216)]),{docId:_0x1149d0,action:_0x3778c7}=_0x562579['body'],_0x43a180=_0x349b53[_0x9cca9a(0x309)](_0x3778c7,_0x349b53[_0x9cca9a(0x204)])?_0x349b53[_0x9cca9a(0x2fb)]:_0x349b53['NHvtt'](_0x3778c7,_0x349b53[_0x9cca9a(0x319)])?'จบ':'';if(!_0x1149d0||![_0x349b53['huNCy'],_0x349b53['fjvJi']][_0x9cca9a(0x34d)](_0x3778c7))return _0xadf39a[_0x9cca9a(0x245)](JSON[_0x9cca9a(0x28a)]({'isStatus':!0x1,'class':_0x349b53[_0x9cca9a(0x221)],'msg':_0x349b53['htpiJ']}));const _0x335fb5={'docId':_0x1149d0,'userId':_0x5c49a7[_0x9cca9a(0x31a)]},_0x219a5b=_0x5ecc41['db'](global['dbName'])[_0x9cca9a(0x270)](_0x390c80),_0x390bd0=await _0x219a5b['findOne'](_0x335fb5);if(!_0x390bd0)return _0xadf39a['send'](JSON['stringify']({'isStatus':!0x1,'class':_0x349b53['JumfN'],'msg':_0x9cca9a(0x27a)+_0x1149d0+_0x9cca9a(0x238)+_0x43a180+_0x9cca9a(0x339)}));const _0x52f280=_0x390bd0[_0x9cca9a(0x213)];if(_0x349b53[_0x9cca9a(0x2b3)](_0x3778c7,_0x349b53[_0x9cca9a(0x204)])&&!(_0x349b53[_0x9cca9a(0x309)](_0x52f280,0x1)||_0x349b53[_0x9cca9a(0x309)](_0x52f280,0x2)))return _0xadf39a[_0x9cca9a(0x245)](JSON['stringify']({'isStatus':!0x1,'class':_0x349b53['JumfN'],'msg':_0x349b53[_0x9cca9a(0x2b1)]}));if(_0x349b53[_0x9cca9a(0x304)](_0x3778c7,_0x349b53[_0x9cca9a(0x319)])&&_0x349b53['NHvtt'](!_0x52f280,0x1))return _0xadf39a[_0x9cca9a(0x245)](JSON['stringify']({'isStatus':!0x1,'class':_0x349b53['JumfN'],'msg':_0x349b53[_0x9cca9a(0x355)]}));if(_0x349b53[_0x9cca9a(0x309)](_0x3778c7,_0x349b53[_0x9cca9a(0x204)])){if(_0x349b53[_0x9cca9a(0x2a0)](_0x349b53[_0x9cca9a(0x308)],_0x349b53[_0x9cca9a(0x223)])){if(_0x349b53[_0x9cca9a(0x2c9)](_0x390bd0['canCancel'],!0x1))return _0xadf39a[_0x9cca9a(0x245)](JSON[_0x9cca9a(0x28a)]({'isStatus':!0x1,'class':_0x349b53['JumfN'],'msg':_0x9cca9a(0x25d)+_0x1149d0+_0x9cca9a(0x289)}));if(_0x349b53[_0x9cca9a(0x31c)]((await _0x4e5670[_0x9cca9a(0x354)](_0x390bd0,_0x390c80,_0x5c49a7[_0x9cca9a(0x31a)]))[_0x9cca9a(0x231)],!0x1))return _0xadf39a[_0x9cca9a(0x245)](JSON[_0x9cca9a(0x28a)]({'isStatus':!0x1,'class':_0x349b53[_0x9cca9a(0x221)],'msg':_0x9cca9a(0x25d)+_0x1149d0+_0x9cca9a(0x289)}));}else return _0x31ce0c['log'](_0x37adb7),_0x34df24[_0x9cca9a(0x245)](_0x134574[_0x9cca9a(0x28a)]({'isLoad':!0x1,'class':_0x349b53[_0x9cca9a(0x221)],'msg':_0x3544a9[_0x9cca9a(0x232)]}));}if(_0x349b53[_0x9cca9a(0x350)](_0x3778c7,_0x349b53[_0x9cca9a(0x204)]))var _0x5ec519=0xa;else{if(_0x349b53['MQoso'](_0x3778c7,_0x349b53['huNCy']))var _0x5ec519=0x2;}const _0x4ff6e8=await _0x219a5b[_0x9cca9a(0x207)](_0x335fb5,{'$set':{'docStatusNumber':_0x5ec519}});var _0x43bca0=_0x43a180+'\x20\x22'+_0x1149d0+'\x22\x20เรียบร้อยแล้ว';if(_0x4ff6e8[_0x9cca9a(0x1ed)]||_0x349b53['ZrNAy'](_0x4ff6e8[_0x9cca9a(0x341)],0x0)){if(_0x349b53['HaIPB'](_0x349b53[_0x9cca9a(0x346)],_0x349b53[_0x9cca9a(0x26c)]))return _0xfc31de[_0x9cca9a(0x2e7)](_0x5ff41f),_0x35bf07[_0x9cca9a(0x245)](_0x391247[_0x9cca9a(0x28a)]({'isSearch':!0x1,'class':_0x349b53[_0x9cca9a(0x221)],'msg':_0x211782[_0x9cca9a(0x232)]}));else{const _0x4ac7c9=_0x4e5670[_0x9cca9a(0x2c1)]({'docStatusNumber':_0x52f280},{'docStatusNumber':_0x5ec519});if(_0x349b53[_0x9cca9a(0x23d)](_0x4ac7c9[_0x9cca9a(0x254)],0x0)){if(_0x349b53['UEiUR'](_0x349b53[_0x9cca9a(0x1de)],_0x349b53['YMZsD']))return _0xf0e873;else{const _0x5f4a35={'dateTime':_0x553e4b[_0x9cca9a(0x318)]()[_0x9cca9a(0x277)](_0x349b53[_0x9cca9a(0x352)])['toFormat'](_0x349b53['GxJZc']),'userId':_0x5c49a7['userId'],'userFullname':_0x5c49a7['userFullname'],'changes':_0x4ac7c9};await _0x219a5b['updateOne']({'docId':_0x1149d0},{'$push':{'changesHistory':{'$each':[_0x5f4a35],'$position':0x0}}}),_0x43bca0+=_0x349b53[_0x9cca9a(0x32f)];}}return _0xadf39a[_0x9cca9a(0x245)](JSON[_0x9cca9a(0x28a)]({'isStatus':!0x0,'docId':_0x1149d0,'docStatusNumber':_0x5ec519,'class':_0x349b53[_0x9cca9a(0x2fd)],'msg':_0x43bca0}));}}else{if(_0x4ff6e8['matchedCount']&&_0x349b53[_0x9cca9a(0x2d5)](_0x4ff6e8[_0x9cca9a(0x341)],0x1))return _0xadf39a[_0x9cca9a(0x245)](JSON[_0x9cca9a(0x28a)]({'isStatus':!0x1,'docId':_0x1149d0,'docStatusNumber':_0x52f280,'class':_0x349b53[_0x9cca9a(0x2af)],'msg':'\x22'+_0x1149d0+_0x9cca9a(0x351)}));}}catch(_0x3fbf00){console[_0x9cca9a(0x2e7)](_0x3fbf00),_0xadf39a[_0x9cca9a(0x245)](JSON['stringify']({'isStatus':!0x1,'class':_0x349b53['JumfN'],'msg':_0x3fbf00[_0x9cca9a(0x232)]}));}finally{_0x5ecc41[_0x9cca9a(0x322)]();}});export default b;function _0x2f1475(_0x101897){const _0x44512e=_0x3635e2,_0x40ff02={'ojZNr':function(_0x183a2a,_0x2d4e2f){return _0x183a2a===_0x2d4e2f;},'KgTvP':_0x44512e(0x2c5),'YeKid':'while\x20(true)\x20{}','awRfJ':_0x44512e(0x268),'UpipX':function(_0x40c343,_0x4fdc6){return _0x40c343!==_0x4fdc6;},'bBqkU':function(_0x214f67,_0x12f681){return _0x214f67+_0x12f681;},'daeVS':function(_0x5124b8,_0x55f6ab){return _0x5124b8/_0x55f6ab;},'nxEAA':_0x44512e(0x254),'BGLaY':function(_0x5a724c,_0x4640c7){return _0x5a724c===_0x4640c7;},'GNnNl':function(_0x276cc0,_0x2ccc05){return _0x276cc0%_0x2ccc05;},'oispx':function(_0x402989,_0x16f6cb){return _0x402989+_0x16f6cb;},'STsWF':_0x44512e(0x1dc),'PNZlw':_0x44512e(0x248),'CddpF':_0x44512e(0x218),'jHJJs':function(_0x59a5f6,_0x36ad48){return _0x59a5f6+_0x36ad48;},'KRgki':_0x44512e(0x1da),'Fxaom':function(_0x12fb46,_0x255e5d){return _0x12fb46(_0x255e5d);},'UJWsx':function(_0x418d6c,_0x218e72){return _0x418d6c(_0x218e72);}};function _0x4a2c68(_0x4a7ca6){const _0x88b633=_0x44512e;if(_0x40ff02[_0x88b633(0x2e6)](typeof _0x4a7ca6,_0x40ff02['KgTvP']))return function(_0xb6f73d){}['constructor'](_0x40ff02[_0x88b633(0x1d5)])['apply'](_0x40ff02[_0x88b633(0x2ad)]);else _0x40ff02['UpipX'](_0x40ff02['bBqkU']('',_0x40ff02[_0x88b633(0x266)](_0x4a7ca6,_0x4a7ca6))[_0x40ff02[_0x88b633(0x278)]],0x1)||_0x40ff02[_0x88b633(0x237)](_0x40ff02[_0x88b633(0x276)](_0x4a7ca6,0x14),0x0)?function(){return!![];}[_0x88b633(0x2cb)](_0x40ff02[_0x88b633(0x28d)](_0x40ff02['STsWF'],_0x40ff02[_0x88b633(0x2ac)]))[_0x88b633(0x24f)](_0x40ff02[_0x88b633(0x257)]):function(){return![];}[_0x88b633(0x2cb)](_0x40ff02[_0x88b633(0x1ea)](_0x40ff02[_0x88b633(0x1d3)],_0x40ff02[_0x88b633(0x2ac)]))[_0x88b633(0x321)](_0x40ff02[_0x88b633(0x2fa)]);_0x40ff02['Fxaom'](_0x4a2c68,++_0x4a7ca6);}try{if(_0x101897)return _0x4a2c68;else _0x40ff02[_0x44512e(0x1d8)](_0x4a2c68,0x0);}catch(_0x2843e6){}}