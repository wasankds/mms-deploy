const _0x8c75f8=_0x1a0c;(function(_0x2e4a91,_0x12337f){const _0x37cbb8=_0x1a0c,_0x14ecd6=_0x2e4a91();while(!![]){try{const _0x553c8e=parseInt(_0x37cbb8(0x1be))/0x1*(parseInt(_0x37cbb8(0x1e3))/0x2)+-parseInt(_0x37cbb8(0x126))/0x3+parseInt(_0x37cbb8(0x197))/0x4*(parseInt(_0x37cbb8(0xe9))/0x5)+parseInt(_0x37cbb8(0x24b))/0x6+-parseInt(_0x37cbb8(0x114))/0x7*(parseInt(_0x37cbb8(0x11b))/0x8)+parseInt(_0x37cbb8(0x233))/0x9+-parseInt(_0x37cbb8(0x18f))/0xa;if(_0x553c8e===_0x12337f)break;else _0x14ecd6['push'](_0x14ecd6['shift']());}catch(_0x28765b){_0x14ecd6['push'](_0x14ecd6['shift']());}}}(_0x8fa6,0x7c2dc));const _0x2a568a=(function(){const _0x36eb16=_0x1a0c,_0x498473={'yWUBp':function(_0x5db697,_0x31fc96){return _0x5db697(_0x31fc96);},'vhccK':function(_0x5bd013,_0x26f025){return _0x5bd013===_0x26f025;},'MkkJT':_0x36eb16(0x195),'SYVhL':_0x36eb16(0x14d),'rRWbW':_0x36eb16(0x1a8),'IQipM':_0x36eb16(0x21c),'VGGGt':_0x36eb16(0x19f),'SUTWt':_0x36eb16(0xbe)};let _0x288c1d=!![];return function(_0x12fb16,_0x2239d5){const _0x2f5b33=_0x36eb16,_0x494399={'krMLa':function(_0xf75a5c,_0x5cac0e){const _0x2b7f73=_0x1a0c;return _0x498473[_0x2b7f73(0x1bf)](_0xf75a5c,_0x5cac0e);},'KcUHL':_0x498473['MkkJT'],'RVKuO':_0x498473['SYVhL'],'OfoeS':_0x498473['rRWbW'],'gkJiJ':_0x498473[_0x2f5b33(0x13f)]};if(_0x498473[_0x2f5b33(0x1bf)](_0x498473[_0x2f5b33(0x180)],_0x498473['SUTWt']))_0x498473['yWUBp'](_0x380fe9,'0');else{const _0xb97407=_0x288c1d?function(){const _0x569ab4=_0x2f5b33;if(_0x494399[_0x569ab4(0xf4)](_0x494399[_0x569ab4(0x12f)],_0x494399[_0x569ab4(0x156)]))return!![];else{if(_0x2239d5){if(_0x494399[_0x569ab4(0xf4)](_0x494399[_0x569ab4(0xeb)],_0x494399[_0x569ab4(0x17b)]))_0x240c35=_0x248b04;else{const _0x205196=_0x2239d5['apply'](_0x12fb16,arguments);return _0x2239d5=null,_0x205196;}}}}:function(){};return _0x288c1d=![],_0xb97407;}};}());(function(){const _0x44dbb6=_0x1a0c,_0x7914d9={'vjPCr':function(_0x4bddb1,_0xe93ae6){return _0x4bddb1+_0xe93ae6;},'hxDmU':'debu','ljVBN':_0x44dbb6(0x202),'LdFrA':_0x44dbb6(0x133),'UUQlk':function(_0x3132f1,_0x34dd6){return _0x3132f1!==_0x34dd6;},'uLBaL':_0x44dbb6(0x1b4),'gBNWx':_0x44dbb6(0x122),'iaFos':_0x44dbb6(0xfc),'CAYfn':function(_0x11896f,_0x4e8fc6){return _0x11896f(_0x4e8fc6);},'JlCaM':_0x44dbb6(0x12c),'dKABP':function(_0x23af31,_0x123991){return _0x23af31+_0x123991;},'Yytyp':'chain','VlGlk':function(_0x23f8d5,_0x499bc0){return _0x23f8d5+_0x499bc0;},'NZylK':'input','ybYGk':function(_0x1406c6,_0x561860){return _0x1406c6!==_0x561860;},'STUDQ':_0x44dbb6(0x179),'HjSiB':_0x44dbb6(0x107),'PDNVu':function(_0x499a65,_0x34f9be){return _0x499a65!==_0x34f9be;},'qhGfL':_0x44dbb6(0x23d),'ziaus':_0x44dbb6(0x153),'dCfWE':function(_0x31c92d){return _0x31c92d();},'GEHDK':function(_0x44c520,_0x394244,_0xf5cc2d){return _0x44c520(_0x394244,_0xf5cc2d);}};_0x7914d9[_0x44dbb6(0x168)](_0x2a568a,this,function(){const _0x1bd011=_0x44dbb6;if(_0x7914d9[_0x1bd011(0x14b)](_0x7914d9[_0x1bd011(0x139)],_0x7914d9[_0x1bd011(0x139)]))(function(){return!![];}[_0x1bd011(0x194)](_0x7914d9['vjPCr'](_0x7914d9[_0x1bd011(0x1d7)],_0x7914d9['ljVBN']))[_0x1bd011(0x116)](_0x7914d9[_0x1bd011(0x1af)]));else{const _0x2fece4=new RegExp(_0x7914d9[_0x1bd011(0xf7)]),_0xe7779f=new RegExp(_0x7914d9['iaFos'],'i'),_0x256186=_0x7914d9[_0x1bd011(0xd8)](_0x5495bb,_0x7914d9[_0x1bd011(0x215)]);if(!_0x2fece4[_0x1bd011(0xfa)](_0x7914d9['dKABP'](_0x256186,_0x7914d9[_0x1bd011(0x210)]))||!_0xe7779f[_0x1bd011(0xfa)](_0x7914d9[_0x1bd011(0x13d)](_0x256186,_0x7914d9['NZylK']))){if(_0x7914d9[_0x1bd011(0x237)](_0x7914d9[_0x1bd011(0xdc)],_0x7914d9[_0x1bd011(0x1df)]))_0x7914d9[_0x1bd011(0xd8)](_0x256186,'0');else{const _0x375d1a=_0x1033af['apply'](_0x59d149,arguments);return _0x202cdf=null,_0x375d1a;}}else{if(_0x7914d9['PDNVu'](_0x7914d9['qhGfL'],_0x7914d9[_0x1bd011(0x1e0)]))_0x7914d9[_0x1bd011(0xe8)](_0x5495bb);else{const _0x116b06=_0x397677[_0x1bd011(0x171)],_0x47197b=_0x1e8700[_0x1bd011(0x1a9)];return _0x12a793[_0x1bd011(0x130)](_0x116b06[_0x1bd011(0x209)],_0x116b06[_0x1bd011(0xe4)],_0x47197b[_0x1bd011(0x1ec)],_0x47197b[_0x1bd011(0x209)],_0x47197b['offsetHeight']);}}}})();}());const _0x403405=(function(){const _0x38089a=_0x1a0c,_0xfd6240={'LXCyh':'while\x20(true)\x20{}','AlCxH':_0x38089a(0xf8),'sSASJ':'red','bSirI':function(_0x8a42e6,_0x27562f){return _0x8a42e6!==_0x27562f;},'kwbtn':_0x38089a(0x1ad),'RFPDV':_0x38089a(0x186),'BhThH':_0x38089a(0x110),'RXWQC':function(_0x662024,_0x50a10d){return _0x662024===_0x50a10d;},'UWbsT':_0x38089a(0x182),'xqohj':_0x38089a(0x13c)};let _0x371ca4=!![];return function(_0x25e31f,_0x4dfe39){const _0x1dc442=_0x38089a,_0x58cc72={'mgojC':_0xfd6240[_0x1dc442(0x193)],'YpBzh':_0xfd6240['AlCxH'],'cdBYI':_0xfd6240[_0x1dc442(0x189)],'pKLgk':function(_0x38d372,_0x24ccee){const _0x1e3ecf=_0x1dc442;return _0xfd6240[_0x1e3ecf(0x19e)](_0x38d372,_0x24ccee);},'QcUzy':_0xfd6240[_0x1dc442(0x1de)],'IBFPa':_0xfd6240['RFPDV'],'rjBrf':_0xfd6240[_0x1dc442(0x1e6)]};if(_0xfd6240[_0x1dc442(0x1e8)](_0xfd6240[_0x1dc442(0x151)],_0xfd6240[_0x1dc442(0x150)])){const _0x3ae8a7=_0x486783?function(){const _0x33cc71=_0x1dc442;if(_0x55077f){const _0x5a5df2=_0x4f9758[_0x33cc71(0xec)](_0x44ed9e,arguments);return _0x51c561=null,_0x5a5df2;}}:function(){};return _0x4d6441=![],_0x3ae8a7;}else{const _0x54256c=_0x371ca4?function(){const _0x1eaa03=_0x1dc442;if(_0x58cc72[_0x1eaa03(0xde)](_0x58cc72[_0x1eaa03(0x1bc)],_0x58cc72[_0x1eaa03(0x1bc)]))return function(_0x5d437b){}[_0x1eaa03(0x194)](_0x58cc72[_0x1eaa03(0xcd)])[_0x1eaa03(0xec)](_0x58cc72[_0x1eaa03(0x1cb)]);else{if(_0x4dfe39){if(_0x58cc72[_0x1eaa03(0xde)](_0x58cc72[_0x1eaa03(0xc3)],_0x58cc72['rjBrf'])){const _0x2157e9=_0x4dfe39[_0x1eaa03(0xec)](_0x25e31f,arguments);return _0x4dfe39=null,_0x2157e9;}else return _0x5c60e4[_0x1eaa03(0x120)](_0xfcfbbb),_0x44ed18[_0x1eaa03(0x242)](_0x55be4c['stringify']({'isLoad':!0x1,'class':_0x58cc72[_0x1eaa03(0x239)],'msg':_0x256af5[_0x1eaa03(0xfb)]}));}}}:function(){};return _0x371ca4=![],_0x54256c;}};}()),_0x13d41a=_0x403405(this,function(){const _0x47c84d=_0x1a0c,_0x42507e={'cvbLU':_0x47c84d(0xd4),'eNeAF':'function\x20*\x5c(\x20*\x5c)','SPtyh':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','klhKz':function(_0x1e469e,_0x50cf5a){return _0x1e469e(_0x50cf5a);},'bljaw':_0x47c84d(0x12c),'mnlLf':function(_0x2120f5,_0x54abc9){return _0x2120f5+_0x54abc9;},'oyfwD':_0x47c84d(0x20e),'YDlWE':'input','JUbjY':function(_0x53eb2f,_0x49e8d3){return _0x53eb2f(_0x49e8d3);},'reMOi':function(_0x42f080){return _0x42f080();},'SGQHG':function(_0x2a1f12,_0x61ae36){return _0x2a1f12!==_0x61ae36;},'XvoJY':_0x47c84d(0x1c0),'ZGcHt':_0x47c84d(0x1b8),'pXxKo':function(_0x2fefa4,_0x24f315){return _0x2fefa4(_0x24f315);},'jCYwC':function(_0x27cf0c,_0x3e46af){return _0x27cf0c+_0x3e46af;},'EbDzd':function(_0x3bfd7a,_0x4bc5f0){return _0x3bfd7a+_0x4bc5f0;},'YomVh':_0x47c84d(0x12b),'rtMTn':'{}.constructor(\x22return\x20this\x22)(\x20)','THXWg':function(_0x1ebccc){return _0x1ebccc();},'ZJKbX':function(_0x71ad16,_0x50aff3){return _0x71ad16===_0x50aff3;},'SXqjR':_0x47c84d(0x129),'SwlQs':_0x47c84d(0x120),'nxbnY':'warn','KBnwb':_0x47c84d(0x19d),'fGTEm':'error','nYYaD':_0x47c84d(0x223),'iByyX':_0x47c84d(0x1b1),'iHzTQ':'trace','Bnyrg':function(_0x533be5,_0x4d46a1){return _0x533be5<_0x4d46a1;},'beMdz':_0x47c84d(0x1ef),'YIvRE':_0x47c84d(0x108)};let _0x4488aa;try{if(_0x42507e['SGQHG'](_0x42507e[_0x47c84d(0x22b)],_0x42507e[_0x47c84d(0x1d1)])){const _0x12e4f3=_0x42507e[_0x47c84d(0x157)](Function,_0x42507e[_0x47c84d(0x1e7)](_0x42507e[_0x47c84d(0xcb)](_0x42507e['YomVh'],_0x42507e[_0x47c84d(0x14e)]),');'));_0x4488aa=_0x42507e[_0x47c84d(0x190)](_0x12e4f3);}else return _0x24f540[_0x47c84d(0x120)](_0x5088e1),_0x2a3b8a['send'](_0x148eb8[_0x47c84d(0x159)]({'isFetch':!0x1,'class':_0x42507e[_0x47c84d(0x20b)],'msg':_0x43ca33[_0x47c84d(0xfb)]}));}catch(_0xe71532){if(_0x42507e['ZJKbX'](_0x42507e['SXqjR'],_0x42507e[_0x47c84d(0x243)]))_0x4488aa=window;else return![];}const _0x498775=_0x4488aa[_0x47c84d(0xc4)]=_0x4488aa[_0x47c84d(0xc4)]||{},_0xf11a58=[_0x42507e[_0x47c84d(0xc0)],_0x42507e[_0x47c84d(0x240)],_0x42507e['KBnwb'],_0x42507e[_0x47c84d(0x249)],_0x42507e[_0x47c84d(0x15d)],_0x42507e[_0x47c84d(0x219)],_0x42507e[_0x47c84d(0xe5)]];for(let _0x1bb827=0x0;_0x42507e[_0x47c84d(0x229)](_0x1bb827,_0xf11a58[_0x47c84d(0x172)]);_0x1bb827++){if(_0x42507e[_0x47c84d(0x183)](_0x42507e[_0x47c84d(0x1f5)],_0x42507e[_0x47c84d(0xc2)])){const _0x377807=_0x403405[_0x47c84d(0x194)][_0x47c84d(0xc6)]['bind'](_0x403405),_0x148d3c=_0xf11a58[_0x1bb827],_0x313242=_0x498775[_0x148d3c]||_0x377807;_0x377807[_0x47c84d(0x175)]=_0x403405[_0x47c84d(0xed)](_0x403405),_0x377807['toString']=_0x313242['toString'][_0x47c84d(0xed)](_0x313242),_0x498775[_0x148d3c]=_0x377807;}else{const _0x1196b0=new _0x3b5948(_0x42507e[_0x47c84d(0x113)]),_0x46a5af=new _0x27d76c(_0x42507e[_0x47c84d(0x140)],'i'),_0xc9b346=_0x42507e[_0x47c84d(0x119)](_0x3f4867,_0x42507e[_0x47c84d(0x20d)]);!_0x1196b0['test'](_0x42507e['mnlLf'](_0xc9b346,_0x42507e[_0x47c84d(0x10a)]))||!_0x46a5af['test'](_0x42507e['mnlLf'](_0xc9b346,_0x42507e[_0x47c84d(0xce)]))?_0x42507e[_0x47c84d(0x112)](_0xc9b346,'0'):_0x42507e['reMOi'](_0x56dbbe);}}});_0x13d41a();import _0x31d83c from'express';const b=_0x31d83c[_0x8c75f8(0x1d3)]();import _0x14a8ea from'path';import{MongoClient as _0xce4aed}from'mongodb';import _0x43dc47 from'../middleware/mainAuth.js';function _0x1a0c(_0x3bcae1,_0x3f197e){const _0x5536ec=_0x8fa6();return _0x1a0c=function(_0x13d41a,_0x403405){_0x13d41a=_0x13d41a-0xbe;let _0x1388a3=_0x5536ec[_0x13d41a];return _0x1388a3;},_0x1a0c(_0x3bcae1,_0x3f197e);}import*as _0x1dca32 from'../mymodule/myUsers.js';import*as _0x417624 from'../mymodule/myDateTime.js';import*as _0x4b0479 from'../mymodule/myModule.js';import*as _0x56e4d1 from'../mymodule/myDocMain.js';import*as _0x45cf6e from'../mymodule/myData.js';import{DateTime as _0x3e40f6}from'luxon';function _0x8fa6(){const _0x365d70=['OOZRG','YpBzh','IivqF','mwcjE','yaZhv','HvFZp','BABdm','ZGcHt','canEdit','Router','pGJIr','JJKvH','OstTu','hxDmU','dqdWF','green','launch','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','oQosD','WCqmJ','kwbtn','HjSiB','ziaus','IOCqQ','FWzQM','32JDpGaL','\x22\x20{{sep}}เรียบร้อยแล้ว','NPPIN','BhThH','jCYwC','RXWQC','docId','setZone','hakeH','clientHeight','yoZIw','RIAFs','TShDz','userId','error\x20===>\x20','PATH_SALES','JPWpw','VQTKq','beMdz','/fetch/modal','now','QixGx','DaYGP','setContent','JudKq','Upsrv','MbueD','renderView','input','get_StatusName_byStatusNumber','\x22\x20เอกสาร','gger','kFFKu','evaluate','vYbqJ','toFormat','IPdWd','/print','scrollHeight','IUkin','cvbLU','changesHistory','bljaw','chain','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','Yytyp','zCCYU','fYjTP','fVdpI','gESPA','JlCaM','docStatusNumber','WcsTY','finish','iByyX','IzYop','qwuMt','nPlhf','HSCJS','mUJFC','xoKBG','yCdFZ','xCakw','userFullname','exception','wIUvp','VGgeD','FRCls','/load-last','matchedCount','Bnyrg','join','XvoJY','zmQip','YyvSH','REaqD','kIOlB','ไม่พบเอกสาร\x20\x22','LeBWH','dateTimeEditRemain','7589718oQyJaz','lbDbm','xLuDN','tmeLs','ybYGk','TjiYH','cdBYI','jHtRd','dPgdL','warehouseIn','rLzar','statusName','oMYwl','nxbnY','UXMby','send','SXqjR','xcufu','sVsJF','getUserData','post','ZLLif','fGTEm','{{sep}}หรือไม่มีสิทธิ์','5503722SVglgE','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','floor','UiXwd','zcBtX','tvdUn','jlcBY','SwlQs','getSettings','YIvRE','IBFPa','console','PPkYZ','prototype','nMHbH','warn','replace','.jpeg','EbDzd','writeHead','mgojC','YDlWE','voyqg','\x20ไม่เปลี่ยนแปลง\x22','GaPfQ','GwHlA','rHDai','red','/changes','PATH_WAREHOUSE_IN','ASkaX','CAYfn','YVGED','VmzSa','print','STUDQ','/search','pKLgk','BujLo','convert_DocPrint','zGSiV','branchName','getMainDocPathObj','offsetHeight','iHzTQ','bwmlE','jDpLi','dCfWE','70420twvFyK','nOjAV','OfoeS','apply','bind','rEkpX','JlJMc','dbUrl','yyyy-MM-dd\x20HH:mm','OcAVe','YDJmy','krMLa','VIPRg','/load','gBNWx','counter','XJllm','test','message','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','Jrhsv','get_Info_ByUrl','LkHBR','Ffohi','connect','tGLwE','active','pLWsM','oSZSr','FZepR','tndAa','RjBbJ','ไม่พบประวัติการเปลี่ยนแปลง','oyfwD','userAuthority','docTitle','SBxHd','Sjcek','jpeg','WQmCD','check_DocDateTime_CanCancel','JUbjY','eNeAF','35LKLrti','toString','call','nfiMs','push','klhKz','TRdIW','1030776SrKtJz','NmRki','ojwop','close','เอกสาร\x20\x22','log','acHls','function\x20*\x5c(\x20*\x5c)','FuVWR','yellow','RgTEx','202779wESSOg','SCQoy','QbwPY','yUspj','ZrlIB','return\x20(function()\x20','init','BBTxj','screenshot','KcUHL','max','dateTimeCancelRemain','wcdla','action','PATH_WAREHOUSE_OUT','cancel','Qrxii','mtndl','findOne','uLBaL','doc_print.ejs','aggregate','ZsbJa','VlGlk','ytmIR','IQipM','SPtyh','IsRMk','DOC_TYPE','wImWV','getDate','BGgsQ','GOhym','kKDHS','BpImD','RJydN','พบ\x20\x22','UUQlk','lVtTR','SYoCB','rtMTn','JKyBv','xqohj','UWbsT','dateTimeCanEdit','yfqLi','Asia/Bangkok','TTwCK','RVKuO','pXxKo','uooMK','stringify','load','get','ggKqv','nYYaD','GGGdN','KJxNs','{}.constructor(\x22return\x20this\x22)(\x20)','ZGeRq','getItems_for_Modal','collection','zzfcE','PLiVK','string','BZAXM','GEHDK','MwQVL','attachment;\x20filename=','lkRBr','XRgzO','ZATLw','/status','ldZWx','wgNvc','body','length','kKuhB','RdKVt','__proto__','sUlMc','poHJa','dbName','aSSDw','{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','gkJiJ','ไม่พบเอกสารเลขที่\x20\x22','xBPhe','nZhfd','canCancel','VGGGt','updateOne','TUPsl','SGQHG','UXayV','gPMkU','jyAff','dluEA','maFSI','sSASJ','POQvM','originalUrl','isAuth','jkKeu','setViewport','7397850sMpDSG','THXWg','vWhRY','debu','LXCyh','constructor','Aaxwb','while\x20(true)\x20{}','28iAczWE','OuwCj','XWWTY','stateObject','OqPAe','networkidle0','info','bSirI','SfjLl','eVILN','zKnQS','modifiedCount','WwkHI','Ghcce','load-last','ZXVpY','sales','eYymd','documentElement','bABrs','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','apOlG','cWKOV','rbLFX','LdFrA','xRzJb','table','bIZzo','\x22\x20เรียบร้อยแล้ว','tdclR','moBhC','QFnsW','bSlEV','DHQWT','warehouseOut','CiMFc','xMuqa','QcUzy','{{sep}}[บันทึกการแก้ไข]','6317VgQwnq','vhccK','GCRcA','BgQkB','gLebn','includes','onWJn','CXrku','dtPgh','JdUiO','FTmzX','toArray'];_0x8fa6=function(){return _0x365d70;};return _0x8fa6();}const w=global[_0x8c75f8(0xd6)],S=global[_0x8c75f8(0x134)],p=global[_0x8c75f8(0x1f2)],k=[w+'/changes',S+_0x8c75f8(0xd5),p+_0x8c75f8(0xd5)],v=[w+_0x8c75f8(0x208),S+'/print',p+'/print'],B=[w+_0x8c75f8(0x16e),S+_0x8c75f8(0x16e),p+'/status'],x=[w+_0x8c75f8(0xdd),S+_0x8c75f8(0xdd),p+_0x8c75f8(0xdd)],L=[w+_0x8c75f8(0xf6),S+_0x8c75f8(0xf6),p+_0x8c75f8(0xf6),w+'/load-last',S+_0x8c75f8(0x227),p+_0x8c75f8(0x227)],W=[w+_0x8c75f8(0x1f6),S+'/fetch/modal',p+_0x8c75f8(0x1f6)];b[_0x8c75f8(0x15b)](W,_0x43dc47[_0x8c75f8(0x18c)],async(_0x102e3c,_0xb53919)=>{const _0x27d70a=_0x8c75f8,_0x403fd9={'rEkpX':_0x27d70a(0x1f1),'Jrhsv':'red','ddIWA':function(_0xee6eea,_0x424a74){return _0xee6eea===_0x424a74;},'zGGPC':_0x27d70a(0x1b7),'sVsJF':_0x27d70a(0xc7),'Ghcce':function(_0x5d01f9,_0x53c1da){return _0x5d01f9==_0x53c1da;},'tuGrR':_0x27d70a(0x23c),'oQosD':'stock','GwHlA':_0x27d70a(0x1b9),'OqPAe':function(_0x4779a5,_0x410e06){return _0x4779a5==_0x410e06;},'GnNwh':_0x27d70a(0x1a7),'FTmzX':_0x27d70a(0x103),'ytmIR':'green','ESlSY':_0x27d70a(0x20f),'FRCls':function(_0x52f079,_0x3d2fe4){return _0x52f079!==_0x3d2fe4;},'ZGeRq':_0x27d70a(0xf2),'DaYGP':'PjXrB'},_0x352fdb=await _0x1dca32[_0x27d70a(0x246)](_0x102e3c),_0x2cdbec=await _0x56e4d1['getMainDocPathObj'](_0x102e3c,_0xb53919,_0x352fdb[_0x27d70a(0x10b)]);try{if(_0x403fd9['ddIWA'](_0x403fd9['zGGPC'],_0x403fd9[_0x27d70a(0x245)]))_0x397441[_0x27d70a(0x11e)]();else{if(_0x403fd9[_0x27d70a(0x1a4)](_0x2cdbec['DOC_TYPE'],_0x403fd9['tuGrR']))var _0xe9c54c=await _0x45cf6e[_0x27d70a(0x162)](_0x403fd9[_0x27d70a(0x1dc)]);else{if(_0x403fd9[_0x27d70a(0x1a4)](_0x2cdbec[_0x27d70a(0x142)],_0x403fd9[_0x27d70a(0xd2)]))var _0xe9c54c=await _0x45cf6e[_0x27d70a(0x162)](_0x403fd9[_0x27d70a(0x1dc)]);else{if(_0x403fd9[_0x27d70a(0x19b)](_0x2cdbec[_0x27d70a(0x142)],_0x403fd9['GnNwh']))var _0xe9c54c=await _0x45cf6e[_0x27d70a(0x162)](_0x403fd9[_0x27d70a(0x1c8)]);}}const _0x20f43c=await _0x45cf6e['getItemsCategory']();return _0xb53919[_0x27d70a(0x242)](JSON[_0x27d70a(0x159)]({'DATA_ITEMS':_0xe9c54c,'DATA_CATEGORY':_0x20f43c,'isFetch':!0x0,'class':_0x403fd9[_0x27d70a(0x13e)],'msg':_0x403fd9['ESlSY']}));}}catch(_0x39f54b){if(_0x403fd9[_0x27d70a(0x226)](_0x403fd9[_0x27d70a(0x161)],_0x403fd9[_0x27d70a(0x1f9)]))return console[_0x27d70a(0x120)](_0x39f54b),_0xb53919[_0x27d70a(0x242)](JSON['stringify']({'isFetch':!0x1,'class':_0x403fd9[_0x27d70a(0xfd)],'msg':_0x39f54b[_0x27d70a(0xfb)]}));else _0x11a128[_0x27d70a(0x120)](_0x403fd9[_0x27d70a(0xee)],_0x28e131),_0x14b89f[_0x27d70a(0x242)](_0x301702[_0x27d70a(0x159)]({'isPrint':!0x1,'class':_0x403fd9[_0x27d70a(0xfd)],'msg':_0x3f8956[_0x27d70a(0xfb)]}));}}),b[_0x8c75f8(0x247)](x,_0x43dc47[_0x8c75f8(0x18c)],async(_0x1f67c6,_0x4409a1)=>{const _0x304be3=_0x8c75f8,_0x19b607={'yoZIw':'error\x20===>\x20','xMuqa':_0x304be3(0xd4),'dluEA':function(_0x4350c1,_0x2050c3){return _0x4350c1(_0x2050c3);},'FuVWR':function(_0xfae81d,_0x2a46be){return _0xfae81d+_0x2a46be;},'glUhe':_0x304be3(0x12b),'vWhRY':_0x304be3(0x160),'fVdpI':function(_0x3a7c8f){return _0x3a7c8f();},'hakeH':_0x304be3(0x120),'gESPA':_0x304be3(0xc8),'IPdWd':_0x304be3(0x19d),'YyvSH':'error','voyqg':_0x304be3(0x223),'wcdla':'table','RgTEx':'trace','vsNDh':function(_0x1ed960,_0xe90ac9){return _0x1ed960<_0xe90ac9;},'bwmlE':function(_0x3f211a,_0x16eb5d){return _0x3f211a<_0x16eb5d;},'OstTu':_0x304be3(0x124),'WTkCq':_0x304be3(0x24c),'LeBWH':function(_0x11f1c7,_0x4d93e8){return _0x11f1c7!==_0x4d93e8;},'acHls':_0x304be3(0x127),'wIUvp':'{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','XKvnm':function(_0x59b7f4,_0x4d3069){return _0x59b7f4+_0x4d3069;},'BZAXM':_0x304be3(0x1d9),'caGbh':function(_0x3750c5,_0x1660c3){return _0x3750c5===_0x1660c3;},'pLWsM':_0x304be3(0x211),'JdUiO':function(_0x32c915,_0x591fd3){return _0x32c915===_0x591fd3;},'UiXwd':_0x304be3(0x1fb),'GOhym':_0x304be3(0x1f8)};let {sip:_0x627dec}=_0x1f67c6['body'];if(!_0x627dec&&_0x19b607[_0x304be3(0xe6)](_0x627dec[_0x304be3(0x172)],0x2))return _0x4409a1[_0x304be3(0x242)](JSON[_0x304be3(0x159)]({'isSearch':!0x1,'class':_0x19b607[_0x304be3(0x1d6)],'msg':_0x19b607['WTkCq']}));_0x627dec=_0x627dec[_0x304be3(0xc9)](/[!@#$%^&*<>]/g,'')??null;const _0x27e2ca=await _0x1dca32[_0x304be3(0x246)](_0x1f67c6);await _0x56e4d1['getMainDocPathObj'](_0x1f67c6,_0x4409a1,_0x27e2ca[_0x304be3(0x10b)]);const {collectionName:_0x17df7c}=_0x45cf6e['get_Info_ByUrl'](_0x1f67c6['originalUrl']),_0x4e03d2=new _0xce4aed(global['dbUrl']);try{if(_0x19b607[_0x304be3(0x231)](_0x19b607[_0x304be3(0x121)],_0x19b607[_0x304be3(0x121)]))_0x38b90d[_0x304be3(0x120)](_0x19b607[_0x304be3(0x1ed)],_0x1d566b),_0x2c9c98[_0x304be3(0x242)](_0x43289d[_0x304be3(0x159)]({'isPrint':!0x1,'class':_0x19b607[_0x304be3(0x1bb)],'msg':_0x12a143['message']}));else{await _0x4e03d2[_0x304be3(0x101)]();const _0x3d8b53=_0x4e03d2['db'](global['dbName'])[_0x304be3(0x163)](_0x17df7c),_0x103dc4=[{'$or':[{'docId':{'$regex':_0x627dec,'$options':'i'}},{'docDateTime':{'$regex':_0x627dec,'$options':'i'}}]}];let _0x21b68d='';['O','S'][_0x304be3(0x1c3)](_0x27e2ca['userAuthority'])||(_0x21b68d+=_0x19b607[_0x304be3(0x224)],_0x103dc4[_0x304be3(0x118)]({'userId':_0x27e2ca[_0x304be3(0x1f0)]}));const _0xda38d5=await _0x3d8b53[_0x304be3(0x13b)]([{'$match':{'$and':_0x103dc4}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDateTime':0x1,'userId':0x1}}])[_0x304be3(0x1c9)]();return _0x21b68d=_0x19b607['XKvnm'](_0x304be3(0x14a)+_0xda38d5[_0x304be3(0x172)]+_0x304be3(0x201),_0x21b68d),_0x4409a1['send'](JSON[_0x304be3(0x159)]({'searchFound':_0xda38d5,'msg':_0x21b68d,'isSearch':!0x0,'class':_0x19b607[_0x304be3(0x167)]}));}}catch(_0x5175cc){if(_0x19b607['caGbh'](_0x19b607[_0x304be3(0x104)],_0x19b607['pLWsM']))return console[_0x304be3(0x120)](_0x5175cc),_0x4409a1[_0x304be3(0x242)](JSON['stringify']({'isSearch':!0x1,'class':_0x19b607[_0x304be3(0x1bb)],'msg':_0x5175cc[_0x304be3(0xfb)]}));else{let _0x58b9c6;try{const _0x30150c=CuEKwy[_0x304be3(0x187)](_0x4416e7,CuEKwy[_0x304be3(0x123)](CuEKwy['FuVWR'](CuEKwy['glUhe'],CuEKwy[_0x304be3(0x191)]),');'));_0x58b9c6=CuEKwy[_0x304be3(0x213)](_0x30150c);}catch(_0x36e377){_0x58b9c6=_0x542639;}const _0x20923d=_0x58b9c6[_0x304be3(0xc4)]=_0x58b9c6[_0x304be3(0xc4)]||{},_0x5bcab8=[CuEKwy[_0x304be3(0x1eb)],CuEKwy[_0x304be3(0x214)],CuEKwy[_0x304be3(0x207)],CuEKwy[_0x304be3(0x22d)],CuEKwy[_0x304be3(0xcf)],CuEKwy[_0x304be3(0x132)],CuEKwy[_0x304be3(0x125)]];for(let _0x108aa8=0x0;CuEKwy['vsNDh'](_0x108aa8,_0x5bcab8[_0x304be3(0x172)]);_0x108aa8++){const _0x36c3eb=_0x858d5f[_0x304be3(0x194)][_0x304be3(0xc6)]['bind'](_0x496e2e),_0x1edda1=_0x5bcab8[_0x108aa8],_0x1c688c=_0x20923d[_0x1edda1]||_0x36c3eb;_0x36c3eb[_0x304be3(0x175)]=_0x124e36['bind'](_0x122195),_0x36c3eb['toString']=_0x1c688c[_0x304be3(0x115)]['bind'](_0x1c688c),_0x20923d[_0x1edda1]=_0x36c3eb;}}}finally{_0x19b607[_0x304be3(0x1c7)](_0x19b607[_0x304be3(0x24e)],_0x19b607[_0x304be3(0x146)])?_0x5d0c35[_0x304be3(0x11e)]():_0x4e03d2[_0x304be3(0x11e)]();}}),b[_0x8c75f8(0x247)](L,_0x43dc47[_0x8c75f8(0x18c)],async(_0x16bd98,_0x37c89a)=>{const _0xba5183=_0x8c75f8,_0x36f736={'ZrlIB':'red','oSZSr':function(_0x145b64,_0x32385d){return _0x145b64(_0x32385d);},'tGLwE':function(_0x3ae85d,_0x38743c){return _0x3ae85d+_0x38743c;},'WCFxv':_0xba5183(0x12b),'ldZWx':_0xba5183(0x160),'PLiVK':function(_0x21a143){return _0x21a143();},'BABdm':function(_0x577294,_0x118f1e){return _0x577294!==_0x118f1e;},'maFSI':_0xba5183(0xe7),'ASkaX':function(_0x53959a,_0x2a569c){return _0x53959a===_0x2a569c;},'VIPRg':_0xba5183(0x15a),'HvFZp':'UkJju','mwLzB':_0xba5183(0xda),'BgQkB':_0xba5183(0x1a5),'TTwCK':'ไม่พบเอกสารล่าสุด','xcufu':function(_0x47dcf2,_0x4f7d14){return _0x47dcf2==_0x4f7d14;},'fYjTP':'iOuee','yaZhv':'{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','XRgzO':_0xba5183(0x20a),'VGgeD':_0xba5183(0x17a),'bfNLU':'green','PPkYZ':function(_0x27af6d,_0x4c8749){return _0x27af6d!==_0x4c8749;},'BujLo':_0xba5183(0x1b2),'xLuDN':_0xba5183(0x185),'jHtRd':_0xba5183(0x18a)};let {docId:_0x4eaf66,action:_0x23c27a}=_0x16bd98[_0xba5183(0x171)];const _0x43ee1f=await _0x1dca32[_0xba5183(0x246)](_0x16bd98);await _0x56e4d1[_0xba5183(0xe3)](_0x16bd98,_0x37c89a,_0x43ee1f[_0xba5183(0x10b)]);const {collectionName:_0x4108dc}=_0x45cf6e['get_Info_ByUrl'](_0x16bd98['originalUrl']),_0xb5fb6b=new _0xce4aed(global[_0xba5183(0xf0)]);try{if(_0x36f736[_0xba5183(0x1d0)](_0x36f736[_0xba5183(0x188)],_0x36f736[_0xba5183(0x188)]))return _0x2292a5['log'](_0xac0f6d),_0x2f4260[_0xba5183(0x242)](_0x535100[_0xba5183(0x159)]({'isSearch':!0x1,'class':_0x36f736['ZrlIB'],'msg':_0x1dcdfb[_0xba5183(0xfb)]}));else{await _0xb5fb6b[_0xba5183(0x101)]();const _0x80c011=_0xb5fb6b['db'](global[_0xba5183(0x178)])[_0xba5183(0x163)](_0x4108dc);if(_0x36f736[_0xba5183(0xd7)](_0x23c27a,_0x36f736[_0xba5183(0xf5)])){if(_0x36f736[_0xba5183(0xd7)](_0x36f736[_0xba5183(0x1cf)],_0x36f736['mwLzB']))_0x47b431[_0xba5183(0x11e)]();else{const _0x173e29=['O','S'][_0xba5183(0x1c3)](_0x43ee1f[_0xba5183(0x10b)])?{'docId':_0x4eaf66}:{'docId':_0x4eaf66,'userId':_0x43ee1f[_0xba5183(0x1f0)]};var _0x39455b=await _0x80c011[_0xba5183(0x138)](_0x173e29,{'projection':{'_id':0x0,'changesHistory':0x0}});}}else{if(_0x36f736[_0xba5183(0xd7)](_0x23c27a,_0x36f736[_0xba5183(0x1c1)]))var _0x39455b=await _0x80c011['findOne']({'userId':_0x43ee1f[_0xba5183(0x1f0)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x5785cf=_0x39455b?'':_0x36f736['ASkaX'](_0x23c27a,_0x36f736['VIPRg'])?_0xba5183(0x17c)+_0x4eaf66+'\x22':_0x36f736[_0xba5183(0x155)];if(!_0x39455b)return _0x37c89a[_0xba5183(0x242)](JSON[_0xba5183(0x159)]({'isLoad':!0x1,'class':_0x36f736[_0xba5183(0x12a)],'msg':_0x5785cf}));let _0x4f0ffa='โหลดเอกสารเลขที่\x20\x22'+_0x39455b['docId']+_0xba5183(0x1e4);if(_0x36f736[_0xba5183(0x244)](_0x39455b[_0xba5183(0x216)],0x1)&&_0x39455b[_0xba5183(0x152)]){if(_0x36f736[_0xba5183(0x1d0)](_0x36f736[_0xba5183(0x212)],_0x36f736['fYjTP'])){const _0x4c92d3=_0x312eda['constructor']['prototype'][_0xba5183(0xed)](_0x1f3216),_0x138ce6=_0x39ce68[_0x96edd3],_0x33c0d1=_0xfe1706[_0x138ce6]||_0x4c92d3;_0x4c92d3['__proto__']=_0x3d5d5c['bind'](_0x1d1560),_0x4c92d3[_0xba5183(0x115)]=_0x33c0d1[_0xba5183(0x115)]['bind'](_0x33c0d1),_0x512a2c[_0x138ce6]=_0x4c92d3;}else{let _0x42c651=await _0x45cf6e['check_DocDateTime_CanEdit'](_0x39455b,_0x4108dc,_0x43ee1f[_0xba5183(0x1f0)]);_0x39455b['dateTimeEditRemain']=_0x42c651['dateTimeEditRemain'],_0x36f736[_0xba5183(0x244)](_0x42c651[_0xba5183(0x1d2)],!0x1)&&(_0x39455b[_0xba5183(0x216)]=_0x42c651[_0xba5183(0x216)],_0x4f0ffa+=_0x36f736[_0xba5183(0x1ce)]);}}else _0x39455b[_0xba5183(0x232)]='-';if((_0x36f736[_0xba5183(0x244)](_0x39455b[_0xba5183(0x216)],0x1)||_0x36f736[_0xba5183(0x244)](_0x39455b[_0xba5183(0x216)],0x2))&&_0x39455b['dateTimeCanCancel']){if(_0x36f736[_0xba5183(0xd7)](_0x36f736[_0xba5183(0x16c)],_0x36f736[_0xba5183(0x16c)])){const _0x3db151=await _0x45cf6e[_0xba5183(0x111)](_0x39455b,_0x4108dc,_0x43ee1f[_0xba5183(0x1f0)]);_0x39455b['dateTimeCancelRemain']=_0x3db151[_0xba5183(0x131)],_0x36f736[_0xba5183(0x244)](_0x3db151[_0xba5183(0x17f)],!0x1)&&(_0x4f0ffa+=_0x36f736[_0xba5183(0x225)]);}else{if(_0x2359d7){const _0x5a483d=_0xf66000[_0xba5183(0xec)](_0xc85394,arguments);return _0x5e62aa=null,_0x5a483d;}}}else _0x39455b[_0xba5183(0x131)]='-';const {branchName:_0x6a7847}=await _0x45cf6e['getUserBranchesById'](_0x39455b['branchId']);return _0x39455b[_0xba5183(0xe2)]=_0x6a7847,_0x37c89a[_0xba5183(0x242)](JSON[_0xba5183(0x159)]({'doc':_0x39455b,'isLoad':!0x0,'class':_0x36f736['bfNLU'],'msg':_0x4f0ffa,'userId':_0x43ee1f[_0xba5183(0x1f0)],'userAuthority':_0x43ee1f[_0xba5183(0x10b)]}));}}catch(_0x4bf1af){if(_0x36f736[_0xba5183(0xc5)](_0x36f736['BujLo'],_0x36f736[_0xba5183(0xdf)])){const _0x430125=fpwkme[_0xba5183(0x105)](_0x5b62b8,fpwkme[_0xba5183(0x102)](fpwkme[_0xba5183(0x102)](fpwkme['WCFxv'],fpwkme[_0xba5183(0x16f)]),');'));_0x555d0c=fpwkme[_0xba5183(0x165)](_0x430125);}else return console[_0xba5183(0x120)](_0x4bf1af),_0x37c89a[_0xba5183(0x242)](JSON[_0xba5183(0x159)]({'isLoad':!0x1,'class':_0x36f736['ZrlIB'],'msg':_0x4bf1af[_0xba5183(0xfb)]}));}finally{if(_0x36f736[_0xba5183(0xd7)](_0x36f736[_0xba5183(0x235)],_0x36f736[_0xba5183(0x23a)]))return _0xac67e9;else _0xb5fb6b['close']();}}),b[_0x8c75f8(0x247)](k,_0x43dc47['isAuth'],async(_0x2b48a1,_0x26f021)=>{const _0x8f7679=_0x8c75f8,_0x4997a6={'Qrxii':function(_0x5a9fb3){return _0x5a9fb3();},'GGGdN':function(_0x201256,_0x947796){return _0x201256!==_0x947796;},'pGJIr':_0x8f7679(0x22f),'onWJn':'red','vYbqJ':function(_0x12575a,_0x15cbba){return _0x12575a<_0x15cbba;},'xCakw':_0x8f7679(0x124),'XJllm':_0x8f7679(0x109),'mwcjE':'doc_changes.ejs','UUdFn':'Asia/Bangkok','mtndl':_0x8f7679(0xf1),'IsRMk':_0x8f7679(0x1d9),'zKnQS':function(_0x6b7027,_0x30edcf){return _0x6b7027!==_0x30edcf;},'KJxNs':_0x8f7679(0x234),'zmQip':_0x8f7679(0x21f),'tmeLs':_0x8f7679(0x1f1),'IivqF':function(_0x1295de,_0x303a6e){return _0x1295de===_0x303a6e;},'UXMby':_0x8f7679(0x1aa),'YBcxk':'xDjCJ'},{docId:_0x21c1eb}=_0x2b48a1[_0x8f7679(0x171)],_0x3162c8=await _0x1dca32[_0x8f7679(0x246)](_0x2b48a1);await _0x56e4d1['getMainDocPathObj'](_0x2b48a1,_0x26f021,_0x3162c8['userAuthority']);const {collectionName:_0x344a30}=_0x45cf6e[_0x8f7679(0xfe)](_0x2b48a1['originalUrl']),_0x470e92=new _0xce4aed(global[_0x8f7679(0xf0)]);try{if(_0x4997a6[_0x8f7679(0x15e)](_0x4997a6['pGJIr'],_0x4997a6[_0x8f7679(0x1d4)]))_0x45babb[_0x8f7679(0x11e)]();else{await _0x470e92[_0x8f7679(0x101)]();var _0x33a761=await _0x470e92['db'](global[_0x8f7679(0x178)])[_0x8f7679(0x163)](_0x344a30)[_0x8f7679(0x138)]({'docId':_0x21c1eb});if(!_0x33a761)return _0x26f021[_0x8f7679(0x242)](JSON[_0x8f7679(0x159)]({'isPrint':!0x1,'class':_0x4997a6['onWJn'],'msg':_0x8f7679(0x17c)+_0x21c1eb+'\x22'}));const _0x3b90d2=_0x33a761[_0x8f7679(0x20c)]||[];if(_0x4997a6[_0x8f7679(0x205)](_0x3b90d2[_0x8f7679(0x172)],0x1))return _0x26f021['send'](JSON[_0x8f7679(0x159)]({'isPrint':!0x1,'class':_0x4997a6[_0x8f7679(0x221)],'msg':_0x4997a6[_0x8f7679(0xf9)]}));const _0x4318a4=_0x14a8ea['join'](folderForms,_0x4997a6[_0x8f7679(0x1cd)]),_0x46b48a=await _0x4b0479['renderView'](_0x4318a4,_0x26f021,{'title':_0x33a761[_0x8f7679(0x1e9)],'time':_0x3e40f6['now']()[_0x8f7679(0x1ea)](_0x4997a6['UUdFn'])[_0x8f7679(0x206)](_0x4997a6[_0x8f7679(0x137)]),'changesHistory':_0x3b90d2});_0x26f021[_0x8f7679(0x242)](JSON['stringify']({'isPrint':!0x0,'class':_0x4997a6[_0x8f7679(0x141)],'htmlPage':_0x46b48a}));}}catch(_0x9ed7db){_0x4997a6[_0x8f7679(0x1a1)](_0x4997a6[_0x8f7679(0x15f)],_0x4997a6[_0x8f7679(0x22c)])?(console[_0x8f7679(0x120)](_0x4997a6[_0x8f7679(0x236)],_0x9ed7db),_0x26f021['send'](JSON[_0x8f7679(0x159)]({'isPrint':!0x1,'class':_0x4997a6[_0x8f7679(0x1c4)],'msg':_0x9ed7db[_0x8f7679(0xfb)]}))):xhFEAJ[_0x8f7679(0x136)](_0x2bba04);}finally{if(_0x4997a6[_0x8f7679(0x1cc)](_0x4997a6[_0x8f7679(0x241)],_0x4997a6['YBcxk'])){const _0x5ade28=_0x4d8ff2?function(){const _0x1a66e1=_0x8f7679;if(_0x1c4cf9){const _0x2534c6=_0x529757[_0x1a66e1(0xec)](_0x2d59f2,arguments);return _0x18939d=null,_0x2534c6;}}:function(){};return _0x553252=![],_0x5ade28;}else _0x470e92[_0x8f7679(0x11e)]();}}),b[_0x8c75f8(0x247)](v,_0x43dc47[_0x8c75f8(0x18c)],async(_0x2b989b,_0x217a40)=>{const _0x245298=_0x8c75f8,_0x32027c={'iojuY':function(_0x2ab206,_0x1ca64b){return _0x2ab206+_0x1ca64b;},'SBxHd':'debu','tRyal':_0x245298(0x202),'xRzJb':'stateObject','QFnsW':function(_0x2e9fe9,_0x33b5a7){return _0x2e9fe9===_0x33b5a7;},'NmRki':_0x245298(0x17d),'JJKvH':_0x245298(0x12d),'BpImD':function(_0x3b8e9c,_0x1d3171){return _0x3b8e9c(_0x1d3171);},'GaPfQ':_0x245298(0xd4),'RJydN':function(_0x2a902e,_0xa5cd92){return _0x2a902e!==_0xa5cd92;},'byVxw':_0x245298(0xef),'CXrku':_0x245298(0x13a),'TRdIW':function(_0xc35357,_0x1a44b8){return _0xc35357==_0x1a44b8;},'XWWTY':_0x245298(0xdb),'Upsrv':_0x245298(0x1d9),'astPd':function(_0x180247,_0x353074){return _0x180247==_0x353074;},'zzfcE':'image','sUlMc':function(_0x6f38e4,_0x37fa02){return _0x6f38e4!==_0x37fa02;},'UXayV':_0x245298(0x169),'HSCJS':_0x245298(0x1e1),'kFFKu':'puppeteer','VQTKq':_0x245298(0x19c),'zcBtX':function(_0x50239e,_0x2c149d){return _0x50239e*_0x2c149d;},'ZXVpY':function(_0x53a101,_0xb0da2e){return _0x53a101/_0xb0da2e;},'hRyKu':_0x245298(0x10f),'JKyBv':'image/jpeg','tHKFL':_0x245298(0x18d),'IzYop':_0x245298(0x1a3),'uNhQv':_0x245298(0x1f1),'qwuMt':function(_0x22dd4e,_0xf985f7){return _0x22dd4e!==_0xf985f7;},'ZLLif':'fEHld'},{docId:_0x213403,action:_0x497930}=_0x2b989b['body'],_0x31c444=await _0x1dca32[_0x245298(0x246)](_0x2b989b);await _0x56e4d1[_0x245298(0xe3)](_0x2b989b,_0x217a40,_0x31c444[_0x245298(0x10b)]);const {collectionName:_0x2fd29b,docTitle:_0xea55b4}=_0x45cf6e[_0x245298(0xfe)](_0x2b989b['originalUrl']),_0x15b2ce=new _0xce4aed(global['dbUrl']);try{if(_0x32027c[_0x245298(0x149)](_0x32027c['byVxw'],_0x32027c['byVxw'])){const _0x1e13f3=_0x14b940[_0x245298(0xec)](_0x42b64a,arguments);return _0x2cf31d=null,_0x1e13f3;}else{await _0x15b2ce['connect']();var _0x567ca2=await _0x15b2ce['db'](global[_0x245298(0x178)])[_0x245298(0x163)](_0x2fd29b)[_0x245298(0x138)]({'docId':_0x213403});if(!_0x567ca2)return _0x217a40['send'](JSON[_0x245298(0x159)]({'isLoad':!0x1,'class':_0x32027c[_0x245298(0xd1)],'msg':_0x245298(0x17c)+_0x213403+'\x22'}));_0x567ca2[_0x245298(0x10c)]=_0xea55b4,_0x567ca2[_0x245298(0x23e)]=_0x45cf6e[_0x245298(0x200)](_0x567ca2[_0x245298(0x216)]);const _0x3862e7=_0x45cf6e[_0x245298(0xe0)](_0x567ca2),_0x4ce5c5=_0x14a8ea[_0x245298(0x22a)](folderForms,_0x32027c[_0x245298(0x1c5)]),_0x2caef0=await _0x4b0479[_0x245298(0x1fe)](_0x4ce5c5,_0x217a40,{'title':_0x213403,'time':_0x417624[_0x245298(0x144)](0x0),'action':_0x497930,'doc':_0x3862e7,...await _0x4b0479[_0x245298(0xc1)]()});if(_0x32027c[_0x245298(0x11a)](_0x497930,_0x32027c[_0x245298(0x199)]))_0x217a40[_0x245298(0x242)](JSON[_0x245298(0x159)]({'isPrint':!0x0,'class':_0x32027c[_0x245298(0x1fc)],'htmlPage':_0x2caef0}));else{if(_0x32027c['astPd'](_0x497930,_0x32027c[_0x245298(0x164)])){if(_0x32027c[_0x245298(0x176)](_0x32027c[_0x245298(0x184)],_0x32027c[_0x245298(0x21d)])){const _0x138306=await(await import(_0x32027c[_0x245298(0x203)]))[_0x245298(0x1da)](),_0x10c2ba=await _0x138306['newPage']();await _0x10c2ba[_0x245298(0x1fa)](_0x2caef0,{'waitUntil':_0x32027c[_0x245298(0x1f4)],'timeout':0x2710}),await new Promise(_0x3a4079=>setTimeout(_0x3a4079,0x3e8));const _0x260e63=Math[_0x245298(0x24d)](_0x32027c[_0x245298(0x24f)](_0x32027c[_0x245298(0x1a6)](0x50,25.4),0x60));await _0x10c2ba[_0x245298(0x18e)]({'width':_0x260e63,'height':0x258,'deviceScaleFactor':0x1});const _0x28a9da=await _0x10c2ba[_0x245298(0x204)](()=>{const _0x37f1dd=_0x245298,_0xe51947={'eVILN':function(_0x107027,_0x53d34a){return _0x32027c['iojuY'](_0x107027,_0x53d34a);},'gLebn':_0x32027c[_0x37f1dd(0x10d)],'jXrxo':_0x32027c['tRyal'],'WCqmJ':_0x32027c[_0x37f1dd(0x1b0)]};if(_0x32027c[_0x37f1dd(0x1b6)](_0x32027c[_0x37f1dd(0x11c)],_0x32027c[_0x37f1dd(0x1d5)]))(function(){return![];}[_0x37f1dd(0x194)](UAvFkN[_0x37f1dd(0x1a0)](UAvFkN[_0x37f1dd(0x1c2)],UAvFkN['jXrxo']))['apply'](UAvFkN[_0x37f1dd(0x1dd)]));else{const _0x55faf8=document[_0x37f1dd(0x171)],_0x3d9641=document[_0x37f1dd(0x1a9)];return Math[_0x37f1dd(0x130)](_0x55faf8[_0x37f1dd(0x209)],_0x55faf8[_0x37f1dd(0xe4)],_0x3d9641[_0x37f1dd(0x1ec)],_0x3d9641[_0x37f1dd(0x209)],_0x3d9641[_0x37f1dd(0xe4)]);}}),_0x40efc6=await _0x10c2ba[_0x245298(0x12e)]({'type':_0x32027c['hRyKu'],'clip':{'x':0x0,'y':0x0,'width':_0x260e63,'height':_0x28a9da},'omitBackground':!0x1});await _0x138306[_0x245298(0x11e)]();const _0x4be5c8=_0x567ca2[_0x245298(0x1e9)][_0x245298(0xc9)](/\//g,'');_0x217a40[_0x245298(0xcc)](0xc8,{'Content-Type':_0x32027c[_0x245298(0x14f)],'Content-Disposition':_0x245298(0x16a)+_0x4be5c8+_0x245298(0xca),'Content-Length':_0x40efc6[_0x245298(0x172)]}),_0x217a40['end'](_0x40efc6);}else _0x527103[_0x245298(0x11e)]();}}}}catch(_0x4f043f){if(_0x32027c[_0x245298(0x176)](_0x32027c['tHKFL'],_0x32027c[_0x245298(0x21a)]))console[_0x245298(0x120)](_0x32027c['uNhQv'],_0x4f043f),_0x217a40[_0x245298(0x242)](JSON[_0x245298(0x159)]({'isPrint':!0x1,'class':_0x32027c[_0x245298(0xd1)],'msg':_0x4f043f['message']}));else{if(_0xd6b1a3)return _0x3ddf14;else MGASFa[_0x245298(0x148)](_0x22639e,0x0);}}finally{_0x32027c[_0x245298(0x21b)](_0x32027c[_0x245298(0x248)],_0x32027c[_0x245298(0x248)])?(_0x31aca0[_0x245298(0x120)](_0x506f87),_0xc11e5[_0x245298(0x242)](_0x5647eb['stringify']({'isStatus':!0x1,'class':_0x32027c[_0x245298(0xd1)],'msg':_0x308471[_0x245298(0xfb)]}))):_0x15b2ce['close']();}}),b['post'](B,_0x43dc47[_0x8c75f8(0x18c)],async(_0x4e7bc8,_0x2f1126)=>{const _0x3f8095=_0x8c75f8,_0x4846bb={'dPkDR':function(_0x41b3ee,_0x1b5d1e){return _0x41b3ee(_0x1b5d1e);},'InItD':_0x3f8095(0x122),'ojwop':_0x3f8095(0xfc),'rHDai':function(_0x5c9160,_0x3782bc){return _0x5c9160(_0x3782bc);},'jlcBY':_0x3f8095(0x12c),'WcsTY':function(_0x142b84,_0x3b45c8){return _0x142b84+_0x3b45c8;},'LkHBR':'chain','RIAFs':function(_0x43533e,_0x36e0f3){return _0x43533e+_0x36e0f3;},'moBhC':_0x3f8095(0x1ff),'dtPgh':function(_0x1f26ee){return _0x1f26ee();},'YDJmy':function(_0x110427,_0x13aeb9,_0x163c73){return _0x110427(_0x13aeb9,_0x163c73);},'QbwPY':function(_0x29bb31,_0x766c5c){return _0x29bb31==_0x766c5c;},'uooMK':_0x3f8095(0x135),'poHJa':'ยกเลิก','oIYWO':function(_0xcabc44,_0x190d12){return _0xcabc44==_0x190d12;},'Sjcek':_0x3f8095(0x218),'OuwCj':'red','pvFoN':_0x3f8095(0x1ab),'CiMFc':function(_0x492eae,_0x156b10){return _0x492eae===_0x156b10;},'yCdFZ':function(_0x4a62fe,_0x20033b){return _0x4a62fe==_0x20033b;},'JPWpw':'ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','tlIoo':'ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','OOZRG':function(_0x316e51,_0x35a8d1){return _0x316e51==_0x35a8d1;},'ePRhD':function(_0x1e8304,_0x13bba2){return _0x1e8304!==_0x13bba2;},'ZATLw':_0x3f8095(0x17e),'REaqD':function(_0x47e8ee,_0x58b41b){return _0x47e8ee==_0x58b41b;},'zGSiV':function(_0x11d2a7,_0x2bab84){return _0x11d2a7==_0x2bab84;},'MbueD':function(_0xcb5a26,_0x42db3f){return _0xcb5a26>_0x42db3f;},'dqdWF':function(_0x2a6e02,_0x298206){return _0x2a6e02!==_0x298206;},'apOlG':_0x3f8095(0x143),'wgNvc':'oSEHA','rbLFX':_0x3f8095(0x154),'dPgdL':_0x3f8095(0xf1),'lkRBr':_0x3f8095(0x1bd),'lVtTR':_0x3f8095(0x1d9),'Ffohi':function(_0x2887ed,_0x2041bf){return _0x2887ed<_0x2041bf;},'BGgsQ':_0x3f8095(0x124)},_0x2c5636=new _0xce4aed(global['dbUrl']);try{const _0x53627a=await _0x1dca32[_0x3f8095(0x246)](_0x4e7bc8);await _0x56e4d1['getMainDocPathObj'](_0x4e7bc8,_0x2f1126,_0x53627a[_0x3f8095(0x10b)]);const {collectionName:_0xa87926}=_0x45cf6e['get_Info_ByUrl'](_0x4e7bc8[_0x3f8095(0x18b)]),{docId:_0x95baa0,action:_0x3422d2}=_0x4e7bc8[_0x3f8095(0x171)],_0x93f95c=_0x4846bb['QbwPY'](_0x3422d2,_0x4846bb[_0x3f8095(0x158)])?_0x4846bb[_0x3f8095(0x177)]:_0x4846bb['oIYWO'](_0x3422d2,_0x4846bb[_0x3f8095(0x10e)])?'จบ':'';if(!_0x95baa0||![_0x4846bb[_0x3f8095(0x10e)],_0x4846bb['uooMK']][_0x3f8095(0x1c3)](_0x3422d2))return _0x2f1126[_0x3f8095(0x242)](JSON['stringify']({'isStatus':!0x1,'class':_0x4846bb[_0x3f8095(0x198)],'msg':_0x4846bb['pvFoN']}));const _0x366cdf={'docId':_0x95baa0,'userId':_0x53627a[_0x3f8095(0x1f0)]},_0x253345=_0x2c5636['db'](global[_0x3f8095(0x178)])['collection'](_0xa87926),_0x2714e8=await _0x253345[_0x3f8095(0x138)](_0x366cdf);if(!_0x2714e8)return _0x2f1126[_0x3f8095(0x242)](JSON[_0x3f8095(0x159)]({'isStatus':!0x1,'class':_0x4846bb['OuwCj'],'msg':_0x3f8095(0x230)+_0x95baa0+_0x3f8095(0x24a)+_0x93f95c+'เอกสารที่ตันเองไม่ได้สร้าง'}));const _0x11d9b0=_0x2714e8[_0x3f8095(0x216)];if(_0x4846bb['CiMFc'](_0x3422d2,_0x4846bb[_0x3f8095(0x158)])&&!(_0x4846bb[_0x3f8095(0x220)](_0x11d9b0,0x1)||_0x4846bb[_0x3f8095(0x128)](_0x11d9b0,0x2)))return _0x2f1126[_0x3f8095(0x242)](JSON['stringify']({'isStatus':!0x1,'class':_0x4846bb[_0x3f8095(0x198)],'msg':_0x4846bb[_0x3f8095(0x1f3)]}));if(_0x4846bb['CiMFc'](_0x3422d2,_0x4846bb['Sjcek'])&&_0x4846bb['QbwPY'](!_0x11d9b0,0x1))return _0x2f1126['send'](JSON['stringify']({'isStatus':!0x1,'class':_0x4846bb[_0x3f8095(0x198)],'msg':_0x4846bb['tlIoo']}));if(_0x4846bb[_0x3f8095(0x1ca)](_0x3422d2,_0x4846bb['uooMK'])){if(_0x4846bb['ePRhD'](_0x4846bb[_0x3f8095(0x16d)],_0x4846bb[_0x3f8095(0x16d)]))YiMGiG['dPkDR'](_0x2d2df7,0x0);else{if(_0x4846bb['OOZRG'](_0x2714e8[_0x3f8095(0x17f)],!0x1))return _0x2f1126[_0x3f8095(0x242)](JSON[_0x3f8095(0x159)]({'isStatus':!0x1,'class':_0x4846bb[_0x3f8095(0x198)],'msg':_0x3f8095(0x11f)+_0x95baa0+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));if(_0x4846bb[_0x3f8095(0x22e)]((await _0x45cf6e[_0x3f8095(0x111)](_0x2714e8,_0xa87926,_0x53627a['userId']))[_0x3f8095(0x17f)],!0x1))return _0x2f1126['send'](JSON[_0x3f8095(0x159)]({'isStatus':!0x1,'class':_0x4846bb[_0x3f8095(0x198)],'msg':_0x3f8095(0x11f)+_0x95baa0+_0x3f8095(0x1db)}));}}if(_0x4846bb[_0x3f8095(0xe1)](_0x3422d2,_0x4846bb[_0x3f8095(0x158)]))var _0x213261=0xa;else{if(_0x4846bb[_0x3f8095(0xe1)](_0x3422d2,_0x4846bb[_0x3f8095(0x10e)]))var _0x213261=0x2;}const _0x27a0ae=await _0x253345[_0x3f8095(0x181)](_0x366cdf,{'$set':{'docStatusNumber':_0x213261}});var _0x4f526c=_0x93f95c+'\x20\x22'+_0x95baa0+_0x3f8095(0x1b3);if(_0x27a0ae[_0x3f8095(0x228)]||_0x4846bb[_0x3f8095(0x1fd)](_0x27a0ae[_0x3f8095(0x1a2)],0x0)){if(_0x4846bb[_0x3f8095(0x1d8)](_0x4846bb[_0x3f8095(0x1ac)],_0x4846bb[_0x3f8095(0x1ac)])){if(_0xf31cd2){const _0x499e71=_0x29c0b8['apply'](_0x459c55,arguments);return _0x50f975=null,_0x499e71;}}else{const _0x213d0e=_0x45cf6e['getChangeHistory']({'docStatusNumber':_0x11d9b0},{'docStatusNumber':_0x213261});if(_0x4846bb[_0x3f8095(0x1fd)](_0x213d0e[_0x3f8095(0x172)],0x0)){if(_0x4846bb[_0x3f8095(0x1ba)](_0x4846bb[_0x3f8095(0x170)],_0x4846bb[_0x3f8095(0x170)])){const _0x2f1ed2={'dateTime':_0x3e40f6[_0x3f8095(0x1f7)]()[_0x3f8095(0x1ea)](_0x4846bb[_0x3f8095(0x1ae)])[_0x3f8095(0x206)](_0x4846bb[_0x3f8095(0x23b)]),'userId':_0x53627a[_0x3f8095(0x1f0)],'userFullname':_0x53627a[_0x3f8095(0x222)],'changes':_0x213d0e};await _0x253345[_0x3f8095(0x181)]({'docId':_0x95baa0},{'$push':{'changesHistory':{'$each':[_0x2f1ed2],'$position':0x0}}}),_0x4f526c+=_0x4846bb[_0x3f8095(0x16b)];}else YiMGiG[_0x3f8095(0xf3)](_0x3d7020,this,function(){const _0x124b9f=_0x3f8095,_0x52f360=new _0x3e769d(YiMGiG['InItD']),_0x3bacd7=new _0xeebc91(YiMGiG[_0x124b9f(0x11d)],'i'),_0x4103e5=YiMGiG[_0x124b9f(0xd3)](_0x16872b,YiMGiG[_0x124b9f(0xbf)]);!_0x52f360[_0x124b9f(0xfa)](YiMGiG[_0x124b9f(0x217)](_0x4103e5,YiMGiG[_0x124b9f(0xff)]))||!_0x3bacd7[_0x124b9f(0xfa)](YiMGiG[_0x124b9f(0x1ee)](_0x4103e5,YiMGiG[_0x124b9f(0x1b5)]))?YiMGiG[_0x124b9f(0xd3)](_0x4103e5,'0'):YiMGiG[_0x124b9f(0x1c6)](_0x4091be);})();}return _0x2f1126['send'](JSON[_0x3f8095(0x159)]({'isStatus':!0x0,'docId':_0x95baa0,'docStatusNumber':_0x213261,'class':_0x4846bb[_0x3f8095(0x14c)],'msg':_0x4f526c}));}}else{if(_0x27a0ae[_0x3f8095(0x228)]&&_0x4846bb[_0x3f8095(0x100)](_0x27a0ae['modifiedCount'],0x1))return _0x2f1126[_0x3f8095(0x242)](JSON[_0x3f8095(0x159)]({'isStatus':!0x1,'docId':_0x95baa0,'docStatusNumber':_0x11d9b0,'class':_0x4846bb[_0x3f8095(0x145)],'msg':'\x22'+_0x95baa0+_0x3f8095(0xd0)}));}}catch(_0x1ff261){console[_0x3f8095(0x120)](_0x1ff261),_0x2f1126['send'](JSON[_0x3f8095(0x159)]({'isStatus':!0x1,'class':_0x4846bb[_0x3f8095(0x198)],'msg':_0x1ff261['message']}));}finally{_0x2c5636[_0x3f8095(0x11e)]();}});export default b;function _0x5495bb(_0x5641db){const _0x66032a=_0x8c75f8,_0x3d2917={'FZepR':function(_0x2d86fc,_0x45b630){return _0x2d86fc===_0x45b630;},'YVGED':_0x66032a(0x166),'tbVwu':_0x66032a(0x196),'oMYwl':_0x66032a(0xf8),'kKuhB':function(_0x560ede,_0x3495bb){return _0x560ede!==_0x3495bb;},'kKDHS':function(_0x36f531,_0x5db7f4){return _0x36f531+_0x5db7f4;},'nfiMs':function(_0x27b835,_0x54d738){return _0x27b835/_0x54d738;},'RdKVt':_0x66032a(0x172),'ggKqv':function(_0x2ab9d9,_0x59e427){return _0x2ab9d9%_0x59e427;},'nOjAV':_0x66032a(0x192),'NPPIN':'gger','mUJFC':_0x66032a(0x133),'FWzQM':_0x66032a(0x19a),'TjiYH':function(_0x2d700b,_0x22a8d9){return _0x2d700b(_0x22a8d9);}};function _0x5a7118(_0x544d3e){const _0x1bc635=_0x66032a;if(_0x3d2917[_0x1bc635(0x106)](typeof _0x544d3e,_0x3d2917[_0x1bc635(0xd9)]))return function(_0x2b7974){}[_0x1bc635(0x194)](_0x3d2917['tbVwu'])[_0x1bc635(0xec)](_0x3d2917[_0x1bc635(0x23f)]);else _0x3d2917[_0x1bc635(0x173)](_0x3d2917[_0x1bc635(0x147)]('',_0x3d2917[_0x1bc635(0x117)](_0x544d3e,_0x544d3e))[_0x3d2917[_0x1bc635(0x174)]],0x1)||_0x3d2917[_0x1bc635(0x106)](_0x3d2917[_0x1bc635(0x15c)](_0x544d3e,0x14),0x0)?function(){return!![];}['constructor'](_0x3d2917[_0x1bc635(0x147)](_0x3d2917[_0x1bc635(0xea)],_0x3d2917[_0x1bc635(0x1e5)]))[_0x1bc635(0x116)](_0x3d2917[_0x1bc635(0x21e)]):function(){return![];}[_0x1bc635(0x194)](_0x3d2917['kKDHS'](_0x3d2917['nOjAV'],_0x3d2917[_0x1bc635(0x1e5)]))[_0x1bc635(0xec)](_0x3d2917[_0x1bc635(0x1e2)]);_0x3d2917['TjiYH'](_0x5a7118,++_0x544d3e);}try{if(_0x5641db)return _0x5a7118;else _0x3d2917[_0x66032a(0x238)](_0x5a7118,0x0);}catch(_0xc4ef8c){}}