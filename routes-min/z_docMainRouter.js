const _0x7a580c=_0x4f1d;(function(_0x2f4990,_0x58d6cb){const _0xa078eb=_0x4f1d,_0x246365=_0x2f4990();while(!![]){try{const _0x4c7302=-parseInt(_0xa078eb(0x15e))/0x1+parseInt(_0xa078eb(0xc4))/0x2*(parseInt(_0xa078eb(0xbe))/0x3)+parseInt(_0xa078eb(0x17f))/0x4+-parseInt(_0xa078eb(0x1af))/0x5*(-parseInt(_0xa078eb(0x192))/0x6)+-parseInt(_0xa078eb(0xfc))/0x7+-parseInt(_0xa078eb(0x184))/0x8+parseInt(_0xa078eb(0x1b9))/0x9*(parseInt(_0xa078eb(0xea))/0xa);if(_0x4c7302===_0x58d6cb)break;else _0x246365['push'](_0x246365['shift']());}catch(_0x2ac72c){_0x246365['push'](_0x246365['shift']());}}}(_0x277b,0x29fc8));function _0x277b(){const _0x16da9f=['XuBEw','docId','hZQQI','ZBlHE','constructor','vlXAj','bqAem','jmgVF','fyqov','toLowerCase','\x22\x20ไม่มีการเปลี่ยนแปลงข้อมูล','CzpdK','userFullname','SMZTQ','YHTnp','ALkWd','PPlya','docStatusNumber','kaCtv','40pyeaKg','wdjiC','cLpqm','CKcVi','LqaTS','NUWqM','input','eNgBe','fYsuG','StTfe','LmlgD','aSscW','convert_DataType','WiZQA','message','สร้างเอกสารใหม่\x20','RpbaX','getUserData','638295eKlAmC','end','ujKVJ','KZdae','IPwob','MiOqt','sgrWD','QoStX','getDateTime','hbVcZ','AXIfg','send','stringify','userId','qtYIc','jTarP','apply','zvrmS','DiMMP','application/octet-stream','red','xKoEI','NJVDO','FIips','kIjvx','MDNeS','YsuXx','jjQBB','ILroI','XhfpR','GTmTs','Thudr','green','chain','flash','ไม่สามารถอัปเดทเอกสารได้{{sep}}เนื่องจากสถานะเอกสารไม่ใช่\x201\x20แล้ว','check_DocDateTime_CanEdit','aYkDo','getChangeHistory','collection','prototype','DifcV','gcTYK','dateTimeCanCancel','ddSKy','POVRv','xFMNb','hOTAs','HlaqG','RXsWu','table','VLIMg','ybdsH','BwFgM','init','HBcWt','now','bCkCa','KHBWf','dateTimeEditRemain','dSJBv','bind','jSeOR','PATH_WAREHOUSE_OUT','toFormat','tFTqu','eAiZH','LHeyc','/save','yyyy-MM-dd\x20HH:mm','wZZlq','HXnUR','YqIdA','vkjfw','nIogN','uilBd','ovDQs','XiblT','{}.constructor(\x22return\x20this\x22)(\x20)','HXNbr','ejBmp','RCVRv','yPDvy','WCoca','HXYIp','yyyy-MM-dd','__proto__','slice','bCkrM','OdmsY','SLOsd','VfYJy','originalUrl','PPzIl','rwsIZ','acknowledged','status','สถานะเอกสารผิดผลาด','145372XMmnDW','RMCpx','ckvmB','while\x20(true)\x20{}','DrxmX','Kjcyo','wzric','get_Info_ByUrl','cgDoB','length','oLfoF','sQZCO','LxGes','eXPOJ','kdTXs','EXTey','console','TNySa','XmvZs','pcsOD','ZxWKm','lZkJP','sort','XopBC','Tquuz','lblOs','oskfh','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','Router','tOSWj','kvhXq','raHPa','mDNEx','1040760wUtfur','get','warehouseOut','test','dateTimeCancelRemain','399152AEkSOM','yellow','PAGE','setZone','limit','exception','wkByc','TmwJD','uccQG','\x20เรียบร้อยแล้ว{{sep}}[บันทึกการแก้ไข]','insertOne','sXRFw','extname','close','34548JPBqmR','NimYi','DOC_STATUS_TITLE','aHYnG','MVqLv','dehGp','cWRBo','อัปเดท\x20','HbdyO','fxluE','trnzr','PiEWT','/view-image','RmsQc','brREA','from','renderView','ไม่พบไฟล์รูปภาพ','updateOne','zwIOL','IYckd','padStart','pnJdv','Asia/Bangkok','wxvEy','LvAhw','PATH_SALES','qXsVp','xqses','95dDgTyt','BgDLZ','trace','WUVxr','bAzDk','jpeg','gZGwQ','toString','Ncjvj','dieIY','196821OUjcQU','return\x20(function()\x20','getSettings','Flwkl','QOPrQ','PdPgl','join','find','kSzbU','function\x20*\x5c(\x20*\x5c)','FgKgN','fPCSh','YQkDp','{{sep}}เรียบร้อยแล้ว','AuuYO','ไม่สามารถบันทึกเอกสารได้{{sep}}เนื่องจากเลยกำหนดยกเลิกเอกสารแล้ว','eaBMK','bPnvV','check_DocDateTime_CanCancel','\x20ได้','DFtRe','resize','dwYwK','body','hyqiR','userAuthority','เกิดข้อผิดพลาดในการดึงรูปภาพ','TOiif','WMdJU','info','getMainDocPathObj','hsYbD','canEdit','warn','SWsBd','log','QBcMp','Kresm','WcHAB','aXGIH','lxMvw','readFile','yjpwz','bomaJ','VJBnC','QuEGT','action','lrDDI','FAUeX','SNehl','thDAu','SbZtp','jokJd','AfbHr','lVTIb','counter','.jpg','query','BBqYJ','EYcFa','-00001','foHQy','stateObject','NNCzL','pRUdv','TfBsM','uirMP','lIECv','Kjkpg','split','image/jpeg','qksYn','cgTNC','ubMHg','cYsqC','isAuth','GJtjR','TfhLG','warehouseIn','gger','Error\x20reading\x20image:','debu','findOne','getFullYear','jMpTI','docMain','fIxcE','pTONJ','refImageBase64','VloSO','9bTDLGe','modifiedCount','post','mzPNs','LxEaI','dbUrl','906QAYZmP','LiSiN','UmGef','yjUqS','TXYDL','bevDp','PqvFl','error','writeHead','VwWrU','vRuWG','JkrAX','lqrnS','UVMYQ','objLs','zahCO','aVwJm','gzKSu','GKMzk'];_0x277b=function(){return _0x16da9f;};return _0x277b();}const _0x186c27=(function(){const _0x391185=_0x4f1d,_0x284e81={'vkjfw':function(_0x58221b,_0x2ba6dd){return _0x58221b===_0x2ba6dd;},'YQkDp':_0x391185(0xa7),'KZdae':function(_0x507ea6,_0xca5129){return _0x507ea6!==_0xca5129;},'bCkrM':_0x391185(0xc7),'NJVDO':function(_0x11a6d4,_0x2dfb54){return _0x11a6d4===_0x2dfb54;},'fYsuG':'CDaQD','LmlgD':_0x391185(0x1d8)};let _0x10457e=!![];return function(_0x1578e6,_0xd03ca1){const _0x526b00=_0x391185;if(_0x284e81[_0x526b00(0x112)](_0x284e81[_0x526b00(0xf2)],_0x284e81[_0x526b00(0xf4)])){const _0x2531f0=_0x2c9f8e[_0x526b00(0xdb)][_0x526b00(0x124)]['bind'](_0x110643),_0x3d4850=_0x275e57[_0x59bc4f],_0x38b7b7=_0xc3200b[_0x3d4850]||_0x2531f0;_0x2531f0['__proto__']=_0x1fac8a[_0x526b00(0x139)](_0x30b022),_0x2531f0[_0x526b00(0x1b6)]=_0x38b7b7[_0x526b00(0x1b6)][_0x526b00(0x139)](_0x38b7b7),_0x310913[_0x3d4850]=_0x2531f0;}else{const _0x417a46=_0x10457e?function(){const _0x5bde9e=_0x526b00;if(_0x284e81[_0x5bde9e(0x145)](_0x284e81[_0x5bde9e(0x1c5)],_0x284e81[_0x5bde9e(0x1c5)])){if(_0xd03ca1){if(_0x284e81[_0x5bde9e(0xff)](_0x284e81[_0x5bde9e(0x154)],_0x284e81[_0x5bde9e(0x154)])){if(_0x484790){const _0x25d0f2=_0x1d4ae8['apply'](_0x4a2a48,arguments);return _0x2ae869=null,_0x25d0f2;}}else{const _0x1a2286=_0xd03ca1[_0x5bde9e(0x10c)](_0x1578e6,arguments);return _0xd03ca1=null,_0x1a2286;}}}else{const _0x1a08ce=_0x3204bb?function(){if(_0x5cfbf1){const _0x3f85d6=_0x55b4b1['apply'](_0x2971f8,arguments);return _0x3fbe61=null,_0x3f85d6;}}:function(){};return _0x1717c0=![],_0x1a08ce;}}:function(){};return _0x10457e=![],_0x417a46;}};}());(function(){const _0x50e1f0=_0x4f1d,_0x33a8ac={'XiblT':_0x50e1f0(0x1a3),'VLIMg':_0x50e1f0(0xaa),'EYcFa':_0x50e1f0(0xb4),'CZJVe':_0x50e1f0(0x1d3),'dSJBv':_0x50e1f0(0x10f),'QOPrQ':_0x50e1f0(0x1c2),'FIips':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','SMZTQ':function(_0x52f365,_0xadf2f0){return _0x52f365(_0xadf2f0);},'eNgBe':_0x50e1f0(0x132),'ntsuW':function(_0x12eed3,_0xa8f022){return _0x12eed3+_0xa8f022;},'DrxmX':_0x50e1f0(0x11d),'XopBC':_0x50e1f0(0xf0),'DifcV':function(_0x2c17eb){return _0x2c17eb();},'eXPOJ':function(_0x24d5bb,_0x553635,_0x42b5b0){return _0x24d5bb(_0x553635,_0x42b5b0);},'aSscW':function(_0x87f3e0,_0x262de3){return _0x87f3e0===_0x262de3;},'jJVDx':_0x50e1f0(0x13a),'ckvmB':function(_0x3d876d,_0x5702ea){return _0x3d876d(_0x5702ea);},'ReKEz':function(_0x285e5b,_0x57f225){return _0x285e5b+_0x57f225;},'kizZe':function(_0xa5400a,_0xb355e9){return _0xa5400a+_0xb355e9;},'Kjcyo':function(_0x800f43,_0x5382e1){return _0x800f43!==_0x5382e1;},'NqltM':_0x50e1f0(0xda),'vhZWi':'audkg','dehGp':function(_0x429897,_0x247172){return _0x429897(_0x247172);},'fymoW':_0x50e1f0(0x1a6),'wsZgf':_0x50e1f0(0xc6),'MiOqt':function(_0x2912b9,_0x36e656,_0x5c6607){return _0x2912b9(_0x36e656,_0x5c6607);}};_0x33a8ac[_0x50e1f0(0x101)](_0x186c27,this,function(){const _0x52b0b2=_0x50e1f0,_0x436c63={'ybdsH':_0x33a8ac[_0x52b0b2(0x9f)],'yjpwz':_0x33a8ac['CZJVe'],'TwSqc':_0x33a8ac[_0x52b0b2(0x138)],'PiEWT':_0x33a8ac[_0x52b0b2(0x1bd)],'thDAu':_0x33a8ac[_0x52b0b2(0x113)],'CzpdK':function(_0x2fed02,_0x43af13){return _0x33a8ac['SMZTQ'](_0x2fed02,_0x43af13);},'LGxDW':_0x33a8ac[_0x52b0b2(0xf1)],'EXTey':function(_0x52da0b,_0x1820dd){return _0x33a8ac['ntsuW'](_0x52da0b,_0x1820dd);},'ahPag':_0x33a8ac[_0x52b0b2(0x162)],'IMMXC':_0x33a8ac[_0x52b0b2(0x175)],'kJKiq':function(_0x1fe86c,_0x25b865){const _0x1b8188=_0x52b0b2;return _0x33a8ac[_0x1b8188(0xe4)](_0x1fe86c,_0x25b865);},'fPCSh':function(_0x590ce7){const _0x45e026=_0x52b0b2;return _0x33a8ac[_0x45e026(0x125)](_0x590ce7);},'azLBt':function(_0x431344,_0x5a4265,_0x2b92a1){const _0x5953ae=_0x52b0b2;return _0x33a8ac[_0x5953ae(0x16b)](_0x431344,_0x5a4265,_0x2b92a1);}};if(_0x33a8ac[_0x52b0b2(0xf5)](_0x33a8ac['jJVDx'],_0x33a8ac['jJVDx'])){const _0x1b21a6=new RegExp(_0x33a8ac[_0x52b0b2(0x1bd)]),_0x396762=new RegExp(_0x33a8ac['FIips'],'i'),_0x114f28=_0x33a8ac[_0x52b0b2(0x160)](_0x1dc8a0,_0x33a8ac[_0x52b0b2(0xf1)]);if(!_0x1b21a6[_0x52b0b2(0x182)](_0x33a8ac['ReKEz'](_0x114f28,_0x33a8ac[_0x52b0b2(0x162)]))||!_0x396762[_0x52b0b2(0x182)](_0x33a8ac['kizZe'](_0x114f28,_0x33a8ac[_0x52b0b2(0x175)]))){if(_0x33a8ac['Kjcyo'](_0x33a8ac['NqltM'],_0x33a8ac['vhZWi']))_0x33a8ac[_0x52b0b2(0x197)](_0x114f28,'0');else{const {filename:_0x3a4f1a}=_0x4699b3['body'];if(!_0x3a4f1a)return _0x21a9da[_0x52b0b2(0x15c)](0x190)[_0x52b0b2(0x107)](_0x33a8ac[_0x52b0b2(0x149)]);const {folderName:_0xd43b78}=_0xde1802[_0x52b0b2(0x165)](_0x16958c['originalUrl']),_0x5c6faa=_0x3ba780[_0x52b0b2(0x1bf)](_0xd43b78,_0x3a4f1a),_0x37006d=_0x1e1600[_0x52b0b2(0x190)](_0x3a4f1a)[_0x52b0b2(0xe0)](),_0x1005cd={'.jpg':_0x33a8ac[_0x52b0b2(0x12f)],'.jpeg':_0x33a8ac[_0x52b0b2(0x12f)]};_0x5a6a5d[_0x52b0b2(0x1e2)](_0x5c6faa,(_0x522ca0,_0x2cd696)=>{const _0x446689=_0x52b0b2;if(_0x522ca0)return _0x2ec711[_0x446689(0xcb)](_0x436c63[_0x446689(0x130)],_0x522ca0),_0x27e57b[_0x446689(0x15c)](0x1f4)[_0x446689(0x107)](_0x436c63[_0x446689(0x1e3)]);const _0x22b57c=_0x1005cd[_0x37006d]||_0x436c63['TwSqc'];_0x401550['writeHead'](0xc8,{'Content-Type':_0x22b57c}),_0x56fa05['end'](_0x2cd696);});}}else _0x33a8ac[_0x52b0b2(0x163)](_0x33a8ac['fymoW'],_0x33a8ac['wsZgf'])?_0x33a8ac[_0x52b0b2(0x125)](_0x1dc8a0):_0x436c63['azLBt'](_0x44f5ca,this,function(){const _0x55e677=_0x52b0b2,_0x4936f2=new _0x320036(_0x436c63[_0x55e677(0x19d)]),_0x508450=new _0x28651e(_0x436c63[_0x55e677(0x1eb)],'i'),_0xf5ee78=_0x436c63[_0x55e677(0xe2)](_0x43996a,_0x436c63['LGxDW']);!_0x4936f2[_0x55e677(0x182)](_0x436c63[_0x55e677(0x16d)](_0xf5ee78,_0x436c63['ahPag']))||!_0x508450['test'](_0x436c63[_0x55e677(0x16d)](_0xf5ee78,_0x436c63['IMMXC']))?_0x436c63['kJKiq'](_0xf5ee78,'0'):_0x436c63[_0x55e677(0x1c4)](_0x1a8406);})();}else _0x436c63['CzpdK'](_0x498533,0x0);})();}());const _0x16e05b=(function(){const _0x3a8b4a=_0x4f1d,_0x429cf2={'PPlya':_0x3a8b4a(0x1c2),'SVWFD':_0x3a8b4a(0x179),'HlaqG':function(_0x3a1fa3,_0x56da15){return _0x3a1fa3(_0x56da15);},'HmMAG':'init','kKmxH':function(_0x5ef88a,_0x49cb91){return _0x5ef88a+_0x49cb91;},'zvrmS':_0x3a8b4a(0x11d),'FTTnQ':_0x3a8b4a(0xf0),'jokJd':function(_0x3b58c8){return _0x3b58c8();},'pRUdv':function(_0x385333,_0x2dae6e){return _0x385333!==_0x2dae6e;},'hZQQI':_0x3a8b4a(0x1a8),'XmvZs':_0x3a8b4a(0xad),'QuEGT':_0x3a8b4a(0x9a),'oLfoF':function(_0x233b2d,_0xa39794){return _0x233b2d===_0xa39794;},'LHeyc':_0x3a8b4a(0x1b7),'tOSWj':_0x3a8b4a(0x17c)};let _0x215ffd=!![];return function(_0x296074,_0x1d0547){const _0x5ed0e5=_0x3a8b4a,_0x39d631={'hbVcZ':_0x429cf2[_0x5ed0e5(0xe7)],'bqAem':_0x429cf2['SVWFD'],'sQZCO':function(_0x45bf19,_0x5a870f){const _0x56c2a0=_0x5ed0e5;return _0x429cf2[_0x56c2a0(0x12c)](_0x45bf19,_0x5a870f);},'eAiZH':_0x429cf2['HmMAG'],'uirMP':function(_0x50dbf1,_0x53c364){return _0x429cf2['kKmxH'](_0x50dbf1,_0x53c364);},'ywEpH':_0x429cf2[_0x5ed0e5(0x10d)],'GMLyk':_0x429cf2['FTTnQ'],'hICWe':function(_0x4a0c93){const _0x3c3068=_0x5ed0e5;return _0x429cf2[_0x3c3068(0x1ed)](_0x4a0c93);},'WcHAB':function(_0x22c6d8,_0x460157){return _0x429cf2['pRUdv'](_0x22c6d8,_0x460157);},'ujKVJ':_0x429cf2[_0x5ed0e5(0xd9)],'YyKYG':function(_0x3e5216,_0xc9001){const _0x3e366e=_0x5ed0e5;return _0x429cf2[_0x3e366e(0xa4)](_0x3e5216,_0xc9001);},'TNySa':_0x429cf2[_0x5ed0e5(0x170)],'uilBd':_0x429cf2[_0x5ed0e5(0x1e6)]};if(_0x429cf2[_0x5ed0e5(0x168)](_0x429cf2[_0x5ed0e5(0x13f)],_0x429cf2[_0x5ed0e5(0x17b)])){const _0x4495ca=_0x3ec9d3[_0x5ed0e5(0x10c)](_0x5e7d67,arguments);return _0xb956fc=null,_0x4495ca;}else{const _0x167504=_0x215ffd?function(){const _0x12938b=_0x5ed0e5,_0x2a93fb={'RMCpx':_0x39d631[_0x12938b(0x105)],'mbCxQ':_0x39d631[_0x12938b(0xdd)],'QoStX':function(_0x2e2b2e,_0x5d108e){const _0x1bf8fc=_0x12938b;return _0x39d631[_0x1bf8fc(0x169)](_0x2e2b2e,_0x5d108e);},'YsuXx':_0x39d631[_0x12938b(0x13e)],'VJBnC':function(_0x214c99,_0x361570){const _0x37aebe=_0x12938b;return _0x39d631[_0x37aebe(0xa6)](_0x214c99,_0x361570);},'LiSiN':_0x39d631['ywEpH'],'HbdyO':_0x39d631['GMLyk'],'qksYn':function(_0x248345){return _0x39d631['hICWe'](_0x248345);}};if(_0x39d631[_0x12938b(0x1df)](_0x39d631['ujKVJ'],_0x39d631[_0x12938b(0xfe)])){const _0x5ab640=new _0x3643dc(_0x2a93fb[_0x12938b(0x15f)]),_0x5e9580=new _0x27d33d(_0x2a93fb['mbCxQ'],'i'),_0x1883a1=_0x2a93fb['QoStX'](_0x118e1e,_0x2a93fb[_0x12938b(0x116)]);!_0x5ab640['test'](_0x2a93fb[_0x12938b(0x1e5)](_0x1883a1,_0x2a93fb[_0x12938b(0xc5)]))||!_0x5e9580[_0x12938b(0x182)](_0x2a93fb[_0x12938b(0x1e5)](_0x1883a1,_0x2a93fb[_0x12938b(0x19a)]))?_0x2a93fb[_0x12938b(0x103)](_0x1883a1,'0'):_0x2a93fb[_0x12938b(0xab)](_0x300fc3);}else{if(_0x1d0547){if(_0x39d631['YyKYG'](_0x39d631[_0x12938b(0x16f)],_0x39d631[_0x12938b(0x147)])){const _0x3e1cc2=_0x1d0547[_0x12938b(0x10c)](_0x296074,arguments);return _0x1d0547=null,_0x3e1cc2;}else return!![];}}}:function(){};return _0x215ffd=![],_0x167504;}};}()),_0x4554e4=_0x16e05b(this,function(){const _0x130b72=_0x4f1d,_0x1c383d={'xqses':function(_0x109191,_0x2042b1){return _0x109191+_0x2042b1;},'RCVRv':'debu','MVqLv':_0x130b72(0xb3),'mzPNs':_0x130b72(0x1e7),'QiFLT':function(_0x341e6e,_0x2b1bb5){return _0x341e6e(_0x2b1bb5);},'zellS':function(_0x10ca90,_0x313c48){return _0x10ca90(_0x313c48);},'zwIOL':_0x130b72(0x1ba),'cgTNC':_0x130b72(0x14a),'vlXAj':function(_0x516313){return _0x516313();},'rwsIZ':function(_0x14f367,_0x5085b7){return _0x14f367!==_0x5085b7;},'hqzeL':_0x130b72(0x1d1),'xKoEI':function(_0xa9856f,_0x296b67){return _0xa9856f(_0x296b67);},'TOiif':function(_0x192135,_0x537811){return _0x192135+_0x537811;},'GTmTs':function(_0x2799f1,_0x433d1d){return _0x2799f1+_0x433d1d;},'hiwtQ':function(_0xaed9f2){return _0xaed9f2();},'BBqYJ':'FrbmV','PMfKd':'LAbdv','ieMLq':_0x130b72(0x1dc),'Uawxq':'warn','qtYIc':_0x130b72(0x1d6),'lxMvw':_0x130b72(0xcb),'QBcMp':'exception','SbZtp':_0x130b72(0x12e),'uIstn':_0x130b72(0x1b1),'LxGes':function(_0x430ad2,_0x42a47a){return _0x430ad2<_0x42a47a;},'jTarP':function(_0x50fbdb,_0x3c937f){return _0x50fbdb===_0x3c937f;},'fxluE':_0x130b72(0x166),'bCkCa':_0x130b72(0x1b8)};let _0xa590a5;try{if(_0x1c383d[_0x130b72(0x15a)](_0x1c383d['hqzeL'],_0x1c383d['hqzeL']))(function(){return!![];}[_0x130b72(0xdb)](_0x1c383d[_0x130b72(0x1ae)](_0x1c383d[_0x130b72(0x14d)],_0x1c383d[_0x130b72(0x196)]))['call'](_0x1c383d[_0x130b72(0xc1)]));else{const _0x1d2f70=_0x1c383d[_0x130b72(0x111)](Function,_0x1c383d[_0x130b72(0x1d4)](_0x1c383d[_0x130b72(0x11a)](_0x1c383d[_0x130b72(0x1a5)],_0x1c383d[_0x130b72(0xac)]),');'));_0xa590a5=_0x1c383d['hiwtQ'](_0x1d2f70);}}catch(_0xf00d1f){_0x1c383d[_0x130b72(0x15a)](_0x1c383d[_0x130b72(0x9e)],_0x1c383d['PMfKd'])?_0xa590a5=window:_0x1c383d['QiFLT'](_0x5046f9,'0');}const _0x4d77d8=_0xa590a5[_0x130b72(0x16e)]=_0xa590a5[_0x130b72(0x16e)]||{},_0x1a302c=[_0x1c383d['ieMLq'],_0x1c383d['Uawxq'],_0x1c383d[_0x130b72(0x10a)],_0x1c383d[_0x130b72(0x1e1)],_0x1c383d[_0x130b72(0x1dd)],_0x1c383d[_0x130b72(0x1ec)],_0x1c383d['uIstn']];for(let _0x17602b=0x0;_0x1c383d[_0x130b72(0x16a)](_0x17602b,_0x1a302c[_0x130b72(0x167)]);_0x17602b++){if(_0x1c383d[_0x130b72(0x10b)](_0x1c383d[_0x130b72(0x19b)],_0x1c383d[_0x130b72(0x135)])){const _0x199a0b=_0x1c383d['zellS'](_0x360f7d,_0x1c383d['xqses'](_0x1c383d[_0x130b72(0x1ae)](_0x1c383d[_0x130b72(0x1a5)],_0x1c383d[_0x130b72(0xac)]),');'));_0x408b2b=_0x1c383d[_0x130b72(0xdc)](_0x199a0b);}else{const _0x3d902a=_0x16e05b['constructor']['prototype'][_0x130b72(0x139)](_0x16e05b),_0x38ca4f=_0x1a302c[_0x17602b],_0x24e209=_0x4d77d8[_0x38ca4f]||_0x3d902a;_0x3d902a[_0x130b72(0x152)]=_0x16e05b[_0x130b72(0x139)](_0x16e05b),_0x3d902a['toString']=_0x24e209[_0x130b72(0x1b6)][_0x130b72(0x139)](_0x24e209),_0x4d77d8[_0x38ca4f]=_0x3d902a;}}});_0x4554e4();import _0x5a8770 from'path';import _0x4a78e8 from'fs';import _0x4efccb from'sharp';import _0x5132a1 from'express';const I=_0x5132a1[_0x7a580c(0x17a)]();import{MongoClient as _0x2cc900}from'mongodb';import*as _0x2a473f from'../mymodule/myDateTime.js';import*as _0x2a6b12 from'../mymodule/myUsers.js';import*as _0x123fb7 from'../mymodule/myModule.js';import*as _0x470856 from'../mymodule/myData.js';import*as _0x55f525 from'../mymodule/myDocMain.js';import _0x481df9 from'../middleware/mainAuth.js';import{DateTime as _0x54519f}from'luxon';function _0x4f1d(_0x385867,_0x5b9597){const _0x530f63=_0x277b();return _0x4f1d=function(_0x4554e4,_0x16e05b){_0x4554e4=_0x4554e4-0x9a;let _0x26dc1e=_0x530f63[_0x4554e4];return _0x26dc1e;},_0x4f1d(_0x385867,_0x5b9597);}const N=global['PATH_WAREHOUSE_IN'],O=global[_0x7a580c(0x13b)],v=global[_0x7a580c(0x1ac)],k=[N,O,v],F=[N+'/save',O+_0x7a580c(0x140),v+'/save'],B=[N+_0x7a580c(0x19e),O+_0x7a580c(0x19e)];I[_0x7a580c(0x180)](k,_0x481df9[_0x7a580c(0xaf)],async(_0x5dd89e,_0x5add1d)=>{const _0x53dc8d=_0x7a580c,_0x5a8b2c={'wkByc':function(_0x357d53,_0x20a6d0){return _0x357d53(_0x20a6d0);},'IPwob':function(_0x1ab2e8,_0x3d6bb2){return _0x1ab2e8+_0x3d6bb2;},'LxEaI':'return\x20(function()\x20','UVMYQ':_0x53dc8d(0x14a),'RXsWu':function(_0xc923db){return _0xc923db();},'bomaJ':_0x53dc8d(0x1dc),'LWjwF':_0x53dc8d(0x1da),'XhfpR':_0x53dc8d(0x1d6),'bPnvV':_0x53dc8d(0xcb),'Kjkpg':_0x53dc8d(0x189),'Jnmqv':_0x53dc8d(0x12e),'sXRFw':_0x53dc8d(0x1b1),'TXYDL':function(_0x3d4f53,_0x148c32){return _0x3d4f53<_0x148c32;},'pTONJ':function(_0x24bcce,_0x204590){return _0x24bcce!==_0x204590;},'YHTnp':_0x53dc8d(0x19c),'AuuYO':_0x53dc8d(0xb9),'HBcWt':_0x53dc8d(0x1a9),'VloSO':_0x53dc8d(0x151),'yPDvy':'msg','ovDQs':_0x53dc8d(0xd3)},{docId:_0x30a9a6,sip:_0x190c44}=_0x5dd89e[_0x53dc8d(0x9d)];try{if(_0x5a8b2c[_0x53dc8d(0xbb)](_0x5a8b2c[_0x53dc8d(0xe5)],_0x5a8b2c['YHTnp'])){let _0x1cbbbb;try{const _0xb4eac2=pYwBHV[_0x53dc8d(0x18a)](_0x1e1279,pYwBHV[_0x53dc8d(0x100)](pYwBHV[_0x53dc8d(0x100)](pYwBHV[_0x53dc8d(0xc2)],pYwBHV[_0x53dc8d(0xd1)]),');'));_0x1cbbbb=pYwBHV[_0x53dc8d(0x12d)](_0xb4eac2);}catch(_0x1ef711){_0x1cbbbb=_0x531eab;}const _0x3a8d6a=_0x1cbbbb[_0x53dc8d(0x16e)]=_0x1cbbbb[_0x53dc8d(0x16e)]||{},_0x1cdcb3=[pYwBHV[_0x53dc8d(0x1e4)],pYwBHV['LWjwF'],pYwBHV[_0x53dc8d(0x119)],pYwBHV[_0x53dc8d(0x1ca)],pYwBHV[_0x53dc8d(0xa8)],pYwBHV['Jnmqv'],pYwBHV[_0x53dc8d(0x18f)]];for(let _0x49cd03=0x0;pYwBHV[_0x53dc8d(0xc8)](_0x49cd03,_0x1cdcb3['length']);_0x49cd03++){const _0x1b0493=_0x28fd8c['constructor'][_0x53dc8d(0x124)]['bind'](_0x333ee4),_0xd8346c=_0x1cdcb3[_0x49cd03],_0x43a664=_0x3a8d6a[_0xd8346c]||_0x1b0493;_0x1b0493[_0x53dc8d(0x152)]=_0x17791a[_0x53dc8d(0x139)](_0x48eb38),_0x1b0493[_0x53dc8d(0x1b6)]=_0x43a664[_0x53dc8d(0x1b6)][_0x53dc8d(0x139)](_0x43a664),_0x3a8d6a[_0xd8346c]=_0x1b0493;}}else{const _0x37bcc5=await _0x2a6b12[_0x53dc8d(0xfb)](_0x5dd89e),_0x8578f1=await _0x55f525['getMainDocPathObj'](_0x5dd89e,_0x5add1d,_0x37bcc5['userAuthority']),_0x5e5e62=await _0x123fb7[_0x53dc8d(0x1a2)](_0x5a8b2c[_0x53dc8d(0x1c7)],_0x5add1d,{'title':_0x8578f1[_0x53dc8d(0x186)],'time':_0x54519f['now']()[_0x53dc8d(0x187)](_0x5a8b2c[_0x53dc8d(0x133)])[_0x53dc8d(0x13c)](_0x5a8b2c[_0x53dc8d(0xbd)]),'msg':_0x5dd89e[_0x53dc8d(0x11e)](_0x5a8b2c[_0x53dc8d(0x14e)]),'user':_0x37bcc5,...await _0x123fb7[_0x53dc8d(0x1bb)](),..._0x8578f1,'DOC_STATUS_TITLE':global[_0x53dc8d(0x194)],'DOC_ID':_0x30a9a6,'SIP':_0x190c44});_0x5add1d[_0x53dc8d(0x107)](_0x5e5e62);}}catch(_0x2bd068){if(_0x5a8b2c[_0x53dc8d(0xbb)](_0x5a8b2c[_0x53dc8d(0x148)],_0x5a8b2c['ovDQs']))return _0x26ec4e;else console[_0x53dc8d(0x1dc)](_0x2bd068[_0x53dc8d(0xf8)]),_0x5add1d[_0x53dc8d(0x15c)](0x194)['sendFile'](file404);}}),I[_0x7a580c(0xc0)](F,_0x481df9[_0x7a580c(0xaf)],async(_0x4b570c,_0x322d4f)=>{const _0x5e2ad5=_0x7a580c,_0x4436dc={'wzric':_0x5e2ad5(0x110),'GKMzk':function(_0x376684){return _0x376684();},'kSzbU':_0x5e2ad5(0xb4),'bevDp':_0x5e2ad5(0x1d3),'WCoca':'application/octet-stream','gzKSu':function(_0x4dfd8e,_0xc51161){return _0x4dfd8e+_0xc51161;},'kIjvx':_0x5e2ad5(0xb5),'kdTXs':'gger','jUGxV':_0x5e2ad5(0xa2),'VtJOt':function(_0xc4a294,_0xfab9ba){return _0xc4a294(_0xfab9ba);},'AXIfg':'while\x20(true)\x20{}','jmgVF':_0x5e2ad5(0x9b),'Thudr':function(_0x41a010,_0x9adac7){return _0x41a010!==_0x9adac7;},'Flwkl':'hmEUF','cYsqC':function(_0x17499a,_0x38f443){return _0x17499a===_0x38f443;},'WMdJU':_0x5e2ad5(0x1e0),'tFTqu':_0x5e2ad5(0x1b0),'aVwJm':function(_0x15d96d,_0x1685d2){return _0x15d96d(_0x1685d2);},'nIogN':function(_0x19ea5c,_0xb049ae){return _0x19ea5c&&_0xb049ae;},'DygRi':function(_0x4d7de3,_0x3643c0){return _0x4d7de3!==_0x3643c0;},'raHPa':_0x5e2ad5(0x1b5),'mDNEx':function(_0x15a430,_0x40da47){return _0x15a430==_0x40da47;},'StTfe':_0x5e2ad5(0xb2),'oskfh':function(_0x5b9b88,_0x29f99f){return _0x5b9b88==_0x29f99f;},'SLOsd':_0x5e2ad5(0x181),'lblOs':function(_0x3bc837,_0x2f8b4a){return _0x3bc837==_0x2f8b4a;},'XuBEw':'sales','aHYnG':function(_0xcd4192,_0x577607){return _0xcd4192>_0x577607;},'FAUeX':function(_0x277773,_0x1ba9e9){return _0x277773===_0x1ba9e9;},'qXsVp':_0x5e2ad5(0x1ea),'WUVxr':'usGtM','fyqov':function(_0x1e2432,_0x12ac1a){return _0x1e2432(_0x12ac1a);},'OspJg':function(_0x49a839,_0x59a389){return _0x49a839(_0x59a389);},'klViH':function(_0x2191f1,_0x487af6){return _0x2191f1+_0x487af6;},'kaCtv':'Asia/Bangkok','foHQy':_0x5e2ad5(0x141),'uccQG':function(_0x14808c,_0x57b256){return _0x14808c!==_0x57b256;},'OdmsY':_0x5e2ad5(0xcf),'WiZQA':'base64','qpeto':function(_0x1ea10d,_0x41c336){return _0x1ea10d*_0x41c336;},'jMpTI':function(_0x5d00f5,_0x14105b){return _0x5d00f5*_0x14105b;},'BwFgM':_0x5e2ad5(0x11c),'POVRv':function(_0x1d3e63,_0x425849){return _0x1d3e63==_0x425849;},'lqrnS':function(_0x18f5d7,_0x5ed04a){return _0x18f5d7!==_0x5ed04a;},'NUWqM':_0x5e2ad5(0x1a0),'zHIyL':'ไม่สามารถแก้ไขเอกสารนี้ได้{{sep}}หากต้องการแก้ไข{{sep}}กรุณายกเลิกเอกสารนี้แล้วสร้างใหม่','PqvFl':'ไม่พบเอกสารที่ต้องการอัปเดท\x20หรือ{{sep}}ไม่สามารถบันทึกเอกสารที่ตนเองไม่ได้สร้าง','lfmzg':function(_0x4c9e4a,_0x54ae48){return _0x4c9e4a!=_0x54ae48;},'BGDuv':_0x5e2ad5(0x11f),'jZkMa':function(_0x21b383,_0x4bc186){return _0x21b383==_0x4bc186;},'hOTAs':_0x5e2ad5(0xd2),'ddSKy':_0x5e2ad5(0x14c),'LqaTS':function(_0x4718b1,_0x369126){return _0x4718b1==_0x369126;},'TgViP':'เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ','fIxcE':function(_0x52193b,_0x229063){return _0x52193b==_0x229063;},'PdPgl':'JIdot','fBGwf':_0x5e2ad5(0xec),'dwYwK':_0x5e2ad5(0x1c8),'RrXiB':_0x5e2ad5(0x157),'xFMNb':_0x5e2ad5(0xcd),'Kresm':function(_0x5a0df9,_0x28d0cb){return _0x5a0df9===_0x28d0cb;},'AfbHr':_0x5e2ad5(0xed),'RmsQc':_0x5e2ad5(0x102),'bAzDk':function(_0x20fb42,_0x569d2c){return _0x20fb42>_0x569d2c;},'ILroI':function(_0x5b1b3e,_0x1e7e08){return _0x5b1b3e===_0x1e7e08;},'LvAhw':_0x5e2ad5(0xeb),'KHBWf':'qCFYG','dmyRw':function(_0x2f1e5e,_0x441adc){return _0x2f1e5e<_0x441adc;},'RpbaX':_0x5e2ad5(0x185),'FgKgN':function(_0x29e335,_0x44a96c){return _0x29e335==_0x44a96c;},'aYkDo':_0x5e2ad5(0x15d),'wZZlq':function(_0x4cc832,_0x1a6fb3){return _0x4cc832!==_0x1a6fb3;},'DFtRe':_0x5e2ad5(0xb1),'QXTzP':_0x5e2ad5(0x176),'CyzsS':'jVuIT'};await _0x55f525[_0x5e2ad5(0x1d7)](_0x4b570c,_0x322d4f);const _0x2d1331=new _0x2cc900(global[_0x5e2ad5(0xc3)]);await _0x2d1331['connect']();try{if(_0x4436dc['Thudr'](_0x4436dc[_0x5e2ad5(0x1bc)],_0x4436dc['Flwkl']))_0x342652['log'](_0x2958b0),_0x873b17['send'](_0x577bbc[_0x5e2ad5(0x108)]({'isSave':!0x1,'class':_0x4436dc[_0x5e2ad5(0x164)],'msg':_0x5e1173['message']}));else{const _0xd114d7=await _0x2a6b12[_0x5e2ad5(0xfb)](_0x4b570c);if(_0x4b570c[_0x5e2ad5(0x1d0)]=_0x470856[_0x5e2ad5(0xf6)](_0x4b570c['body']),_0x4b570c[_0x5e2ad5(0x1d0)][_0x5e2ad5(0xbc)]){if(_0x4436dc[_0x5e2ad5(0xae)](_0x4436dc[_0x5e2ad5(0x1d5)],_0x4436dc[_0x5e2ad5(0x13d)]))KAoPQb[_0x5e2ad5(0xd6)](_0x449a97);else{var _0x166198=_0x4b570c[_0x5e2ad5(0x1d0)][_0x5e2ad5(0xbc)]?_0x4b570c['body'][_0x5e2ad5(0xbc)]:null;delete _0x4b570c['body']['refImageBase64'];}}const _0x3a9ad0=_0x4b570c[_0x5e2ad5(0x1d0)][_0x5e2ad5(0xe8)]?_0x4436dc[_0x5e2ad5(0xd4)](Number,_0x4b570c[_0x5e2ad5(0x1d0)][_0x5e2ad5(0xe8)]):_0x4b570c['body']['docStatusNumber'],_0x41f5ad=_0x4b570c[_0x5e2ad5(0x1d0)][_0x5e2ad5(0xd8)],{collectionName:_0x190409,docType:_0xbd5cb4,hoursCanEdit:_0x378615,hoursCanCancel:_0xb526b6}=_0x470856['get_Info_ByUrl'](_0x4b570c[_0x5e2ad5(0x158)]),_0x4203e5=_0x2d1331['db'](global['dbName'])[_0x5e2ad5(0x123)](_0x190409);if(_0x4436dc[_0x5e2ad5(0x146)](!_0x3a9ad0,!_0x41f5ad)){if(_0x4436dc['DygRi'](_0x4436dc[_0x5e2ad5(0x17d)],_0x4436dc['raHPa'])){if(_0x2325a1)return _0x4d7d72[_0x5e2ad5(0xcb)](_0x4436dc[_0x5e2ad5(0x1c1)],_0x5897de),_0x1096ce[_0x5e2ad5(0x15c)](0x1f4)[_0x5e2ad5(0x107)](_0x4436dc[_0x5e2ad5(0xc9)]);const _0x46cc4c=_0x1f9008[_0x4edebd]||_0x4436dc[_0x5e2ad5(0x14f)];_0x336c5e[_0x5e2ad5(0xcc)](0xc8,{'Content-Type':_0x46cc4c}),_0xe940a8[_0x5e2ad5(0xfd)](_0x55e5f5);}else{const _0x281a02=await _0x4203e5[_0x5e2ad5(0x1c0)]()[_0x5e2ad5(0x174)]({'_id':-0x1})[_0x5e2ad5(0x188)](0x1)['toArray'](),_0x1e7389=new Date()[_0x5e2ad5(0xb7)]()[_0x5e2ad5(0x1b6)]()[_0x5e2ad5(0x153)](-0x2),_0x2ba067=_0x4436dc['gzKSu'](new Date()['getMonth'](),0x1)[_0x5e2ad5(0x1b6)]()[_0x5e2ad5(0x1a7)](0x2,'0');if(_0x4436dc[_0x5e2ad5(0x17e)](_0xbd5cb4,_0x4436dc[_0x5e2ad5(0xf3)]))var _0x53870a='WI'+_0x1e7389+_0x2ba067;else{if(_0x4436dc[_0x5e2ad5(0x178)](_0xbd5cb4,_0x4436dc[_0x5e2ad5(0x156)]))var _0x53870a='WO'+_0x1e7389+_0x2ba067;else{if(_0x4436dc['lblOs'](_0xbd5cb4,_0x4436dc[_0x5e2ad5(0xd7)]))var _0x53870a='S'+_0x1e7389+_0x2ba067;}}let _0x4940a9=_0x53870a+_0x5e2ad5(0xa0);if(_0x4436dc[_0x5e2ad5(0x195)](_0x281a02['length'],0x0)){if(_0x4436dc[_0x5e2ad5(0x1e9)](_0x4436dc[_0x5e2ad5(0x1ad)],_0x4436dc[_0x5e2ad5(0x1b2)]))_0x4fd111[_0x5e2ad5(0x191)]();else{const _0x45ee03=_0x281a02[0x0][_0x5e2ad5(0xd8)],_0xce15d=_0x4436dc[_0x5e2ad5(0xdf)](Number,_0x45ee03['split']('-')[0x1]);_0x4940a9=_0x53870a+'-'+_0x4436dc['OspJg'](String,_0x4436dc['klViH'](_0xce15d,0x1))[_0x5e2ad5(0x1a7)](0x5,'0');}}_0x4b570c['body']['docId']=_0x4940a9,_0x4b570c['body']['docStatusNumber']=0x1;const _0x293b4c=_0x54519f['now']()[_0x5e2ad5(0x187)](_0x4436dc['kaCtv'])[_0x5e2ad5(0x13c)](_0x4436dc[_0x5e2ad5(0xa1)]);if(_0x4b570c[_0x5e2ad5(0x1d0)]['docDateTime']=_0x293b4c,_0x166198){if(_0x4436dc[_0x5e2ad5(0x18c)](_0x4436dc[_0x5e2ad5(0x155)],_0x4436dc[_0x5e2ad5(0x155)])){const _0x3f3e8d=_0x53d961?function(){const _0x56dfb8=_0x5e2ad5;if(_0x1f4258){const _0x328c37=_0x25d43c[_0x56dfb8(0x10c)](_0x42ceb5,arguments);return _0x1c666f=null,_0x328c37;}}:function(){};return _0x59804a=![],_0x3f3e8d;}else{const _0x1a6409=_0x166198['replace'](/^data:image\/\w+;base64,/,''),_0x3fced8=Buffer['from'](_0x1a6409,_0x4436dc[_0x5e2ad5(0xf7)]),_0x50329e=_0x4940a9+_0x5e2ad5(0x9c),{folderName:_0x523af0}=_0x470856['get_Info_ByUrl'](_0x4b570c[_0x5e2ad5(0x158)]),_0x513924=_0x5a8770[_0x5e2ad5(0x1bf)](_0x523af0,_0x50329e);await _0x4436dc[_0x5e2ad5(0xd4)](_0x4efccb,_0x3fced8)[_0x5e2ad5(0x1ce)]({'height':0x3e8,'withoutEnlargement':!0x0})['jpeg']({'quality':0x5a})['toFile'](_0x513924),_0x4b570c[_0x5e2ad5(0x1d0)]['refImage']=_0x50329e;}}return _0x4b570c[_0x5e2ad5(0x1d0)]['dateTimeCanEdit']=_0x2a473f['getDateTime'](_0x4436dc['qpeto'](_0x378615,0x3c)),_0x4b570c['body'][_0x5e2ad5(0x127)]=_0x2a473f[_0x5e2ad5(0x104)](_0x4436dc[_0x5e2ad5(0xb8)](_0xb526b6,0x3c)),await _0x4203e5[_0x5e2ad5(0x18e)](_0x4b570c['body']),_0x322d4f['send'](JSON['stringify']({'isSave':!0x0,'class':_0x4436dc['BwFgM'],'msg':_0x5e2ad5(0xf9)+_0x4940a9+_0x5e2ad5(0x1c6),'doc':_0x4b570c[_0x5e2ad5(0x1d0)]}));}}else{if(_0x4436dc['POVRv'](_0x3a9ad0,0x1)&&_0x41f5ad){if(_0x4436dc[_0x5e2ad5(0xd0)](_0x4436dc[_0x5e2ad5(0xef)],_0x4436dc[_0x5e2ad5(0xef)])){if(_0x12df69){const _0x5ae141=_0x1ae77e[_0x5e2ad5(0x10c)](_0x2c3470,arguments);return _0x11cb86=null,_0x5ae141;}}else{if(_0x4436dc[_0x5e2ad5(0x178)](_0xd114d7[_0x5e2ad5(0x1d2)],'U'))return _0x322d4f[_0x5e2ad5(0x107)](JSON[_0x5e2ad5(0x108)]({'isSave':!0x1,'class':_0x4436dc[_0x5e2ad5(0x164)],'msg':_0x4436dc['zHIyL']}));const _0x21f6be=await _0x4203e5[_0x5e2ad5(0xb6)]({'docId':_0x41f5ad,'userId':_0xd114d7[_0x5e2ad5(0x109)]});if(!_0x21f6be)return _0x322d4f[_0x5e2ad5(0x107)](JSON['stringify']({'isSave':!0x1,'class':_0x4436dc[_0x5e2ad5(0x164)],'msg':_0x4436dc[_0x5e2ad5(0xca)]}));if(_0x4436dc['lfmzg'](_0x21f6be[_0x5e2ad5(0xe8)],0x1))return _0x322d4f[_0x5e2ad5(0x107)](JSON['stringify']({'isSave':!0x1,'class':_0x4436dc[_0x5e2ad5(0x164)],'msg':_0x4436dc['BGDuv']}));if(_0x4436dc['jZkMa'](_0x21f6be[_0x5e2ad5(0xe8)],0x1)&&_0x21f6be['dateTimeCanEdit']){if(_0x4436dc[_0x5e2ad5(0xae)](_0x4436dc[_0x5e2ad5(0x12b)],_0x4436dc[_0x5e2ad5(0x128)]))(function(){return![];}[_0x5e2ad5(0xdb)](KAoPQb[_0x5e2ad5(0xd5)](KAoPQb[_0x5e2ad5(0x114)],KAoPQb[_0x5e2ad5(0x16c)]))[_0x5e2ad5(0x10c)](KAoPQb['jUGxV']));else{let _0x397ec4=await _0x470856[_0x5e2ad5(0x120)](_0x21f6be,_0x190409,_0xd114d7[_0x5e2ad5(0x109)]);if(_0x21f6be[_0x5e2ad5(0x137)]=_0x397ec4[_0x5e2ad5(0x137)],_0x4436dc[_0x5e2ad5(0xee)](_0x397ec4[_0x5e2ad5(0x1d9)],!0x1))return _0x21f6be[_0x5e2ad5(0xe8)]=_0x397ec4[_0x5e2ad5(0xe8)],_0x322d4f[_0x5e2ad5(0x107)](JSON[_0x5e2ad5(0x108)]({'isSave':!0x1,'doc':_0x21f6be,'class':_0x4436dc[_0x5e2ad5(0x164)],'msg':_0x4436dc['TgViP']}));}}if((_0x4436dc[_0x5e2ad5(0xba)](_0x21f6be['docStatusNumber'],0x1)||_0x4436dc[_0x5e2ad5(0x177)](_0x21f6be['docStatusNumber'],0x2))&&_0x21f6be[_0x5e2ad5(0x127)]){if(_0x4436dc[_0x5e2ad5(0x11b)](_0x4436dc[_0x5e2ad5(0x1be)],_0x4436dc['fBGwf'])){const _0x2f7807=await _0x470856[_0x5e2ad5(0x1cb)](_0x21f6be,_0x190409,_0xd114d7[_0x5e2ad5(0x109)]);if(_0x21f6be[_0x5e2ad5(0x183)]=_0x2f7807[_0x5e2ad5(0x183)],_0x4436dc[_0x5e2ad5(0x129)](_0x2f7807['canCancel'],!0x1))return _0x322d4f[_0x5e2ad5(0x107)](JSON[_0x5e2ad5(0x108)]({'isSave':!0x1,'doc':_0x21f6be,'class':_0x4436dc[_0x5e2ad5(0x164)],'msg':_0x4436dc[_0x5e2ad5(0x1cf)]}));}else{if(_0x106d00)return _0x58a191;else KAoPQb['VtJOt'](_0x4bad06,0x0);}}if(_0x166198){if(_0x4436dc['FAUeX'](_0x4436dc['RrXiB'],_0x4436dc[_0x5e2ad5(0x12a)]))return function(_0x91e2b2){}[_0x5e2ad5(0xdb)](KAoPQb[_0x5e2ad5(0x106)])[_0x5e2ad5(0x10c)](KAoPQb[_0x5e2ad5(0xde)]);else{const _0x5a3a9f=_0x166198['replace'](/^data:image\/\w+;base64,/,''),_0x22b52c=Buffer[_0x5e2ad5(0x1a1)](_0x5a3a9f,_0x4436dc[_0x5e2ad5(0xf7)]),_0x2824b7=_0x21f6be[_0x5e2ad5(0xd8)]+_0x5e2ad5(0x9c),{folderName:_0x2ce9a8}=_0x470856['get_Info_ByUrl'](_0x4b570c[_0x5e2ad5(0x158)]),_0x18c6ab=_0x5a8770['join'](_0x2ce9a8,_0x2824b7);await _0x4436dc['OspJg'](_0x4efccb,_0x22b52c)[_0x5e2ad5(0x1ce)]({'height':0x3e8,'withoutEnlargement':!0x0})[_0x5e2ad5(0x1b4)]({'quality':0x5a})['toFile'](_0x18c6ab),_0x4b570c['body']['refImage']=_0x2824b7;}}const _0x1b0bb4=await _0x4203e5['updateOne']({'docId':_0x41f5ad,'userId':_0xd114d7[_0x5e2ad5(0x109)]},{'$set':_0x4b570c[_0x5e2ad5(0x1d0)]});if(_0x4436dc['aHYnG'](_0x1b0bb4[_0x5e2ad5(0xbf)],0x0)){if(_0x4436dc[_0x5e2ad5(0x1de)](_0x4436dc[_0x5e2ad5(0x1ee)],_0x4436dc[_0x5e2ad5(0x19f)]))return![];else{const _0x50cec=_0x470856[_0x5e2ad5(0x122)](_0x21f6be,_0x4b570c[_0x5e2ad5(0x1d0)]);if(_0x4436dc[_0x5e2ad5(0x1b3)](_0x50cec[_0x5e2ad5(0x167)],0x0)){if(_0x4436dc[_0x5e2ad5(0x118)](_0x4436dc[_0x5e2ad5(0x1ab)],_0x4436dc[_0x5e2ad5(0x136)])){const _0x1d70c4=_0x6fc80e[_0x5e2ad5(0x10c)](_0x5a6176,arguments);return _0x2a038f=null,_0x1d70c4;}else{const _0x95ca43={'dateTime':_0x54519f[_0x5e2ad5(0x134)]()[_0x5e2ad5(0x187)](_0x4436dc[_0x5e2ad5(0xe9)])[_0x5e2ad5(0x13c)](_0x4436dc['foHQy']),'userId':_0xd114d7[_0x5e2ad5(0x109)],'userFullname':_0xd114d7[_0x5e2ad5(0xe3)],'changes':_0x50cec};return await _0x4203e5[_0x5e2ad5(0x1a4)]({'docId':_0x41f5ad},{'$push':{'changesHistory':{'$each':[_0x95ca43],'$position':0x0}}}),_0x322d4f[_0x5e2ad5(0x107)](JSON['stringify']({'doc':_0x4b570c['body'],'isSave':!0x0,'class':_0x4436dc[_0x5e2ad5(0x131)],'msg':'อัปเดท\x20'+_0x41f5ad+_0x5e2ad5(0x18d)}));}}else return _0x322d4f[_0x5e2ad5(0x107)](JSON['stringify']({'doc':_0x4b570c[_0x5e2ad5(0x1d0)],'isSave':!0x0,'class':_0x4436dc[_0x5e2ad5(0x131)],'msg':_0x5e2ad5(0x199)+_0x41f5ad+'\x20เรียบร้อยแล้ว'}));}}else{if(_0x1b0bb4[_0x5e2ad5(0x15b)]&&_0x4436dc['dmyRw'](_0x1b0bb4['modifiedCount'],0x1))return _0x322d4f[_0x5e2ad5(0x107)](JSON[_0x5e2ad5(0x108)]({'doc':_0x4b570c['body'],'isSave':!0x1,'class':_0x4436dc[_0x5e2ad5(0xfa)],'msg':'\x22'+_0x41f5ad+_0x5e2ad5(0xe1)}));}}}else return(_0x4436dc[_0x5e2ad5(0x1c3)](_0x3a9ad0,0x2)||_0x4436dc['oskfh'](_0x3a9ad0,0xa))&&_0x41f5ad?_0x322d4f['send'](JSON[_0x5e2ad5(0x108)]({'isSave':!0x1,'class':_0x4436dc[_0x5e2ad5(0x164)],'msg':'ไม่สามารถบันทึกเอกสาร\x20สถานะ\x20'+_0x3a9ad0+_0x5e2ad5(0x1cc)})):_0x322d4f['send'](JSON[_0x5e2ad5(0x108)]({'isSave':!0x1,'class':_0x4436dc[_0x5e2ad5(0x164)],'msg':_0x4436dc[_0x5e2ad5(0x121)]}));}}}catch(_0x306765){_0x4436dc[_0x5e2ad5(0x142)](_0x4436dc[_0x5e2ad5(0x1cd)],_0x4436dc[_0x5e2ad5(0x1cd)])?_0x1d8179=_0x56a41e:(console['log'](_0x306765),_0x322d4f[_0x5e2ad5(0x107)](JSON[_0x5e2ad5(0x108)]({'isSave':!0x1,'class':_0x4436dc[_0x5e2ad5(0x164)],'msg':_0x306765[_0x5e2ad5(0xf8)]})));}finally{if(_0x4436dc[_0x5e2ad5(0x1e9)](_0x4436dc['QXTzP'],_0x4436dc['CyzsS'])){var _0x15fc36=_0x530cdf['body'][_0x5e2ad5(0xbc)]?_0x451978['body'][_0x5e2ad5(0xbc)]:null;delete _0x409ffe[_0x5e2ad5(0x1d0)][_0x5e2ad5(0xbc)];}else _0x2d1331['close']();}}),I[_0x7a580c(0xc0)](B,_0x481df9[_0x7a580c(0xaf)],async(_0x3f62a5,_0x167e6a)=>{const _0x3b1b1a=_0x7a580c,_0x251e96={'HXYIp':function(_0x2d155a,_0x5ec043){return _0x2d155a(_0x5ec043);},'gcTYK':function(_0xb51d39,_0x2e079a){return _0xb51d39+_0x2e079a;},'HXNbr':function(_0x33d51b,_0xb03d21){return _0x33d51b!==_0xb03d21;},'eaBMK':_0x3b1b1a(0x173),'iXaBe':_0x3b1b1a(0x115),'vRuWG':_0x3b1b1a(0xb4),'GJtjR':_0x3b1b1a(0x1d3),'MpULg':_0x3b1b1a(0x10f),'gLteO':_0x3b1b1a(0x1a3),'SWsBd':'image/jpeg'},{filename:_0x1c4251}=_0x3f62a5['body'];if(!_0x1c4251)return _0x167e6a[_0x3b1b1a(0x15c)](0x190)[_0x3b1b1a(0x107)](_0x251e96['gLteO']);const {folderName:_0x153ad9}=_0x470856[_0x3b1b1a(0x165)](_0x3f62a5[_0x3b1b1a(0x158)]),_0x2453f7=_0x5a8770[_0x3b1b1a(0x1bf)](_0x153ad9,_0x1c4251),_0x26910d=_0x5a8770[_0x3b1b1a(0x190)](_0x1c4251)[_0x3b1b1a(0xe0)](),_0x5e93b0={'.jpg':_0x251e96['SWsBd'],'.jpeg':_0x251e96[_0x3b1b1a(0x1db)]};_0x4a78e8[_0x3b1b1a(0x1e2)](_0x2453f7,(_0x5c6dd2,_0x443feb)=>{const _0xd6deec=_0x3b1b1a,_0x3db4c7={'PPzIl':function(_0x36e4b0,_0x15a09b){const _0x4a2977=_0x4f1d;return _0x251e96[_0x4a2977(0x150)](_0x36e4b0,_0x15a09b);},'YqIdA':function(_0x1227db,_0x337201){const _0x1ecebd=_0x4f1d;return _0x251e96[_0x1ecebd(0x126)](_0x1227db,_0x337201);}};if(_0x251e96[_0xd6deec(0x14b)](_0x251e96[_0xd6deec(0x1c9)],_0x251e96['iXaBe'])){if(_0x5c6dd2)return console['error'](_0x251e96[_0xd6deec(0xce)],_0x5c6dd2),_0x167e6a['status'](0x1f4)[_0xd6deec(0x107)](_0x251e96[_0xd6deec(0xb0)]);const _0x131f79=_0x5e93b0[_0x26910d]||_0x251e96['MpULg'];_0x167e6a[_0xd6deec(0xcc)](0xc8,{'Content-Type':_0x131f79}),_0x167e6a[_0xd6deec(0xfd)](_0x443feb);}else{const _0xb50eb0=_0x1dfda5[0x0]['docId'],_0x357cba=_0x3db4c7[_0xd6deec(0x159)](_0x2b8aab,_0xb50eb0[_0xd6deec(0xa9)]('-')[0x1]);_0x28ab6e=_0x5ec083+'-'+_0x3db4c7['PPzIl'](_0x36818c,_0x3db4c7[_0xd6deec(0x144)](_0x357cba,0x1))[_0xd6deec(0x1a7)](0x5,'0');}});});export default I;function _0x1dc8a0(_0x1b43e4){const _0x3364d3=_0x7a580c,_0x1bd74f={'wxvEy':function(_0x4fb387,_0x526f69){return _0x4fb387===_0x526f69;},'NNCzL':'string','DiMMP':_0x3364d3(0x1e8),'JlFnq':_0x3364d3(0x161),'jjQBB':_0x3364d3(0x9b),'HXnUR':function(_0x5e1db7,_0xe4766c){return _0x5e1db7!==_0xe4766c;},'TmwJD':function(_0x396a02,_0x132119){return _0x396a02+_0x132119;},'Vyufe':function(_0x3398da,_0x1c5c30){return _0x3398da/_0x1c5c30;},'cWRBo':_0x3364d3(0x167),'HsaVO':function(_0x98be57,_0x2c9f6b){return _0x98be57%_0x2c9f6b;},'pcsOD':_0x3364d3(0xb5),'ALkWd':_0x3364d3(0xb3),'TfBsM':'action','NimYi':function(_0x7a8975,_0x30e310){return _0x7a8975+_0x30e310;},'iuFYr':'stateObject','ZxWKm':function(_0x387cf2,_0x227db8){return _0x387cf2(_0x227db8);}};function _0x2b7b7d(_0x17e45f){const _0x5765cc=_0x3364d3;if(_0x1bd74f[_0x5765cc(0x1aa)](typeof _0x17e45f,_0x1bd74f[_0x5765cc(0xa3)])){if(_0x1bd74f[_0x5765cc(0x1aa)](_0x1bd74f[_0x5765cc(0x10e)],_0x1bd74f[_0x5765cc(0x10e)]))return function(_0x37c30e){}[_0x5765cc(0xdb)](_0x1bd74f['JlFnq'])[_0x5765cc(0x10c)](_0x1bd74f[_0x5765cc(0x117)]);else _0x44e347[_0x5765cc(0x1dc)](_0x1a3457[_0x5765cc(0xf8)]),_0x1e4958[_0x5765cc(0x15c)](0x194)['sendFile'](_0x281932);}else _0x1bd74f[_0x5765cc(0x143)](_0x1bd74f[_0x5765cc(0x18b)]('',_0x1bd74f['Vyufe'](_0x17e45f,_0x17e45f))[_0x1bd74f[_0x5765cc(0x198)]],0x1)||_0x1bd74f[_0x5765cc(0x1aa)](_0x1bd74f['HsaVO'](_0x17e45f,0x14),0x0)?function(){return!![];}[_0x5765cc(0xdb)](_0x1bd74f[_0x5765cc(0x18b)](_0x1bd74f[_0x5765cc(0x171)],_0x1bd74f[_0x5765cc(0xe6)]))['call'](_0x1bd74f[_0x5765cc(0xa5)]):function(){return![];}[_0x5765cc(0xdb)](_0x1bd74f[_0x5765cc(0x193)](_0x1bd74f[_0x5765cc(0x171)],_0x1bd74f[_0x5765cc(0xe6)]))[_0x5765cc(0x10c)](_0x1bd74f['iuFYr']);_0x1bd74f['ZxWKm'](_0x2b7b7d,++_0x17e45f);}try{if(_0x1b43e4)return _0x2b7b7d;else _0x1bd74f[_0x3364d3(0x172)](_0x2b7b7d,0x0);}catch(_0x5c3379){}}