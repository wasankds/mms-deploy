const _0x1a5d90=_0x27bd;(function(_0x4d9fd7,_0x4042d8){const _0x275c3a=_0x27bd,_0x16de25=_0x4d9fd7();while(!![]){try{const _0x2d9d79=parseInt(_0x275c3a(0x238))/0x1+parseInt(_0x275c3a(0x1bc))/0x2*(-parseInt(_0x275c3a(0x2a9))/0x3)+-parseInt(_0x275c3a(0x1e2))/0x4+parseInt(_0x275c3a(0x2ca))/0x5*(parseInt(_0x275c3a(0x1f1))/0x6)+-parseInt(_0x275c3a(0x17b))/0x7+parseInt(_0x275c3a(0x1fa))/0x8+parseInt(_0x275c3a(0x28e))/0x9;if(_0x2d9d79===_0x4042d8)break;else _0x16de25['push'](_0x16de25['shift']());}catch(_0x43890c){_0x16de25['push'](_0x16de25['shift']());}}}(_0x343b,0x7dac7));function _0x27bd(_0x366b21,_0x89f143){const _0x5e4b65=_0x343b();return _0x27bd=function(_0x3c24db,_0xd84ea5){_0x3c24db=_0x3c24db-0x174;let _0x57bc79=_0x5e4b65[_0x3c24db];return _0x57bc79;},_0x27bd(_0x366b21,_0x89f143);}function _0x343b(){const _0x953172=['collection','IhRBD','jpeg','AgucZ','Asia/Bangkok','length','call','อัปเดท\x20','getMainDocPathObj','KqISV','vUzbY','-00001','cXvWv','kRBJR','status','cUOFr','readFile','from','nrVkg','OfkNo','onEDS','chain','wcORR','DdySC','base64','yyyy-MM-dd','ไม่สามารถอัปเดทเอกสารได้{{sep}}เนื่องจากสถานะเอกสารไม่ใช่\x201\x20แล้ว','DFEZI','/save','YvSje','yellow','extname','YAlAo','bOcYw','TSbFC','XefRL','zoGCs','ZPsGF','vrjAb','PATH_SALES','return\x20(function()\x20','application/octet-stream','send','cFPbm','2468rqskec','counter','table','gTqhS','docMain','Jlmvu','qlwzG','\x20เรียบร้อยแล้ว','stringify','Router','AEJJj','AZpQL','tLSuc','fBNLQ','HJbCY','flash','ZbkHB','eUVrq','body','znnmJ','ไม่พบเอกสารที่ต้องการอัปเดท\x20หรือ{{sep}}ไม่สามารถบันทึกเอกสารที่ตนเองไม่ได้สร้าง','get_Info_ByUrl','ACxnv','OjqTc','jYdly','sqCss','iLLYg','fALhK','console','mxyfc','Lwjag','qNBob','UhVAV','FXLuQ','split','fRNkc','zqPXH','xAmFd','1248800RyQvox','stateObject','padStart','.jpg','WWihZ','findOne','gSURM','SUJnB','สถานะเอกสารผิดผลาด','WuNYI','yPbHL','tcCvu','acknowledged','\x20เรียบร้อยแล้ว{{sep}}[บันทึกการแก้ไข]','AGWOv','472308ietHIr','wBQVf','eerKg','tNUgp','iVheN','replace','itRbH','nAQFF','PATH_WAREHOUSE_OUT','6493200qUvguk','RPXgO','check_DocDateTime_CanEdit','byTPi','setZone','syRsb','ZGyrm','QciWT','gEhcS','zsYvq','init','XhsUl','renderView','docId','CrHIO','ionFx','while\x20(true)\x20{}','error','iSbMH','TdYJl','getMonth','tjsbd','docStatusNumber','VossZ','FHdcf','__proto__','warehouseOut','IJpaU','TSowW','dAwoL','OrZZm','userFullname','HoBEc','KNGCY','SFyad','prototype','fiHGl','dateTimeCanCancel','OqOLr','NAeeu','Yjrwk','trace','getFullYear','resize','hFvyO','ZSucW','Obkbo','YOQTt','connect','modifiedCount','XOAuZ','sdJIH','message','getDateTime','OLYef','originalUrl','ntmHa','QNiFL','kkGZw','ROofz','GLaim','jpMbl','59941mLWXGE','Ypyge','refImage','umXSw','Error\x20reading\x20image:','dmPhL','dbEyo','TYRHj','EkkJP','iiICf','canEdit','find','gppSB','dbName','BQMXI','wbpeM','lMRHg','ABrMq','green','fBBUA','BTDSG','rfpzA','DWmsk','RucCK','zjZpl','userId','canCancel','uigHt','KxwmF','wnrlP','vgzVa','fDfze','hsEaz','qihfc','tGybS','WDxak','VMUjm','BBimh','FitNQ','action','sendFile','PvZge','kPWuM','toFormat','qMfcb','toString','MXZoV','/view-image','limit','TuNlL','สร้างเอกสารใหม่\x20','msg','IqLfJ','ocZvm','LlZbl','yeVpK','OPhuR','getUserData','xisfk','nWSgV','insertOne','FYSHn','JlXwt','slice','test','ECSuV','bmugl','xWbGW','{}.constructor(\x22return\x20this\x22)(\x20)','toArray','MhRRA','xjuJC','EVYMe','get','gger','ไม่สามารถแก้ไขเอกสารนี้ได้{{sep}}หากต้องการแก้ไข{{sep}}กรุณายกเลิกเอกสารนี้แล้วสร้างใหม่','tNBqB','dateTimeCanEdit','close','refImageBase64','{{sep}}เรียบร้อยแล้ว','FMOhx','NGqdJ','docDateTime','odkUb','CVbdv','390312USkPPs','NlsBr','bind','klCdN','yyyy-MM-dd\x20HH:mm','kzDMf','EPTfX','log','uRvqu','aMJPZ','nFnQn','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','rpgNq','uKyCx','join','PIIOq','updateOne','UtRqh','rKQFR','isAuth','eNKWO','IVktN','userAuthority','zAyqt','OjqGv','vyWbI','nodBu','156uETQdV','KitAl','check_DocDateTime_CanCancel','ZgLXv','JAhCH','wzayi','PATH_WAREHOUSE_IN','rNAFb','info','dateTimeCancelRemain','KNGGi','eJiUM','inofN','yTHcE','jMLyh','UPzhI','EYRda','post','SaSwE','qWKfs','เกิดข้อผิดพลาดในการดึงรูปภาพ','FcnIO','curNk','query','yKMkY','cUwgA','toFile','end','qjgpJ','writeHead','kcqnF','ftnLg','tIXWZ','10zbtjqf','\x22\x20ไม่มีการเปลี่ยนแปลงข้อมูล','ZBVFG','SqBay','WDbTO','iWObo','EJEKD','vHJLd','XdLoF','1268876kJBRWO','vgLuU','input','OvUrg','getSettings','bsUNd','now','olKOq','DzYhh','constructor','zIvJS','oynrs','ROzRS','warehouseIn','sales','toLowerCase','apply','glVQC','debu','function\x20*\x5c(\x20*\x5c)','nCKHD'];_0x343b=function(){return _0x953172;};return _0x343b();}const _0x992274=(function(){const _0x2eb159=_0x27bd,_0x5a420f={'zoGCs':function(_0xe3c87e,_0x510e27){return _0xe3c87e(_0x510e27);},'WuNYI':function(_0x50a680,_0x57e1f8){return _0x50a680+_0x57e1f8;},'EJEKD':_0x2eb159(0x1b8),'tNUgp':_0x2eb159(0x27c),'TSowW':function(_0x154da9,_0x1adca1){return _0x154da9!==_0x1adca1;},'fiqln':_0x2eb159(0x19a),'ABrMq':_0x2eb159(0x2b0),'AEJJj':function(_0x158572,_0x1490b5){return _0x158572===_0x1490b5;},'XefRL':_0x2eb159(0x2b5),'xWbGW':_0x2eb159(0x261),'KpnPR':'AfEOF'};let _0x1407d8=!![];return function(_0x1f5008,_0x40d2ef){const _0x5f2923=_0x2eb159,_0x57246a={'nWSgV':function(_0x2d08cb,_0xc7d629){const _0x38e3a1=_0x27bd;return _0x5a420f[_0x38e3a1(0x1b4)](_0x2d08cb,_0xc7d629);},'ocZvm':function(_0xb7ddb7,_0x1a7c0f){const _0x23524d=_0x27bd;return _0x5a420f[_0x23524d(0x1eb)](_0xb7ddb7,_0x1a7c0f);},'wvDAt':_0x5a420f[_0x5f2923(0x178)],'zezQg':_0x5a420f[_0x5f2923(0x1f4)],'ZgLXv':function(_0x150e16,_0x7be458){return _0x5a420f['TSowW'](_0x150e16,_0x7be458);},'wzayi':_0x5a420f['fiqln'],'AgucZ':_0x5a420f[_0x5f2923(0x249)],'TSbFC':function(_0x9f136b,_0x8bceb2){const _0x470317=_0x5f2923;return _0x5a420f[_0x470317(0x1c6)](_0x9f136b,_0x8bceb2);},'AZpQL':_0x5a420f[_0x5f2923(0x1b3)]};if(_0x5a420f[_0x5f2923(0x216)](_0x5a420f[_0x5f2923(0x27b)],_0x5a420f['KpnPR'])){const _0x1165a0=_0x1407d8?function(){const _0x446516=_0x5f2923;if(_0x57246a[_0x446516(0x2ac)](_0x57246a[_0x446516(0x2ae)],_0x57246a[_0x446516(0x193)])){if(_0x40d2ef){if(_0x57246a[_0x446516(0x1b2)](_0x57246a[_0x446516(0x1c7)],_0x57246a[_0x446516(0x1c7)])){const _0x54e7e1=_0x40d2ef[_0x446516(0x18b)](_0x1f5008,arguments);return _0x40d2ef=null,_0x54e7e1;}else return!![];}}else{let _0x425813;try{_0x425813=_0x57246a[_0x446516(0x273)](_0x10108a,_0x57246a['ocZvm'](_0x57246a[_0x446516(0x26d)](_0x57246a['wvDAt'],_0x57246a['zezQg']),');'))();}catch(_0x9bdee3){_0x425813=_0x4fe0f4;}return _0x425813;}}:function(){};return _0x1407d8=![],_0x1165a0;}else{if(_0x1cebe8){const _0x40b2a7=_0x6c2946[_0x5f2923(0x18b)](_0x1528af,arguments);return _0x1ce4bc=null,_0x40b2a7;}}};}());(function(){const _0x18aafd=_0x27bd,_0x2b3a02={'KitAl':'ไม่พบไฟล์รูปภาพ','IqLfJ':'image/jpeg','IVktN':'Error\x20reading\x20image:','aUTvG':_0x18aafd(0x2bd),'LlZbl':'application/octet-stream','dmPhL':function(_0x5c73ec,_0x2e3ac7){return _0x5c73ec===_0x2e3ac7;},'qWKfs':_0x18aafd(0x234),'IJpaU':_0x18aafd(0x18e),'nIJna':_0x18aafd(0x299),'NlsBr':function(_0x1b705c,_0x4b03df){return _0x1b705c(_0x4b03df);},'cXvWv':_0x18aafd(0x204),'TYRHj':function(_0x592352,_0x5615a8){return _0x592352+_0x5615a8;},'SFyad':_0x18aafd(0x1a5),'eerKg':_0x18aafd(0x17d),'KqISV':function(_0x46a82a,_0x78c49e){return _0x46a82a===_0x78c49e;},'rKQFR':'vivIC','KdAcS':_0x18aafd(0x19f),'tGybS':function(_0x9960e5,_0x385c80){return _0x9960e5(_0x385c80);},'gTqhS':function(_0x1fe127,_0x27bdfb){return _0x1fe127!==_0x27bdfb;},'rfpzA':'HTFLy','oynrs':function(_0x29b17a){return _0x29b17a();},'aMJPZ':function(_0x2c5174,_0x42b977,_0x12da3f){return _0x2c5174(_0x42b977,_0x12da3f);}};_0x2b3a02[_0x18aafd(0x297)](_0x992274,this,function(){const _0x52e75c=_0x18aafd,_0x759080={'KvMwe':_0x2b3a02[_0x52e75c(0x2a3)],'jMLyh':_0x2b3a02['aUTvG'],'fRNkc':_0x2b3a02[_0x52e75c(0x26e)]};if(_0x2b3a02[_0x52e75c(0x23d)](_0x2b3a02[_0x52e75c(0x2bc)],_0x2b3a02['qWKfs'])){const _0x2a41c6=new RegExp(_0x2b3a02[_0x52e75c(0x215)]),_0x784cfd=new RegExp(_0x2b3a02['nIJna'],'i'),_0x318f4a=_0x2b3a02[_0x52e75c(0x28f)](_0x2bcbb9,_0x2b3a02[_0x52e75c(0x19c)]);if(!_0x2a41c6[_0x52e75c(0x278)](_0x2b3a02[_0x52e75c(0x23f)](_0x318f4a,_0x2b3a02[_0x52e75c(0x21c)]))||!_0x784cfd['test'](_0x2b3a02['TYRHj'](_0x318f4a,_0x2b3a02[_0x52e75c(0x1f3)]))){if(_0x2b3a02[_0x52e75c(0x199)](_0x2b3a02[_0x52e75c(0x2a0)],_0x2b3a02['KdAcS'])){const _0x47e340=_0x2db879[_0x52e75c(0x18b)](_0x20db3b,arguments);return _0x10256e=null,_0x47e340;}else _0x2b3a02[_0x52e75c(0x25a)](_0x318f4a,'0');}else{if(_0x2b3a02[_0x52e75c(0x1bf)](_0x2b3a02[_0x52e75c(0x24d)],_0x2b3a02[_0x52e75c(0x24d)])){const _0x518a54=_0x26a919[_0x52e75c(0x184)][_0x52e75c(0x21d)][_0x52e75c(0x290)](_0x32b108),_0x207152=_0x3ef6af[_0x140ef1],_0x3e3033=_0xd21ce3[_0x207152]||_0x518a54;_0x518a54['__proto__']=_0x35da96['bind'](_0x2bdbf3),_0x518a54[_0x52e75c(0x265)]=_0x3e3033['toString'][_0x52e75c(0x290)](_0x3e3033),_0x5ea9e6[_0x207152]=_0x518a54;}else _0x2b3a02[_0x52e75c(0x186)](_0x2bcbb9);}}else{const {filename:_0x1e0030}=_0x1ccff0['body'];if(!_0x1e0030)return _0x16bc32[_0x52e75c(0x19e)](0x190)[_0x52e75c(0x1ba)](_0x2b3a02[_0x52e75c(0x2aa)]);const {folderName:_0x22b75f}=_0x53c323[_0x52e75c(0x1d1)](_0x51a03e[_0x52e75c(0x231)]),_0x5889c1=_0x5b6c7b['join'](_0x22b75f,_0x1e0030),_0x585b71=_0x51c3de[_0x52e75c(0x1af)](_0x1e0030)[_0x52e75c(0x18a)](),_0x21c5d4={'.jpg':_0x2b3a02['IqLfJ'],'.jpeg':_0x2b3a02[_0x52e75c(0x26c)]};_0x3b4655['readFile'](_0x5889c1,(_0x166195,_0x1a4f04)=>{const _0x13f80c=_0x52e75c;if(_0x166195)return _0x498edc[_0x13f80c(0x20b)](_0x759080['KvMwe'],_0x166195),_0x88f58e[_0x13f80c(0x19e)](0x1f4)[_0x13f80c(0x1ba)](_0x759080[_0x13f80c(0x2b7)]);const _0x4658c5=_0x21c5d4[_0x585b71]||_0x759080[_0x13f80c(0x1df)];_0x47d4fa[_0x13f80c(0x2c6)](0xc8,{'Content-Type':_0x4658c5}),_0x25f6c3[_0x13f80c(0x2c4)](_0x1a4f04);});}})();}());const _0xd84ea5=(function(){const _0x1e4e11=_0x27bd,_0x12e556={'UhVAV':function(_0x2b57b6,_0x207cf8){return _0x2b57b6(_0x207cf8);},'onEDS':function(_0x364544,_0x214a65){return _0x364544===_0x214a65;},'JAhCH':_0x1e4e11(0x205),'XOAuZ':'kcvrv','fALhK':'CCfIA','mzRgX':_0x1e4e11(0x264),'yPbHL':function(_0x12e463,_0x3f5780){return _0x12e463!==_0x3f5780;},'cUwgA':_0x1e4e11(0x239)};let _0x5d3ea9=!![];return function(_0xac82cd,_0x3b498b){const _0x3a7248=_0x1e4e11,_0x1515ba={'ZwLwc':function(_0xc261dd,_0x67c73f){const _0x11c5dc=_0x27bd;return _0x12e556[_0x11c5dc(0x1dc)](_0xc261dd,_0x67c73f);},'zjZpl':function(_0x46727c,_0x37b3f1){const _0x4bade8=_0x27bd;return _0x12e556[_0x4bade8(0x1a4)](_0x46727c,_0x37b3f1);},'wnrlP':_0x12e556[_0x3a7248(0x2ad)],'WciUH':_0x12e556[_0x3a7248(0x22c)],'DFEZI':_0x12e556[_0x3a7248(0x1d7)],'lomQg':_0x12e556['mzRgX']};if(_0x12e556[_0x3a7248(0x1ec)](_0x12e556[_0x3a7248(0x2c2)],_0x12e556[_0x3a7248(0x2c2)]))_0x1b1347[_0x3a7248(0x295)](_0xef8e74[_0x3a7248(0x22e)]),_0x54c61b[_0x3a7248(0x19e)](0x194)[_0x3a7248(0x260)](_0x4b2b3b);else{const _0x1330b6=_0x5d3ea9?function(){const _0x461c50=_0x3a7248,_0x21c4d6={'uigHt':function(_0x71fe5d,_0x5e0e60){return _0x1515ba['ZwLwc'](_0x71fe5d,_0x5e0e60);}};if(_0x1515ba[_0x461c50(0x250)](_0x1515ba[_0x461c50(0x255)],_0x1515ba['WciUH'])){const _0x201fc9=_0x5109ec?function(){const _0x6c151c=_0x461c50;if(_0x27a33e){const _0x431939=_0x420e75[_0x6c151c(0x18b)](_0x383254,arguments);return _0xc073c8=null,_0x431939;}}:function(){};return _0x1d3c6e=![],_0x201fc9;}else{if(_0x3b498b){if(_0x1515ba['zjZpl'](_0x1515ba[_0x461c50(0x1ab)],_0x1515ba['lomQg']))_0x21c4d6[_0x461c50(0x253)](_0x224931,'0');else{const _0x39f435=_0x3b498b[_0x461c50(0x18b)](_0xac82cd,arguments);return _0x3b498b=null,_0x39f435;}}}}:function(){};return _0x5d3ea9=![],_0x1330b6;}};}()),_0x3c24db=_0xd84ea5(this,function(){const _0x50a64f=_0x27bd,_0x5e888b={'QciWT':'function\x20*\x5c(\x20*\x5c)','PIIOq':_0x50a64f(0x299),'OLYef':function(_0x3c0070,_0x5722bf){return _0x3c0070(_0x5722bf);},'yKMkY':_0x50a64f(0x204),'sqCss':function(_0x1b3ce4,_0x383ea2){return _0x1b3ce4+_0x383ea2;},'VMUjm':_0x50a64f(0x1a5),'FMOhx':function(_0x1e858a,_0x533ec9){return _0x1e858a+_0x533ec9;},'OjqTc':_0x50a64f(0x17d),'LHbON':function(_0x1b29ab,_0x5a1415){return _0x1b29ab(_0x5a1415);},'sdJIH':function(_0x1177f5){return _0x1177f5();},'hsEaz':function(_0xf446eb,_0x40cdd4){return _0xf446eb===_0x40cdd4;},'nFnQn':_0x50a64f(0x20d),'SqBay':_0x50a64f(0x1cd),'wBQVf':'fMqeW','HoBEc':function(_0x262c30,_0x2f7e4e){return _0x262c30(_0x2f7e4e);},'NGqdJ':'return\x20(function()\x20','byTPi':'{}.constructor(\x22return\x20this\x22)(\x20)','eNKWO':_0x50a64f(0x209),'XZgcC':_0x50a64f(0x18d),'kTTfh':'gger','nodBu':'action','kcqnF':_0x50a64f(0x295),'xjuJC':'warn','vHJLd':_0x50a64f(0x2b1),'WDbTO':_0x50a64f(0x20b),'fDfze':'exception','xEqEW':_0x50a64f(0x1be),'jYdly':_0x50a64f(0x223),'ftnLg':function(_0x30bedf,_0x24fa8c){return _0x30bedf<_0x24fa8c;},'PXVvT':function(_0x26e9cb,_0x324704){return _0x26e9cb===_0x324704;},'IhRBD':_0x50a64f(0x1f8)},_0xa3db78=function(){const _0x3a9036=_0x50a64f;if(_0x5e888b[_0x3a9036(0x258)](_0x5e888b[_0x3a9036(0x298)],_0x5e888b[_0x3a9036(0x175)]))return _0x3941ba;else{let _0x41678d;try{if(_0x5e888b[_0x3a9036(0x258)](_0x5e888b[_0x3a9036(0x1f2)],_0x5e888b['wBQVf']))_0x41678d=_0x5e888b[_0x3a9036(0x21a)](Function,_0x5e888b[_0x3a9036(0x289)](_0x5e888b[_0x3a9036(0x289)](_0x5e888b[_0x3a9036(0x28a)],_0x5e888b[_0x3a9036(0x1fd)]),');'))();else{const _0x2f9d81=new _0x199e16(_0x5e888b[_0x3a9036(0x201)]),_0x2e82a2=new _0x295d2a(_0x5e888b[_0x3a9036(0x29d)],'i'),_0x419385=_0x5e888b[_0x3a9036(0x230)](_0x5b4c3a,_0x5e888b[_0x3a9036(0x2c1)]);!_0x2f9d81['test'](_0x5e888b[_0x3a9036(0x1d5)](_0x419385,_0x5e888b[_0x3a9036(0x25c)]))||!_0x2e82a2['test'](_0x5e888b[_0x3a9036(0x289)](_0x419385,_0x5e888b[_0x3a9036(0x1d3)]))?_0x5e888b['LHbON'](_0x419385,'0'):_0x5e888b['sdJIH'](_0x4819c1);}}catch(_0x105786){if(_0x5e888b['hsEaz'](_0x5e888b[_0x3a9036(0x2a2)],_0x5e888b[_0x3a9036(0x2a2)]))_0x41678d=window;else{var _0x1e5059=_0x251d78['body'][_0x3a9036(0x287)]?_0x1c0391[_0x3a9036(0x1ce)]['refImageBase64']:null;delete _0x2832d3[_0x3a9036(0x1ce)][_0x3a9036(0x287)];}}return _0x41678d;}},_0x263b14=_0x5e888b[_0x50a64f(0x22d)](_0xa3db78),_0x20d817=_0x263b14['console']=_0x263b14[_0x50a64f(0x1d8)]||{},_0x4d4610=[_0x5e888b[_0x50a64f(0x2c7)],_0x5e888b[_0x50a64f(0x27f)],_0x5e888b[_0x50a64f(0x179)],_0x5e888b[_0x50a64f(0x176)],_0x5e888b[_0x50a64f(0x257)],_0x5e888b['xEqEW'],_0x5e888b[_0x50a64f(0x1d4)]];for(let _0x1587a7=0x0;_0x5e888b[_0x50a64f(0x2c8)](_0x1587a7,_0x4d4610[_0x50a64f(0x195)]);_0x1587a7++){if(_0x5e888b['PXVvT'](_0x5e888b[_0x50a64f(0x191)],_0x5e888b[_0x50a64f(0x191)])){const _0x4c4ed2=_0xd84ea5['constructor'][_0x50a64f(0x21d)][_0x50a64f(0x290)](_0xd84ea5),_0x26b7b4=_0x4d4610[_0x1587a7],_0x5751d5=_0x20d817[_0x26b7b4]||_0x4c4ed2;_0x4c4ed2[_0x50a64f(0x213)]=_0xd84ea5[_0x50a64f(0x290)](_0xd84ea5),_0x4c4ed2['toString']=_0x5751d5[_0x50a64f(0x265)][_0x50a64f(0x290)](_0x5751d5),_0x20d817[_0x26b7b4]=_0x4c4ed2;}else(function(){return!![];}['constructor'](_0x5e888b[_0x50a64f(0x1d5)](_0x5e888b['XZgcC'],_0x5e888b['kTTfh']))[_0x50a64f(0x196)](_0x5e888b[_0x50a64f(0x2a8)]));}});_0x3c24db();import _0x356d2b from'path';import _0x52c4d6 from'fs';import _0x354703 from'sharp';import _0x2958b3 from'express';const I=_0x2958b3[_0x1a5d90(0x1c5)]();import{MongoClient as _0x2dad22}from'mongodb';import*as _0x245029 from'../mymodule/myDateTime.js';import*as _0x20a634 from'../mymodule/myUsers.js';import*as _0xb0158e from'../mymodule/myModule.js';import*as _0x59c774 from'../mymodule/myData.js';import*as _0x39e926 from'../mymodule/myDocMain.js';import _0x8a5eaf from'../middleware/mainAuth.js';import{DateTime as _0x1469cb}from'luxon';const N=global[_0x1a5d90(0x2af)],O=global[_0x1a5d90(0x1f9)],v=global[_0x1a5d90(0x1b7)],k=[N,O,v],F=[N+_0x1a5d90(0x1ac),O+_0x1a5d90(0x1ac),v+_0x1a5d90(0x1ac)],B=[N+_0x1a5d90(0x267),O+'/view-image'];I[_0x1a5d90(0x281)](k,_0x8a5eaf[_0x1a5d90(0x2a1)],async(_0x369f08,_0x14e7fd)=>{const _0x56e9e3=_0x1a5d90,_0x41d13b={'FXLuQ':_0x56e9e3(0x20a),'yTHcE':_0x56e9e3(0x1bd),'olKOq':function(_0x108cf2,_0x2e81cd){return _0x108cf2(_0x2e81cd);},'nrVkg':function(_0x377eab,_0x38c8f2){return _0x377eab!==_0x38c8f2;},'iSbMH':_0x56e9e3(0x29f),'ECSuV':_0x56e9e3(0x217),'umXSw':_0x56e9e3(0x1c0),'ROzRS':_0x56e9e3(0x194),'tjsbd':_0x56e9e3(0x1a9),'fBNLQ':_0x56e9e3(0x26b),'rENGD':function(_0xdc11b3,_0xbf7175){return _0xdc11b3===_0xbf7175;},'AcoZQ':_0x56e9e3(0x1a3)},{docId:_0x56f01d,sip:_0x1314b6}=_0x369f08[_0x56e9e3(0x2c0)];try{if(_0x41d13b[_0x56e9e3(0x1a2)](_0x41d13b[_0x56e9e3(0x20c)],_0x41d13b[_0x56e9e3(0x279)])){const _0x5a4446=await _0x20a634[_0x56e9e3(0x271)](_0x369f08),_0x517205=await _0x39e926[_0x56e9e3(0x198)](_0x369f08,_0x14e7fd,_0x5a4446[_0x56e9e3(0x2a4)]),_0x101fc3=await _0xb0158e[_0x56e9e3(0x206)](_0x41d13b[_0x56e9e3(0x23b)],_0x14e7fd,{'title':_0x517205['PAGE'],'time':_0x1469cb[_0x56e9e3(0x181)]()[_0x56e9e3(0x1fe)](_0x41d13b[_0x56e9e3(0x187)])[_0x56e9e3(0x263)](_0x41d13b[_0x56e9e3(0x20f)]),'msg':_0x369f08[_0x56e9e3(0x1cb)](_0x41d13b[_0x56e9e3(0x1c9)]),'user':_0x5a4446,...await _0xb0158e[_0x56e9e3(0x17f)](),..._0x517205,'DOC_STATUS_TITLE':global['DOC_STATUS_TITLE'],'DOC_ID':_0x56f01d,'SIP':_0x1314b6});_0x14e7fd[_0x56e9e3(0x1ba)](_0x101fc3);}else return function(_0x5d45bb){}[_0x56e9e3(0x184)](ekjgFz[_0x56e9e3(0x1dd)])['apply'](ekjgFz[_0x56e9e3(0x2b6)]);}catch(_0x1c41fa){_0x41d13b['rENGD'](_0x41d13b['AcoZQ'],_0x41d13b['AcoZQ'])?(console[_0x56e9e3(0x295)](_0x1c41fa[_0x56e9e3(0x22e)]),_0x14e7fd['status'](0x194)['sendFile'](file404)):ekjgFz[_0x56e9e3(0x182)](_0xc2c91d,0x0);}}),I[_0x1a5d90(0x2ba)](F,_0x8a5eaf['isAuth'],async(_0x3c23f9,_0x136fe3)=>{const _0x4788e6=_0x1a5d90,_0x34a64e={'hFvyO':function(_0x59a702,_0x1ea3b6){return _0x59a702(_0x1ea3b6);},'OqOLr':function(_0x717747,_0x149349){return _0x717747+_0x149349;},'CrHIO':_0x4788e6(0x1b8),'vgLuU':_0x4788e6(0x27c),'MhRRA':'red','gSURM':_0x4788e6(0x23c),'YvSje':_0x4788e6(0x2bd),'EkkJP':_0x4788e6(0x1b9),'itRbH':function(_0x36327,_0x55f36f){return _0x36327(_0x55f36f);},'FitNQ':function(_0x4f076f,_0x20f3f6){return _0x4f076f+_0x20f3f6;},'kPWuM':_0x4788e6(0x18e),'DdySC':_0x4788e6(0x299),'BBimh':_0x4788e6(0x204),'uKyCx':function(_0x43abca,_0x4042c7){return _0x43abca+_0x4042c7;},'XhHQz':_0x4788e6(0x1a5),'fiHGl':_0x4788e6(0x17d),'glVQC':function(_0x5a62b6,_0x26bb1e){return _0x5a62b6(_0x26bb1e);},'EPTfX':function(_0x13d822){return _0x13d822();},'xmXhW':function(_0x25f361,_0x3810ac,_0x5ba6ec){return _0x25f361(_0x3810ac,_0x5ba6ec);},'JlXwt':_0x4788e6(0x18d),'bsUNd':'gger','jHTNZ':_0x4788e6(0x1e3),'kzDMf':function(_0x350581,_0x5efec2){return _0x350581===_0x5efec2;},'KNGGi':_0x4788e6(0x228),'vgzVa':_0x4788e6(0x1e1),'crSWY':function(_0x276853,_0x3a3dc8){return _0x276853===_0x3a3dc8;},'UceKN':'VdprS','YOQTt':_0x4788e6(0x275),'qlwzG':function(_0x73c793,_0xb7abbf){return _0x73c793(_0xb7abbf);},'iVheN':function(_0x50524c,_0x50b621){return _0x50524c&&_0x50b621;},'WWihZ':function(_0x54f454,_0x302c1){return _0x54f454!==_0x302c1;},'ZSucW':_0x4788e6(0x1e0),'OrZZm':_0x4788e6(0x24e),'gppSB':function(_0x1d827f,_0x106162){return _0x1d827f==_0x106162;},'qjgpJ':_0x4788e6(0x188),'coDQs':_0x4788e6(0x214),'wcORR':function(_0x23e32e,_0x8eacfd){return _0x23e32e==_0x8eacfd;},'tNBqB':_0x4788e6(0x189),'KxwmF':function(_0x19bb6e,_0x56be89){return _0x19bb6e>_0x56be89;},'DPyBE':'qwews','EVYMe':_0x4788e6(0x2be),'YAlAo':function(_0x230d64,_0x3d4337){return _0x230d64(_0x3d4337);},'bOcYw':function(_0x387969,_0x3743c4){return _0x387969+_0x3743c4;},'rpgNq':'Asia/Bangkok','tcCvu':_0x4788e6(0x292),'FHdcf':function(_0x3022e6,_0x48bdbf){return _0x3022e6===_0x48bdbf;},'xisfk':_0x4788e6(0x269),'AGWOv':_0x4788e6(0x1a8),'odkUb':function(_0x21db46,_0x4b5eeb){return _0x21db46(_0x4b5eeb);},'vrjAb':function(_0x1f9fbc,_0x1a677b){return _0x1f9fbc*_0x1a677b;},'mxyfc':function(_0x21f0c3,_0x7642df){return _0x21f0c3*_0x7642df;},'RPXgO':_0x4788e6(0x24a),'KVzCW':_0x4788e6(0x2b9),'VossZ':_0x4788e6(0x1cc),'iWObo':function(_0x4c2e25,_0x198f44){return _0x4c2e25==_0x198f44;},'dbEyo':_0x4788e6(0x283),'ROofz':_0x4788e6(0x1d0),'xfiPo':function(_0x3f14ff,_0x3815a2){return _0x3f14ff!=_0x3815a2;},'Jlmvu':_0x4788e6(0x1aa),'NAeeu':function(_0x3557b9,_0x59479b){return _0x3557b9==_0x59479b;},'zIvJS':'fQmHO','ZBVFG':_0x4788e6(0x24b),'syRsb':'เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ','GLaim':function(_0x3a6f04,_0x184ec3){return _0x3a6f04==_0x184ec3;},'tIXWZ':function(_0x55cb89,_0x2141ed){return _0x55cb89==_0x2141ed;},'Yjrwk':_0x4788e6(0x1db),'klCdN':_0x4788e6(0x237),'wbpeM':function(_0x4b0de7,_0x26f96d){return _0x4b0de7==_0x26f96d;},'ACxnv':'ไม่สามารถบันทึกเอกสารได้{{sep}}เนื่องจากเลยกำหนดยกเลิกเอกสารแล้ว','WDxak':function(_0x10ec8b,_0x221bfd){return _0x10ec8b===_0x221bfd;},'QNiFL':_0x4788e6(0x24f),'DzYhh':function(_0x5a8a3b,_0x260fbe){return _0x5a8a3b(_0x260fbe);},'ZPsGF':function(_0x5b8245,_0x1bd0e6){return _0x5b8245>_0x1bd0e6;},'OPhuR':_0x4788e6(0x1c8),'Lwjag':_0x4788e6(0x200),'SaSwE':_0x4788e6(0x26f),'KNGCY':function(_0x4efc35,_0x417c4d){return _0x4efc35<_0x417c4d;},'dgqNz':_0x4788e6(0x1ae),'znnmJ':_0x4788e6(0x1ea),'OvUrg':_0x4788e6(0x17a),'vyWbI':function(_0x29aefc,_0x582acc){return _0x29aefc===_0x582acc;},'iLLYg':_0x4788e6(0x202),'SUJnB':'tukip'};await _0x39e926[_0x4788e6(0x198)](_0x3c23f9,_0x136fe3);const _0x3a4fd3=new _0x2dad22(global['dbUrl']);await _0x3a4fd3[_0x4788e6(0x22a)]();try{if(_0x34a64e[_0x4788e6(0x293)](_0x34a64e[_0x4788e6(0x2b3)],_0x34a64e[_0x4788e6(0x256)]))_0x575fd6=FzWoMY[_0x4788e6(0x226)](_0x5abe66,FzWoMY[_0x4788e6(0x220)](FzWoMY[_0x4788e6(0x220)](FzWoMY[_0x4788e6(0x208)],FzWoMY[_0x4788e6(0x17c)]),');'))();else{const _0x53622a=await _0x20a634['getUserData'](_0x3c23f9);if(_0x3c23f9[_0x4788e6(0x1ce)]=_0x59c774['convert_DataType'](_0x3c23f9[_0x4788e6(0x1ce)]),_0x3c23f9[_0x4788e6(0x1ce)][_0x4788e6(0x287)]){if(_0x34a64e['crSWY'](_0x34a64e['UceKN'],_0x34a64e[_0x4788e6(0x229)]))return![];else{var _0x48ef5a=_0x3c23f9[_0x4788e6(0x1ce)][_0x4788e6(0x287)]?_0x3c23f9[_0x4788e6(0x1ce)][_0x4788e6(0x287)]:null;delete _0x3c23f9['body'][_0x4788e6(0x287)];}}const _0x1b08b3=_0x3c23f9[_0x4788e6(0x1ce)][_0x4788e6(0x210)]?_0x34a64e[_0x4788e6(0x1c2)](Number,_0x3c23f9[_0x4788e6(0x1ce)][_0x4788e6(0x210)]):_0x3c23f9[_0x4788e6(0x1ce)][_0x4788e6(0x210)],_0x41a154=_0x3c23f9[_0x4788e6(0x1ce)]['docId'],{collectionName:_0x3d3ef1,docType:_0x54d845,hoursCanEdit:_0x414d5a,hoursCanCancel:_0x18de2f}=_0x59c774[_0x4788e6(0x1d1)](_0x3c23f9[_0x4788e6(0x231)]),_0x50fbc1=_0x3a4fd3['db'](global[_0x4788e6(0x245)])[_0x4788e6(0x190)](_0x3d3ef1);if(_0x34a64e[_0x4788e6(0x1f5)](!_0x1b08b3,!_0x41a154)){if(_0x34a64e['WWihZ'](_0x34a64e[_0x4788e6(0x227)],_0x34a64e[_0x4788e6(0x218)])){const _0x35b000=await _0x50fbc1[_0x4788e6(0x243)]()['sort']({'_id':-0x1})[_0x4788e6(0x268)](0x1)[_0x4788e6(0x27d)](),_0x315a84=new Date()[_0x4788e6(0x224)]()[_0x4788e6(0x265)]()[_0x4788e6(0x277)](-0x2),_0x51feb8=_0x34a64e['OqOLr'](new Date()[_0x4788e6(0x20e)](),0x1)[_0x4788e6(0x265)]()[_0x4788e6(0x1e4)](0x2,'0');if(_0x34a64e['gppSB'](_0x54d845,_0x34a64e[_0x4788e6(0x2c5)]))var _0x4d1a46='WI'+_0x315a84+_0x51feb8;else{if(_0x34a64e[_0x4788e6(0x244)](_0x54d845,_0x34a64e['coDQs']))var _0x4d1a46='WO'+_0x315a84+_0x51feb8;else{if(_0x34a64e[_0x4788e6(0x1a6)](_0x54d845,_0x34a64e[_0x4788e6(0x284)]))var _0x4d1a46='S'+_0x315a84+_0x51feb8;}}let _0x4306b1=_0x4d1a46+_0x4788e6(0x19b);if(_0x34a64e[_0x4788e6(0x254)](_0x35b000[_0x4788e6(0x195)],0x0)){if(_0x34a64e[_0x4788e6(0x1e6)](_0x34a64e['DPyBE'],_0x34a64e[_0x4788e6(0x280)])){const _0x115d1c=_0x35b000[0x0][_0x4788e6(0x207)],_0x4d047f=_0x34a64e[_0x4788e6(0x18c)](Number,_0x115d1c[_0x4788e6(0x1de)]('-')[0x1]);_0x4306b1=_0x4d1a46+'-'+_0x34a64e[_0x4788e6(0x1b0)](String,_0x34a64e[_0x4788e6(0x1b1)](_0x4d047f,0x1))['padStart'](0x5,'0');}else _0x21501a[_0x4788e6(0x295)](_0x5b0efa),_0x1d9604[_0x4788e6(0x1ba)](_0x535a0b[_0x4788e6(0x1c4)]({'isSave':!0x1,'class':_0x34a64e[_0x4788e6(0x27e)],'msg':_0x438458[_0x4788e6(0x22e)]}));}_0x3c23f9[_0x4788e6(0x1ce)][_0x4788e6(0x207)]=_0x4306b1,_0x3c23f9[_0x4788e6(0x1ce)][_0x4788e6(0x210)]=0x1;const _0xc85299=_0x1469cb['now']()[_0x4788e6(0x1fe)](_0x34a64e['rpgNq'])[_0x4788e6(0x263)](_0x34a64e['tcCvu']);if(_0x3c23f9[_0x4788e6(0x1ce)][_0x4788e6(0x28b)]=_0xc85299,_0x48ef5a){if(_0x34a64e[_0x4788e6(0x212)](_0x34a64e[_0x4788e6(0x272)],_0x34a64e[_0x4788e6(0x272)])){const _0x5cdf28=_0x48ef5a[_0x4788e6(0x1f6)](/^data:image\/\w+;base64,/,''),_0x439800=Buffer[_0x4788e6(0x1a1)](_0x5cdf28,_0x34a64e[_0x4788e6(0x1f0)]),_0x3c3c29=_0x4306b1+_0x4788e6(0x1e5),{folderName:_0x5ab4d2}=_0x59c774[_0x4788e6(0x1d1)](_0x3c23f9[_0x4788e6(0x231)]),_0x132fd3=_0x356d2b[_0x4788e6(0x29c)](_0x5ab4d2,_0x3c3c29);await _0x34a64e[_0x4788e6(0x28c)](_0x354703,_0x439800)[_0x4788e6(0x225)]({'height':0x3e8,'withoutEnlargement':!0x0})['jpeg']({'quality':0x5a})[_0x4788e6(0x2c3)](_0x132fd3),_0x3c23f9[_0x4788e6(0x1ce)][_0x4788e6(0x23a)]=_0x3c3c29;}else{const _0x1cc99c=_0x48b2e1?function(){const _0x480b68=_0x4788e6;if(_0x3d8ce9){const _0x142593=_0x8f6dcd[_0x480b68(0x18b)](_0x53be7c,arguments);return _0x4cef87=null,_0x142593;}}:function(){};return _0x521b27=![],_0x1cc99c;}}return _0x3c23f9[_0x4788e6(0x1ce)][_0x4788e6(0x285)]=_0x245029[_0x4788e6(0x22f)](_0x34a64e[_0x4788e6(0x1b6)](_0x414d5a,0x3c)),_0x3c23f9[_0x4788e6(0x1ce)][_0x4788e6(0x21f)]=_0x245029[_0x4788e6(0x22f)](_0x34a64e[_0x4788e6(0x1d9)](_0x18de2f,0x3c)),await _0x50fbc1[_0x4788e6(0x274)](_0x3c23f9[_0x4788e6(0x1ce)]),_0x136fe3['send'](JSON[_0x4788e6(0x1c4)]({'isSave':!0x0,'class':_0x34a64e[_0x4788e6(0x1fb)],'msg':_0x4788e6(0x26a)+_0x4306b1+_0x4788e6(0x288),'doc':_0x3c23f9[_0x4788e6(0x1ce)]}));}else{if(_0x4fc456)return _0x45654d[_0x4788e6(0x20b)](_0x34a64e[_0x4788e6(0x1e8)],_0x301673),_0x2b1d30[_0x4788e6(0x19e)](0x1f4)[_0x4788e6(0x1ba)](_0x34a64e[_0x4788e6(0x1ad)]);const _0x4b8dfd=_0x35d450[_0x2fe496]||_0x34a64e[_0x4788e6(0x240)];_0x55d4da[_0x4788e6(0x2c6)](0xc8,{'Content-Type':_0x4b8dfd}),_0x28da01[_0x4788e6(0x2c4)](_0x1e9c04);}}else{if(_0x34a64e[_0x4788e6(0x1a6)](_0x1b08b3,0x1)&&_0x41a154){if(_0x34a64e[_0x4788e6(0x212)](_0x34a64e['KVzCW'],_0x34a64e[_0x4788e6(0x211)])){const _0x523b86=_0x290188[0x0][_0x4788e6(0x207)],_0xb39377=_0x34a64e[_0x4788e6(0x1f7)](_0x3c922b,_0x523b86[_0x4788e6(0x1de)]('-')[0x1]);_0x174504=_0x517032+'-'+_0x34a64e[_0x4788e6(0x1f7)](_0x449533,_0x34a64e[_0x4788e6(0x25e)](_0xb39377,0x1))[_0x4788e6(0x1e4)](0x5,'0');}else{if(_0x34a64e[_0x4788e6(0x177)](_0x53622a[_0x4788e6(0x2a4)],'U'))return _0x136fe3['send'](JSON[_0x4788e6(0x1c4)]({'isSave':!0x1,'class':_0x34a64e[_0x4788e6(0x27e)],'msg':_0x34a64e[_0x4788e6(0x23e)]}));const _0x3c841f=await _0x50fbc1[_0x4788e6(0x1e7)]({'docId':_0x41a154,'userId':_0x53622a['userId']});if(!_0x3c841f)return _0x136fe3[_0x4788e6(0x1ba)](JSON[_0x4788e6(0x1c4)]({'isSave':!0x1,'class':_0x34a64e[_0x4788e6(0x27e)],'msg':_0x34a64e[_0x4788e6(0x235)]}));if(_0x34a64e['xfiPo'](_0x3c841f['docStatusNumber'],0x1))return _0x136fe3['send'](JSON['stringify']({'isSave':!0x1,'class':_0x34a64e[_0x4788e6(0x27e)],'msg':_0x34a64e[_0x4788e6(0x1c1)]}));if(_0x34a64e[_0x4788e6(0x221)](_0x3c841f[_0x4788e6(0x210)],0x1)&&_0x3c841f[_0x4788e6(0x285)]){if(_0x34a64e[_0x4788e6(0x1e6)](_0x34a64e[_0x4788e6(0x185)],_0x34a64e[_0x4788e6(0x174)])){let _0x4128c7=await _0x59c774[_0x4788e6(0x1fc)](_0x3c841f,_0x3d3ef1,_0x53622a['userId']);if(_0x3c841f['dateTimeEditRemain']=_0x4128c7['dateTimeEditRemain'],_0x34a64e['gppSB'](_0x4128c7[_0x4788e6(0x242)],!0x1))return _0x3c841f['docStatusNumber']=_0x4128c7[_0x4788e6(0x210)],_0x136fe3['send'](JSON['stringify']({'isSave':!0x1,'doc':_0x3c841f,'class':_0x34a64e[_0x4788e6(0x27e)],'msg':_0x34a64e[_0x4788e6(0x1ff)]}));}else{const _0x5de475=_0x2f40d6[_0x4788e6(0x18b)](_0x2e20f1,arguments);return _0x41897d=null,_0x5de475;}}if((_0x34a64e[_0x4788e6(0x236)](_0x3c841f[_0x4788e6(0x210)],0x1)||_0x34a64e[_0x4788e6(0x2c9)](_0x3c841f['docStatusNumber'],0x2))&&_0x3c841f[_0x4788e6(0x21f)]){if(_0x34a64e[_0x4788e6(0x212)](_0x34a64e[_0x4788e6(0x222)],_0x34a64e[_0x4788e6(0x291)]))FzWoMY['xmXhW'](_0x17bbb3,this,function(){const _0x514dfb=_0x4788e6,_0x861611=new _0x155d26(FzWoMY[_0x514dfb(0x262)]),_0x548592=new _0x371d59(FzWoMY[_0x514dfb(0x1a7)],'i'),_0x4f8a48=FzWoMY[_0x514dfb(0x1f7)](_0x4a1d7a,FzWoMY[_0x514dfb(0x25d)]);!_0x861611['test'](FzWoMY[_0x514dfb(0x29b)](_0x4f8a48,FzWoMY['XhHQz']))||!_0x548592['test'](FzWoMY[_0x514dfb(0x29b)](_0x4f8a48,FzWoMY[_0x514dfb(0x21e)]))?FzWoMY[_0x514dfb(0x18c)](_0x4f8a48,'0'):FzWoMY[_0x514dfb(0x294)](_0x3c6ecf);})();else{const _0x2f9da7=await _0x59c774[_0x4788e6(0x2ab)](_0x3c841f,_0x3d3ef1,_0x53622a[_0x4788e6(0x251)]);if(_0x3c841f[_0x4788e6(0x2b2)]=_0x2f9da7[_0x4788e6(0x2b2)],_0x34a64e[_0x4788e6(0x247)](_0x2f9da7[_0x4788e6(0x252)],!0x1))return _0x136fe3['send'](JSON[_0x4788e6(0x1c4)]({'isSave':!0x1,'doc':_0x3c841f,'class':_0x34a64e['MhRRA'],'msg':_0x34a64e[_0x4788e6(0x1d2)]}));}}if(_0x48ef5a){if(_0x34a64e[_0x4788e6(0x25b)](_0x34a64e[_0x4788e6(0x233)],_0x34a64e['QNiFL'])){const _0x44c656=_0x48ef5a[_0x4788e6(0x1f6)](/^data:image\/\w+;base64,/,''),_0x4047fb=Buffer[_0x4788e6(0x1a1)](_0x44c656,_0x34a64e[_0x4788e6(0x1f0)]),_0xeaa75=_0x3c841f['docId']+_0x4788e6(0x1e5),{folderName:_0x9eeb38}=_0x59c774[_0x4788e6(0x1d1)](_0x3c23f9[_0x4788e6(0x231)]),_0x1238d3=_0x356d2b[_0x4788e6(0x29c)](_0x9eeb38,_0xeaa75);await _0x34a64e[_0x4788e6(0x183)](_0x354703,_0x4047fb)['resize']({'height':0x3e8,'withoutEnlargement':!0x0})[_0x4788e6(0x192)]({'quality':0x5a})[_0x4788e6(0x2c3)](_0x1238d3),_0x3c23f9[_0x4788e6(0x1ce)][_0x4788e6(0x23a)]=_0xeaa75;}else FzWoMY['EPTfX'](_0x22ac83);}const _0x56fd9b=await _0x50fbc1[_0x4788e6(0x29e)]({'docId':_0x41a154,'userId':_0x53622a[_0x4788e6(0x251)]},{'$set':_0x3c23f9[_0x4788e6(0x1ce)]});if(_0x34a64e[_0x4788e6(0x1b5)](_0x56fd9b[_0x4788e6(0x22b)],0x0)){if(_0x34a64e[_0x4788e6(0x1e6)](_0x34a64e[_0x4788e6(0x270)],_0x34a64e[_0x4788e6(0x1da)])){const _0x208bd3=_0x59c774['getChangeHistory'](_0x3c841f,_0x3c23f9[_0x4788e6(0x1ce)]);if(_0x34a64e[_0x4788e6(0x254)](_0x208bd3[_0x4788e6(0x195)],0x0)){if(_0x34a64e[_0x4788e6(0x1e6)](_0x34a64e[_0x4788e6(0x2bb)],_0x34a64e[_0x4788e6(0x2bb)]))(function(){return![];}[_0x4788e6(0x184)](FzWoMY[_0x4788e6(0x220)](FzWoMY[_0x4788e6(0x276)],FzWoMY[_0x4788e6(0x180)]))[_0x4788e6(0x18b)](FzWoMY['jHTNZ']));else{const _0x2f448c={'dateTime':_0x1469cb['now']()[_0x4788e6(0x1fe)](_0x34a64e[_0x4788e6(0x29a)])[_0x4788e6(0x263)](_0x34a64e[_0x4788e6(0x1ed)]),'userId':_0x53622a['userId'],'userFullname':_0x53622a[_0x4788e6(0x219)],'changes':_0x208bd3};return await _0x50fbc1[_0x4788e6(0x29e)]({'docId':_0x41a154},{'$push':{'changesHistory':{'$each':[_0x2f448c],'$position':0x0}}}),_0x136fe3[_0x4788e6(0x1ba)](JSON[_0x4788e6(0x1c4)]({'doc':_0x3c23f9[_0x4788e6(0x1ce)],'isSave':!0x0,'class':_0x34a64e[_0x4788e6(0x1fb)],'msg':_0x4788e6(0x197)+_0x41a154+_0x4788e6(0x1ef)}));}}else return _0x136fe3[_0x4788e6(0x1ba)](JSON[_0x4788e6(0x1c4)]({'doc':_0x3c23f9['body'],'isSave':!0x0,'class':_0x34a64e['RPXgO'],'msg':_0x4788e6(0x197)+_0x41a154+_0x4788e6(0x1c3)}));}else{if(_0x3e71f0)return _0x436496;else FzWoMY[_0x4788e6(0x18c)](_0x2adda1,0x0);}}else{if(_0x56fd9b[_0x4788e6(0x1ee)]&&_0x34a64e[_0x4788e6(0x21b)](_0x56fd9b[_0x4788e6(0x22b)],0x1))return _0x136fe3[_0x4788e6(0x1ba)](JSON['stringify']({'doc':_0x3c23f9[_0x4788e6(0x1ce)],'isSave':!0x1,'class':_0x34a64e['dgqNz'],'msg':'\x22'+_0x41a154+_0x4788e6(0x2cb)}));}}}else return(_0x34a64e[_0x4788e6(0x2c9)](_0x1b08b3,0x2)||_0x34a64e[_0x4788e6(0x236)](_0x1b08b3,0xa))&&_0x41a154?_0x136fe3['send'](JSON[_0x4788e6(0x1c4)]({'isSave':!0x1,'class':_0x34a64e[_0x4788e6(0x27e)],'msg':'ไม่สามารถบันทึกเอกสาร\x20สถานะ\x20'+_0x1b08b3+'\x20ได้'})):_0x136fe3[_0x4788e6(0x1ba)](JSON[_0x4788e6(0x1c4)]({'isSave':!0x1,'class':_0x34a64e[_0x4788e6(0x27e)],'msg':_0x34a64e[_0x4788e6(0x1cf)]}));}}}catch(_0x3963bd){_0x34a64e[_0x4788e6(0x293)](_0x34a64e[_0x4788e6(0x17e)],_0x34a64e[_0x4788e6(0x17e)])?(console[_0x4788e6(0x295)](_0x3963bd),_0x136fe3['send'](JSON['stringify']({'isSave':!0x1,'class':_0x34a64e[_0x4788e6(0x27e)],'msg':_0x3963bd[_0x4788e6(0x22e)]}))):_0x13a716[_0x4788e6(0x286)]();}finally{if(_0x34a64e[_0x4788e6(0x2a7)](_0x34a64e[_0x4788e6(0x1d6)],_0x34a64e[_0x4788e6(0x1e9)])){if(_0x427779){const _0x3375b5=_0x2ebb18[_0x4788e6(0x18b)](_0x429a50,arguments);return _0x4f9fec=null,_0x3375b5;}}else _0x3a4fd3[_0x4788e6(0x286)]();}}),I[_0x1a5d90(0x2ba)](B,_0x8a5eaf[_0x1a5d90(0x2a1)],async(_0x411fe3,_0x3dc038)=>{const _0x34fd82=_0x1a5d90,_0x2d16cf={'OjqGv':function(_0x29abce,_0x482a63){return _0x29abce!==_0x482a63;},'CVbdv':'VeDLb','nCKHD':_0x34fd82(0x23c),'UPzhI':_0x34fd82(0x2bd),'ntmHa':_0x34fd82(0x1b9),'lMRHg':'ไม่พบไฟล์รูปภาพ','FnNIC':'image/jpeg'},{filename:_0x2e200f}=_0x411fe3['body'];if(!_0x2e200f)return _0x3dc038[_0x34fd82(0x19e)](0x190)['send'](_0x2d16cf[_0x34fd82(0x248)]);const {folderName:_0x1dae4f}=_0x59c774[_0x34fd82(0x1d1)](_0x411fe3[_0x34fd82(0x231)]),_0x19a22a=_0x356d2b[_0x34fd82(0x29c)](_0x1dae4f,_0x2e200f),_0x57204f=_0x356d2b['extname'](_0x2e200f)[_0x34fd82(0x18a)](),_0x5bd2db={'.jpg':_0x2d16cf['FnNIC'],'.jpeg':_0x2d16cf['FnNIC']};_0x52c4d6[_0x34fd82(0x1a0)](_0x19a22a,(_0x1dabed,_0xbc5926)=>{const _0x276d00=_0x34fd82;if(_0x2d16cf[_0x276d00(0x2a6)](_0x2d16cf['CVbdv'],_0x2d16cf[_0x276d00(0x28d)]))_0xbdbb37=_0x354b46;else{if(_0x1dabed)return console[_0x276d00(0x20b)](_0x2d16cf[_0x276d00(0x18f)],_0x1dabed),_0x3dc038[_0x276d00(0x19e)](0x1f4)[_0x276d00(0x1ba)](_0x2d16cf[_0x276d00(0x2b8)]);const _0xdc48ce=_0x5bd2db[_0x57204f]||_0x2d16cf[_0x276d00(0x232)];_0x3dc038[_0x276d00(0x2c6)](0xc8,{'Content-Type':_0xdc48ce}),_0x3dc038[_0x276d00(0x2c4)](_0xbc5926);}});});export default I;function _0x2bcbb9(_0x75e3d8){const _0x302a39=_0x1a5d90,_0xabe0c5={'kRBJR':function(_0x318b39,_0x4d9485){return _0x318b39===_0x4d9485;},'curNk':'string','HJbCY':_0x302a39(0x20a),'zAyqt':_0x302a39(0x1bd),'cFPbm':function(_0x494617,_0x573fd8){return _0x494617!==_0x573fd8;},'uRvqu':function(_0x3cbdc7,_0x30e304){return _0x3cbdc7+_0x30e304;},'bmugl':function(_0x2ddfd1,_0x2f64b0){return _0x2ddfd1/_0x2f64b0;},'zsYvq':_0x302a39(0x195),'qihfc':function(_0x48d302,_0x4830e4){return _0x48d302===_0x4830e4;},'MXZoV':function(_0x2f10ee,_0x192c14){return _0x2f10ee%_0x192c14;},'BQMXI':'debu','BTDSG':_0x302a39(0x282),'eJiUM':_0x302a39(0x25f),'iiICf':_0x302a39(0x1e3),'Qjuzp':function(_0x32ae29,_0x3a1a42){return _0x32ae29(_0x3a1a42);}};function _0x3379a5(_0x3bf6ea){const _0x1c85bd=_0x302a39;if(_0xabe0c5[_0x1c85bd(0x19d)](typeof _0x3bf6ea,_0xabe0c5[_0x1c85bd(0x2bf)]))return function(_0x34fc05){}['constructor'](_0xabe0c5[_0x1c85bd(0x1ca)])[_0x1c85bd(0x18b)](_0xabe0c5[_0x1c85bd(0x2a5)]);else _0xabe0c5[_0x1c85bd(0x1bb)](_0xabe0c5[_0x1c85bd(0x296)]('',_0xabe0c5[_0x1c85bd(0x27a)](_0x3bf6ea,_0x3bf6ea))[_0xabe0c5[_0x1c85bd(0x203)]],0x1)||_0xabe0c5[_0x1c85bd(0x259)](_0xabe0c5[_0x1c85bd(0x266)](_0x3bf6ea,0x14),0x0)?function(){return!![];}[_0x1c85bd(0x184)](_0xabe0c5[_0x1c85bd(0x296)](_0xabe0c5['BQMXI'],_0xabe0c5[_0x1c85bd(0x24c)]))['call'](_0xabe0c5[_0x1c85bd(0x2b4)]):function(){return![];}[_0x1c85bd(0x184)](_0xabe0c5[_0x1c85bd(0x296)](_0xabe0c5[_0x1c85bd(0x246)],_0xabe0c5[_0x1c85bd(0x24c)]))[_0x1c85bd(0x18b)](_0xabe0c5[_0x1c85bd(0x241)]);_0xabe0c5['Qjuzp'](_0x3379a5,++_0x3bf6ea);}try{if(_0x75e3d8)return _0x3379a5;else _0xabe0c5['Qjuzp'](_0x3379a5,0x0);}catch(_0x158022){}}