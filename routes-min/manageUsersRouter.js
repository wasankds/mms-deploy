const _0x2d27a9=_0x5d9b;(function(_0x289b13,_0x4cb68e){const _0x58357a=_0x5d9b,_0x55e348=_0x289b13();while(!![]){try{const _0x76e4a9=-parseInt(_0x58357a(0x1b0))/0x1+-parseInt(_0x58357a(0x258))/0x2+parseInt(_0x58357a(0x1be))/0x3*(-parseInt(_0x58357a(0x19b))/0x4)+-parseInt(_0x58357a(0x28a))/0x5+-parseInt(_0x58357a(0x21b))/0x6*(parseInt(_0x58357a(0x12c))/0x7)+-parseInt(_0x58357a(0x2be))/0x8*(parseInt(_0x58357a(0x289))/0x9)+parseInt(_0x58357a(0x213))/0xa*(parseInt(_0x58357a(0x19f))/0xb);if(_0x76e4a9===_0x4cb68e)break;else _0x55e348['push'](_0x55e348['shift']());}catch(_0x597fce){_0x55e348['push'](_0x55e348['shift']());}}}(_0x5e5f,0x4cc3f));const _0xd775f7=(function(){const _0xe3f85b=_0x5d9b,_0x3eb086={'JDrcH':_0xe3f85b(0x2d0),'pNsfd':_0xe3f85b(0x218),'LlWdP':function(_0x2c91ff,_0x30ffd3){return _0x2c91ff(_0x30ffd3);},'ymcuY':function(_0x5c2a20,_0x4b6c47){return _0x5c2a20===_0x4b6c47;},'uLvpC':'Ofztm','HMzYv':_0xe3f85b(0x281),'oGAmb':_0xe3f85b(0x14b),'lszMj':_0xe3f85b(0x2dd)};let _0x4b14fe=!![];return function(_0x537e45,_0x705cdb){const _0x566f38=_0xe3f85b,_0xa6a5c3={'IIAKQ':function(_0x2542b9,_0x9e14e0){const _0x17011f=_0x5d9b;return _0x3eb086[_0x17011f(0x20a)](_0x2542b9,_0x9e14e0);},'DQSsZ':function(_0x1caadd,_0x3f68d8){const _0x393f62=_0x5d9b;return _0x3eb086[_0x393f62(0x1ce)](_0x1caadd,_0x3f68d8);},'SLxPe':_0x3eb086[_0x566f38(0x14d)],'fxcCn':_0x3eb086[_0x566f38(0x137)],'YUSia':_0x3eb086[_0x566f38(0x18d)]};if(_0x3eb086[_0x566f38(0x1ce)](_0x3eb086['lszMj'],_0x3eb086['lszMj'])){const _0x127a94=_0x4b14fe?function(){const _0xac7b06=_0x566f38,_0x573616={'zDlQE':function(_0x104a64,_0x529cc0){const _0x36df95=_0x5d9b;return _0xa6a5c3[_0x36df95(0x22a)](_0x104a64,_0x529cc0);}};if(_0xa6a5c3[_0xac7b06(0x25a)](_0xa6a5c3[_0xac7b06(0x1f9)],_0xa6a5c3['SLxPe'])){if(_0x705cdb){if(_0xa6a5c3[_0xac7b06(0x25a)](_0xa6a5c3[_0xac7b06(0x1fb)],_0xa6a5c3[_0xac7b06(0x197)]))_0x573616[_0xac7b06(0x1fe)](_0x4d28e3,'0');else{const _0x16f92c=_0x705cdb[_0xac7b06(0x170)](_0x537e45,arguments);return _0x705cdb=null,_0x16f92c;}}}else _0x422626[_0xac7b06(0x17b)]();}:function(){};return _0x4b14fe=![],_0x127a94;}else return function(_0x6d5e03){}[_0x566f38(0x19d)](_0x3eb086['JDrcH'])[_0x566f38(0x170)](_0x3eb086[_0x566f38(0x1c0)]);};}());(function(){const _0x42282c=_0x5d9b,_0x5247ad={'WAqTc':_0x42282c(0x2ae),'TeWgZ':_0x42282c(0x27d),'eHQDs':function(_0x27db9f,_0x506b81){return _0x27db9f!==_0x506b81;},'YFnUV':_0x42282c(0x277),'AQeqv':'function\x20*\x5c(\x20*\x5c)','DLEso':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','wIBYU':function(_0x44d249,_0x187baa){return _0x44d249(_0x187baa);},'eEuMT':_0x42282c(0x192),'llcmH':function(_0x3e1082,_0x69d4f4){return _0x3e1082+_0x69d4f4;},'BfNbi':_0x42282c(0x1a4),'IsLYD':_0x42282c(0x1e3),'jTZZJ':function(_0x28dc57,_0x3d8085){return _0x28dc57===_0x3d8085;},'EYeWp':'KYVfL','jYJmC':_0x42282c(0x28c),'sdZSQ':_0x42282c(0x2bc),'LmpNk':_0x42282c(0x1bd),'Dytzy':function(_0x5ab417){return _0x5ab417();},'rnxWq':function(_0x72ebaf,_0x39f9be,_0x12a82d){return _0x72ebaf(_0x39f9be,_0x12a82d);}};_0x5247ad[_0x42282c(0x256)](_0xd775f7,this,function(){const _0x5a43dc=_0x42282c;if(_0x5247ad[_0x5a43dc(0x1d7)](_0x5247ad[_0x5a43dc(0x134)],_0x5247ad[_0x5a43dc(0x134)])){const _0x24d55d=_0x40c122[_0x5a43dc(0x170)](_0x59ed8e,arguments);return _0x228269=null,_0x24d55d;}else{const _0x2436a4=new RegExp(_0x5247ad[_0x5a43dc(0x29a)]),_0x240c39=new RegExp(_0x5247ad[_0x5a43dc(0x164)],'i'),_0x45dcf9=_0x5247ad[_0x5a43dc(0x243)](_0xc29b5a,_0x5247ad[_0x5a43dc(0x1c8)]);!_0x2436a4['test'](_0x5247ad[_0x5a43dc(0x270)](_0x45dcf9,_0x5247ad[_0x5a43dc(0x253)]))||!_0x240c39[_0x5a43dc(0x242)](_0x5247ad[_0x5a43dc(0x270)](_0x45dcf9,_0x5247ad['IsLYD']))?_0x5247ad[_0x5a43dc(0x235)](_0x5247ad[_0x5a43dc(0x115)],_0x5247ad[_0x5a43dc(0x2cd)])?_0x3e9cee[_0x5a43dc(0x17b)]():_0x5247ad['wIBYU'](_0x45dcf9,'0'):_0x5247ad['jTZZJ'](_0x5247ad[_0x5a43dc(0x1cb)],_0x5247ad[_0x5a43dc(0x22c)])?(_0x23f599[_0x5a43dc(0x295)](_0x5247ad['WAqTc'],_0x2206aa[_0x5a43dc(0x123)]),_0x23c7cf['send'](_0x282ac7[_0x5a43dc(0x199)]({'isPrint':!0x1,'class':_0x5247ad[_0x5a43dc(0x238)],'msg':_0x31e7b4[_0x5a43dc(0x123)]}))):_0x5247ad[_0x5a43dc(0x2d6)](_0xc29b5a);}})();}());const _0x2db428=(function(){const _0x1da852=_0x5d9b,_0x445300={'xlwgx':_0x1da852(0x196),'DmrZi':'red','lUCTo':function(_0x2c40a9,_0x2129c2){return _0x2c40a9===_0x2129c2;},'yNgjc':_0x1da852(0x224),'myJqj':'VupNH','ElAeT':_0x1da852(0x1e4),'mfRHQ':function(_0x12e87b,_0xbe8175){return _0x12e87b!==_0xbe8175;},'wICaC':_0x1da852(0x167),'DgYTH':_0x1da852(0x116)};let _0x7dd4c6=!![];return function(_0x2a41a3,_0x3ce6d5){const _0x5ca96c=_0x1da852,_0x389dc0={'MldQO':function(_0x25f85e,_0x3626e5){return _0x445300['lUCTo'](_0x25f85e,_0x3626e5);},'ZHCuY':_0x445300['yNgjc'],'zcYqM':_0x445300['myJqj'],'renDS':_0x445300['ElAeT']};if(_0x445300[_0x5ca96c(0x132)](_0x445300[_0x5ca96c(0x252)],_0x445300[_0x5ca96c(0x2a6)])){const _0x343453=_0x7dd4c6?function(){const _0x3b0cef=_0x5ca96c;if(_0x389dc0[_0x3b0cef(0x26a)](_0x389dc0[_0x3b0cef(0x112)],_0x389dc0['ZHCuY'])){if(_0x3ce6d5){if(_0x389dc0['MldQO'](_0x389dc0['zcYqM'],_0x389dc0[_0x3b0cef(0x23f)])){if(_0x3c4372){const _0x4dd97b=_0x1dcf71['apply'](_0x7483d7,arguments);return _0x45a1d6=null,_0x4dd97b;}}else{const _0x3e737f=_0x3ce6d5['apply'](_0x2a41a3,arguments);return _0x3ce6d5=null,_0x3e737f;}}}else{if(_0x5bf56c){const _0x5cb3d7=_0x3c0be8[_0x3b0cef(0x170)](_0x1dc9ba,arguments);return _0x2310db=null,_0x5cb3d7;}}}:function(){};return _0x7dd4c6=![],_0x343453;}else return _0x46cf7b[_0x5ca96c(0x295)](_0x281bbf[_0x5ca96c(0x123)]),_0x28e657['flash'](_0x445300['xlwgx'],{'class':_0x445300['DmrZi'],'text':''+_0x54eed5['message']}),_0x42a52e[_0x5ca96c(0x13f)](_0x46d6cd);};}()),_0x51cc2b=_0x2db428(this,function(){const _0x5b63d1=_0x5d9b,_0x1649a5={'YjVLS':_0x5b63d1(0x2ae),'CJgaI':_0x5b63d1(0x27d),'RNoqZ':function(_0x15c773,_0x13110f){return _0x15c773!==_0x13110f;},'IbpUT':function(_0x358005,_0x38f8c8){return _0x358005==_0x38f8c8;},'DXISO':function(_0x245591,_0x47d55b){return _0x245591!==_0x47d55b;},'suVrm':_0x5b63d1(0x158),'oyMyI':function(_0x90b3e3,_0x3ab87d){return _0x90b3e3>_0x3ab87d;},'BHrHB':function(_0x236b24,_0x2a312f){return _0x236b24===_0x2a312f;},'ysndE':_0x5b63d1(0x2de),'bEDLA':_0x5b63d1(0x1d1),'EaPYT':function(_0x2f1f24,_0x2e3728){return _0x2f1f24===_0x2e3728;},'GXKIn':'goqXS','hCZeL':'SZKOy','ZnwLJ':function(_0x2c0cd5,_0x18ebd5){return _0x2c0cd5(_0x18ebd5);},'vtTgO':function(_0x1f47d1,_0x774138){return _0x1f47d1+_0x774138;},'dmoDb':function(_0x2ef99a,_0x1469fe){return _0x2ef99a+_0x1469fe;},'mBgXi':_0x5b63d1(0x17c),'xvBdG':'{}.constructor(\x22return\x20this\x22)(\x20)','KxVQL':function(_0x2d0f70,_0xf88cb9){return _0x2d0f70!==_0xf88cb9;},'clqSP':_0x5b63d1(0x10a),'etKXF':_0x5b63d1(0x190),'JqJuI':_0x5b63d1(0x2d8),'mFwDZ':'init','DmjdF':function(_0x340954,_0x19b0ff){return _0x340954+_0x19b0ff;},'eHFlw':_0x5b63d1(0x1a4),'iIBUF':'input','IveWP':function(_0x1732ab,_0x2d2aba){return _0x1732ab(_0x2d2aba);},'CdjSN':function(_0x2a3706){return _0x2a3706();},'VmuYN':function(_0x300a88,_0x2b4395,_0x50496f){return _0x300a88(_0x2b4395,_0x50496f);},'BqrwK':_0x5b63d1(0x295),'UnKYO':_0x5b63d1(0x168),'YviTG':_0x5b63d1(0x1e0),'vOYVp':'error','HYORi':'exception','evlND':'table','uUsDy':'trace','Lqjna':function(_0x4424b8,_0x4750d9){return _0x4424b8<_0x4750d9;},'EKEmT':function(_0x38fc1f,_0x140bc8){return _0x38fc1f===_0x140bc8;},'sRSXa':'ilXhE','kXpLN':'lCOTS'},_0x554911=function(){const _0x8de03=_0x5b63d1,_0x35fedd={'INntk':_0x1649a5[_0x8de03(0x25c)],'XkGRm':_0x1649a5[_0x8de03(0x154)],'BGGbt':function(_0x564235,_0x3a7e6c){const _0xd9bcbd=_0x8de03;return _0x1649a5[_0xd9bcbd(0x232)](_0x564235,_0x3a7e6c);},'yFxpD':function(_0x3a4083,_0x959f3a){const _0x36378b=_0x8de03;return _0x1649a5[_0x36378b(0x21a)](_0x3a4083,_0x959f3a);},'sVZer':function(_0xdbd671,_0x18dee1){const _0x4efa52=_0x8de03;return _0x1649a5[_0x4efa52(0x201)](_0xdbd671,_0x18dee1);},'smQIf':_0x1649a5['suVrm'],'bwUPc':function(_0x119eba,_0x7e8e17){const _0x428151=_0x8de03;return _0x1649a5[_0x428151(0x269)](_0x119eba,_0x7e8e17);}};if(_0x1649a5[_0x8de03(0x1b8)](_0x1649a5['ysndE'],_0x1649a5[_0x8de03(0x19a)]))_0x295188[_0x8de03(0x295)](_0x35fedd[_0x8de03(0x130)],_0x382abf),_0x4025e6['send'](_0x18ad2b[_0x8de03(0x199)]({'isPrint':!0x1,'class':_0x35fedd[_0x8de03(0x1bc)],'msg':_0x4e9dfc[_0x8de03(0x123)]}));else{let _0x11d60d;try{if(_0x1649a5[_0x8de03(0x25b)](_0x1649a5['GXKIn'],_0x1649a5[_0x8de03(0x223)])){const _0x3a0521=_0x35fedd[_0x8de03(0x287)](_0x3c3964[_0x8de03(0x16b)],'A')||_0x35fedd[_0x8de03(0x239)](_0x425394['userId'],_0xfed76);return _0x35fedd[_0x8de03(0x1b2)](_0x365cb7['userAuthority'],'O')&&_0x3a0521;}else _0x11d60d=_0x1649a5[_0x8de03(0x282)](Function,_0x1649a5[_0x8de03(0x283)](_0x1649a5['dmoDb'](_0x1649a5[_0x8de03(0x136)],_0x1649a5[_0x8de03(0x149)]),');'))();}catch(_0x28ae39){if(_0x1649a5[_0x8de03(0x117)](_0x1649a5[_0x8de03(0x25d)],_0x1649a5[_0x8de03(0x25d)])){const _0xd99b0d=_0x8bc6f8[_0x8de03(0x10c)](_0x35fedd['smQIf']);_0xd99b0d&&_0x35fedd['bwUPc'](_0xd99b0d[_0x8de03(0x222)],0x0)&&(_0x3318e5={..._0xd99b0d[0x0]});}else _0x11d60d=window;}return _0x11d60d;}},_0x4fa438=_0x1649a5[_0x5b63d1(0x250)](_0x554911),_0xcf4f92=_0x4fa438[_0x5b63d1(0x15f)]=_0x4fa438[_0x5b63d1(0x15f)]||{},_0x194820=[_0x1649a5[_0x5b63d1(0x229)],_0x1649a5[_0x5b63d1(0x1c4)],_0x1649a5[_0x5b63d1(0x163)],_0x1649a5[_0x5b63d1(0x14a)],_0x1649a5['HYORi'],_0x1649a5[_0x5b63d1(0x1bf)],_0x1649a5[_0x5b63d1(0x14e)]];for(let _0xb9d16b=0x0;_0x1649a5['Lqjna'](_0xb9d16b,_0x194820[_0x5b63d1(0x222)]);_0xb9d16b++){if(_0x1649a5['EKEmT'](_0x1649a5[_0x5b63d1(0x144)],_0x1649a5['kXpLN'])){const _0x340924={'dIIUP':_0x1649a5[_0x5b63d1(0x113)],'PLnih':_0x1649a5['JqJuI'],'kkAcP':function(_0x4a0572,_0x29fda7){const _0xc3e7ad=_0x5b63d1;return _0x1649a5[_0xc3e7ad(0x282)](_0x4a0572,_0x29fda7);},'uvBQv':_0x1649a5[_0x5b63d1(0x119)],'iBLRj':function(_0x303015,_0x344f85){return _0x1649a5['DmjdF'](_0x303015,_0x344f85);},'ZZMdj':_0x1649a5[_0x5b63d1(0x1a7)],'vYgwc':function(_0x239d8e,_0x1de6b4){const _0x3e8b6f=_0x5b63d1;return _0x1649a5[_0x3e8b6f(0x111)](_0x239d8e,_0x1de6b4);},'EOzWr':_0x1649a5['iIBUF'],'mPgmg':function(_0x519015,_0x5d776c){const _0x414264=_0x5b63d1;return _0x1649a5[_0x414264(0x198)](_0x519015,_0x5d776c);},'DHnmu':function(_0x159278){const _0x59c077=_0x5b63d1;return _0x1649a5[_0x59c077(0x250)](_0x159278);}};_0x1649a5[_0x5b63d1(0x114)](_0x40f957,this,function(){const _0x312aff=_0x5b63d1,_0x38fb84=new _0x5c5120(_0x340924[_0x312aff(0x1bb)]),_0x536147=new _0xc667fd(_0x340924[_0x312aff(0x141)],'i'),_0x1cec7e=_0x340924[_0x312aff(0x1b6)](_0x3258bd,_0x340924['uvBQv']);!_0x38fb84[_0x312aff(0x242)](_0x340924['iBLRj'](_0x1cec7e,_0x340924['ZZMdj']))||!_0x536147['test'](_0x340924[_0x312aff(0x2c0)](_0x1cec7e,_0x340924[_0x312aff(0x109)]))?_0x340924['mPgmg'](_0x1cec7e,'0'):_0x340924[_0x312aff(0x15c)](_0x3897bf);})();}else{const _0x4e3b31=_0x2db428[_0x5b63d1(0x19d)][_0x5b63d1(0x1c1)][_0x5b63d1(0x24b)](_0x2db428),_0x38905d=_0x194820[_0xb9d16b],_0x3323e2=_0xcf4f92[_0x38905d]||_0x4e3b31;_0x4e3b31[_0x5b63d1(0x155)]=_0x2db428[_0x5b63d1(0x24b)](_0x2db428),_0x4e3b31[_0x5b63d1(0x1af)]=_0x3323e2[_0x5b63d1(0x1af)][_0x5b63d1(0x24b)](_0x3323e2),_0xcf4f92[_0x38905d]=_0x4e3b31;}}});_0x51cc2b();import _0x2bd86f from'express';import{MongoClient as _0x36bda7,ObjectId as _0xe330a2}from'mongodb';import _0x351519 from'bcrypt';const x=_0x2bd86f[_0x2d27a9(0x150)]();import _0x46842c from'path';import _0x23ace8 from'fs';import _0x306f5a from'ejs';import _0x1eb476 from'../middleware/mainAuth.js';function _0x5d9b(_0xe1fd69,_0x5672bd){const _0x44bb7b=_0x5e5f();return _0x5d9b=function(_0x51cc2b,_0x2db428){_0x51cc2b=_0x51cc2b-0x109;let _0x36d6a6=_0x44bb7b[_0x51cc2b];return _0x36d6a6;},_0x5d9b(_0xe1fd69,_0x5672bd);}const U=await import(_0x2d27a9(0x26d)+mymoduleFolder+'/myModule.js'),S=await import(_0x2d27a9(0x26d)+mymoduleFolder+_0x2d27a9(0x216)),L=await import(_0x2d27a9(0x26d)+mymoduleFolder+'/myUsers.js'),Z=await import(_0x2d27a9(0x26d)+mymoduleFolder+_0x2d27a9(0x267)),q=await import('../'+mymoduleFolder+_0x2d27a9(0x254)),u=_0x2d27a9(0x2d2),Q=u+'/save',W=u+_0x2d27a9(0x118),B=u+_0x2d27a9(0x2a0),G=u+_0x2d27a9(0x13e),V=u+_0x2d27a9(0x182),X=u+'/changes',ee=u+'/download-excel',se=u+_0x2d27a9(0x212),te=u[_0x2d27a9(0x227)](/\//g,'_'),oe=0x5a0*0x3c;x[_0x2d27a9(0x1a6)](u,_0x1eb476[_0x2d27a9(0x1f2)],async(_0x271f99,_0x1e3b00)=>{const _0x4683c2=_0x2d27a9,_0xe79f9f={'bNTeW':_0x4683c2(0x190),'EVaIC':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','efLMV':function(_0x39e802,_0x1ce81d){return _0x39e802(_0x1ce81d);},'DAYFG':_0x4683c2(0x192),'hxDmY':function(_0x2fa820,_0x273367){return _0x2fa820+_0x273367;},'oMfiL':_0x4683c2(0x1a4),'hzURv':function(_0x10e76f,_0x247c64){return _0x10e76f+_0x247c64;},'yEFDi':_0x4683c2(0x1e3),'NvBgN':function(_0x2c6a46,_0x4110cd){return _0x2c6a46(_0x4110cd);},'ZShet':function(_0x4b0d5a){return _0x4b0d5a();},'wZzML':_0x4683c2(0x2ae),'gibMA':_0x4683c2(0x196),'dnZpy':_0x4683c2(0x27d),'JsqCD':function(_0x4c442e,_0x1e7402){return _0x4c442e===_0x1e7402;},'ADiBk':'CLzbn','HZsVv':_0x4683c2(0x2df),'mPGaM':function(_0x2ab630,_0x5c983c){return _0x2ab630!==_0x5c983c;},'Krjju':function(_0x35346b,_0x119496){return _0x35346b==_0x119496;},'wdlor':function(_0x32abe7,_0x3d2ffb){return _0x32abe7!==_0x3d2ffb;},'dRUkX':function(_0x2d1514,_0x3fd382){return _0x2d1514!==_0x3fd382;},'Ezhcv':function(_0x2bb856,_0x38e758){return _0x2bb856+_0x38e758;},'xFcRD':_0x4683c2(0x23d),'xUHCl':'gger','AEhpu':_0x4683c2(0x1ff),'BjEFE':function(_0x18e4a7,_0x12eccb){return _0x18e4a7(_0x12eccb);},'OgpwJ':function(_0x4e420d,_0x29d027){return _0x4e420d*_0x29d027;},'ACFoE':function(_0x23bdd2,_0x2b08b6){return _0x23bdd2-_0x2b08b6;},'Jhetk':function(_0x583e37,_0x401812){return _0x583e37!==_0x401812;},'nBojt':_0x4683c2(0x29c),'PExxm':_0x4683c2(0x23a),'XpicK':_0x4683c2(0x12d),'URzuD':function(_0x1d8958,_0x51341b){return _0x1d8958(_0x51341b);},'CxxyZ':function(_0x244122,_0x3cc7df){return _0x244122(_0x3cc7df);},'TQvsc':function(_0x48a2a4,_0x17c568){return _0x48a2a4/_0x17c568;},'Ecwwo':function(_0xf688c6,_0x3f233e){return _0xf688c6<_0x3f233e;},'qfFad':function(_0x2b972b,_0x1cb2c4){return _0x2b972b(_0x1cb2c4);},'jGwxq':function(_0x156596,_0x4b875e){return _0x156596(_0x4b875e);},'rcVna':function(_0x2cf7c8,_0x43a92c){return _0x2cf7c8(_0x43a92c);},'KFxWT':function(_0x3cb9f5,_0x117032){return _0x3cb9f5>_0x117032;},'ZqLUR':function(_0x1c183a,_0x55e5f5){return _0x1c183a(_0x55e5f5);},'EQljq':function(_0x48caca,_0x431107){return _0x48caca+_0x431107;},'dwuir':function(_0x48e414,_0x2cc24b){return _0x48e414(_0x2cc24b);},'gJBBr':_0x4683c2(0x1fc),'HPDYI':_0x4683c2(0x1f6),'InEjR':_0x4683c2(0x1eb),'YpgzB':_0x4683c2(0x121),'uotXA':_0x4683c2(0x1ca),'jEAuT':_0x4683c2(0x169),'gMtcC':function(_0x3c8e38,_0x214dfb){return _0x3c8e38===_0x214dfb;},'aJjVZ':_0x4683c2(0x10d),'Qivid':'gZdsP','TrdAU':function(_0x37000e,_0x2820d5){return _0x37000e===_0x2820d5;},'rMxGc':_0x4683c2(0x28b),'jlmXx':function(_0x21a891,_0x1a32f0){return _0x21a891===_0x1a32f0;},'JgCVV':_0x4683c2(0x183),'iPsmm':'MEcgV','pqrwc':_0x4683c2(0x158),'cohyI':function(_0x24a998,_0x13d19c){return _0x24a998>_0x13d19c;},'pQEBb':'manageUsers','xXgkT':function(_0xe589ee,_0x166f3e){return _0xe589ee!==_0x166f3e;},'sFmpH':_0x4683c2(0x2ab),'wFPqi':_0x4683c2(0x1f4),'MGFOl':'ZqryZ'},_0x1f687b=_0x271f99['query'][_0x4683c2(0x166)],_0x34e8c9=_0xe79f9f[_0x4683c2(0x276)](Number,_0x271f99['query'][_0x4683c2(0x19e)])||0x14,_0x25fba7=_0xe79f9f[_0x4683c2(0x174)](Number,_0x271f99[_0x4683c2(0x27f)][_0x4683c2(0x2b5)])||0x1,_0x47d3c7=_0x271f99[_0x4683c2(0x27f)][_0x4683c2(0x219)]||'',_0x59db28=_0xe79f9f[_0x4683c2(0x1cc)](Number,_0xe79f9f[_0x4683c2(0x23c)](_0xe79f9f[_0x4683c2(0x153)](_0x25fba7,0x1),_0x34e8c9)),_0x387589=S[_0x4683c2(0x1d5)](0x0),_0x119e5b=new _0x36bda7(dbUrl);try{if(_0xe79f9f[_0x4683c2(0x12f)](_0xe79f9f[_0x4683c2(0x249)],_0xe79f9f[_0x4683c2(0x249)]))_0x5ca61d=_0x4933b1;else{await _0x119e5b[_0x4683c2(0x12b)]();const _0x42b838=_0x119e5b['db'](global[_0x4683c2(0x2c6)])[_0x4683c2(0x135)](global['dbColl_users']);if(_0x1f687b){if(_0xe79f9f[_0x4683c2(0x1ed)](_0xe79f9f['PExxm'],_0xe79f9f[_0x4683c2(0x20f)])){const _0x216556=new _0x9b8697(SoMxEW['bNTeW']),_0x4ef7f0=new _0x56d143(SoMxEW[_0x4683c2(0x15d)],'i'),_0x1bb9f2=SoMxEW[_0x4683c2(0x1cc)](_0x42893,SoMxEW[_0x4683c2(0x133)]);!_0x216556['test'](SoMxEW['hxDmY'](_0x1bb9f2,SoMxEW[_0x4683c2(0x1aa)]))||!_0x4ef7f0['test'](SoMxEW[_0x4683c2(0x234)](_0x1bb9f2,SoMxEW['yEFDi']))?SoMxEW[_0x4683c2(0x276)](_0x1bb9f2,'0'):SoMxEW[_0x4683c2(0x13a)](_0x378e2b);}else{const _0x345c64=new RegExp(_0x1f687b[_0x4683c2(0x227)](/[.*+?^${}()|[\]\\]/g,_0xe79f9f['XpicK']),'i');let _0x36519f={};_0xe79f9f['BjEFE'](isNaN,_0xe79f9f['URzuD'](Number,_0x1f687b))?_0x36519f={'userId':{'$regex':_0x345c64}}:_0x36519f={'userId':_0xe79f9f[_0x4683c2(0x181)](Number,_0x1f687b)};var _0x163411=await _0x42b838[_0x4683c2(0x1b7)]({'$or':[_0x36519f,{'username':{'$regex':_0x345c64}},{'userFirstname':{'$regex':_0x345c64}}]});}}else var _0x163411=await _0x42b838[_0x4683c2(0x1b7)]({});const _0x42347a=Math[_0x4683c2(0x22e)](_0xe79f9f[_0x4683c2(0x146)](_0x163411,_0x34e8c9)),_0x2f502d=_0xe79f9f[_0x4683c2(0x1c7)](_0xe79f9f['ACFoE'](_0xe79f9f['qfFad'](Number,_0x25fba7),0x1),0x1)?'-':_0xe79f9f['ACFoE'](_0xe79f9f[_0x4683c2(0x240)](Number,_0x25fba7),0x1),_0x5e4b85=_0xe79f9f[_0x4683c2(0x2d9)](Number,_0x25fba7),_0x1492ce=_0xe79f9f[_0x4683c2(0x125)](_0xe79f9f['hzURv'](_0xe79f9f[_0x4683c2(0x245)](Number,_0x25fba7),0x1),_0x42347a)?'-':_0xe79f9f[_0x4683c2(0x20d)](_0xe79f9f[_0x4683c2(0x259)](Number,_0x25fba7),0x1),_0x72c864=[{'$project':{'_id':0x1,'userIsActive':0x1,'userId':0x1,'username':0x1,'userFullname':{'$concat':[_0xe79f9f['gJBBr'],'\x20',_0xe79f9f[_0x4683c2(0x18c)],'\x20',_0xe79f9f[_0x4683c2(0x176)]]},'userAuthority':0x1,'canDelete':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0xe79f9f[_0x4683c2(0x1a2)],[]]}},'isCanDelete':{'$cond':{'if':{'$gt':[{'$dateDiff':{'startDate':{'$toDate':_0x387589},'endDate':{'$toDate':_0xe79f9f[_0x4683c2(0x188)]},'unit':_0xe79f9f[_0x4683c2(0x265)]}},0x0]},'then':!0x0,'else':!0x1}}}},{'$sort':{'userId':-0x1}},{'$skip':_0x59db28},{'$limit':_0x34e8c9}];if(_0x1f687b){if(_0xe79f9f['gMtcC'](_0xe79f9f[_0x4683c2(0x221)],_0xe79f9f[_0x4683c2(0x128)]))_0x1f7548[_0x4683c2(0x17b)]();else{const _0x36c733=_0x1f687b?new RegExp(''+_0x1f687b,'i'):new RegExp('.*');let _0x9cd283={};_0xe79f9f[_0x4683c2(0x240)](isNaN,_0xe79f9f['efLMV'](Number,_0x1f687b))?_0x9cd283={'userId':{'$regex':_0x36c733}}:_0x9cd283={'userId':_0xe79f9f[_0x4683c2(0x240)](Number,_0x1f687b)},_0x72c864['unshift']({'$match':{'$or':[_0x9cd283,{'username':{'$regex':_0x36c733}},{'userFirstname':{'$regex':_0x36c733}}]}});}}const _0x316170=L[_0x4683c2(0x2da)](_0x271f99),_0x143a78=_0x316170['userAuthority'];let _0x34e0ae=await _0x42b838[_0x4683c2(0x1ee)](_0x72c864)[_0x4683c2(0x129)]();if(['A']['includes'](_0x143a78)){if(_0xe79f9f[_0x4683c2(0x27c)](_0xe79f9f[_0x4683c2(0x194)],_0xe79f9f[_0x4683c2(0x194)])){const _0x4fe205=_0x316170[_0x4683c2(0x1a0)];_0x34e0ae=_0x34e0ae[_0x4683c2(0x11c)](_0x40b3a7=>{const _0x74fca0=_0x4683c2;if(_0xe79f9f[_0x74fca0(0x15e)](_0xe79f9f['ADiBk'],_0xe79f9f['HZsVv']))return _0x248905[_0x74fca0(0x295)](_0xe79f9f[_0x74fca0(0x286)],_0x349625),_0x5c4b56[_0x74fca0(0x10c)](_0xe79f9f[_0x74fca0(0x1d8)],{'class':_0xe79f9f['dnZpy'],'text':_0xd6f122[_0x74fca0(0x123)]}),_0x4b661d[_0x74fca0(0x13f)](_0xdeed7a);else{const _0x4824e0=_0xe79f9f['mPGaM'](_0x40b3a7['userAuthority'],'A')||_0xe79f9f[_0x74fca0(0x1b3)](_0x40b3a7[_0x74fca0(0x1a0)],_0x4fe205);return _0xe79f9f[_0x74fca0(0x2b6)](_0x40b3a7[_0x74fca0(0x16b)],'O')&&_0x4824e0;}});}else SoMxEW[_0x4683c2(0x13a)](_0x1ec969);}if(_0x47d3c7)var _0x1a3cbc=await _0x42b838[_0x4683c2(0x2c2)]({'_id':new _0xe330a2(_0x47d3c7)},{'projection':{'userPassword':0x0}});else var _0x1a3cbc={};if(_0x1a3cbc&&_0xe79f9f[_0x4683c2(0x27c)](Object[_0x4683c2(0x1c5)](_0x1a3cbc)['length'],0x0)){if(_0xe79f9f['jlmXx'](_0xe79f9f['JgCVV'],_0xe79f9f[_0x4683c2(0x145)])){const _0x35c19f=_0x5aa85a[_0x4683c2(0x1a0)];_0x1e523c=_0x276f88[_0x4683c2(0x11c)](_0x47991=>{const _0x28316a=_0x4683c2,_0x1da016=_0xe79f9f[_0x28316a(0x1ed)](_0x47991[_0x28316a(0x16b)],'A')||_0xe79f9f[_0x28316a(0x1b3)](_0x47991['userId'],_0x35c19f);return _0xe79f9f['dRUkX'](_0x47991[_0x28316a(0x16b)],'O')&&_0x1da016;});}else{const _0x287803=_0x271f99[_0x4683c2(0x10c)](_0xe79f9f['pqrwc']);_0x287803&&_0xe79f9f['cohyI'](_0x287803[_0x4683c2(0x222)],0x0)&&(_0x1a3cbc={..._0x287803[0x0]});}}const _0x20dfb1=await U[_0x4683c2(0x12e)](_0xe79f9f[_0x4683c2(0x1e1)],_0x1e3b00,{'title':PAGE_MANAGE_USERS,'time':S[_0x4683c2(0x2ca)](),'msg':_0x271f99[_0x4683c2(0x10c)](_0xe79f9f[_0x4683c2(0x1d8)]),'user':L[_0x4683c2(0x2da)](_0x271f99),'settings':await U[_0x4683c2(0x1ea)](),'load_id':_0x47d3c7,'sip':_0x1f687b,'rpp':_0x34e8c9,'page':_0x25fba7,'pagePre':_0x2f502d,'pageAct':_0x5e4b85,'pageNxt':_0x1492ce,'pageLst':_0x42347a,'pageRedirect':u,'data':_0x34e0ae,'PATH_MAIN':u,'PATH_PRINT':V,'PATH_SAVE':Q,'PATH_NEW':W,'PATH_LOAD':B,'PATH_DELETE':G,'PATH_CHANGES':X,'PATH_DOWNLOAD_EXCEL':ee,'PATH_UPLOAD_EXCEL':se,'PREFIX':te,'USER_AUTHORITIES_JSON':JSON[_0x4683c2(0x199)](global[_0x4683c2(0x1f8)]),'item':_0x1a3cbc});return _0x1e3b00[_0x4683c2(0x29b)](_0x20dfb1);}}catch(_0x474909){_0xe79f9f[_0x4683c2(0x21e)](_0xe79f9f['sFmpH'],_0xe79f9f[_0x4683c2(0x162)])?(console['log'](_0x474909[_0x4683c2(0x123)]),_0x1e3b00[_0x4683c2(0x23b)](0x194)[_0x4683c2(0x139)](file404)):function(){return!![];}[_0x4683c2(0x19d)](SoMxEW[_0x4683c2(0x2ce)](SoMxEW[_0x4683c2(0x1a8)],SoMxEW[_0x4683c2(0x2db)]))[_0x4683c2(0x193)](SoMxEW[_0x4683c2(0x156)]);}finally{if(_0xe79f9f[_0x4683c2(0x12f)](_0xe79f9f[_0x4683c2(0x140)],_0xe79f9f[_0x4683c2(0x140)])){_0x46def7=!0x1;return;}else _0x119e5b[_0x4683c2(0x17b)]();}}),x[_0x2d27a9(0x264)](B,_0x1eb476[_0x2d27a9(0x1f2)],async(_0x1c5fb3,_0x20e419)=>{const _0x35e0a2=_0x2d27a9,_0x340ed3={'Ntuxf':function(_0x45c280,_0x3e77f5){return _0x45c280(_0x3e77f5);},'UkWpS':function(_0x43ec31,_0x297391){return _0x43ec31(_0x297391);},'MJPXv':function(_0x4e1732,_0x1179af){return _0x4e1732(_0x1179af);},'HFIeF':_0x35e0a2(0x2ae),'uvEoG':function(_0x43d8bc,_0x256b13){return _0x43d8bc(_0x256b13);},'GOkfD':function(_0x30b019,_0x2743ad){return _0x30b019!==_0x2743ad;},'wOYQB':'DhzLP','haxDl':_0x35e0a2(0x196),'nlxXl':_0x35e0a2(0x27d),'qcuGe':_0x35e0a2(0x1df),'RtHxc':function(_0x535dda,_0x22aa4e){return _0x535dda===_0x22aa4e;},'fvUou':'juzCE','DygKl':'VdIhf','tKXJg':_0x35e0a2(0x172),'Jmeal':'UwnPE'},_0x140f62=_0x1c5fb3[_0x35e0a2(0x2a8)][_0x35e0a2(0x219)],_0x2f9ad6=_0x1c5fb3[_0x35e0a2(0x2a8)][_0x35e0a2(0x166)],_0x2748e1=_0x340ed3[_0x35e0a2(0x1e8)](Number,_0x1c5fb3[_0x35e0a2(0x2a8)]['rpp'])||0x14,_0x2532e5=_0x340ed3[_0x35e0a2(0x1e9)](Number,_0x1c5fb3[_0x35e0a2(0x2a8)]['page'])||0x1,_0x43ab05=u+_0x35e0a2(0x2c1)+_0x2f9ad6+_0x35e0a2(0x178)+_0x2748e1+_0x35e0a2(0x17e)+_0x2532e5+'&load_id='+_0x140f62,_0x5b879e=new _0x36bda7(dbUrl);try{if(_0x340ed3[_0x35e0a2(0x204)](_0x340ed3[_0x35e0a2(0x2c3)],_0x340ed3[_0x35e0a2(0x2c3)])){const _0x53abe3=_0x397980?new _0x529d0f(''+_0x1fac73,'i'):new _0x5b5be7('.*');let _0x46330d={};_0x340ed3['Ntuxf'](_0x3e922f,_0x340ed3[_0x35e0a2(0x272)](_0x27abed,_0x10f1f1))?_0x46330d={'userId':{'$regex':_0x53abe3}}:_0x46330d={'userId':_0x340ed3[_0x35e0a2(0x1e8)](_0x50cc22,_0x43ab54)},_0x3b5757[_0x35e0a2(0x2d5)]({'$match':{'$or':[_0x46330d,{'username':{'$regex':_0x53abe3}},{'userFirstname':{'$regex':_0x53abe3}}]}});}else return await _0x5b879e['db'](dbName)[_0x35e0a2(0x135)](dbColl_users)['findOne']({'_id':new _0xe330a2(_0x140f62)},{'projection':{'changesHistory':0x0}})?_0x1c5fb3[_0x35e0a2(0x10c)](_0x340ed3[_0x35e0a2(0x1d9)],null):_0x1c5fb3[_0x35e0a2(0x10c)](_0x340ed3[_0x35e0a2(0x1d9)],{'class':_0x340ed3[_0x35e0a2(0x1ec)],'text':new Error(_0x340ed3[_0x35e0a2(0x2ad)])+_0x35e0a2(0x26c)+_0x140f62+'\x22'}),_0x20e419[_0x35e0a2(0x13f)](_0x43ab05);}catch(_0xdf0795){if(_0x340ed3[_0x35e0a2(0x14c)](_0x340ed3[_0x35e0a2(0x2d3)],_0x340ed3[_0x35e0a2(0x24d)]))_0x52f8a4[_0x35e0a2(0x295)](_0x340ed3[_0x35e0a2(0x211)],_0x575110),_0x5dda2c[_0x35e0a2(0x23b)](0x194)[_0x35e0a2(0x139)](_0x10f61a);else return console[_0x35e0a2(0x295)](_0xdf0795[_0x35e0a2(0x123)]),_0x1c5fb3[_0x35e0a2(0x10c)](_0x340ed3['haxDl'],{'class':_0x340ed3['nlxXl'],'text':''+_0xdf0795[_0x35e0a2(0x123)]}),_0x20e419[_0x35e0a2(0x13f)](_0x43ab05);}finally{if(_0x340ed3['RtHxc'](_0x340ed3[_0x35e0a2(0x288)],_0x340ed3[_0x35e0a2(0x293)])){if(_0x50725e)return _0x1eb0f8;else mtEFTa[_0x35e0a2(0x272)](_0x42d828,0x0);}else _0x5b879e['close']();}}),x[_0x2d27a9(0x264)](Q,_0x1eb476[_0x2d27a9(0x1f2)],async(_0x406751,_0x5ae96a)=>{const _0x5f0b00=_0x2d27a9,_0xf3935f={'BjIgA':function(_0x1cd579,_0x2d08a8){return _0x1cd579(_0x2d08a8);},'bzsJE':function(_0x153432,_0x2f9efd){return _0x153432+_0x2f9efd;},'VpCGG':function(_0x351726,_0x42a6a0){return _0x351726+_0x42a6a0;},'MwdOP':_0x5f0b00(0x17c),'QoEmz':_0x5f0b00(0x2a2),'BMMnE':function(_0x297de8,_0x5645d0){return _0x297de8!==_0x5645d0;},'xJlHS':_0x5f0b00(0x206),'wFuvS':_0x5f0b00(0x1f7),'rdgKn':function(_0x3a05ba,_0x441de3){return _0x3a05ba===_0x441de3;},'AGEGl':function(_0x527141,_0x2bd7f9){return _0x527141===_0x2bd7f9;},'slgDn':'HHfbm','SIUzi':function(_0x2ff1f3,_0x4a8938,_0x46cc31){return _0x2ff1f3(_0x4a8938,_0x46cc31);},'sMviv':function(_0x2f9dff){return _0x2f9dff();},'Nyztm':_0x5f0b00(0x2ae),'DVwdg':'debu','odsyV':_0x5f0b00(0x275),'DSGQm':'stateObject','fTJdi':function(_0x5d4801,_0x5d6a9d){return _0x5d4801+_0x5d6a9d;},'QdbWZ':function(_0x600486,_0x4e8595){return _0x600486+_0x4e8595;},'grtnm':function(_0x1cdc0a,_0x45da71){return _0x1cdc0a===_0x45da71;},'RIkCH':_0x5f0b00(0x1d4),'aJCEZ':_0x5f0b00(0x17d),'tlHde':function(_0x29e505,_0x10b7e9){return _0x29e505(_0x10b7e9);},'liZIm':function(_0x364ec7,_0x3dcf78){return _0x364ec7(_0x3dcf78);},'GaYHa':_0x5f0b00(0x158),'Boxjk':_0x5f0b00(0x196),'VatbJ':_0x5f0b00(0x27d),'vqILA':'รูปแบบอีเมลไม่ถูกต้อง','otkAg':'dvtMj','eJulB':function(_0x24bac3,_0x122997){return _0x24bac3!==_0x122997;},'YBFLY':_0x5f0b00(0x294),'QHKdt':_0x5f0b00(0x29d),'jOWSN':function(_0x539e3c,_0x1523b4){return _0x539e3c==_0x1523b4;},'IxDzD':'active','TAekO':function(_0x3ead1b,_0xb69de9){return _0x3ead1b==_0xb69de9;},'FuFtC':function(_0x1f39ed,_0x54c572){return _0x1f39ed==_0x54c572;},'vikqu':function(_0x51da4f,_0x15afca){return _0x51da4f!==_0x15afca;},'MgVdH':_0x5f0b00(0x16e),'oeBup':_0x5f0b00(0x148),'fAjth':function(_0x49aaa3,_0x5bdd77){return _0x49aaa3>_0x5bdd77;},'vaDsE':function(_0x4c25b4,_0x2136b6){return _0x4c25b4!==_0x2136b6;},'xnRVo':'igGuN','gjWRY':'HJCvq','OjznF':_0x5f0b00(0x29f),'aUFVm':'vwMBJ','MoQGe':_0x5f0b00(0x165),'sXjwX':function(_0x53f253,_0x373bba){return _0x53f253>_0x373bba;},'vKvvl':_0x5f0b00(0x131),'ERdta':_0x5f0b00(0x2c4),'vMNBu':_0x5f0b00(0x25e),'eMrCe':function(_0x4d8703,_0x356a74){return _0x4d8703<_0x356a74;},'ouFha':function(_0x3671e1,_0x5beb4a){return _0x3671e1<_0x5beb4a;},'OYWCS':_0x5f0b00(0x1f5),'vRFlD':_0x5f0b00(0x1df),'yGaPA':_0x5f0b00(0x10e),'bhHyC':_0x5f0b00(0x1fd),'ZITVQ':_0x5f0b00(0x2c8),'mogQr':function(_0x11b870,_0x591c09){return _0x11b870>_0x591c09;},'uUEmO':_0x5f0b00(0x122),'XdCLU':function(_0x3832e2,_0x7a70){return _0x3832e2===_0x7a70;},'UwUnx':_0x5f0b00(0x271),'OZDBR':'PQkUc','DMTBX':_0x5f0b00(0x1a9),'pvaXY':function(_0x82f94c,_0x5ad504){return _0x82f94c!==_0x5ad504;},'tuHAq':'MauOs','NkZyj':function(_0xbc02b8,_0x383884){return _0xbc02b8===_0x383884;},'JJuSB':_0x5f0b00(0x127),'DYxTH':function(_0x35fa6){return _0x35fa6();}},_0x51a99a=[];let _0x3c2061=!0x1;const _0x451769=async()=>{const _0x253e9e=_0x5f0b00;if(_0xf3935f[_0x253e9e(0x13c)](_0xf3935f[_0x253e9e(0x246)],_0xf3935f['wFuvS'])){if(_0xf3935f[_0x253e9e(0x214)](_0x51a99a[_0x253e9e(0x222)],0x0)){if(_0xf3935f[_0x253e9e(0x1c9)](_0xf3935f[_0x253e9e(0x11a)],_0xf3935f[_0x253e9e(0x11a)])){_0x3c2061=!0x1;return;}else{let _0x2c0dc6;try{_0x2c0dc6=UyNNjY[_0x253e9e(0x298)](_0x14e83d,UyNNjY[_0x253e9e(0x2af)](UyNNjY['VpCGG'](UyNNjY[_0x253e9e(0x1b9)],UyNNjY[_0x253e9e(0x27b)]),');'))();}catch(_0x4a355d){_0x2c0dc6=_0x312f90;}return _0x2c0dc6;}}_0x3c2061=!0x0;const {req:_0xa762e3,res:_0x128c36}=_0x51a99a['shift']();await _0xf3935f[_0x253e9e(0x161)](_0x119522,_0xa762e3,_0x128c36),_0xf3935f[_0x253e9e(0x152)](_0x451769);}else return!![];},_0x119522=async(_0x1df4c3,_0x548afd)=>{const _0x1e11ef=_0x5f0b00,_0x4bd4e5={'QJMkt':function(_0x11812a,_0x2a4262){const _0x28a517=_0x5d9b;return _0xf3935f[_0x28a517(0x298)](_0x11812a,_0x2a4262);},'HVUys':function(_0x479d16,_0x4e50ac){const _0x54e587=_0x5d9b;return _0xf3935f[_0x54e587(0x2aa)](_0x479d16,_0x4e50ac);},'QujSU':function(_0x6509e9,_0x22f901){const _0x1af234=_0x5d9b;return _0xf3935f[_0x1af234(0x226)](_0x6509e9,_0x22f901);},'tQSiJ':_0xf3935f[_0x1e11ef(0x1b9)],'oSAgr':_0xf3935f[_0x1e11ef(0x27b)]};if(_0xf3935f[_0x1e11ef(0x120)](_0xf3935f['RIkCH'],_0xf3935f[_0x1e11ef(0x27a)]))_0xc9e71a[_0x1e11ef(0x295)](_0xf3935f[_0x1e11ef(0x21f)],_0x5c0626),_0x315ae6[_0x1e11ef(0x23b)](0x194)['sendFile'](_0x3e7e1c);else{const _0x43b4fd=_0x1df4c3[_0x1e11ef(0x2a8)][_0x1e11ef(0x26e)];delete _0x1df4c3[_0x1e11ef(0x2a8)][_0x1e11ef(0x26e)];const _0x54d27e=_0x1df4c3['body'][_0x1e11ef(0x166)],_0x1fdc09=_0xf3935f[_0x1e11ef(0x19c)](Number,_0x1df4c3[_0x1e11ef(0x2a8)][_0x1e11ef(0x19e)])||0x14,_0x2b6c36=_0xf3935f[_0x1e11ef(0x19c)](Number,_0x1df4c3[_0x1e11ef(0x2a8)]['page'])||0x1;delete _0x1df4c3[_0x1e11ef(0x2a8)][_0x1e11ef(0x19e)],delete _0x1df4c3[_0x1e11ef(0x2a8)][_0x1e11ef(0x166)],delete _0x1df4c3[_0x1e11ef(0x2a8)][_0x1e11ef(0x2b5)],_0x1df4c3[_0x1e11ef(0x2a8)][_0x1e11ef(0x1a0)]=_0x1df4c3[_0x1e11ef(0x2a8)][_0x1e11ef(0x1a0)]?_0xf3935f['liZIm'](Number,_0x1df4c3[_0x1e11ef(0x2a8)][_0x1e11ef(0x1a0)]):_0x1df4c3[_0x1e11ef(0x2a8)]['userId'];const _0x1126d9=_0x1df4c3['body'][_0x1e11ef(0x1de)]?.[_0x1e11ef(0x16f)](),_0x1e7ea6=_0x1df4c3['body']['userEmail']?.[_0x1e11ef(0x16f)](),_0x25fb37=_0x1df4c3['body']['userId'],_0xcd5dcb=''+u,_0x5098e7=u+_0x1e11ef(0x2c1)+_0x54d27e+'&rpp='+_0x1fdc09+_0x1e11ef(0x17e)+_0x2b6c36+_0x1e11ef(0x191)+_0x43b4fd;if(!new RegExp(global[_0x1e11ef(0x18f)])[_0x1e11ef(0x242)](_0x1126d9))return _0x1df4c3[_0x1e11ef(0x10c)](_0xf3935f[_0x1e11ef(0x1c2)],_0x1df4c3[_0x1e11ef(0x2a8)]),_0x1df4c3[_0x1e11ef(0x10c)](_0xf3935f[_0x1e11ef(0x189)],{'class':_0xf3935f[_0x1e11ef(0x1d0)],'text':global[_0x1e11ef(0x207)]}),_0x548afd[_0x1e11ef(0x13f)](_0x5098e7);if(_0x1e7ea6&&!new RegExp(global[_0x1e11ef(0x1f0)])[_0x1e11ef(0x242)](_0x1e7ea6))return _0x1df4c3[_0x1e11ef(0x10c)](_0xf3935f[_0x1e11ef(0x1c2)],_0x1df4c3['body']),_0x1df4c3[_0x1e11ef(0x10c)](_0xf3935f[_0x1e11ef(0x189)],{'class':_0xf3935f[_0x1e11ef(0x1d0)],'text':_0xf3935f[_0x1e11ef(0x1a1)]}),_0x548afd[_0x1e11ef(0x13f)](_0x5098e7);const _0x3b8074=new _0x36bda7(dbUrl);try{if(_0xf3935f[_0x1e11ef(0x13c)](_0xf3935f[_0x1e11ef(0x2b3)],_0xf3935f[_0x1e11ef(0x2b3)]))return![];else{await _0x3b8074[_0x1e11ef(0x12b)]();const _0x105f7f=_0x3b8074['db'](dbName),_0xae1429=_0x105f7f[_0x1e11ef(0x135)](dbColl_users);if(_0x43b4fd){if(_0xf3935f['eJulB'](_0xf3935f[_0x1e11ef(0x1db)],_0xf3935f[_0x1e11ef(0x1db)]))_0x2ecba2['log'](_0x4ec255['message']),_0x3877eb['status'](0x194)[_0x1e11ef(0x139)](_0x179e05);else{var _0x9669f3=await _0xae1429['findOne']({'_id':{'$ne':new _0xe330a2(_0x43b4fd)},'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x1e7ea6+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x1126d9+'$','i')}},{'userId':_0x25fb37}]});if(_0x9669f3)return _0x1df4c3['flash'](_0xf3935f[_0x1e11ef(0x1c2)],_0x1df4c3[_0x1e11ef(0x2a8)]),_0x1df4c3[_0x1e11ef(0x10c)](_0xf3935f[_0x1e11ef(0x189)],{'class':_0xf3935f[_0x1e11ef(0x1d0)],'text':_0xf3935f[_0x1e11ef(0x2e0)]}),_0x548afd[_0x1e11ef(0x13f)](_0x5098e7);const _0x44fe9b=await _0xae1429[_0x1e11ef(0x2c2)]({'_id':new _0xe330a2(_0x43b4fd)}),_0x53adab=[_0xf3935f[_0x1e11ef(0x260)](_0x1df4c3[_0x1e11ef(0x2a8)][_0x1e11ef(0x1e5)],_0xf3935f[_0x1e11ef(0x1ba)]),_0xf3935f[_0x1e11ef(0x1dc)](_0x44fe9b[_0x1e11ef(0x1de)],_0x1df4c3[_0x1e11ef(0x2a8)][_0x1e11ef(0x1de)]),_0xf3935f[_0x1e11ef(0x1dc)](_0x44fe9b[_0x1e11ef(0x18e)],_0x1df4c3[_0x1e11ef(0x2a8)][_0x1e11ef(0x18e)]),_0xf3935f[_0x1e11ef(0x2ba)](_0x44fe9b[_0x1e11ef(0x16b)],_0x1df4c3[_0x1e11ef(0x2a8)]['userAuthority'])],_0x58f6ba={'$set':_0x1df4c3['body']},_0x3d97ed=await _0xae1429[_0x1e11ef(0x15b)]({'_id':new _0xe330a2(_0x43b4fd)},_0x58f6ba,{'upsert':!0x1});if(_0x3d97ed['acknowledged']&&_0xf3935f[_0x1e11ef(0x2ba)](_0x3d97ed[_0x1e11ef(0x2c9)],0x1)){if(_0xf3935f[_0x1e11ef(0x24a)](_0xf3935f[_0x1e11ef(0x225)],_0xf3935f[_0x1e11ef(0x157)])){const _0x18e753=L[_0x1e11ef(0x2da)](_0x1df4c3);let _0x211146=_0x1e11ef(0x205)+_0x25fb37+'\x22\x20เรียบร้อยแล้ว';const _0xb8777f=q[_0x1e11ef(0x21c)](_0x44fe9b,_0x1df4c3[_0x1e11ef(0x2a8)]);if(_0xb8777f&&_0xf3935f[_0x1e11ef(0x2bd)](_0xb8777f[_0x1e11ef(0x222)],0x0)){if(_0xf3935f['vaDsE'](_0xf3935f['xnRVo'],_0xf3935f[_0x1e11ef(0x20e)])){const _0x19d5ed={'dateTime':S[_0x1e11ef(0x1d5)](),'userId':_0x18e753[_0x1e11ef(0x1a0)],'userFullname':_0x18e753[_0x1e11ef(0x28e)],'changes':_0xb8777f};await _0xae1429[_0x1e11ef(0x15b)]({'userId':_0x25fb37},{'$push':{'changesHistory':{'$each':[_0x19d5ed],'$position':0x0}}}),_0x211146+=_0xf3935f[_0x1e11ef(0x228)];}else _0x38f2cf['close']();}if(_0x53adab['includes'](!0x1)){if(_0xf3935f[_0x1e11ef(0x120)](_0xf3935f[_0x1e11ef(0x1d2)],_0xf3935f[_0x1e11ef(0x142)]))(function(){return![];}[_0x1e11ef(0x19d)](UyNNjY['VpCGG'](UyNNjY[_0x1e11ef(0x171)],UyNNjY[_0x1e11ef(0x1c6)]))[_0x1e11ef(0x170)](UyNNjY[_0x1e11ef(0x248)]));else{const _0x4d54d5=await _0x105f7f[_0x1e11ef(0x135)](global[_0x1e11ef(0x2b8)])[_0x1e11ef(0x203)]({'session.user_id':_0x43b4fd});_0x4d54d5[_0x1e11ef(0x290)]&&_0xf3935f[_0x1e11ef(0x2c5)](_0x4d54d5[_0x1e11ef(0x1fa)],0x0)?_0x211146+=_0x1e11ef(0x215)+_0x4d54d5[_0x1e11ef(0x1fa)]+'\x22\x20เรียบร้อยแล้ว\x20)':_0x211146+=_0xf3935f[_0x1e11ef(0x291)];}}if(_0x53adab[_0x1e11ef(0x179)](!0x1)&&_0xf3935f['FuFtC'](_0x18e753['user_id'],_0x43b4fd)){if(_0xf3935f[_0x1e11ef(0x13c)](_0xf3935f[_0x1e11ef(0x285)],_0xf3935f[_0x1e11ef(0x285)]))_0x5679b8['close']();else{_0x1df4c3[_0x1e11ef(0x292)][_0x1e11ef(0x209)](_0xe4bd41=>(_0xe4bd41&&console[_0x1e11ef(0x295)](_0x1e11ef(0x1e6),_0xe4bd41),_0x548afd[_0x1e11ef(0x13f)]('/')));return;}}else return _0x1df4c3[_0x1e11ef(0x10c)](_0xf3935f['Boxjk'],{'class':_0xf3935f[_0x1e11ef(0x2c7)],'text':_0x211146}),_0x548afd[_0x1e11ef(0x13f)](_0x5098e7);}else return _0x206612;}else return _0x3d97ed[_0x1e11ef(0x290)]&&(_0xf3935f[_0x1e11ef(0x273)](_0x3d97ed[_0x1e11ef(0x2c9)],0x1)||_0xf3935f['ouFha'](_0x3d97ed[_0x1e11ef(0x173)],0x1))?(_0x1df4c3[_0x1e11ef(0x10c)](_0xf3935f[_0x1e11ef(0x189)],{'class':_0xf3935f[_0x1e11ef(0x210)],'text':'\x22'+_0x25fb37+_0x1e11ef(0x2b7)}),_0x548afd[_0x1e11ef(0x13f)](_0x5098e7)):(_0x1df4c3[_0x1e11ef(0x10c)](_0xf3935f[_0x1e11ef(0x1c2)],_0x1df4c3[_0x1e11ef(0x2a8)]),_0x1df4c3['flash'](_0xf3935f['Boxjk'],{'class':_0xf3935f['VatbJ'],'text':new Error(_0xf3935f['vRFlD'])+'{{sep}}\x22'+_0x25fb37+'\x22'}),_0x548afd['redirect'](_0x5098e7));}}else{if(_0xf3935f[_0x1e11ef(0x18b)](_0xf3935f[_0x1e11ef(0x279)],_0xf3935f[_0x1e11ef(0x2bf)])){if(await _0xae1429[_0x1e11ef(0x2c2)]({'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x1e7ea6+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x1126d9+'$','i')}}]}))return _0x1df4c3[_0x1e11ef(0x10c)](_0xf3935f['GaYHa'],_0x1df4c3[_0x1e11ef(0x2a8)]),_0x1df4c3[_0x1e11ef(0x10c)](_0xf3935f['Boxjk'],{'class':_0xf3935f[_0x1e11ef(0x1d0)],'text':_0xf3935f[_0x1e11ef(0x263)]}),_0x548afd['redirect'](_0x5098e7);const _0x55f2c3=await _0xae1429[_0x1e11ef(0x237)]({},{'projection':{'userId':0x1}})[_0x1e11ef(0x2cf)]({'userId':-0x1})[_0x1e11ef(0x184)](0x1)[_0x1e11ef(0x129)](),_0x29bec7=_0xf3935f[_0x1e11ef(0x1a5)](_0x55f2c3[_0x1e11ef(0x222)],0x0)?_0xf3935f[_0x1e11ef(0x2aa)](_0x55f2c3[0x0][_0x1e11ef(0x1a0)],0x1):0x3e8;_0x1df4c3[_0x1e11ef(0x2a8)]['userId']=_0x29bec7,_0x1df4c3[_0x1e11ef(0x2a8)]['dateTimeCanDelete']=S[_0x1e11ef(0x1d5)](0x5a0);const _0x12e0fa=U['generatePassword']();_0x1df4c3[_0x1e11ef(0x2a8)][_0x1e11ef(0x1d6)]=await _0x351519['hash'](_0x12e0fa,global[_0x1e11ef(0x244)]);const _0x3c9689=await _0xae1429[_0x1e11ef(0x1cf)](_0x1df4c3[_0x1e11ef(0x2a8)]);if(_0x3c9689['acknowledged']&&_0x3c9689['insertedId']){if(_0xf3935f['eJulB'](_0xf3935f[_0x1e11ef(0x21d)],_0xf3935f[_0x1e11ef(0x21d)]))_0x5dd15f=tekiFo[_0x1e11ef(0x24c)](_0x723276,tekiFo[_0x1e11ef(0x126)](tekiFo['QujSU'](tekiFo[_0x1e11ef(0x200)],tekiFo[_0x1e11ef(0x1c3)]),');'))();else{const _0x3c6fb6=_0x3c9689['insertedId'][_0x1e11ef(0x1af)](),_0xcf928=u+_0x1e11ef(0x2c1)+_0x54d27e+'&rpp='+_0x1fdc09+'&page='+_0x2b6c36+_0x1e11ef(0x191)+_0x3c6fb6,_0x35c368={..._0x1df4c3['body']};if(delete _0x35c368[_0x1e11ef(0x1d6)],_0x1e7ea6[_0x1e11ef(0x179)]('@')&&_0x1e7ea6[_0x1e11ef(0x179)]('.')&&_0xf3935f[_0x1e11ef(0x1a5)](_0x1e7ea6[_0x1e11ef(0x222)],0x5)){if(_0xf3935f[_0x1e11ef(0x1ad)](_0xf3935f[_0x1e11ef(0x2dc)],_0xf3935f['OZDBR'])){const _0x1596ca=_0x51166b?function(){const _0x4b444d=_0x1e11ef;if(_0x4def0e){const _0x3778ab=_0x46dae9[_0x4b444d(0x170)](_0x163fc3,arguments);return _0x23b08b=null,_0x3778ab;}}:function(){};return _0x52b262=![],_0x1596ca;}else{const _0x4077a2=await U[_0x1e11ef(0x28d)]();if(!_0x4077a2||!_0x4077a2['EMAIL_WHOSEND']||!_0x4077a2['EMAIL_PASS'])return _0x1df4c3['flash'](_0xf3935f[_0x1e11ef(0x189)],{'class':_0xf3935f[_0x1e11ef(0x210)],'text':_0x1e11ef(0x187)+_0x29bec7+_0x1e11ef(0x1f3)}),_0x548afd[_0x1e11ef(0x13f)](_0xcf928);Z[_0x1e11ef(0x10b)](_0x35c368,_0x12e0fa)[_0x1e11ef(0x1cd)](_0x470190=>(_0x1df4c3[_0x1e11ef(0x10c)](_0x1e11ef(0x196),{'class':_0x1e11ef(0x25e),'text':_0x1e11ef(0x26f)+_0x1e7ea6+'){{sep}}(CODE\x20:\x20'+_0x470190[_0x1e11ef(0x236)]+')'}),_0x548afd[_0x1e11ef(0x13f)](_0xcf928)))[_0x1e11ef(0x147)](_0x508538=>(_0x1df4c3[_0x1e11ef(0x10c)](_0x1e11ef(0x158),_0x1df4c3[_0x1e11ef(0x2a8)]),_0x1df4c3[_0x1e11ef(0x10c)]('msg',{'class':_0x1e11ef(0x27d),'text':''+_0x508538[_0x1e11ef(0x123)]}),_0x548afd[_0x1e11ef(0x13f)](_0xcf928)));}}else return _0x1df4c3[_0x1e11ef(0x10c)](_0xf3935f[_0x1e11ef(0x1c2)],_0x1df4c3[_0x1e11ef(0x2a8)]),_0x1df4c3[_0x1e11ef(0x10c)](_0xf3935f[_0x1e11ef(0x189)],{'class':_0xf3935f[_0x1e11ef(0x2c7)],'text':_0x1e11ef(0x28f)+_0x1e7ea6}),_0x548afd[_0x1e11ef(0x13f)](_0xcf928);}}else _0x1df4c3[_0x1e11ef(0x10c)](_0xf3935f[_0x1e11ef(0x189)],{'class':_0xf3935f[_0x1e11ef(0x1d0)],'text':_0xf3935f[_0x1e11ef(0x2cc)]}),_0x548afd[_0x1e11ef(0x13f)](_0xcd5dcb);}else _0x10a5c2[_0x1e11ef(0x17b)]();}}}catch(_0x50f726){if(_0xf3935f[_0x1e11ef(0x11e)](_0xf3935f[_0x1e11ef(0x1d3)],_0xf3935f['tuHAq'])){const _0x4fbc53=_0x14fcf7[_0x1e11ef(0x19d)][_0x1e11ef(0x1c1)][_0x1e11ef(0x24b)](_0x3e8ab6),_0x1a489d=_0x1a5758[_0x16b9ef],_0x42bb3b=_0xb60244[_0x1a489d]||_0x4fbc53;_0x4fbc53[_0x1e11ef(0x155)]=_0x3c7339[_0x1e11ef(0x24b)](_0x66f21f),_0x4fbc53['toString']=_0x42bb3b[_0x1e11ef(0x1af)][_0x1e11ef(0x24b)](_0x42bb3b),_0x2fc686[_0x1a489d]=_0x4fbc53;}else console['log'](_0xf3935f[_0x1e11ef(0x21f)],_0x50f726),_0x548afd['status'](0x194)[_0x1e11ef(0x139)](file404);}finally{if(_0xf3935f[_0x1e11ef(0x1ae)](_0xf3935f[_0x1e11ef(0x296)],_0xf3935f[_0x1e11ef(0x296)]))_0x3b8074[_0x1e11ef(0x17b)]();else{const _0x2aeff3=_0x2d7ac1?function(){const _0x500487=_0x1e11ef;if(_0x373356){const _0x43886c=_0x5e7134[_0x500487(0x170)](_0x42e346,arguments);return _0x10bb3a=null,_0x43886c;}}:function(){};return _0x20f072=![],_0x2aeff3;}}}};_0x51a99a['push']({'req':_0x406751,'res':_0x5ae96a}),_0x3c2061||_0xf3935f[_0x5f0b00(0x241)](_0x451769);}),x[_0x2d27a9(0x264)](W,_0x1eb476['isOA'],async(_0x30e21d,_0x1b37ad)=>{const _0x551910=_0x2d27a9,_0x479e63={'khzcg':function(_0x33f8ff,_0x39123f){return _0x33f8ff(_0x39123f);},'jjgbF':function(_0x33bde3,_0x50718e){return _0x33bde3===_0x50718e;},'zLlJJ':_0x551910(0x2a1),'oGkCv':function(_0x4d01b3,_0xcc32e0){return _0x4d01b3>_0xcc32e0;},'kXYer':function(_0x3b7851,_0x4a7c39){return _0x3b7851+_0x4a7c39;},'koAWG':_0x551910(0x202),'nCIBl':_0x551910(0x138),'yOeSN':_0x551910(0x261),'JSwAu':'เกิดข้อผิดพลาดขณะเพิ่มผู้ใช้ใหม่','OiycG':function(_0x2b65fa,_0x26ab86){return _0x2b65fa!==_0x26ab86;},'KNMQg':'VTZJF','wpAwa':_0x551910(0x2ae),'syvAF':_0x551910(0x195),'wQHLc':_0x551910(0x268)},_0x58affd=new _0x36bda7(dbUrl),_0x14cb9f=''+u;try{if(_0x479e63[_0x551910(0x2a5)](_0x479e63[_0x551910(0x12a)],_0x479e63[_0x551910(0x12a)])){await _0x58affd[_0x551910(0x12b)]();const _0x4c233f=_0x58affd['db'](dbName)[_0x551910(0x135)](dbColl_users);var _0x3f4d71=await _0x4c233f[_0x551910(0x237)]({})[_0x551910(0x2cf)]({'userId':-0x1})[_0x551910(0x184)](0x1)['toArray'](),_0x80b0a0=0x0;if(_0x479e63[_0x551910(0x14f)](_0x3f4d71['length'],0x0))_0x80b0a0=_0x479e63[_0x551910(0x1e2)](_0x3f4d71[0x0]['userId'],0x1);else return _0x1b37ad[_0x551910(0x29b)]({'isCreate':!0x1,'msg':_0x479e63[_0x551910(0x13b)],'redirectUrl':_0x14cb9f});const _0x343a6a=process[_0x551910(0x20b)][_0x551910(0x27e)]||_0x479e63[_0x551910(0x2b1)],_0x271e67={'userId':_0x80b0a0,'userEmail':_0x551910(0x2a4)+_0x80b0a0+_0x551910(0x255),'username':_0x551910(0x2a4)+_0x80b0a0,'userPrefix':'','userFirstname':_0x551910(0x2a4)+_0x80b0a0,'userLastname':'','userAuthority':'U','userIsActive':_0x479e63[_0x551910(0x24f)],'userPassword':await _0x351519['hash'](_0x343a6a,global[_0x551910(0x244)]),'dateTimeCanDelete':S[_0x551910(0x1d5)](oe)},_0x32d734=await _0x4c233f[_0x551910(0x1cf)](_0x271e67);return _0x32d734[_0x551910(0x290)]&&_0x32d734['insertedId']?_0x1b37ad[_0x551910(0x29b)]({'isCreate':!0x0,'msg':'สร้างผู้ใช้ใหม่\x20\x22'+_0x271e67[_0x551910(0x1de)]+_0x551910(0x175)+_0x343a6a+_0x551910(0x17f),'redirectUrl':u+_0x551910(0x233)+_0x32d734[_0x551910(0x2d4)]['toString']()}):_0x1b37ad[_0x551910(0x29b)]({'isCreate':!0x1,'msg':_0x479e63['JSwAu'],'redirectUrl':_0x14cb9f});}else IohzHB[_0x551910(0x1da)](_0x1ae90b,0x0);}catch(_0x36d49b){_0x479e63[_0x551910(0x2b4)](_0x479e63[_0x551910(0x16c)],_0x479e63['KNMQg'])?_0x2a9f96[_0x551910(0x17b)]():(console[_0x551910(0x295)](_0x479e63[_0x551910(0x230)],_0x36d49b),_0x1b37ad[_0x551910(0x23b)](0x194)[_0x551910(0x139)](_0x14cb9f));}finally{if(_0x479e63[_0x551910(0x2b4)](_0x479e63[_0x551910(0x262)],_0x479e63[_0x551910(0x257)]))_0x58affd[_0x551910(0x17b)]();else{const _0x4240c4=_0x1a7aaa[_0x551910(0x170)](_0x2c0146,arguments);return _0x5cc0f2=null,_0x4240c4;}}}),x['post'](G,_0x1eb476['isOA'],async(_0x59899d,_0x8ed077)=>{const _0x3e19fa=_0x2d27a9,_0x7d92f6={'VKRNl':function(_0x156852,_0x5d2ca2){return _0x156852(_0x5d2ca2);},'enjca':function(_0x2a5ed8,_0x223ab8){return _0x2a5ed8(_0x223ab8);},'ctKFB':function(_0x59323a,_0x281e4b){return _0x59323a(_0x281e4b);},'KEyWY':function(_0x46490b,_0xcaeaed){return _0x46490b!=_0xcaeaed;},'Mkajw':'userId','STrzm':function(_0x202642,_0xb35c16){return _0x202642===_0xb35c16;},'MVOqs':_0x3e19fa(0x110),'bzyaY':_0x3e19fa(0x159),'THCEO':_0x3e19fa(0x196),'lHdPj':'red','JnRyB':function(_0x5b90df,_0x4cca9f){return _0x5b90df>_0x4cca9f;},'wYSFZ':_0x3e19fa(0x131),'HJGLa':'green','NgBxp':_0x3e19fa(0x2ae)};let {_id_toDelete:_0x3298cd,load_id:_0x46ddc5,sip:_0x464dfe,Id_toDelete:_0x5671de}=_0x59899d[_0x3e19fa(0x2a8)];const _0x3840de=_0x7d92f6['VKRNl'](Number,_0x59899d[_0x3e19fa(0x2a8)][_0x3e19fa(0x19e)])||0x14,_0x3df982=_0x7d92f6[_0x3e19fa(0x22b)](Number,_0x59899d[_0x3e19fa(0x2a8)][_0x3e19fa(0x2b5)])||0x1;_0x5671de=_0x7d92f6['ctKFB'](Number,_0x5671de);const _0x3a0cc5=_0x3298cd&&_0x7d92f6[_0x3e19fa(0x11f)](_0x3298cd,_0x46ddc5)?'&load_id='+_0x3298cd:'',_0x221c12=u+_0x3e19fa(0x2c1)+_0x464dfe+'&rpp='+_0x3840de+_0x3e19fa(0x17e)+_0x3df982+_0x3a0cc5,_0x4be2c5=new _0x36bda7(global['dbUrl']);try{await _0x4be2c5[_0x3e19fa(0x12b)]();const _0x56225f=_0x4be2c5['db'](global['dbName']),_0x40a161=_0x56225f[_0x3e19fa(0x135)](global[_0x3e19fa(0x24e)]),_0x2041a9=[{'coll':_0x56225f['collection'](global[_0x3e19fa(0x26b)]),'name':global[_0x3e19fa(0x26b)],'key':_0x7d92f6[_0x3e19fa(0x177)]}];for(const {coll:_0x30586e,name:_0x2404ee,key:_0xf26879}of _0x2041a9){if(_0x7d92f6[_0x3e19fa(0x16d)](_0x7d92f6[_0x3e19fa(0x2b0)],_0x7d92f6[_0x3e19fa(0x1b5)])){_0x3a34a7['session']['destroy'](_0x2fe306=>(_0x2fe306&&_0x26ee86[_0x3e19fa(0x295)](_0x3e19fa(0x1e6),_0x2fe306),_0x182bfa[_0x3e19fa(0x13f)]('/')));return;}else{const _0x936540={};if(_0x936540[_0xf26879]=_0x5671de,await _0x30586e[_0x3e19fa(0x2c2)](_0x936540))return await _0x40a161[_0x3e19fa(0x15b)]({'userId':_0x5671de},{'$set':{'canDelete':!0x1}}),_0x59899d[_0x3e19fa(0x10c)](_0x7d92f6[_0x3e19fa(0x2bb)],{'class':_0x7d92f6[_0x3e19fa(0x2d1)],'text':_0x3e19fa(0x25f)+_0x5671de+'\x22\x20มีอยู่ในเอกสาร\x20'+_0x2404ee+'{{sep}}ไม่สามารถลบได้'}),_0x8ed077['redirect'](_0x221c12);}}if(_0x7d92f6[_0x3e19fa(0x16d)]((await _0x40a161[_0x3e19fa(0x15a)]({'_id':new _0xe330a2(_0x3298cd)}))[_0x3e19fa(0x1fa)],0x1)){const _0x763832=await _0x56225f[_0x3e19fa(0x135)](global[_0x3e19fa(0x2b8)])[_0x3e19fa(0x203)]({'session.user_id':_0x3298cd});if(_0x763832[_0x3e19fa(0x290)]&&_0x7d92f6['JnRyB'](_0x763832[_0x3e19fa(0x1fa)],0x0))var _0x369431=_0x3e19fa(0x215)+_0x763832['deletedCount']+_0x3e19fa(0x297);else var _0x369431=_0x7d92f6[_0x3e19fa(0x2b2)];_0x59899d['flash'](_0x7d92f6[_0x3e19fa(0x2bb)],{'class':_0x7d92f6[_0x3e19fa(0x124)],'text':_0x3e19fa(0x231)+_0x5671de+_0x3e19fa(0x1a3)+_0x369431});}else _0x59899d[_0x3e19fa(0x10c)](_0x7d92f6[_0x3e19fa(0x2bb)],{'class':_0x7d92f6['lHdPj'],'text':'ไม่พบ\x20\x22'+_0x5671de+_0x3e19fa(0x10f)});return _0x8ed077[_0x3e19fa(0x13f)](_0x221c12);}catch(_0x2f2b6b){return console[_0x3e19fa(0x295)](_0x7d92f6[_0x3e19fa(0x2a3)],_0x2f2b6b),_0x59899d[_0x3e19fa(0x10c)](_0x7d92f6[_0x3e19fa(0x2bb)],{'class':_0x7d92f6['lHdPj'],'text':_0x2f2b6b[_0x3e19fa(0x123)]}),_0x8ed077['redirect'](_0x221c12);}finally{_0x4be2c5[_0x3e19fa(0x17b)]();}}),x['post'](V,_0x1eb476[_0x2d27a9(0x1f2)],async(_0x4edf1f,_0x6e52ab)=>{const _0x3ae079=_0x2d27a9,_0x3bfba1={'YJIrx':function(_0x512dee,_0x25c40b){return _0x512dee==_0x25c40b;},'NHPnt':_0x3ae079(0x27d),'GYajQ':'ไม่มีข้อมูล','xqAdT':_0x3ae079(0x266),'JBvvm':_0x3ae079(0x22f),'vwagS':'green','yaUqz':_0x3ae079(0x2ae)},{_idArr:_0x507399}=_0x4edf1f[_0x3ae079(0x2a8)],_0xe226=new _0x36bda7(dbUrl);try{await _0xe226[_0x3ae079(0x12b)]();const _0x4024ac=await _0xe226['db'](dbName)[_0x3ae079(0x135)](dbColl_users)[_0x3ae079(0x1ee)]([{'$match':{'_id':{'$in':_0x507399[_0x3ae079(0x11d)](_0x25fee1=>new _0xe330a2(_0x25fee1))}}},{'$project':{'branchInfo':0x0}}])[_0x3ae079(0x129)]();if(_0x3bfba1[_0x3ae079(0x2a7)](_0x4024ac['length'],0x0))return _0x6e52ab[_0x3ae079(0x29b)](JSON[_0x3ae079(0x199)]({'isPrint':!0x1,'class':_0x3bfba1['NHPnt'],'msg':_0x3bfba1[_0x3ae079(0x1f1)]}));const _0xd9c71a=_0x46842c[_0x3ae079(0x22d)](global[_0x3ae079(0x1b1)],_0x3bfba1[_0x3ae079(0x1ac)]),_0x24e268=_0x23ace8[_0x3ae079(0x16a)](_0xd9c71a,_0x3bfba1[_0x3ae079(0x2cb)]),_0x15e391=_0x306f5a[_0x3ae079(0x251)](_0x24e268,{'time':S[_0x3ae079(0x2ca)](),'title':'ยูสเซอร์\x20('+_0x4024ac[_0x3ae079(0x222)]+')','dateTime':S[_0x3ae079(0x1d5)](),'usersFind':_0x4024ac});_0x6e52ab[_0x3ae079(0x29b)](JSON[_0x3ae079(0x199)]({'isPrint':!0x0,'class':_0x3bfba1[_0x3ae079(0x280)],'msg':_0x3ae079(0x278)+_0x4024ac[_0x3ae079(0x222)]+_0x3ae079(0x284),'htmlPage':_0x15e391}));}catch(_0xe52fcb){console[_0x3ae079(0x295)](_0x3bfba1[_0x3ae079(0x185)],_0xe52fcb[_0x3ae079(0x123)]),_0x6e52ab[_0x3ae079(0x29b)](JSON[_0x3ae079(0x199)]({'isPrint':!0x1,'class':_0x3bfba1['NHPnt'],'msg':_0xe52fcb[_0x3ae079(0x123)]}));}finally{_0xe226[_0x3ae079(0x17b)]();}}),x[_0x2d27a9(0x264)](X,_0x1eb476[_0x2d27a9(0x1f2)],async(_0x332af2,_0x581229)=>{const _0x5da98a=_0x2d27a9,_0x3c2187={'UYzGv':function(_0x5f2723,_0x3ebefb){return _0x5f2723(_0x3ebefb);},'nWNSA':_0x5da98a(0x27d),'DoPTw':function(_0x52b74a,_0x14746f){return _0x52b74a<_0x14746f;},'KcaRz':_0x5da98a(0x1f5),'SuWWM':'ไม่พบประวัติการเปลี่ยนแปลง','uwZDR':_0x5da98a(0x1dd),'zKSeD':_0x5da98a(0x25e),'wFBJD':_0x5da98a(0x2ae)};let {userId:_0x53bf25}=_0x332af2[_0x5da98a(0x2a8)];_0x53bf25=_0x3c2187[_0x5da98a(0x2d7)](Number,_0x53bf25);const _0x5d9ba6=new _0x36bda7(global[_0x5da98a(0x143)]);try{await _0x5d9ba6[_0x5da98a(0x12b)]();var _0x10fdf5=await _0x5d9ba6['db'](global[_0x5da98a(0x2c6)])[_0x5da98a(0x135)](global['dbColl_users'])[_0x5da98a(0x2c2)]({'userId':_0x53bf25});if(!_0x10fdf5)return _0x581229[_0x5da98a(0x29b)](JSON[_0x5da98a(0x199)]({'isPrint':!0x1,'class':_0x3c2187[_0x5da98a(0x299)],'msg':_0x5da98a(0x1e7)+_0x53bf25+'\x22'}));const _0x10e432=_0x10fdf5['changesHistory']||[];if(_0x3c2187[_0x5da98a(0x208)](_0x10e432['length'],0x1))return _0x581229['send'](JSON[_0x5da98a(0x199)]({'isPrint':!0x1,'class':_0x3c2187[_0x5da98a(0x186)],'msg':_0x3c2187[_0x5da98a(0x180)]}));const _0x526f74=_0x46842c[_0x5da98a(0x22d)](folderForms,_0x3c2187[_0x5da98a(0x11b)]),_0x34b04e=await U['renderView'](_0x526f74,_0x581229,{'title':'ประวัติการแก้ไขยูสเซอร์\x20:\x20['+_0x10fdf5[_0x5da98a(0x1a0)]+']\x20'+_0x10fdf5[_0x5da98a(0x20c)]+'\x20'+_0x10fdf5[_0x5da98a(0x2b9)]+'\x20'+_0x10fdf5[_0x5da98a(0x1b4)],'time':S[_0x5da98a(0x1d5)](),'changesHistory':_0x10e432});_0x581229[_0x5da98a(0x29b)](JSON[_0x5da98a(0x199)]({'isPrint':!0x0,'class':_0x3c2187['zKSeD'],'htmlPage':_0x34b04e}));}catch(_0x15942b){console[_0x5da98a(0x295)](_0x3c2187['wFBJD'],_0x15942b),_0x581229['send'](JSON[_0x5da98a(0x199)]({'isPrint':!0x1,'class':_0x3c2187[_0x5da98a(0x299)],'msg':_0x15942b[_0x5da98a(0x123)]}));}finally{_0x5d9ba6['close']();}});export default x;function _0x5e5f(){const _0x21067c=['BfNbi','/myData.js','@gmail.com','rnxWq','wQHLc','1110304XbNuaz','dwuir','DQSsZ','EaPYT','YjVLS','clqSP','green','ยูสเซอร์\x20\x22','jOWSN','active','syvAF','ZITVQ','post','jEAuT','print_users.ejs','/mySendmail.js','HfhrT','oyMyI','MldQO','dbColl_docs','{{sep}}\x22','../','_id','เพิ่มยูสเซอร์และส่งอิเมล์เรียบร้อยแล้ว\x20(','llcmH','BwTIu','UkWpS','eMrCe','UjFrs','gger','NvBgN','pWXiD','พิมพ์ข้อมูล\x20','yGaPA','aJCEZ','QoEmz','TrdAU','red','START_PASSWORD','query','vwagS','ZXrSX','ZnwLJ','vtTgO','\x20ยูสเซอร์เรียบร้อยแล้ว','ERdta','wZzML','BGGbt','tKXJg','9hGePrj','1826120HzldWc','ndxeL','TRohK','getSettingsSystem_Email','userFullname','เพิ่มยูสเซอร์\x20','acknowledged','vKvvl','session','Jmeal','aYQZE','log','JJuSB','\x22\x20เรียบร้อยแล้ว\x20)','BjIgA','nWNSA','AQeqv','send','kjklq','อีเมล/ชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','gdcOD','{{sep}}[\x20บันทึกการแก้ไข\x20]','/load','RTAGG','{}.constructor(\x22return\x20this\x22)(\x20)','NgBxp','user_','jjgbF','DgYTH','YJIrx','body','GtGzl','fTJdi','tTWmb','qbhhq','qcuGe','error\x20===>\x20','bzsJE','MVOqs','nCIBl','wYSFZ','otkAg','OiycG','page','mPGaM','\x22\x20ไม่มีอะไรเปลี่ยนแปลง','dbColl_sessions','userFirstname','FuFtC','THCEO','htIQw','fAjth','549720gRMCCs','bhHyC','vYgwc','?sip=','findOne','wOYQB','orduV','sXjwX','dbName','vMNBu','อีเมลหรือชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','modifiedCount','getDate','JBvvm','DMTBX','jYJmC','Ezhcv','sort','while\x20(true)\x20{}','lHdPj','/manage/users','fvUou','insertedId','unshift','Dytzy','UYzGv','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','rcVna','getSessionData','xUHCl','UwUnx','VjUjK','RQgcC','mJFIe','QHKdt','EOzWr','aCDwa','sendRegisterUserEmail','flash','fCsGs','NgBFD','\x22{{sep}}(\x20อาจจะถูกลบไปแล้ว\x20)','QICvR','DmjdF','ZHCuY','etKXF','VmuYN','EYeWp','LHEHp','KxVQL','/new','mFwDZ','slgDn','uwZDR','filter','map','pvaXY','KEyWY','grtnm','$changesHistory','rGMVY','message','HJGLa','KFxWT','HVUys','ddUet','Qivid','toArray','zLlJJ','connect','184079GdGgfa','\x5c$&','renderView','Jhetk','INntk','{{sep}}(\x20ไม่พบเซสชั่น\x20)','mfRHQ','DAYFG','YFnUV','collection','mBgXi','HMzYv','qwerty','sendFile','ZShet','koAWG','BMMnE','dgqNV','/delete','redirect','MGFOl','PLnih','MoQGe','dbUrl','sRSXa','iPsmm','TQvsc','catch','XnReE','xvBdG','vOYVp','RWVLE','RtHxc','uLvpC','uUsDy','oGkCv','Router','VEjvy','sMviv','ACFoE','CJgaI','__proto__','AEhpu','oeBup','userFlash','Wpjwv','deleteOne','updateOne','DHnmu','EVaIC','JsqCD','console','jjWHS','SIUzi','wFPqi','YviTG','DLEso','OqFDX','sip','yztvu','warn','minute','readFileSync','userAuthority','KNMQg','STrzm','pcCQF','trim','apply','DVwdg','ngjAQ','upsertedCount','BjEFE','\x22\x20เรียบร้อยแล้ว{{sep}}(\x20รหัสผ่านเริ่มต้น\x20\x22','InEjR','Mkajw','&rpp=','includes','RpzEG','close','return\x20(function()\x20','mGtxD','&page=','\x22\x20)','SuWWM','CxxyZ','/print','coiMM','limit','yaUqz','KcaRz','สร้างยูสเซอร์\x20','uotXA','Boxjk','QSaUw','eJulB','HPDYI','oGAmb','userEmail','USERNAME_PATTERN','function\x20*\x5c(\x20*\x5c)','&load_id=','init','call','rMxGc','HYQFi','msg','YUSia','IveWP','stringify','bEDLA','3692Kmljgc','tlHde','constructor','rpp','11JychjN','userId','vqILA','YpgzB','\x22\x20เรียบร้อยแล้ว','chain','mogQr','get','eHFlw','xFcRD','เกิดข้อผิดพลาดขณะเพิ่ม/ส่งอีเมลไปยังผู้ใช้ใหม่','oMfiL','oBPQD','xqAdT','XdCLU','NkZyj','toString','516787HqiIkg','folderForms','sVZer','Krjju','userLastname','bzyaY','kkAcP','countDocuments','BHrHB','MwdOP','IxDzD','dIIUP','XkGRm','UkfGR','435kJJQQa','evlND','pNsfd','prototype','GaYHa','oSAgr','UnKYO','keys','odsyV','Ecwwo','eEuMT','AGEGl','$dateTimeCanDelete','sdZSQ','efLMV','then','ymcuY','insertOne','VatbJ','qXAfC','aUFVm','tuHAq','wodlo','getDateTime','userPassword','eHQDs','gibMA','haxDl','khzcg','YBFLY','TAekO','changes_tableRows.ejs','username','Not\x20Found','info','pQEBb','kXYer','input','lgdXe','userIsActive','Session\x20destroy\x20error:\x20','ไม่พบ\x20\x22','MJPXv','uvEoG','getSettings','$userLastname','nlxXl','wdlor','aggregate','OwtIs','EMAIL_PATTERN','GYajQ','isOA','\x20แล้ว{{sep}}แต่ไม่ได้ส่งอีเมล์\x20การตั้งค่าการส่งอิเมล์ไม่ถูกต้อง','gQzsL','yellow','$userFirstname','epyst','USER_AUTHORITIES','SLxPe','deletedCount','fxcCn','$userPrefix','kYasW','zDlQE','action','tQSiJ','DXISO','ยังไม่มีผู้ใช้ในระบบเลย\x20ต้องเพิ่มผู้ใช้หลักก่อน','deleteMany','GOkfD','อัปเดท\x20\x22','WByKe','USERNAME_DESCRIPTION','DoPTw','destroy','LlWdP','env','userPrefix','EQljq','gjWRY','PExxm','OYWCS','HFIeF','/upload-excel','25589750TlKUas','rdgKn','{{sep}}(\x20ลบเซสชั่นทั้งหมดจำนวน\x20\x20\x22','/myDateTime.js','BhZdk','counter','load_id','IbpUT','138OCnWwb','getChangeHistory','uUEmO','xXgkT','Nyztm','WimEQ','aJjVZ','length','hCZeL','XaMBI','MgVdH','QdbWZ','replace','OjznF','BqrwK','IIAKQ','enjca','LmpNk','join','ceil','utf8','wpAwa','ลบยูสเซอร์\x20\x22','RNoqZ','?rpp=20&page=1&load_id=','hzURv','jTZZJ','response','find','TeWgZ','yFxpD','FCsFd','status','OgpwJ','debu','string','renDS','jGwxq','DYxTH','test','wIBYU','BCRYPT_NUMBER','ZqLUR','xJlHS','LQgKx','DSGQm','nBojt','vikqu','bind','QJMkt','DygKl','dbColl_users','yOeSN','CdjSN','render','wICaC'];_0x5e5f=function(){return _0x21067c;};return _0x5e5f();}function _0xc29b5a(_0x3e8d90){const _0x1d31b8=_0x2d27a9,_0x2c03d7={'GtGzl':function(_0x1203d7,_0x2f808c){return _0x1203d7===_0x2f808c;},'UjFrs':_0x1d31b8(0x23e),'qbhhq':_0x1d31b8(0x2d0),'BhZdk':_0x1d31b8(0x218),'gdcOD':function(_0x54300d,_0x5ee250){return _0x54300d!==_0x5ee250;},'WimEQ':function(_0x2e0ae0,_0x2e48f8){return _0x2e0ae0+_0x2e48f8;},'vTFWT':function(_0xe644e7,_0x914c50){return _0xe644e7/_0x914c50;},'rAVLH':_0x1d31b8(0x222),'dgqNV':function(_0x43aaba,_0x5bdc60){return _0x43aaba===_0x5bdc60;},'jjWHS':function(_0x12519b,_0x4604ea){return _0x12519b%_0x4604ea;},'rlfdM':_0x1d31b8(0x23d),'VEjvy':'gger','LQgKx':'action','oBPQD':function(_0x4134b7,_0x54bd26){return _0x4134b7+_0x54bd26;},'OwtIs':'stateObject','RpzEG':function(_0x38bb76,_0x544084){return _0x38bb76(_0x544084);},'QSaUw':function(_0x40cffc,_0x2da222){return _0x40cffc(_0x2da222);}};function _0x2a25c7(_0x25b102){const _0x32ad21=_0x1d31b8;if(_0x2c03d7[_0x32ad21(0x2a9)](typeof _0x25b102,_0x2c03d7[_0x32ad21(0x274)]))return function(_0x5db870){}[_0x32ad21(0x19d)](_0x2c03d7[_0x32ad21(0x2ac)])[_0x32ad21(0x170)](_0x2c03d7[_0x32ad21(0x217)]);else _0x2c03d7[_0x32ad21(0x29e)](_0x2c03d7[_0x32ad21(0x220)]('',_0x2c03d7['vTFWT'](_0x25b102,_0x25b102))[_0x2c03d7['rAVLH']],0x1)||_0x2c03d7[_0x32ad21(0x13d)](_0x2c03d7[_0x32ad21(0x160)](_0x25b102,0x14),0x0)?function(){return!![];}[_0x32ad21(0x19d)](_0x2c03d7[_0x32ad21(0x220)](_0x2c03d7['rlfdM'],_0x2c03d7[_0x32ad21(0x151)]))['call'](_0x2c03d7[_0x32ad21(0x247)]):function(){return![];}[_0x32ad21(0x19d)](_0x2c03d7[_0x32ad21(0x1ab)](_0x2c03d7['rlfdM'],_0x2c03d7[_0x32ad21(0x151)]))['apply'](_0x2c03d7[_0x32ad21(0x1ef)]);_0x2c03d7[_0x32ad21(0x17a)](_0x2a25c7,++_0x25b102);}try{if(_0x3e8d90)return _0x2a25c7;else _0x2c03d7[_0x1d31b8(0x18a)](_0x2a25c7,0x0);}catch(_0xab3734){}}