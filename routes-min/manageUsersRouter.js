const _0x50c3a3=_0x4740;(function(_0x10a926,_0x4d29e3){const _0x41c8b3=_0x4740,_0x5b550c=_0x10a926();while(!![]){try{const _0x27ffcd=-parseInt(_0x41c8b3(0x293))/0x1+-parseInt(_0x41c8b3(0x1de))/0x2*(-parseInt(_0x41c8b3(0x31c))/0x3)+parseInt(_0x41c8b3(0x342))/0x4+-parseInt(_0x41c8b3(0x371))/0x5*(parseInt(_0x41c8b3(0x2e6))/0x6)+-parseInt(_0x41c8b3(0x254))/0x7+-parseInt(_0x41c8b3(0x338))/0x8*(-parseInt(_0x41c8b3(0x374))/0x9)+-parseInt(_0x41c8b3(0x294))/0xa;if(_0x27ffcd===_0x4d29e3)break;else _0x5b550c['push'](_0x5b550c['shift']());}catch(_0xef28d8){_0x5b550c['push'](_0x5b550c['shift']());}}}(_0x1825,0x8cd0a));const _0x1d6d7b=(function(){const _0x3b39bd=_0x4740,_0x4d99ef={'ILkqn':function(_0x536efa,_0x42bfd3){return _0x536efa(_0x42bfd3);},'uVrse':function(_0x561017,_0x352b44){return _0x561017!==_0x352b44;},'GsCxl':'rYoZU','EisLc':_0x3b39bd(0x373),'mTOnN':_0x3b39bd(0x24a),'mIDjC':function(_0x114b49,_0x4c838f){return _0x114b49!==_0x4c838f;},'soGnk':_0x3b39bd(0x230)};let _0x1387ed=!![];return function(_0x395322,_0x6b0245){const _0xf9774=_0x3b39bd,_0x441843={'cjcaS':function(_0x204569,_0x5e865f){const _0xfbe4f4=_0x4740;return _0x4d99ef[_0xfbe4f4(0x29a)](_0x204569,_0x5e865f);},'QLGJH':function(_0x1d85b4,_0x3d8798){const _0x470e82=_0x4740;return _0x4d99ef[_0x470e82(0x29a)](_0x1d85b4,_0x3d8798);},'plINK':function(_0x1f682c,_0x52d490){return _0x4d99ef['ILkqn'](_0x1f682c,_0x52d490);},'yYUxm':function(_0x4d4e5f,_0xe6a516){const _0x5d8c69=_0x4740;return _0x4d99ef[_0x5d8c69(0x292)](_0x4d4e5f,_0xe6a516);},'BcjHP':_0x4d99ef[_0xf9774(0x337)],'fpjoh':function(_0x3d2901,_0x29e0f8){const _0x221b47=_0xf9774;return _0x4d99ef[_0x221b47(0x292)](_0x3d2901,_0x29e0f8);},'sWKNX':_0x4d99ef['EisLc'],'tLaeU':_0x4d99ef[_0xf9774(0x1d8)]};if(_0x4d99ef['mIDjC'](_0x4d99ef[_0xf9774(0x30b)],_0x4d99ef[_0xf9774(0x30b)])){if(_0x11c377){const _0x4490a7=_0xa958f0['apply'](_0x2df030,arguments);return _0x4c62c6=null,_0x4490a7;}}else{const _0x1403a8=_0x1387ed?function(){const _0x36815f=_0xf9774,_0x55ea37={'aUHIY':function(_0x5781a7,_0x39903f){const _0x1e09fd=_0x4740;return _0x441843[_0x1e09fd(0x24f)](_0x5781a7,_0x39903f);}};if(_0x441843[_0x36815f(0x379)](_0x441843['BcjHP'],_0x441843[_0x36815f(0x271)])){const _0x2d0dad=_0x3a1df1?new _0x4ddd50(''+_0x4887a8,'i'):new _0xfbf75b('.*');let _0x37a85f={};_0x441843[_0x36815f(0x32d)](_0x3968d7,_0x441843[_0x36815f(0x1f8)](_0x35df39,_0x1c691b))?_0x37a85f={'userId':{'$regex':_0x2d0dad}}:_0x37a85f={'userId':_0x441843[_0x36815f(0x1f8)](_0xdd406b,_0x33a03e)},_0x4b909e[_0x36815f(0x296)]({'$match':{'$or':[_0x37a85f,{'username':{'$regex':_0x2d0dad}},{'userFirstname':{'$regex':_0x2d0dad}}]}});}else{if(_0x6b0245){if(_0x441843[_0x36815f(0x32e)](_0x441843[_0x36815f(0x27d)],_0x441843[_0x36815f(0x304)])){const _0x3ec3ce=_0x6b0245[_0x36815f(0x269)](_0x395322,arguments);return _0x6b0245=null,_0x3ec3ce;}else{if(_0x4faaa4)return _0x3efc7d;else _0x55ea37[_0x36815f(0x2d3)](_0xf95ad2,0x0);}}}}:function(){};return _0x1387ed=![],_0x1403a8;}};}());(function(){const _0x42448f=_0x4740,_0x51350b={'DWsUP':function(_0x3adaea,_0x464e0e){return _0x3adaea(_0x464e0e);},'AZvEp':function(_0x308f3f,_0x36c4a9){return _0x308f3f+_0x36c4a9;},'AJQnG':function(_0x20de17,_0xee26aa){return _0x20de17+_0xee26aa;},'xyICF':'return\x20(function()\x20','qVMeg':'{}.constructor(\x22return\x20this\x22)(\x20)','eYuTX':function(_0x4e6791){return _0x4e6791();},'QUBUg':_0x42448f(0x35f),'nqDGf':'warn','sGhch':_0x42448f(0x390),'qClnz':_0x42448f(0x285),'UDiIZ':_0x42448f(0x2b0),'oMBOh':_0x42448f(0x26b),'HDPYb':_0x42448f(0x244),'gFfVJ':function(_0x1da569,_0x30cfb1){return _0x1da569<_0x30cfb1;},'WGvsn':function(_0x1afca0,_0x169719){return _0x1afca0===_0x169719;},'mlJjg':'HgfjQ','SrKuh':_0x42448f(0x1d4),'uyPSy':'function\x20*\x5c(\x20*\x5c)','cPcBJ':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','ROsUH':function(_0x3bee87,_0x249b34){return _0x3bee87(_0x249b34);},'yOPTi':_0x42448f(0x270),'sAoDj':function(_0xf06cb2,_0x5d7958){return _0xf06cb2+_0x5d7958;},'XrEXK':_0x42448f(0x205),'yaiXC':_0x42448f(0x307),'XCZKs':function(_0x4fc9dc,_0x9f01ae){return _0x4fc9dc!==_0x9f01ae;},'uenaC':_0x42448f(0x2dd),'cZcjO':function(_0x7468e0,_0x22f054){return _0x7468e0(_0x22f054);},'gnxYn':_0x42448f(0x1fd),'uIHST':function(_0x1570a9,_0x8be098,_0xaa6525){return _0x1570a9(_0x8be098,_0xaa6525);}};_0x51350b[_0x42448f(0x2a8)](_0x1d6d7b,this,function(){const _0x35e084=_0x42448f;if(_0x51350b[_0x35e084(0x2c9)](_0x51350b['mlJjg'],_0x51350b['SrKuh'])){let _0x32a55b;try{const _0x4c230e=_0x51350b[_0x35e084(0x213)](_0x5b50a7,_0x51350b['AZvEp'](_0x51350b[_0x35e084(0x233)](_0x51350b['xyICF'],_0x51350b['qVMeg']),');'));_0x32a55b=_0x51350b[_0x35e084(0x323)](_0x4c230e);}catch(_0x4f825e){_0x32a55b=_0x4a7a64;}const _0x201e78=_0x32a55b[_0x35e084(0x32c)]=_0x32a55b[_0x35e084(0x32c)]||{},_0x34c71c=[_0x51350b[_0x35e084(0x37f)],_0x51350b[_0x35e084(0x1f2)],_0x51350b[_0x35e084(0x2ce)],_0x51350b['qClnz'],_0x51350b[_0x35e084(0x1d2)],_0x51350b[_0x35e084(0x382)],_0x51350b['HDPYb']];for(let _0x6e14ef=0x0;_0x51350b[_0x35e084(0x1dd)](_0x6e14ef,_0x34c71c[_0x35e084(0x20a)]);_0x6e14ef++){const _0x6dd2e2=_0x43a104['constructor'][_0x35e084(0x226)][_0x35e084(0x2b5)](_0x4d5d42),_0x59206f=_0x34c71c[_0x6e14ef],_0x4a4d67=_0x201e78[_0x59206f]||_0x6dd2e2;_0x6dd2e2[_0x35e084(0x239)]=_0xe3be26[_0x35e084(0x2b5)](_0x1f25bb),_0x6dd2e2[_0x35e084(0x1cc)]=_0x4a4d67['toString'][_0x35e084(0x2b5)](_0x4a4d67),_0x201e78[_0x59206f]=_0x6dd2e2;}}else{const _0x27126a=new RegExp(_0x51350b[_0x35e084(0x212)]),_0x3e7ded=new RegExp(_0x51350b[_0x35e084(0x1fa)],'i'),_0x1bcbaa=_0x51350b['ROsUH'](_0x305b9e,_0x51350b[_0x35e084(0x228)]);if(!_0x27126a[_0x35e084(0x33b)](_0x51350b[_0x35e084(0x290)](_0x1bcbaa,_0x51350b[_0x35e084(0x2f9)]))||!_0x3e7ded['test'](_0x51350b[_0x35e084(0x376)](_0x1bcbaa,_0x51350b[_0x35e084(0x25a)]))){if(_0x51350b['XCZKs'](_0x51350b[_0x35e084(0x2a6)],_0x51350b['uenaC'])){const _0x477a09=_0x5bd5fb['apply'](_0x427d7e,arguments);return _0x8d74aa=null,_0x477a09;}else _0x51350b[_0x35e084(0x386)](_0x1bcbaa,'0');}else{if(_0x51350b[_0x35e084(0x26f)](_0x51350b[_0x35e084(0x344)],_0x51350b[_0x35e084(0x344)]))return _0xb62fd1;else _0x51350b[_0x35e084(0x323)](_0x305b9e);}}})();}());const _0x138171=(function(){const _0x1c9664=_0x4740,_0x384b78={'uSzCF':function(_0x64727a,_0x4ef141){return _0x64727a(_0x4ef141);},'vvHYx':function(_0x38f34c,_0x1bde1f){return _0x38f34c!==_0x1bde1f;},'qPgYs':'SowSb','lRsHH':'FcIaK','FJmFn':function(_0x492b95,_0x219d85){return _0x492b95===_0x219d85;},'hEwvF':_0x1c9664(0x264),'nqKbM':_0x1c9664(0x2b4),'LfTqi':_0x1c9664(0x2ee)};let _0x33aafe=!![];return function(_0x254e36,_0x36f3a9){const _0x4487f8=_0x1c9664,_0x452e48={'WUTMy':function(_0x25458f,_0x12da26){const _0x2110f2=_0x4740;return _0x384b78[_0x2110f2(0x2c2)](_0x25458f,_0x12da26);},'cVfku':function(_0x3c883e,_0x5cc43d){return _0x384b78['vvHYx'](_0x3c883e,_0x5cc43d);},'KFYGr':_0x384b78[_0x4487f8(0x256)],'kVdVj':_0x384b78[_0x4487f8(0x2a2)],'OldLh':function(_0x5b9101,_0x3f5cab){const _0x1d533d=_0x4487f8;return _0x384b78[_0x1d533d(0x2fd)](_0x5b9101,_0x3f5cab);},'OHbMa':_0x384b78[_0x4487f8(0x2fe)],'tBsjz':_0x384b78[_0x4487f8(0x38f)]};if(_0x384b78[_0x4487f8(0x2fd)](_0x384b78[_0x4487f8(0x347)],_0x384b78[_0x4487f8(0x347)])){const _0x225bab=_0x33aafe?function(){const _0x4dcdc8=_0x4487f8,_0x4f0641={'zhwDw':function(_0x38f7ca,_0x4720ed){const _0x4f369b=_0x4740;return _0x452e48[_0x4f369b(0x2c4)](_0x38f7ca,_0x4720ed);}};if(_0x452e48[_0x4dcdc8(0x32f)](_0x452e48[_0x4dcdc8(0x21b)],_0x452e48[_0x4dcdc8(0x2e8)])){if(_0x36f3a9){if(_0x452e48['OldLh'](_0x452e48[_0x4dcdc8(0x2b3)],_0x452e48[_0x4dcdc8(0x1e8)]))_0x2c8c5c[_0x4dcdc8(0x279)]();else{const _0xe709e5=_0x36f3a9[_0x4dcdc8(0x269)](_0x254e36,arguments);return _0x36f3a9=null,_0xe709e5;}}}else _0x4f0641[_0x4dcdc8(0x312)](_0x506dfb,0x0);}:function(){};return _0x33aafe=![],_0x225bab;}else{if(_0x51424e){const _0x121e23=_0x3eb3a4['apply'](_0x500c4a,arguments);return _0x884709=null,_0x121e23;}}};}()),_0x2c8126=_0x138171(this,function(){const _0x28322b=_0x4740,_0x14b23c={'wIuDS':'error\x20===>\x20','JjrYB':_0x28322b(0x2cb),'bisKQ':_0x28322b(0x35c),'WnNEY':function(_0x10fe50,_0x2ba7c7){return _0x10fe50(_0x2ba7c7);},'LiouM':_0x28322b(0x270),'WRmVZ':function(_0x1521ac,_0x25f425){return _0x1521ac+_0x25f425;},'fkWvi':'chain','CtrIe':_0x28322b(0x307),'irQCf':function(_0x86a76e){return _0x86a76e();},'FvYsQ':function(_0x16aebf,_0x5c2ba4,_0x5cf84f){return _0x16aebf(_0x5c2ba4,_0x5cf84f);},'WHJsr':function(_0x53b235,_0x383230){return _0x53b235===_0x383230;},'hicjY':_0x28322b(0x310),'FNalz':'return\x20(function()\x20','gbxVy':'{}.constructor(\x22return\x20this\x22)(\x20)','ngAhz':_0x28322b(0x2d6),'jccST':'NxEzW','tVuMo':_0x28322b(0x35f),'ZZYbc':'warn','oCSoj':_0x28322b(0x390),'Ecggw':_0x28322b(0x285),'OtYnQ':_0x28322b(0x2b0),'XiYTH':_0x28322b(0x26b),'haGQC':'trace','eGiJp':function(_0x313b6f,_0x101a33){return _0x313b6f<_0x101a33;},'nOIbC':function(_0x5017a7,_0x43cf5e){return _0x5017a7!==_0x43cf5e;},'XWGiT':'JTAbz'};let _0x43c4ff;try{if(_0x14b23c[_0x28322b(0x201)](_0x14b23c['hicjY'],_0x14b23c[_0x28322b(0x2d1)])){const _0x8b6739=_0x14b23c[_0x28322b(0x367)](Function,_0x14b23c[_0x28322b(0x36c)](_0x14b23c[_0x28322b(0x36c)](_0x14b23c[_0x28322b(0x2a4)],_0x14b23c[_0x28322b(0x372)]),');'));_0x43c4ff=_0x14b23c[_0x28322b(0x33e)](_0x8b6739);}else _0x56a948[_0x28322b(0x35f)](_0x14b23c[_0x28322b(0x248)],_0x5157a7),_0x14bedd[_0x28322b(0x2e9)](0x194)[_0x28322b(0x234)](_0x63cd5c);}catch(_0x3d73c1){_0x14b23c[_0x28322b(0x201)](_0x14b23c[_0x28322b(0x362)],_0x14b23c['jccST'])?(_0x464595['log'](_0x5cff93['message']),_0x1eeda3['status'](0x194)[_0x28322b(0x234)](_0x4d17b8)):_0x43c4ff=window;}const _0x454596=_0x43c4ff[_0x28322b(0x32c)]=_0x43c4ff[_0x28322b(0x32c)]||{},_0x5a7cde=[_0x14b23c[_0x28322b(0x1e2)],_0x14b23c['ZZYbc'],_0x14b23c[_0x28322b(0x34e)],_0x14b23c['Ecggw'],_0x14b23c[_0x28322b(0x2ed)],_0x14b23c['XiYTH'],_0x14b23c[_0x28322b(0x345)]];for(let _0x13bb4c=0x0;_0x14b23c['eGiJp'](_0x13bb4c,_0x5a7cde[_0x28322b(0x20a)]);_0x13bb4c++){if(_0x14b23c['nOIbC'](_0x14b23c[_0x28322b(0x23c)],_0x14b23c[_0x28322b(0x23c)])){const _0x4d95f9={'ixnDK':_0x14b23c[_0x28322b(0x1fe)],'kpYNA':_0x14b23c[_0x28322b(0x33d)],'jxtPp':function(_0x26373c,_0x2d5ed2){const _0x523cff=_0x28322b;return _0x14b23c[_0x523cff(0x367)](_0x26373c,_0x2d5ed2);},'YBiBu':_0x14b23c[_0x28322b(0x32b)],'fWRDL':function(_0x428b6d,_0x324789){const _0x3fc787=_0x28322b;return _0x14b23c[_0x3fc787(0x36c)](_0x428b6d,_0x324789);},'ywrIU':_0x14b23c['fkWvi'],'ylXWk':_0x14b23c[_0x28322b(0x2bb)],'cwrAa':function(_0x2f94df){const _0x3c1418=_0x28322b;return _0x14b23c[_0x3c1418(0x33e)](_0x2f94df);}};_0x14b23c[_0x28322b(0x204)](_0x25350c,this,function(){const _0x165615=_0x28322b,_0x4c42cd=new _0x4638ec(_0x4d95f9[_0x165615(0x232)]),_0x37de21=new _0x4fd988(_0x4d95f9[_0x165615(0x275)],'i'),_0x5292cb=_0x4d95f9[_0x165615(0x1dc)](_0x10f556,_0x4d95f9['YBiBu']);!_0x4c42cd[_0x165615(0x33b)](_0x4d95f9[_0x165615(0x206)](_0x5292cb,_0x4d95f9[_0x165615(0x22f)]))||!_0x37de21['test'](_0x4d95f9[_0x165615(0x206)](_0x5292cb,_0x4d95f9[_0x165615(0x2d2)]))?_0x4d95f9[_0x165615(0x1dc)](_0x5292cb,'0'):_0x4d95f9[_0x165615(0x1c3)](_0x2c7450);})();}else{const _0x58414c=_0x138171['constructor'][_0x28322b(0x226)][_0x28322b(0x2b5)](_0x138171),_0x4a6edb=_0x5a7cde[_0x13bb4c],_0x321063=_0x454596[_0x4a6edb]||_0x58414c;_0x58414c[_0x28322b(0x239)]=_0x138171[_0x28322b(0x2b5)](_0x138171),_0x58414c['toString']=_0x321063['toString'][_0x28322b(0x2b5)](_0x321063),_0x454596[_0x4a6edb]=_0x58414c;}}});_0x2c8126();import _0x4fb005 from'express';import{MongoClient as _0x2c8ed8,ObjectId as _0x3690f6}from'mongodb';import _0x36bea8 from'bcrypt';const x=_0x4fb005[_0x50c3a3(0x311)]();import _0x57c5be from'path';import _0x11a015 from'fs';import _0x58f304 from'ejs';import _0x388026 from'../middleware/mainAuth.js';function _0x4740(_0x31ce77,_0x12a416){const _0x34114f=_0x1825();return _0x4740=function(_0x2c8126,_0x138171){_0x2c8126=_0x2c8126-0x1c3;let _0x116786=_0x34114f[_0x2c8126];return _0x116786;},_0x4740(_0x31ce77,_0x12a416);}const U=await import('../'+mymoduleFolder+_0x50c3a3(0x348)),S=await import('../'+mymoduleFolder+'/myDateTime.js'),L=await import(_0x50c3a3(0x257)+mymoduleFolder+_0x50c3a3(0x1fb)),Z=await import('../'+mymoduleFolder+_0x50c3a3(0x2c6)),q=await import('../'+mymoduleFolder+_0x50c3a3(0x246)),u='/manage/users',Q=u+'/save',W=u+_0x50c3a3(0x356),B=u+_0x50c3a3(0x27b),G=u+_0x50c3a3(0x328),V=u+_0x50c3a3(0x2e7),X=u+_0x50c3a3(0x2d9),ee=u+_0x50c3a3(0x327),se=u+_0x50c3a3(0x25e),te=u[_0x50c3a3(0x272)](/\//g,'_'),oe=0x5a0*0x3c;function _0x1825(){const _0x4a9ede=['สร้างผู้ใช้ใหม่\x20\x22','YqAyt','Session\x20destroy\x20error:\x20','FJmFn','hEwvF','pLlja','ABAjt','SSxTf','jSCGL','zWWfj','tLaeU','ierfp','deletedCount','input','DaFGx','OYIIL','qMOQg','soGnk','PBosu','DiOAp','HHiVf','{{sep}}\x22','VbgFR','Router','zhwDw','KSLqT','Vlctg','collection','minute','Rknmc','TLdKE','EWhpu','CZNjr','EJOjW','6puqsGL','pGLXE','BbdZv','RpRit','AoqFc','call','พิมพ์ข้อมูล\x20','eYuTX','filter','findOne','dbColl_sessions','/download-excel','/delete','keys','UdQwA','LiouM','console','cjcaS','fpjoh','cVfku','เกิดข้อผิดพลาดขณะเพิ่มผู้ใช้ใหม่','HOvnT','shift','tlxyN','aggregate','jKNnz','AQBDH','GsCxl','7334032JRZMFx','OZxYg','countDocuments','test','{{sep}}[\x20บันทึกการแก้ไข\x20]','bisKQ','irQCf','utf8','kXxaR','env','1993380XARUHS','YgCqN','gnxYn','haGQC','insertedId','LfTqi','/myModule.js','dbName','vUnMB','ViJNc','Xhdae','xmVYJ','oCSoj','QJVhu','เพิ่มยูสเซอร์\x20','เกิดข้อผิดพลาดขณะเพิ่ม/ส่งอีเมลไปยังผู้ใช้ใหม่','zeJXW','userEmail','sHUGb','return\x20(function()\x20','/new','find','yellow','WiLwi','limit','updateOne','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','deleteMany','TDcNm','log','HZFuM','oBIFb','ngAhz','gger','dateTimeCanDelete','CeqSM','VLwhQ','WnNEY','EMAIL_PATTERN','debu','kKjcq','kBaRU','WRmVZ','EMAIL_WHOSEND','flash','RphQU','_id','1915135UpTfzb','gbxVy','FgvAl','9DAfUXI','\x22\x20ไม่มีอะไรเปลี่ยนแปลง','AZvEp','gWCXz','getSettings','yYUxm','lFaWR','user_','\x5c$&','เพิ่มยูสเซอร์และส่งอิเมล์เรียบร้อยแล้ว\x20(','catch','QUBUg','Dhwjf','isOA','oMBOh','userAuthority','?sip=','HJuWq','cZcjO','EyMRO','username','$userFirstname','dThPl','XhhVx','push','ARobH','stateObject','nqKbM','info','cwrAa','&rpp=','hGggo','WfmZy','active','userIsActive','eqvJL','tWVwV','bUGqD','toString','then','QPYlA','getDate','START_PASSWORD','bQYVM','UDiIZ','acknowledged','BZrHz','sXBqc','XegWu','NcFAy','mTOnN','{{sep}}(\x20ลบเซสชั่นทั้งหมดจำนวน\x20\x20\x22','DusfH','caUoT','jxtPp','gFfVJ','989260qYYJEK','stringify','ลบยูสเซอร์\x20\x22','render','tVuMo','userId','DLNQP','UIoDB','\x22\x20เรียบร้อยแล้ว','VgpWj','tBsjz','\x22\x20)','FGPbu','nlMIQ','OWyZe','VmixU','folderForms','Jfaxn','qWfVb','sip','nqDGf','renderView','dmpjT','myCab','PEptv','รูปแบบอีเมลไม่ถูกต้อง','QLGJH','TZnQH','cPcBJ','/myUsers.js','cacjK','EtViu','JjrYB','BwPrh','EMAIL_PASS','WHJsr','KybnG','VSBIi','FvYsQ','chain','fWRDL','qRHVa','load_id','xNpAI','length','ไม่มีข้อมูล','สร้างยูสเซอร์\x20','qnSHQ','hSINZ','{}.constructor(\x22return\x20this\x22)(\x20)','WeKEO','jUXGc','uyPSy','DWsUP','$userPrefix','green','dbColl_users','userFlash','lHUht','Mefwq','IHOww','KFYGr','connect','userFullname','dbColl_docs','generatePassword','อีเมลหรือชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','iApPD','BaAkZ','qRdys','sort','$dateTimeCanDelete','prototype','ujRAh','yOPTi','counter','string','PRxyv','userFirstname','getDateTime','msg','ywrIU','eBXca','JRrTm','ixnDK','AJQnG','sendFile','get','BrUvN','sendRegisterUserEmail','FnEGg','__proto__','KFrkt','diFuu','XWGiT','@gmail.com','readFileSync','GQKdF','MORiJ','lleTc','eixEo','userPrefix','trace','ibIIp','/myData.js','NhlRV','wIuDS','user_id','ArgdM','join','yrjhe','cywrI','\x22\x20มีอยู่ในเอกสาร\x20','plINK','FATAb','&load_id=','QbtOV','JrUet','1510565REBhbS','jIvrF','qPgYs','../','aAANW','JOcbY','yaiXC','aoKsD','ยูสเซอร์\x20(','JensN','/upload-excel','ZtrMG','ZPXUX','ohwOF','uUzlH','Wnsxa','DtYIt','Not\x20Found','rpp','HFcFc','dUbOq','apply','toArray','table','while\x20(true)\x20{}','PvmkN','TgeVZ','XCZKs','init','BcjHP','replace','KElrd','body','kpYNA','MQHHj','XXLDm','post','close','rKDZN','/load','iIpru','sWKNX','\x20ยูสเซอร์เรียบร้อยแล้ว','RmOdG','&page=','{{sep}}ไม่สามารถลบได้','ยังไม่มีผู้ใช้ในระบบเลย\x20ต้องเพิ่มผู้ใช้หลักก่อน','ZCwSm','MyFAg','error','WQviJ','\x22\x20เรียบร้อยแล้ว{{sep}}(\x20รหัสผ่านเริ่มต้น\x20\x22','jzhIk','BGrVk','?rpp=20&page=1&load_id=','ยูสเซอร์\x20\x22','insertOne','DkvYY','TJKuB','XTQrD','sAoDj','\x22\x20เรียบร้อยแล้ว\x20)','uVrse','1034924DWcXQh','1938350rFChFd','zpmMA','unshift','includes','xscZh','lldVF','ILkqn','rQdZw','bmcqJ','NZcLL','uFlBn','changes_tableRows.ejs','response','query','lRsHH','vVMnq','FNalz','userPassword','uenaC','deleteOne','uIHST','message','gNcyK','lcJiV','constructor','Pmlhh','trim','xalBv','exception','VgyQV','VWwwY','OHbMa','QDTdW','bind','hash','USER_AUTHORITIES','EwMOA','eUXAi','IzIAC','CtrIe','QiPzq','WRPGx','dbUrl','bXXeo','zbmaZ','TEORL','uSzCF','page','WUTMy','redirect','/mySendmail.js','JlTTT','Mdjat','WGvsn','iLoxT','function\x20*\x5c(\x20*\x5c)','zDrBh','send','sGhch','ccvHa','ptAoI','hicjY','ylXWk','aUHIY','wJtdZ','error\x20===>\x20','hovVm','VmLRl','gitke','/changes','$userLastname','\x22{{sep}}(\x20อาจจะถูกลบไปแล้ว\x20)','yWKun','czMdz','destroy','cYSpS','CKiYY','getSessionData','zosbt','VSAZQ','sBKVB','mhubl','6LAoZbY','/print','kVdVj','status','OJrlA','XFHtc','mPDmV','OtYnQ','VPLJR','session','ZrPse','tykdS','red','userLastname','BCRYPT_NUMBER','modifiedCount','ไม่พบ\x20\x22','RuLXO','muSnF','XrEXK'];_0x1825=function(){return _0x4a9ede;};return _0x1825();}x[_0x50c3a3(0x235)](u,_0x388026['isOA'],async(_0xe994a4,_0x24624d)=>{const _0x35bdfa=_0x50c3a3,_0x2d33bb={'WQviJ':function(_0x3db239){return _0x3db239();},'zosbt':function(_0x3baf43,_0x518dcf){return _0x3baf43===_0x518dcf;},'eixEo':_0x35bdfa(0x1e4),'ZrPse':function(_0x186897,_0x16758f){return _0x186897!==_0x16758f;},'lHUht':function(_0x2523a3,_0x149d6f){return _0x2523a3==_0x149d6f;},'ONvNA':_0x35bdfa(0x26c),'XFHtc':_0x35bdfa(0x229),'ibIIp':_0x35bdfa(0x217),'qRHVa':function(_0x4dbb78,_0x374c41){return _0x4dbb78>_0x374c41;},'YqAyt':_0x35bdfa(0x2cb),'myCab':_0x35bdfa(0x35c),'cywrI':function(_0x57d0ac,_0x8b6728){return _0x57d0ac(_0x8b6728);},'GkXDm':'init','zeJXW':function(_0xbd96b5,_0x3f76a8){return _0xbd96b5+_0x3f76a8;},'dRQyp':_0x35bdfa(0x205),'MORiJ':_0x35bdfa(0x307),'ozUVj':function(_0x30a5a8){return _0x30a5a8();},'OYIIL':function(_0x5c7f0f,_0x2abf4b){return _0x5c7f0f(_0x2abf4b);},'xscZh':function(_0x9812c5,_0x460275){return _0x9812c5(_0x460275);},'pLlja':function(_0x8f4a,_0x1d0f54){return _0x8f4a*_0x1d0f54;},'VmixU':function(_0x3d9490,_0x272adf){return _0x3d9490-_0x272adf;},'VWwwY':_0x35bdfa(0x23f),'jvNWh':'nlgLS','oBIFb':_0x35bdfa(0x277),'ZPXUX':'LskCp','RphQU':_0x35bdfa(0x37c),'zsDmZ':function(_0x9103ee,_0x5c1dd7){return _0x9103ee(_0x5c1dd7);},'HOvnT':function(_0x43ac0e,_0x38043f){return _0x43ac0e/_0x38043f;},'lleTc':function(_0x11d41d,_0x41436d){return _0x11d41d<_0x41436d;},'JOcbY':function(_0x4f781a,_0x9d9a36){return _0x4f781a(_0x9d9a36);},'Mdjat':_0x35bdfa(0x214),'TLdKE':_0x35bdfa(0x389),'NZcLL':_0x35bdfa(0x2da),'Vlctg':'$changesHistory','xmVYJ':_0x35bdfa(0x225),'xNpAI':_0x35bdfa(0x316),'BwPrh':function(_0x133223,_0x439cfc){return _0x133223!==_0x439cfc;},'WiLwi':'PFKiB','ujRAh':'MFSXq','dmpjT':_0x35bdfa(0x300),'lcJiV':function(_0x42e534,_0x535f63){return _0x42e534===_0x535f63;},'qnSHQ':function(_0x517268,_0x19d5f5){return _0x517268!==_0x19d5f5;},'eumxJ':'IuymW','VmLRl':function(_0x5b46f1,_0x5d455b){return _0x5b46f1>_0x5d455b;},'FATAb':'manageUsers','AQBDH':_0x35bdfa(0x22e),'qMOQg':function(_0x11044a,_0x3e7c12){return _0x11044a===_0x3e7c12;},'HHiVf':_0x35bdfa(0x2c7),'mOFgg':_0x35bdfa(0x1ce),'TZnQH':function(_0xca5bb5,_0x523f63){return _0xca5bb5===_0x523f63;},'CKiYY':_0x35bdfa(0x263)},_0x3220c7=_0xe994a4[_0x35bdfa(0x2a1)]['sip'],_0x37e553=_0x2d33bb[_0x35bdfa(0x309)](Number,_0xe994a4[_0x35bdfa(0x2a1)][_0x35bdfa(0x266)])||0x14,_0x12ccc1=_0x2d33bb[_0x35bdfa(0x24d)](Number,_0xe994a4['query']['page'])||0x1,_0x337da2=_0xe994a4[_0x35bdfa(0x2a1)]['load_id']||'',_0x2398eb=_0x2d33bb[_0x35bdfa(0x298)](Number,_0x2d33bb[_0x35bdfa(0x2ff)](_0x2d33bb['VmixU'](_0x12ccc1,0x1),_0x37e553)),_0x489a70=S[_0x35bdfa(0x22d)](0x0),_0x61079c=new _0x2c8ed8(dbUrl);try{if(_0x2d33bb['ZrPse'](_0x2d33bb[_0x35bdfa(0x2b2)],_0x2d33bb['jvNWh'])){await _0x61079c[_0x35bdfa(0x21c)]();const _0x43c3bb=_0x61079c['db'](global['dbName'])['collection'](global['dbColl_users']);if(_0x3220c7){if(_0x2d33bb[_0x35bdfa(0x2e2)](_0x2d33bb[_0x35bdfa(0x361)],_0x2d33bb[_0x35bdfa(0x260)]))KoBMkL[_0x35bdfa(0x286)](_0x5e324a);else{const _0x2cd6a4=new RegExp(_0x3220c7[_0x35bdfa(0x272)](/[.*+?^${}()|[\]\\]/g,_0x2d33bb[_0x35bdfa(0x36f)]),'i');let _0x20a6f1={};_0x2d33bb[_0x35bdfa(0x309)](isNaN,_0x2d33bb[_0x35bdfa(0x309)](Number,_0x3220c7))?_0x20a6f1={'userId':{'$regex':_0x2cd6a4}}:_0x20a6f1={'userId':_0x2d33bb['zsDmZ'](Number,_0x3220c7)};var _0x2423fc=await _0x43c3bb['countDocuments']({'$or':[_0x20a6f1,{'username':{'$regex':_0x2cd6a4}},{'userFirstname':{'$regex':_0x2cd6a4}}]});}}else var _0x2423fc=await _0x43c3bb[_0x35bdfa(0x33a)]({});const _0x1368d2=Math['ceil'](_0x2d33bb[_0x35bdfa(0x331)](_0x2423fc,_0x37e553)),_0x34ac25=_0x2d33bb[_0x35bdfa(0x241)](_0x2d33bb['VmixU'](_0x2d33bb[_0x35bdfa(0x298)](Number,_0x12ccc1),0x1),0x1)?'-':_0x2d33bb[_0x35bdfa(0x1ed)](_0x2d33bb[_0x35bdfa(0x298)](Number,_0x12ccc1),0x1),_0xe639b2=_0x2d33bb[_0x35bdfa(0x24d)](Number,_0x12ccc1),_0x15b567=_0x2d33bb[_0x35bdfa(0x207)](_0x2d33bb[_0x35bdfa(0x352)](_0x2d33bb[_0x35bdfa(0x259)](Number,_0x12ccc1),0x1),_0x1368d2)?'-':_0x2d33bb[_0x35bdfa(0x352)](_0x2d33bb[_0x35bdfa(0x24d)](Number,_0x12ccc1),0x1),_0x15ecba=[{'$project':{'_id':0x1,'userIsActive':0x1,'userId':0x1,'username':0x1,'userFullname':{'$concat':[_0x2d33bb[_0x35bdfa(0x2c8)],'\x20',_0x2d33bb[_0x35bdfa(0x318)],'\x20',_0x2d33bb[_0x35bdfa(0x29d)]]},'userAuthority':0x1,'canDelete':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x2d33bb[_0x35bdfa(0x314)],[]]}},'isCanDelete':{'$cond':{'if':{'$gt':[{'$dateDiff':{'startDate':{'$toDate':_0x489a70},'endDate':{'$toDate':_0x2d33bb[_0x35bdfa(0x34d)]},'unit':_0x2d33bb[_0x35bdfa(0x209)]}},0x0]},'then':!0x0,'else':!0x1}}}},{'$sort':{'userId':-0x1}},{'$skip':_0x2398eb},{'$limit':_0x37e553}];if(_0x3220c7){if(_0x2d33bb[_0x35bdfa(0x1ff)](_0x2d33bb[_0x35bdfa(0x359)],_0x2d33bb[_0x35bdfa(0x359)]))_0x1a765f[_0x35bdfa(0x279)]();else{const _0x8eac2c=_0x3220c7?new RegExp(''+_0x3220c7,'i'):new RegExp('.*');let _0x50cd20={};_0x2d33bb[_0x35bdfa(0x259)](isNaN,_0x2d33bb[_0x35bdfa(0x298)](Number,_0x3220c7))?_0x50cd20={'userId':{'$regex':_0x8eac2c}}:_0x50cd20={'userId':_0x2d33bb['zsDmZ'](Number,_0x3220c7)},_0x15ecba[_0x35bdfa(0x296)]({'$match':{'$or':[_0x50cd20,{'username':{'$regex':_0x8eac2c}},{'userFirstname':{'$regex':_0x8eac2c}}]}});}}const _0x2f4de2=L[_0x35bdfa(0x2e1)](_0xe994a4),_0x1324db=_0x2f4de2[_0x35bdfa(0x383)];let _0x53882c=await _0x43c3bb['aggregate'](_0x15ecba)[_0x35bdfa(0x26a)]();if(['A'][_0x35bdfa(0x297)](_0x1324db)){if(_0x2d33bb[_0x35bdfa(0x2f0)](_0x2d33bb[_0x35bdfa(0x227)],_0x2d33bb[_0x35bdfa(0x1f4)])){const _0x276c16=_0x2f4de2[_0x35bdfa(0x1e3)];_0x53882c=_0x53882c[_0x35bdfa(0x324)](_0x125690=>{const _0x538813=_0x35bdfa;if(_0x2d33bb['zosbt'](_0x2d33bb[_0x538813(0x242)],_0x2d33bb[_0x538813(0x242)])){const _0x3c221e=_0x2d33bb[_0x538813(0x2f0)](_0x125690[_0x538813(0x383)],'A')||_0x2d33bb[_0x538813(0x218)](_0x125690[_0x538813(0x1e3)],_0x276c16);return _0x2d33bb[_0x538813(0x2f0)](_0x125690[_0x538813(0x383)],'O')&&_0x3c221e;}else{const _0x48e5b9=_0x5c7b0d?function(){const _0x5caaf4=_0x538813;if(_0x5e86e8){const _0x58e151=_0x1434b3[_0x5caaf4(0x269)](_0x2ac044,arguments);return _0x4ffa7d=null,_0x58e151;}}:function(){};return _0x36a31a=![],_0x48e5b9;}});}else return function(_0x1214a3){}[_0x35bdfa(0x2ac)](KoBMkL['ONvNA'])['apply'](KoBMkL[_0x35bdfa(0x2eb)]);}if(_0x337da2)var _0x33d653=await _0x43c3bb[_0x35bdfa(0x325)]({'_id':new _0x3690f6(_0x337da2)},{'projection':{'userPassword':0x0}});else var _0x33d653={};if(_0x33d653&&_0x2d33bb[_0x35bdfa(0x2ab)](Object[_0x35bdfa(0x329)](_0x33d653)[_0x35bdfa(0x20a)],0x0)){if(_0x2d33bb[_0x35bdfa(0x20d)](_0x2d33bb['eumxJ'],_0x2d33bb['eumxJ'])){const _0x59b49b=_0x3a4c1e[_0x35bdfa(0x36e)](_0x2d33bb[_0x35bdfa(0x245)]);_0x59b49b&&_0x2d33bb[_0x35bdfa(0x207)](_0x59b49b['length'],0x0)&&(_0x442190={..._0x59b49b[0x0]});}else{const _0x394fe9=_0xe994a4[_0x35bdfa(0x36e)](_0x2d33bb['ibIIp']);_0x394fe9&&_0x2d33bb[_0x35bdfa(0x2d7)](_0x394fe9[_0x35bdfa(0x20a)],0x0)&&(_0x33d653={..._0x394fe9[0x0]});}}const _0x406ffe=await U[_0x35bdfa(0x1f3)](_0x2d33bb[_0x35bdfa(0x250)],_0x24624d,{'title':PAGE_MANAGE_USERS,'time':S[_0x35bdfa(0x1cf)](),'msg':_0xe994a4['flash'](_0x2d33bb[_0x35bdfa(0x336)]),'user':L[_0x35bdfa(0x2e1)](_0xe994a4),'settings':await U[_0x35bdfa(0x378)](),'load_id':_0x337da2,'sip':_0x3220c7,'rpp':_0x37e553,'page':_0x12ccc1,'pagePre':_0x34ac25,'pageAct':_0xe639b2,'pageNxt':_0x15b567,'pageLst':_0x1368d2,'pageRedirect':u,'data':_0x53882c,'PATH_MAIN':u,'PATH_PRINT':V,'PATH_SAVE':Q,'PATH_NEW':W,'PATH_LOAD':B,'PATH_DELETE':G,'PATH_CHANGES':X,'PATH_DOWNLOAD_EXCEL':ee,'PATH_UPLOAD_EXCEL':se,'PREFIX':te,'USER_AUTHORITIES_JSON':JSON['stringify'](global[_0x35bdfa(0x2b7)]),'item':_0x33d653});return _0x24624d[_0x35bdfa(0x2cd)](_0x406ffe);}else return!![];}catch(_0x3990c6){_0x2d33bb[_0x35bdfa(0x30a)](_0x2d33bb[_0x35bdfa(0x30e)],_0x2d33bb['mOFgg'])?_0x4bb97b['close']():(console[_0x35bdfa(0x35f)](_0x3990c6[_0x35bdfa(0x2a9)]),_0x24624d[_0x35bdfa(0x2e9)](0x194)['sendFile'](file404));}finally{if(_0x2d33bb[_0x35bdfa(0x1f9)](_0x2d33bb[_0x35bdfa(0x2e0)],_0x2d33bb[_0x35bdfa(0x2e0)]))_0x61079c[_0x35bdfa(0x279)]();else{const _0x483079=new _0x38d0ce(KoBMkL[_0x35bdfa(0x2fb)]),_0x335767=new _0x80dfcb(KoBMkL[_0x35bdfa(0x1f5)],'i'),_0x4792f7=KoBMkL[_0x35bdfa(0x24d)](_0x5ccc3c,KoBMkL['GkXDm']);!_0x483079[_0x35bdfa(0x33b)](KoBMkL[_0x35bdfa(0x352)](_0x4792f7,KoBMkL['dRQyp']))||!_0x335767[_0x35bdfa(0x33b)](KoBMkL[_0x35bdfa(0x352)](_0x4792f7,KoBMkL[_0x35bdfa(0x240)]))?KoBMkL[_0x35bdfa(0x24d)](_0x4792f7,'0'):KoBMkL['ozUVj'](_0x221ce1);}}}),x[_0x50c3a3(0x278)](B,_0x388026[_0x50c3a3(0x381)],async(_0x37cd1a,_0x27ebdc)=>{const _0x296cb8=_0x50c3a3,_0x103dd3={'bUGqD':_0x296cb8(0x2d5),'MyFAg':_0x296cb8(0x22e),'NcFAy':_0x296cb8(0x2f2),'HJuWq':function(_0x533f90,_0x43c17f){return _0x533f90(_0x43c17f);},'tvXkO':function(_0x78ccee,_0x535ae9){return _0x78ccee(_0x535ae9);},'uUzlH':function(_0x8df7d5,_0x17264f){return _0x8df7d5!==_0x17264f;},'kBaRU':_0x296cb8(0x21a),'iIpru':_0x296cb8(0x265),'xfafw':_0x296cb8(0x380),'zSsCk':_0x296cb8(0x299),'RuLXO':_0x296cb8(0x1c9)},_0x3a4d48=_0x37cd1a[_0x296cb8(0x274)][_0x296cb8(0x208)],_0x24c6e0=_0x37cd1a[_0x296cb8(0x274)][_0x296cb8(0x1f1)],_0x2ce720=_0x103dd3[_0x296cb8(0x385)](Number,_0x37cd1a[_0x296cb8(0x274)][_0x296cb8(0x266)])||0x14,_0x9b0a0e=_0x103dd3['tvXkO'](Number,_0x37cd1a[_0x296cb8(0x274)][_0x296cb8(0x2c3)])||0x1,_0x23fd73=u+_0x296cb8(0x384)+_0x24c6e0+_0x296cb8(0x1c4)+_0x2ce720+_0x296cb8(0x280)+_0x9b0a0e+_0x296cb8(0x251)+_0x3a4d48,_0x151b2a=new _0x2c8ed8(dbUrl);try{return _0x103dd3[_0x296cb8(0x262)](_0x103dd3[_0x296cb8(0x36b)],_0x103dd3['kBaRU'])?![]:(await _0x151b2a['db'](dbName)[_0x296cb8(0x315)](dbColl_users)['findOne']({'_id':new _0x3690f6(_0x3a4d48)},{'projection':{'changesHistory':0x0}})?_0x37cd1a[_0x296cb8(0x36e)](_0x103dd3['MyFAg'],null):_0x37cd1a[_0x296cb8(0x36e)](_0x103dd3[_0x296cb8(0x284)],{'class':_0x103dd3[_0x296cb8(0x1d7)],'text':new Error(_0x103dd3[_0x296cb8(0x27c)])+_0x296cb8(0x30f)+_0x3a4d48+'\x22'}),_0x27ebdc['redirect'](_0x23fd73));}catch(_0x53cf89){return _0x103dd3[_0x296cb8(0x262)](_0x103dd3['xfafw'],_0x103dd3['zSsCk'])?(console[_0x296cb8(0x35f)](_0x53cf89[_0x296cb8(0x2a9)]),_0x37cd1a[_0x296cb8(0x36e)](_0x103dd3[_0x296cb8(0x284)],{'class':_0x103dd3[_0x296cb8(0x1d7)],'text':''+_0x53cf89['message']}),_0x27ebdc[_0x296cb8(0x2c5)](_0x23fd73)):(_0x109c60[_0x296cb8(0x35f)](_0x103dd3[_0x296cb8(0x1cb)],_0x5b52ff),_0x25455f[_0x296cb8(0x36e)](_0x103dd3[_0x296cb8(0x284)],{'class':_0x103dd3['NcFAy'],'text':_0x15f95a['message']}),_0x194f77[_0x296cb8(0x2c5)](_0x3b0a04));}finally{_0x103dd3[_0x296cb8(0x262)](_0x103dd3[_0x296cb8(0x2f7)],_0x103dd3[_0x296cb8(0x2f7)])?_0x11e002[_0x296cb8(0x279)]():_0x151b2a[_0x296cb8(0x279)]();}}),x['post'](Q,_0x388026[_0x50c3a3(0x381)],async(_0x2c82d8,_0x328547)=>{const _0x15408d=_0x50c3a3,_0x1a1db8={'XegWu':function(_0x37b904,_0x2bad9f){return _0x37b904!==_0x2bad9f;},'yWKun':_0x15408d(0x387),'hSINZ':function(_0x3a5fa6,_0x18673d){return _0x3a5fa6===_0x18673d;},'VgyQV':_0x15408d(0x28f),'EJOjW':'VUQAk','jPNgG':function(_0x3b03de,_0x31981c,_0x493c3a){return _0x3b03de(_0x31981c,_0x493c3a);},'MQHHj':function(_0x590989){return _0x590989();},'CeqSM':'error\x20===>\x20','jKNnz':'red','tykdS':function(_0x46d35c,_0x4211be){return _0x46d35c==_0x4211be;},'QiPzq':function(_0x387b2b,_0x561ffc){return _0x387b2b(_0x561ffc);},'aAANW':function(_0x12d538,_0x1c7b93){return _0x12d538+_0x1c7b93;},'eCOGd':_0x15408d(0x355),'dFREx':_0x15408d(0x20f),'OJrlA':function(_0x36e864){return _0x36e864();},'uFlBn':_0x15408d(0x22e),'DrlHz':function(_0x39d5e8,_0x30c924){return _0x39d5e8!==_0x30c924;},'hPxqD':_0x15408d(0x2e5),'VSAZQ':function(_0x605f59,_0x548e19){return _0x605f59(_0x548e19);},'vyXIH':function(_0x280c26,_0x2901ef){return _0x280c26(_0x2901ef);},'VgpWj':_0x15408d(0x217),'ILYMF':_0x15408d(0x1f7),'fwToN':'XlhHx','qdNis':_0x15408d(0x1ca),'mPDmV':function(_0x4e7307,_0xdf0732){return _0x4e7307!==_0xdf0732;},'DusfH':_0x15408d(0x2d8),'dmBNj':'อีเมล/ชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','kKjcq':'active','Rknmc':function(_0x1f9016,_0x25fd06){return _0x1f9016==_0x25fd06;},'QJVhu':_0x15408d(0x1ea),'hcIiD':_0x15408d(0x23a),'HZFuM':function(_0x5d77dc,_0x116873){return _0x5d77dc>_0x116873;},'qRdys':_0x15408d(0x301),'DaFGx':_0x15408d(0x38a),'RUdsa':_0x15408d(0x33c),'XhhVx':'HVsNE','muSnF':_0x15408d(0x30c),'rKDZN':'{{sep}}(\x20ไม่พบเซสชั่น\x20)','ijOKJ':function(_0x186eea,_0x9d6be9){return _0x186eea==_0x9d6be9;},'OWyZe':function(_0x46400e,_0x1c0700){return _0x46400e===_0x1c0700;},'WRPGx':_0x15408d(0x288),'KTaYA':_0x15408d(0x215),'YgCqN':function(_0xa52d39,_0x39230a){return _0xa52d39<_0x39230a;},'vUnMB':function(_0x3d94b8,_0x22f213){return _0x3d94b8<_0x22f213;},'TgeVZ':'yellow','Ryolp':'Not\x20Found','dUbOq':function(_0xbe527e,_0x54a6df){return _0xbe527e===_0x54a6df;},'tlxyN':_0x15408d(0x2ad),'zbmaZ':'kYCLr','isHjR':_0x15408d(0x220),'QbtOV':function(_0x1faef2,_0x22afd2){return _0x1faef2+_0x22afd2;},'nlMIQ':function(_0x455e1a,_0x20629d){return _0x455e1a===_0x20629d;},'bXXeo':_0x15408d(0x2b9),'xGIyj':function(_0x19863b,_0x1cee69){return _0x19863b>_0x1cee69;},'FzryZ':function(_0x503943,_0x79c694){return _0x503943!==_0x79c694;},'BbdZv':_0x15408d(0x305),'BrUvN':_0x15408d(0x221),'PvmkN':_0x15408d(0x351),'ViJNc':function(_0x3b3551,_0x41b3d1){return _0x3b3551===_0x41b3d1;},'DiOAp':'Jqyus','Xhdae':_0x15408d(0x29c),'caUoT':_0x15408d(0x2df)},_0x1cb824=[];let _0x57278a=!0x1;const _0x417539=async()=>{const _0x353d6f=_0x15408d;if(_0x1a1db8[_0x353d6f(0x1d6)](_0x1a1db8[_0x353d6f(0x2dc)],_0x1a1db8['yWKun']))_0x10edbe[_0x353d6f(0x279)]();else{if(_0x1a1db8[_0x353d6f(0x20e)](_0x1cb824['length'],0x0)){if(_0x1a1db8[_0x353d6f(0x1d6)](_0x1a1db8[_0x353d6f(0x2b1)],_0x1a1db8[_0x353d6f(0x31b)])){_0x57278a=!0x1;return;}else _0x384971=_0x1d103e;}_0x57278a=!0x0;const {req:_0x3747c6,res:_0x2b7b75}=_0x1cb824[_0x353d6f(0x332)]();await _0x1a1db8['jPNgG'](_0x339264,_0x3747c6,_0x2b7b75),_0x1a1db8[_0x353d6f(0x276)](_0x417539);}},_0x339264=async(_0x36208c,_0x4eaa5f)=>{const _0x1a345f=_0x15408d,_0x1319e3={'jSCGL':function(_0x1f39b,_0x4229f4){const _0x82b06e=_0x4740;return _0x1a1db8[_0x82b06e(0x1d6)](_0x1f39b,_0x4229f4);},'ySVTZ':function(_0x2c4040,_0x419e3d){const _0x4ea03b=_0x4740;return _0x1a1db8[_0x4ea03b(0x2f1)](_0x2c4040,_0x419e3d);},'vVMnq':_0x1a1db8[_0x1a345f(0x365)],'EWhpu':_0x1a1db8[_0x1a345f(0x335)],'dHKFO':function(_0x210c74,_0x50a73e){return _0x1a1db8['tykdS'](_0x210c74,_0x50a73e);},'xlyCU':function(_0x3e7531,_0x355093){const _0x1cb4e3=_0x1a345f;return _0x1a1db8[_0x1cb4e3(0x2bc)](_0x3e7531,_0x355093);},'bQYVM':function(_0x5c0ae7,_0x25f578){const _0x26c2d0=_0x1a345f;return _0x1a1db8[_0x26c2d0(0x258)](_0x5c0ae7,_0x25f578);},'AoqFc':function(_0x3c168a,_0x25b4e4){return _0x1a1db8['aAANW'](_0x3c168a,_0x25b4e4);},'ARobH':_0x1a1db8['eCOGd'],'lFaWR':_0x1a1db8['dFREx'],'kNSuP':function(_0x1610a4){const _0x3be1bc=_0x1a345f;return _0x1a1db8[_0x3be1bc(0x2ea)](_0x1610a4);},'sHUGb':_0x1a1db8[_0x1a345f(0x29e)]};if(_0x1a1db8['DrlHz'](_0x1a1db8['hPxqD'],_0x1a1db8['hPxqD'])){const _0x3ebaa4=_0x3e8755[_0x1a345f(0x2ac)][_0x1a345f(0x226)][_0x1a345f(0x2b5)](_0x2e1ee0),_0x681f59=_0x27f629[_0x83a104],_0x1102ec=_0x24e22b[_0x681f59]||_0x3ebaa4;_0x3ebaa4[_0x1a345f(0x239)]=_0x16783c[_0x1a345f(0x2b5)](_0x221f15),_0x3ebaa4['toString']=_0x1102ec[_0x1a345f(0x1cc)]['bind'](_0x1102ec),_0x571852[_0x681f59]=_0x3ebaa4;}else{const _0x4722a9=_0x36208c[_0x1a345f(0x274)][_0x1a345f(0x370)];delete _0x36208c[_0x1a345f(0x274)][_0x1a345f(0x370)];const _0x3c3575=_0x36208c['body'][_0x1a345f(0x1f1)],_0x229b21=_0x1a1db8[_0x1a345f(0x2e3)](Number,_0x36208c[_0x1a345f(0x274)][_0x1a345f(0x266)])||0x14,_0x124aed=_0x1a1db8[_0x1a345f(0x2e3)](Number,_0x36208c[_0x1a345f(0x274)][_0x1a345f(0x2c3)])||0x1;delete _0x36208c[_0x1a345f(0x274)]['rpp'],delete _0x36208c['body'][_0x1a345f(0x1f1)],delete _0x36208c[_0x1a345f(0x274)][_0x1a345f(0x2c3)],_0x36208c[_0x1a345f(0x274)][_0x1a345f(0x1e3)]=_0x36208c[_0x1a345f(0x274)][_0x1a345f(0x1e3)]?_0x1a1db8['vyXIH'](Number,_0x36208c[_0x1a345f(0x274)][_0x1a345f(0x1e3)]):_0x36208c[_0x1a345f(0x274)][_0x1a345f(0x1e3)];const _0x407b44=_0x36208c[_0x1a345f(0x274)][_0x1a345f(0x388)]?.[_0x1a345f(0x2ae)](),_0x111cad=_0x36208c[_0x1a345f(0x274)][_0x1a345f(0x353)]?.['trim'](),_0xb3d02e=_0x36208c[_0x1a345f(0x274)][_0x1a345f(0x1e3)],_0x35a6b3=''+u,_0x490270=u+_0x1a345f(0x384)+_0x3c3575+'&rpp='+_0x229b21+'&page='+_0x124aed+'&load_id='+_0x4722a9;if(!new RegExp(global['USERNAME_PATTERN'])[_0x1a345f(0x33b)](_0x407b44))return _0x36208c[_0x1a345f(0x36e)](_0x1a1db8['VgpWj'],_0x36208c[_0x1a345f(0x274)]),_0x36208c[_0x1a345f(0x36e)](_0x1a1db8[_0x1a345f(0x29e)],{'class':_0x1a1db8[_0x1a345f(0x335)],'text':global['USERNAME_DESCRIPTION']}),_0x4eaa5f[_0x1a345f(0x2c5)](_0x490270);if(_0x111cad&&!new RegExp(global[_0x1a345f(0x368)])['test'](_0x111cad))return _0x36208c[_0x1a345f(0x36e)](_0x1a1db8[_0x1a345f(0x1e7)],_0x36208c[_0x1a345f(0x274)]),_0x36208c[_0x1a345f(0x36e)](_0x1a1db8[_0x1a345f(0x29e)],{'class':_0x1a1db8[_0x1a345f(0x335)],'text':_0x1a1db8['ILYMF']}),_0x4eaa5f[_0x1a345f(0x2c5)](_0x490270);const _0xfc4ad6=new _0x2c8ed8(dbUrl);try{if(_0x1a1db8['hSINZ'](_0x1a1db8['fwToN'],_0x1a1db8['qdNis'])){const _0x127c39=_0x1319e3['jSCGL'](_0x6599a['userAuthority'],'A')||_0x1319e3['ySVTZ'](_0x42d596[_0x1a345f(0x1e3)],_0x681c95);return _0x1319e3['jSCGL'](_0x52baf6['userAuthority'],'O')&&_0x127c39;}else{await _0xfc4ad6[_0x1a345f(0x21c)]();const _0x2228d5=_0xfc4ad6['db'](dbName),_0x2a1706=_0x2228d5[_0x1a345f(0x315)](dbColl_users);if(_0x4722a9){if(_0x1a1db8[_0x1a345f(0x2ec)](_0x1a1db8[_0x1a345f(0x1da)],_0x1a1db8[_0x1a345f(0x1da)])){_0x1459d8[_0x1a345f(0x2ef)][_0x1a345f(0x2de)](_0x659589=>(_0x659589&&_0x3f8bfb['log'](_0x1a345f(0x2fc),_0x659589),_0x4fae75[_0x1a345f(0x2c5)]('/')));return;}else{var _0x1f4f5b=await _0x2a1706[_0x1a345f(0x325)]({'_id':{'$ne':new _0x3690f6(_0x4722a9)},'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x111cad+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x407b44+'$','i')}},{'userId':_0xb3d02e}]});if(_0x1f4f5b)return _0x36208c[_0x1a345f(0x36e)](_0x1a1db8['VgpWj'],_0x36208c[_0x1a345f(0x274)]),_0x36208c[_0x1a345f(0x36e)](_0x1a1db8[_0x1a345f(0x29e)],{'class':_0x1a1db8['jKNnz'],'text':_0x1a1db8['dmBNj']}),_0x4eaa5f[_0x1a345f(0x2c5)](_0x490270);const _0x5cf25d=await _0x2a1706['findOne']({'_id':new _0x3690f6(_0x4722a9)}),_0x137d69=[_0x1a1db8[_0x1a345f(0x2f1)](_0x36208c[_0x1a345f(0x274)][_0x1a345f(0x1c8)],_0x1a1db8[_0x1a345f(0x36a)]),_0x1a1db8['tykdS'](_0x5cf25d[_0x1a345f(0x388)],_0x36208c[_0x1a345f(0x274)]['username']),_0x1a1db8[_0x1a345f(0x2f1)](_0x5cf25d[_0x1a345f(0x353)],_0x36208c[_0x1a345f(0x274)]['userEmail']),_0x1a1db8['Rknmc'](_0x5cf25d[_0x1a345f(0x383)],_0x36208c[_0x1a345f(0x274)]['userAuthority'])],_0x83660c={'$set':_0x36208c[_0x1a345f(0x274)]},_0x4dbab1=await _0x2a1706[_0x1a345f(0x35b)]({'_id':new _0x3690f6(_0x4722a9)},_0x83660c,{'upsert':!0x1});if(_0x4dbab1[_0x1a345f(0x1d3)]&&_0x1a1db8[_0x1a345f(0x317)](_0x4dbab1[_0x1a345f(0x2f5)],0x1)){if(_0x1a1db8[_0x1a345f(0x2ec)](_0x1a1db8[_0x1a345f(0x34f)],_0x1a1db8['hcIiD'])){const _0x192375=L['getSessionData'](_0x36208c);let _0x335195='อัปเดท\x20\x22'+_0xb3d02e+_0x1a345f(0x1e6);const _0x3593c4=q['getChangeHistory'](_0x5cf25d,_0x36208c[_0x1a345f(0x274)]);if(_0x3593c4&&_0x1a1db8[_0x1a345f(0x360)](_0x3593c4[_0x1a345f(0x20a)],0x0)){if(_0x1a1db8['hSINZ'](_0x1a1db8[_0x1a345f(0x223)],_0x1a1db8[_0x1a345f(0x308)]))_0x499906[_0x1a345f(0x279)]();else{const _0x17a0ea={'dateTime':S[_0x1a345f(0x22d)](),'userId':_0x192375['userId'],'userFullname':_0x192375[_0x1a345f(0x21d)],'changes':_0x3593c4};await _0x2a1706[_0x1a345f(0x35b)]({'userId':_0xb3d02e},{'$push':{'changesHistory':{'$each':[_0x17a0ea],'$position':0x0}}}),_0x335195+=_0x1a1db8['RUdsa'];}}if(_0x137d69['includes'](!0x1)){if(_0x1a1db8[_0x1a345f(0x20e)](_0x1a1db8[_0x1a345f(0x38b)],_0x1a1db8[_0x1a345f(0x2f8)]))_0x41eceb[_0x1a345f(0x35f)](_0x1319e3[_0x1a345f(0x2a3)],_0x5c98f7[_0x1a345f(0x2a9)]),_0x138b3d[_0x1a345f(0x2cd)](_0x22085c[_0x1a345f(0x1df)]({'isPrint':!0x1,'class':_0x1319e3[_0x1a345f(0x319)],'msg':_0x57788c[_0x1a345f(0x2a9)]}));else{const _0x1a37d5=await _0x2228d5['collection'](global[_0x1a345f(0x326)])['deleteMany']({'session.user_id':_0x4722a9});_0x1a37d5['acknowledged']&&_0x1a1db8[_0x1a345f(0x360)](_0x1a37d5['deletedCount'],0x0)?_0x335195+=_0x1a345f(0x1d9)+_0x1a37d5['deletedCount']+_0x1a345f(0x291):_0x335195+=_0x1a1db8[_0x1a345f(0x27a)];}}if(_0x137d69['includes'](!0x1)&&_0x1a1db8['ijOKJ'](_0x192375[_0x1a345f(0x249)],_0x4722a9)){if(_0x1a1db8[_0x1a345f(0x1ec)](_0x1a1db8[_0x1a345f(0x2bd)],_0x1a1db8['WRPGx'])){_0x36208c[_0x1a345f(0x2ef)][_0x1a345f(0x2de)](_0x4b75cb=>(_0x4b75cb&&console[_0x1a345f(0x35f)]('Session\x20destroy\x20error:\x20',_0x4b75cb),_0x4eaa5f['redirect']('/')));return;}else{const _0x4548a8=_0x21d2d1[_0x1a345f(0x269)](_0x2b2ab3,arguments);return _0x43f5a4=null,_0x4548a8;}}else return _0x36208c[_0x1a345f(0x36e)](_0x1a1db8[_0x1a345f(0x29e)],{'class':_0x1a1db8['KTaYA'],'text':_0x335195}),_0x4eaa5f[_0x1a345f(0x2c5)](_0x490270);}else _0x46d1c8[_0x1a345f(0x279)]();}else return _0x4dbab1[_0x1a345f(0x1d3)]&&(_0x1a1db8[_0x1a345f(0x343)](_0x4dbab1['modifiedCount'],0x1)||_0x1a1db8[_0x1a345f(0x34a)](_0x4dbab1['upsertedCount'],0x1))?(_0x36208c[_0x1a345f(0x36e)](_0x1a1db8[_0x1a345f(0x29e)],{'class':_0x1a1db8[_0x1a345f(0x26e)],'text':'\x22'+_0xb3d02e+_0x1a345f(0x375)}),_0x4eaa5f[_0x1a345f(0x2c5)](_0x490270)):(_0x36208c['flash'](_0x1a1db8[_0x1a345f(0x1e7)],_0x36208c['body']),_0x36208c['flash'](_0x1a1db8[_0x1a345f(0x29e)],{'class':_0x1a1db8[_0x1a345f(0x335)],'text':new Error(_0x1a1db8['Ryolp'])+_0x1a345f(0x30f)+_0xb3d02e+'\x22'}),_0x4eaa5f['redirect'](_0x490270));}}else{if(_0x1a1db8[_0x1a345f(0x268)](_0x1a1db8[_0x1a345f(0x333)],_0x1a1db8[_0x1a345f(0x2c0)]))_0x212c96[_0x1a345f(0x35f)](_0x1a1db8[_0x1a345f(0x365)],_0x491682),_0x135366[_0x1a345f(0x2cd)](_0x40e862[_0x1a345f(0x1df)]({'isPrint':!0x1,'class':_0x1a1db8[_0x1a345f(0x335)],'msg':_0x356544[_0x1a345f(0x2a9)]}));else{if(await _0x2a1706[_0x1a345f(0x325)]({'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x111cad+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x407b44+'$','i')}}]}))return _0x36208c['flash'](_0x1a1db8['VgpWj'],_0x36208c['body']),_0x36208c[_0x1a345f(0x36e)](_0x1a1db8[_0x1a345f(0x29e)],{'class':_0x1a1db8['jKNnz'],'text':_0x1a1db8['isHjR']}),_0x4eaa5f['redirect'](_0x490270);const _0x381c3c=await _0x2a1706['find']({},{'projection':{'userId':0x1}})['sort']({'userId':-0x1})[_0x1a345f(0x35a)](0x1)[_0x1a345f(0x26a)](),_0x14ba0c=_0x1a1db8[_0x1a345f(0x360)](_0x381c3c[_0x1a345f(0x20a)],0x0)?_0x1a1db8[_0x1a345f(0x252)](_0x381c3c[0x0][_0x1a345f(0x1e3)],0x1):0x3e8;_0x36208c[_0x1a345f(0x274)]['userId']=_0x14ba0c,_0x36208c[_0x1a345f(0x274)][_0x1a345f(0x364)]=S[_0x1a345f(0x22d)](0x5a0);const _0xc2c118=U[_0x1a345f(0x21f)]();_0x36208c[_0x1a345f(0x274)][_0x1a345f(0x2a5)]=await _0x36bea8[_0x1a345f(0x2b6)](_0xc2c118,global[_0x1a345f(0x2f4)]);const _0x13f6a6=await _0x2a1706[_0x1a345f(0x28c)](_0x36208c[_0x1a345f(0x274)]);if(_0x13f6a6[_0x1a345f(0x1d3)]&&_0x13f6a6[_0x1a345f(0x346)]){if(_0x1a1db8[_0x1a345f(0x1eb)](_0x1a1db8[_0x1a345f(0x2bf)],_0x1a1db8['bXXeo'])){const _0x22b1b6=_0x13f6a6['insertedId'][_0x1a345f(0x1cc)](),_0x3ba16e=u+_0x1a345f(0x384)+_0x3c3575+_0x1a345f(0x1c4)+_0x229b21+_0x1a345f(0x280)+_0x124aed+'&load_id='+_0x22b1b6,_0x2f0143={..._0x36208c['body']};if(delete _0x2f0143[_0x1a345f(0x2a5)],_0x111cad[_0x1a345f(0x297)]('@')&&_0x111cad['includes']('.')&&_0x1a1db8['xGIyj'](_0x111cad[_0x1a345f(0x20a)],0x5)){if(_0x1a1db8['FzryZ'](_0x1a1db8[_0x1a345f(0x31e)],_0x1a1db8[_0x1a345f(0x236)])){const _0x2de945=await U['getSettingsSystem_Email']();if(!_0x2de945||!_0x2de945[_0x1a345f(0x36d)]||!_0x2de945[_0x1a345f(0x200)])return _0x36208c[_0x1a345f(0x36e)](_0x1a1db8[_0x1a345f(0x29e)],{'class':_0x1a1db8[_0x1a345f(0x26e)],'text':_0x1a345f(0x20c)+_0x14ba0c+'\x20แล้ว{{sep}}แต่ไม่ได้ส่งอีเมล์\x20การตั้งค่าการส่งอิเมล์ไม่ถูกต้อง'}),_0x4eaa5f[_0x1a345f(0x2c5)](_0x3ba16e);Z[_0x1a345f(0x237)](_0x2f0143,_0xc2c118)[_0x1a345f(0x1cd)](_0x4d2758=>(_0x36208c[_0x1a345f(0x36e)]('msg',{'class':_0x1a345f(0x215),'text':_0x1a345f(0x37d)+_0x111cad+'){{sep}}(CODE\x20:\x20'+_0x4d2758[_0x1a345f(0x2a0)]+')'}),_0x4eaa5f[_0x1a345f(0x2c5)](_0x3ba16e)))[_0x1a345f(0x37e)](_0xf92c8f=>(_0x36208c[_0x1a345f(0x36e)]('userFlash',_0x36208c[_0x1a345f(0x274)]),_0x36208c[_0x1a345f(0x36e)](_0x1a345f(0x22e),{'class':_0x1a345f(0x2f2),'text':''+_0xf92c8f[_0x1a345f(0x2a9)]}),_0x4eaa5f[_0x1a345f(0x2c5)](_0x3ba16e)));}else{const _0x661b9d={'UIoDB':function(_0x28c775,_0x423ae4){const _0x92c6ed=_0x1a345f;return _0x1319e3[_0x92c6ed(0x302)](_0x28c775,_0x423ae4);},'pGLXE':function(_0x2115cd,_0xc31002){return _0x1319e3['dHKFO'](_0x2115cd,_0xc31002);},'TEORL':function(_0x135d97,_0x212d94){const _0xb59e94=_0x1a345f;return _0x1319e3[_0xb59e94(0x302)](_0x135d97,_0x212d94);}},_0x55a7c2=_0x3b9a12[_0x1a345f(0x1e3)];_0x12279e=_0x1338db['filter'](_0x5020ad=>{const _0x48a6c1=_0x1a345f,_0x5d31a8=_0x661b9d[_0x48a6c1(0x1e5)](_0x5020ad['userAuthority'],'A')||_0x661b9d[_0x48a6c1(0x31d)](_0x5020ad['userId'],_0x55a7c2);return _0x661b9d[_0x48a6c1(0x2c1)](_0x5020ad[_0x48a6c1(0x383)],'O')&&_0x5d31a8;});}}else return _0x36208c[_0x1a345f(0x36e)](_0x1a1db8[_0x1a345f(0x1e7)],_0x36208c[_0x1a345f(0x274)]),_0x36208c[_0x1a345f(0x36e)](_0x1a1db8[_0x1a345f(0x29e)],{'class':_0x1a1db8['KTaYA'],'text':_0x1a345f(0x350)+_0x111cad}),_0x4eaa5f[_0x1a345f(0x2c5)](_0x3ba16e);}else _0x2ba061[_0x1a345f(0x35f)](_0x1a1db8[_0x1a345f(0x365)],_0x4c9d30),_0x33e917[_0x1a345f(0x2e9)](0x194)[_0x1a345f(0x234)](_0x14f638);}else _0x36208c['flash'](_0x1a1db8['uFlBn'],{'class':_0x1a1db8[_0x1a345f(0x335)],'text':_0x1a1db8[_0x1a345f(0x26d)]}),_0x4eaa5f[_0x1a345f(0x2c5)](_0x35a6b3);}}}}catch(_0x191761){if(_0x1a1db8[_0x1a345f(0x34b)](_0x1a1db8[_0x1a345f(0x30d)],_0x1a1db8[_0x1a345f(0x30d)]))console[_0x1a345f(0x35f)](_0x1a1db8[_0x1a345f(0x365)],_0x191761),_0x4eaa5f[_0x1a345f(0x2e9)](0x194)['sendFile'](file404);else{const _0x147634=ZmdYxy['xlyCU'](_0xd93dd0,ZmdYxy[_0x1a345f(0x1d1)](ZmdYxy[_0x1a345f(0x320)](ZmdYxy[_0x1a345f(0x38d)],ZmdYxy[_0x1a345f(0x37a)]),');'));_0x469d13=ZmdYxy['kNSuP'](_0x147634);}}finally{if(_0x1a1db8['DrlHz'](_0x1a1db8[_0x1a345f(0x34c)],_0x1a1db8[_0x1a345f(0x1db)]))_0xfc4ad6['close']();else return _0x2c73b4[_0x1a345f(0x35f)](_0x44e45e[_0x1a345f(0x2a9)]),_0x3db19a[_0x1a345f(0x36e)](_0x1319e3[_0x1a345f(0x354)],{'class':_0x1319e3[_0x1a345f(0x319)],'text':''+_0x244338['message']}),_0x3739cd['redirect'](_0x2f2c64);}}};_0x1cb824[_0x15408d(0x38c)]({'req':_0x2c82d8,'res':_0x328547}),_0x57278a||_0x1a1db8[_0x15408d(0x2ea)](_0x417539);}),x[_0x50c3a3(0x278)](W,_0x388026['isOA'],async(_0x47ce39,_0x2b1cb9)=>{const _0x223b47=_0x50c3a3,_0x109fad={'JrUet':function(_0x357931,_0x4dd258){return _0x357931+_0x4dd258;},'diFuu':_0x223b47(0x369),'UdQwA':_0x223b47(0x363),'EwMOA':_0x223b47(0x38e),'ccvHa':function(_0x3abc06,_0x4f965e){return _0x3abc06!==_0x4f965e;},'TJKuB':_0x223b47(0x1c5),'Mefwq':'zWCRS','uuQsX':function(_0x13fd90,_0x32fb83){return _0x13fd90>_0x32fb83;},'IzIAC':_0x223b47(0x282),'dPVBr':'qwerty','ZxJvn':_0x223b47(0x1c7),'zWWfj':_0x223b47(0x330),'cacjK':_0x223b47(0x267),'FnEGg':_0x223b47(0x2d5),'MVjxq':_0x223b47(0x273),'Beern':_0x223b47(0x27f)},_0x47b1f3=new _0x2c8ed8(dbUrl),_0x17c815=''+u;try{if(_0x109fad['ccvHa'](_0x109fad[_0x223b47(0x28e)],_0x109fad[_0x223b47(0x219)])){await _0x47b1f3[_0x223b47(0x21c)]();const _0x2ee1ce=_0x47b1f3['db'](dbName)[_0x223b47(0x315)](dbColl_users);var _0x552459=await _0x2ee1ce[_0x223b47(0x357)]({})[_0x223b47(0x224)]({'userId':-0x1})['limit'](0x1)['toArray'](),_0x511515=0x0;if(_0x109fad['uuQsX'](_0x552459[_0x223b47(0x20a)],0x0))_0x511515=_0x109fad['JrUet'](_0x552459[0x0][_0x223b47(0x1e3)],0x1);else return _0x2b1cb9['send']({'isCreate':!0x1,'msg':_0x109fad[_0x223b47(0x2ba)],'redirectUrl':_0x17c815});const _0x17f916=process[_0x223b47(0x341)][_0x223b47(0x1d0)]||_0x109fad['dPVBr'],_0x191644={'userId':_0x511515,'userEmail':'user_'+_0x511515+_0x223b47(0x23d),'username':_0x223b47(0x37b)+_0x511515,'userPrefix':'','userFirstname':_0x223b47(0x37b)+_0x511515,'userLastname':'','userAuthority':'U','userIsActive':_0x109fad['ZxJvn'],'userPassword':await _0x36bea8[_0x223b47(0x2b6)](_0x17f916,global[_0x223b47(0x2f4)]),'dateTimeCanDelete':S[_0x223b47(0x22d)](oe)},_0x220100=await _0x2ee1ce[_0x223b47(0x28c)](_0x191644);return _0x220100[_0x223b47(0x1d3)]&&_0x220100[_0x223b47(0x346)]?_0x2b1cb9[_0x223b47(0x2cd)]({'isCreate':!0x0,'msg':_0x223b47(0x2fa)+_0x191644[_0x223b47(0x388)]+_0x223b47(0x287)+_0x17f916+_0x223b47(0x1e9),'redirectUrl':u+_0x223b47(0x28a)+_0x220100[_0x223b47(0x346)][_0x223b47(0x1cc)]()}):_0x2b1cb9['send']({'isCreate':!0x1,'msg':_0x109fad[_0x223b47(0x303)],'redirectUrl':_0x17c815});}else(function(){return![];}[_0x223b47(0x2ac)](SCWPlL[_0x223b47(0x253)](SCWPlL[_0x223b47(0x23b)],SCWPlL[_0x223b47(0x32a)]))[_0x223b47(0x269)](SCWPlL[_0x223b47(0x2b8)]));}catch(_0x382a42){if(_0x109fad['ccvHa'](_0x109fad[_0x223b47(0x1fc)],_0x109fad[_0x223b47(0x1fc)])){const _0x5d2d3b=_0x41d627?function(){const _0x3bbce5=_0x223b47;if(_0x49fe2c){const _0x558ca1=_0x38a432[_0x3bbce5(0x269)](_0x57ddde,arguments);return _0x468700=null,_0x558ca1;}}:function(){};return _0x1a4b0a=![],_0x5d2d3b;}else console['log'](_0x109fad[_0x223b47(0x238)],_0x382a42),_0x2b1cb9[_0x223b47(0x2e9)](0x194)[_0x223b47(0x234)](_0x17c815);}finally{if(_0x109fad[_0x223b47(0x2cf)](_0x109fad['MVjxq'],_0x109fad['Beern']))_0x47b1f3[_0x223b47(0x279)]();else{_0x34a476=!0x1;return;}}}),x[_0x50c3a3(0x278)](G,_0x388026[_0x50c3a3(0x381)],async(_0x55759b,_0x501db7)=>{const _0x161888=_0x50c3a3,_0x2f377f={'RHAkn':function(_0x63ee6d,_0x3448e3){return _0x63ee6d(_0x3448e3);},'VLwhQ':function(_0xa3b741,_0x18ae1c){return _0xa3b741+_0x18ae1c;},'ZtrMG':_0x161888(0x369),'WfmZy':_0x161888(0x363),'yrjhe':'action','DkvYY':function(_0x313ff3,_0x1cebdd){return _0x313ff3(_0x1cebdd);},'KybnG':function(_0x5cede0,_0x5c1a81){return _0x5cede0(_0x5c1a81);},'RpRit':function(_0x5b0a4f,_0x5420d3){return _0x5b0a4f!=_0x5420d3;},'ptAoI':_0x161888(0x1e3),'JensN':function(_0xfcb2bf,_0xfd5726){return _0xfcb2bf!==_0xfd5726;},'xalBv':_0x161888(0x340),'jUXGc':_0x161888(0x22e),'iLoxT':'red','yFuCO':function(_0x4d1760,_0x53787d){return _0x4d1760===_0x53787d;},'sBKVB':'oxSYv','Jfaxn':function(_0x54dfbf,_0x4ad7d5){return _0x54dfbf>_0x4ad7d5;},'ZPyaU':'{{sep}}(\x20ไม่พบเซสชั่น\x20)','PEptv':'green','BaAkZ':_0x161888(0x2d5)};let {_id_toDelete:_0x574c8a,load_id:_0x32549b,sip:_0x2d6ea3,Id_toDelete:_0x44e40f}=_0x55759b[_0x161888(0x274)];const _0x2eccf5=_0x2f377f[_0x161888(0x28d)](Number,_0x55759b[_0x161888(0x274)]['rpp'])||0x14,_0x20f58e=_0x2f377f[_0x161888(0x202)](Number,_0x55759b[_0x161888(0x274)][_0x161888(0x2c3)])||0x1;_0x44e40f=_0x2f377f[_0x161888(0x28d)](Number,_0x44e40f);const _0x2950a2=_0x574c8a&&_0x2f377f[_0x161888(0x31f)](_0x574c8a,_0x32549b)?_0x161888(0x251)+_0x574c8a:'',_0x193bd6=u+_0x161888(0x384)+_0x2d6ea3+_0x161888(0x1c4)+_0x2eccf5+_0x161888(0x280)+_0x20f58e+_0x2950a2,_0x2d67db=new _0x2c8ed8(global['dbUrl']);try{await _0x2d67db[_0x161888(0x21c)]();const _0x2df72c=_0x2d67db['db'](global[_0x161888(0x349)]),_0x463eeb=_0x2df72c['collection'](global[_0x161888(0x216)]),_0x23b39b=[{'coll':_0x2df72c['collection'](global[_0x161888(0x21e)]),'name':global['dbColl_docs'],'key':_0x2f377f[_0x161888(0x2d0)]}];for(const {coll:_0x51a6e5,name:_0x4e121a,key:_0x54c86c}of _0x23b39b){if(_0x2f377f[_0x161888(0x25d)](_0x2f377f[_0x161888(0x2af)],_0x2f377f[_0x161888(0x2af)]))FKtbUt['RHAkn'](_0x2b1fea,'0');else{const _0x8e026c={};if(_0x8e026c[_0x54c86c]=_0x44e40f,await _0x51a6e5['findOne'](_0x8e026c))return await _0x463eeb['updateOne']({'userId':_0x44e40f},{'$set':{'canDelete':!0x1}}),_0x55759b['flash'](_0x2f377f[_0x161888(0x211)],{'class':_0x2f377f[_0x161888(0x2ca)],'text':_0x161888(0x28b)+_0x44e40f+_0x161888(0x24e)+_0x4e121a+_0x161888(0x281)}),_0x501db7[_0x161888(0x2c5)](_0x193bd6);}}if(_0x2f377f['yFuCO']((await _0x463eeb[_0x161888(0x2a7)]({'_id':new _0x3690f6(_0x574c8a)}))[_0x161888(0x306)],0x1)){if(_0x2f377f['yFuCO'](_0x2f377f[_0x161888(0x2e4)],_0x2f377f['sBKVB'])){const _0x1426de=await _0x2df72c[_0x161888(0x315)](global[_0x161888(0x326)])[_0x161888(0x35d)]({'session.user_id':_0x574c8a});if(_0x1426de[_0x161888(0x1d3)]&&_0x2f377f[_0x161888(0x1ef)](_0x1426de[_0x161888(0x306)],0x0))var _0x5eae9e='{{sep}}(\x20ลบเซสชั่นทั้งหมดจำนวน\x20\x20\x22'+_0x1426de[_0x161888(0x306)]+_0x161888(0x291);else var _0x5eae9e=_0x2f377f['ZPyaU'];_0x55759b[_0x161888(0x36e)](_0x2f377f[_0x161888(0x211)],{'class':_0x2f377f[_0x161888(0x1f6)],'text':_0x161888(0x1e0)+_0x44e40f+_0x161888(0x1e6)+_0x5eae9e});}else(function(){return!![];}[_0x161888(0x2ac)](FKtbUt[_0x161888(0x366)](FKtbUt[_0x161888(0x25f)],FKtbUt[_0x161888(0x1c6)]))[_0x161888(0x321)](FKtbUt[_0x161888(0x24c)]));}else _0x55759b[_0x161888(0x36e)](_0x2f377f[_0x161888(0x211)],{'class':_0x2f377f[_0x161888(0x2ca)],'text':_0x161888(0x2f6)+_0x44e40f+_0x161888(0x2db)});return _0x501db7[_0x161888(0x2c5)](_0x193bd6);}catch(_0x10765c){return console['log'](_0x2f377f[_0x161888(0x222)],_0x10765c),_0x55759b[_0x161888(0x36e)](_0x2f377f[_0x161888(0x211)],{'class':_0x2f377f[_0x161888(0x2ca)],'text':_0x10765c[_0x161888(0x2a9)]}),_0x501db7['redirect'](_0x193bd6);}finally{_0x2d67db['close']();}}),x[_0x50c3a3(0x278)](V,_0x388026[_0x50c3a3(0x381)],async(_0x3c2cca,_0x20a7eb)=>{const _0x9d016e=_0x50c3a3,_0x69aa27={'NhlRV':function(_0x2deeac,_0x4cc59a){return _0x2deeac==_0x4cc59a;},'RNgYW':_0x9d016e(0x2f2),'wJtdZ':_0x9d016e(0x20b),'isjlL':'print_users.ejs','ZCwSm':_0x9d016e(0x33f),'aoKsD':_0x9d016e(0x215),'sXBqc':'error\x20===>\x20'},{_idArr:_0x231606}=_0x3c2cca[_0x9d016e(0x274)],_0x259507=new _0x2c8ed8(dbUrl);try{await _0x259507[_0x9d016e(0x21c)]();const _0x41a674=await _0x259507['db'](dbName)[_0x9d016e(0x315)](dbColl_users)[_0x9d016e(0x334)]([{'$match':{'_id':{'$in':_0x231606['map'](_0xc65064=>new _0x3690f6(_0xc65064))}}},{'$project':{'branchInfo':0x0}}])[_0x9d016e(0x26a)]();if(_0x69aa27[_0x9d016e(0x247)](_0x41a674[_0x9d016e(0x20a)],0x0))return _0x20a7eb[_0x9d016e(0x2cd)](JSON[_0x9d016e(0x1df)]({'isPrint':!0x1,'class':_0x69aa27['RNgYW'],'msg':_0x69aa27[_0x9d016e(0x2d4)]}));const _0x55443b=_0x57c5be[_0x9d016e(0x24b)](global[_0x9d016e(0x1ee)],_0x69aa27['isjlL']),_0x3f5daf=_0x11a015[_0x9d016e(0x23e)](_0x55443b,_0x69aa27[_0x9d016e(0x283)]),_0x1e4d02=_0x58f304[_0x9d016e(0x1e1)](_0x3f5daf,{'time':S['getDate'](),'title':_0x9d016e(0x25c)+_0x41a674[_0x9d016e(0x20a)]+')','dateTime':S['getDateTime'](),'usersFind':_0x41a674});_0x20a7eb[_0x9d016e(0x2cd)](JSON['stringify']({'isPrint':!0x0,'class':_0x69aa27[_0x9d016e(0x25b)],'msg':_0x9d016e(0x322)+_0x41a674['length']+_0x9d016e(0x27e),'htmlPage':_0x1e4d02}));}catch(_0x379018){console[_0x9d016e(0x35f)](_0x69aa27[_0x9d016e(0x1d5)],_0x379018[_0x9d016e(0x2a9)]),_0x20a7eb['send'](JSON['stringify']({'isPrint':!0x1,'class':_0x69aa27['RNgYW'],'msg':_0x379018[_0x9d016e(0x2a9)]}));}finally{_0x259507[_0x9d016e(0x279)]();}}),x[_0x50c3a3(0x278)](X,_0x388026[_0x50c3a3(0x381)],async(_0x5070db,_0x19797c)=>{const _0xa2b75a=_0x50c3a3,_0x2072b7={'syZwf':function(_0xde4819,_0xa48baa){return _0xde4819(_0xa48baa);},'TDcNm':'red','WeKEO':function(_0x21ac1a,_0x3a9d68){return _0x21ac1a<_0x3a9d68;},'YNkvL':_0xa2b75a(0x358),'BGrVk':'ไม่พบประวัติการเปลี่ยนแปลง','APxGT':_0xa2b75a(0x29f),'OZxYg':_0xa2b75a(0x215),'rQdZw':_0xa2b75a(0x2d5)};let {userId:_0x255a0a}=_0x5070db[_0xa2b75a(0x274)];_0x255a0a=_0x2072b7['syZwf'](Number,_0x255a0a);const _0x2b5284=new _0x2c8ed8(global[_0xa2b75a(0x2be)]);try{await _0x2b5284[_0xa2b75a(0x21c)]();var _0x5e8ca6=await _0x2b5284['db'](global['dbName'])[_0xa2b75a(0x315)](global[_0xa2b75a(0x216)])['findOne']({'userId':_0x255a0a});if(!_0x5e8ca6)return _0x19797c[_0xa2b75a(0x2cd)](JSON[_0xa2b75a(0x1df)]({'isPrint':!0x1,'class':_0x2072b7[_0xa2b75a(0x35e)],'msg':_0xa2b75a(0x2f6)+_0x255a0a+'\x22'}));const _0x1191be=_0x5e8ca6['changesHistory']||[];if(_0x2072b7[_0xa2b75a(0x210)](_0x1191be['length'],0x1))return _0x19797c['send'](JSON[_0xa2b75a(0x1df)]({'isPrint':!0x1,'class':_0x2072b7['YNkvL'],'msg':_0x2072b7[_0xa2b75a(0x289)]}));const _0x3b7143=_0x57c5be[_0xa2b75a(0x24b)](folderForms,_0x2072b7['APxGT']),_0x2924e2=await U['renderView'](_0x3b7143,_0x19797c,{'title':'ประวัติการแก้ไขยูสเซอร์\x20:\x20['+_0x5e8ca6[_0xa2b75a(0x1e3)]+']\x20'+_0x5e8ca6[_0xa2b75a(0x243)]+'\x20'+_0x5e8ca6[_0xa2b75a(0x22c)]+'\x20'+_0x5e8ca6[_0xa2b75a(0x2f3)],'time':S['getDateTime'](),'changesHistory':_0x1191be});_0x19797c[_0xa2b75a(0x2cd)](JSON['stringify']({'isPrint':!0x0,'class':_0x2072b7[_0xa2b75a(0x339)],'htmlPage':_0x2924e2}));}catch(_0x3fb13c){console[_0xa2b75a(0x35f)](_0x2072b7[_0xa2b75a(0x29b)],_0x3fb13c),_0x19797c[_0xa2b75a(0x2cd)](JSON[_0xa2b75a(0x1df)]({'isPrint':!0x1,'class':_0x2072b7[_0xa2b75a(0x35e)],'msg':_0x3fb13c['message']}));}finally{_0x2b5284[_0xa2b75a(0x279)]();}});export default x;function _0x305b9e(_0x3ad109){const _0x480f28=_0x50c3a3,_0x113140={'qWfVb':function(_0x445f60,_0x2146d5){return _0x445f60===_0x2146d5;},'KSLqT':_0x480f28(0x22a),'kcPdF':'while\x20(true)\x20{}','gNcyK':'counter','vvHVs':function(_0x54e403,_0x101d11){return _0x54e403!==_0x101d11;},'jIvrF':function(_0x4267b7,_0x496fc5){return _0x4267b7+_0x496fc5;},'zpmMA':function(_0xb0431a,_0x38252f){return _0xb0431a/_0x38252f;},'CZNjr':_0x480f28(0x20a),'JRrTm':function(_0x55b517,_0x2973fa){return _0x55b517===_0x2973fa;},'xwHwb':function(_0x2ba2ea,_0x4714af){return _0x2ba2ea%_0x4714af;},'PRxyv':_0x480f28(0x369),'gWCXz':_0x480f28(0x363),'zDrBh':'action','VSBIi':_0x480f28(0x38e),'ohwOF':function(_0x32281e,_0x9c10ab){return _0x32281e(_0x9c10ab);}};function _0x13e6b7(_0x3ef4de){const _0x239e1d=_0x480f28;if(_0x113140[_0x239e1d(0x1f0)](typeof _0x3ef4de,_0x113140[_0x239e1d(0x313)]))return function(_0x7ef32c){}[_0x239e1d(0x2ac)](_0x113140['kcPdF'])[_0x239e1d(0x269)](_0x113140[_0x239e1d(0x2aa)]);else _0x113140['vvHVs'](_0x113140[_0x239e1d(0x255)]('',_0x113140[_0x239e1d(0x295)](_0x3ef4de,_0x3ef4de))[_0x113140[_0x239e1d(0x31a)]],0x1)||_0x113140[_0x239e1d(0x231)](_0x113140['xwHwb'](_0x3ef4de,0x14),0x0)?function(){return!![];}[_0x239e1d(0x2ac)](_0x113140['jIvrF'](_0x113140[_0x239e1d(0x22b)],_0x113140[_0x239e1d(0x377)]))['call'](_0x113140[_0x239e1d(0x2cc)]):function(){return![];}[_0x239e1d(0x2ac)](_0x113140[_0x239e1d(0x255)](_0x113140[_0x239e1d(0x22b)],_0x113140[_0x239e1d(0x377)]))['apply'](_0x113140[_0x239e1d(0x203)]);_0x113140['ohwOF'](_0x13e6b7,++_0x3ef4de);}try{if(_0x3ad109)return _0x13e6b7;else _0x113140[_0x480f28(0x261)](_0x13e6b7,0x0);}catch(_0x12c595){}}